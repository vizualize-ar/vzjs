(function(e,t){typeof define=="function"&&define.amd?define("thd-event-emitter",[],function(){return t(e)}):e.EventEmitter=t(e)})(this,function(e){var t=function n(){n.prototype._EventEmitterEvents={},n.prototype._EventEmitterEventsComplete={}};return t.extend=function(e){t.call(e);for(var n in t.prototype)e.prototype[n]=t.prototype[n]},t.prototype.on=function(e,t){var n;e.indexOf(".")===-1&&(e+=".default"),n=e.split(".")[0],typeof this._EventEmitterEvents[e]=="undefined"&&(this._EventEmitterEvents[e]=[]);var r=Object.keys(this._EventEmitterEventsComplete).map(function(e){return e?e.split(".")[0]:""}),i=Object.keys(this._EventEmitterEventsComplete);if(r.indexOf(n)!==-1){for(var s=0;s<i.length;s++){var o=i[s],u=o.split(".");if(u[0]===n)try{t.apply(this,this._EventEmitterEventsComplete[i[s]])}catch(a){typeof console!="undefined"&&console.trace&&console.trace(a)}}this.off(e,this._EventEmitterEventsComplete[n]),typeof this._EventEmitterEvents[e]=="undefined"&&(this._EventEmitterEvents[e]=[]),this._EventEmitterEvents[e].push(t)}else if(Object.keys(this._EventEmitterEventsComplete).indexOf(e)!==-1){try{t.apply(this,this._EventEmitterEventsComplete[e])}catch(a){typeof console!="undefined"&&console.trace&&console.trace(a)}this.off(e,this._EventEmitterEventsComplete[e]),typeof this._EventEmitterEvents[e]=="undefined"&&(this._EventEmitterEvents[e]=[]),this._EventEmitterEvents[e].push(t)}else this._EventEmitterEvents[e].push(t);return this},t.prototype.off=function(e,t){if(!e){var n=Object.keys(this._EventEmitterEvents),r,i=n.length;for(r=0;r<i;r++)e=n[r],this._EventEmitterEvents[e]=null,delete this._EventEmitterEvents[e],this._EventEmitterEventsComplete[e]=null,delete this._EventEmitterEventsComplete[e];return}e.indexOf(".")===-1&&(e+=".default");if(typeof t=="undefined"){this._EventEmitterEvents[e]=null,delete this._EventEmitterEvents[e],this._EventEmitterEventsComplete[e]=null,delete this._EventEmitterEventsComplete[e];return}t=""+t;var s=function(t,n,r){if(!t[n])return;for(var i=0;i<t[n].length;i++){var s=""+t[n][i];if(r===s||s==="[object Object]"){t[n].splice(i,1);if(t[n].length===0){delete t[n];break}}}};return s(this._EventEmitterEvents,e,t),s(this._EventEmitterEventsComplete,e,t),this},t.prototype.trigger=function(e){var t=this,n=function(e,n){if(!t._EventEmitterEvents[e])return;var r=t._EventEmitterEvents[e];n.shift();for(var i=0;i<r.length;i++){var s=r[i];try{s.apply(t,n)}catch(o){typeof console!="undefined"&&console.trace&&console.trace(o)}}return!0},r,i=[].slice.apply(arguments);for(var s in this._EventEmitterEvents){var o=new RegExp("^"+e+".");o.test(s)&&(r=n(s,i.slice()))}if(!r){i.shift();var u;e.indexOf(".")===-1?u=e+".default":u=e,this._EventEmitterEventsComplete[u]=i}},t}),function(t,n){typeof define=="function"&&define.amd?define("thd-overlay",["thd-event-emitter"],n):typeof module!="undefined"&&typeof module.exports!="undefined"?module.exports=n(require("thd-event-emitter").EventEmitter):(t.THD_OVERLAY=n(t.EventEmitter),t.THD=typeof t.THD=="undefined"?{}:t.THD,t.THD.Global=typeof t.THD.Global=="undefined"?{}:t.THD.Global,t.THD.Global.Overlay=t.THD_OVERLAY)}(this,function(t){function S(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()}function x(e,t,n,r){var i,s=typeof r!="undefined"?r:!0;if(e.length&&!e.window)for(i=0;i<e.length;i++)x(e[i],t,n);else e.addEventListener?e.addEventListener(t,n,s):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function T(e,t,n){e.removeEventListener?(e.removeEventListener(t,n,!0),e.removeEventListener(t,n,!1)):e.detachEvent&&e.detachEvent("on"+t,n)}function N(e,t,n){var r;return function(){var s=this,o=arguments,u=function(){r=null,n||e.apply(s,o)},a=n&&!r;clearTimeout(r),r=setTimeout(u,t),a&&e.apply(s,o)}}function C(e){var t=e.split("#"),n,r,i;return t.length<2?e:(n=t[0].indexOf("?")===-1,n?r="?bust=":r="&bust=",i=(new Date).getTime(),t[0]+r+i+"#"+t[1])}function k(e,t){var n=e.split(" "),r,i;for(r=0;r<n.length;r++){i=n[r];if(i===t)return!0}return!1}function L(e,t){k(e.className,t)||(e.className+=" "+t)}function A(e,t){var n=e.className.split(" "),r=n.indexOf(t);r!==-1&&(n.splice(r,1),e.className=n.join(" "))}function O(e,t){var n="",r;for(r=0;r<e.length;r++)n+=e[r]+t+"\n";return n}function M(e,t){e=e||{};for(var n in t)typeof t[n]=="object"?e[n]=M(e[n],t[n]):e[n]=t[n];return e}function _(e,t,n){var r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s={x1:i/2-n/2,y1:r/2-t/2};return s.y1<30&&(e==="desktop-fullscreen"?s.y1=0:s.y1=30),e==="tablet"&&(s.y1=0),s}function D(e){var t=typeof e=="string"?document.querySelector(e):e,n=window.getComputedStyle(t),r=parseFloat(n.marginTop)+parseFloat(n.marginBottom);return Math.ceil(e.offsetHeight+r)}function P(e,t,n){var r,i=n||"*";c?r=JSON.stringify(t):r=t,e.postMessage(r,i)}function H(){var e=document.body,t=document.documentElement,n=Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight);return n}function B(){var e=document.body,t=document.documentElement,n=Math.max(e.scrollWidth,e.offsetWidth,t.clientWidth,t.scrollWidth,t.offsetWidth);return n}function j(e){var t;if(this.getAttribute("src")==="")return;(e.opts.channel==="mobile"&&e.opts.viewType==="auto"||e.opts.channel!=="mobile")&&e.setIframeBounds(),e.toggleLoader(),t={action:"set-bounds",innerHeight:e.height};if(e.opts.channel==="mobile"&&e.opts.viewType==="auto"||e.opts.channel!=="mobile")t.innerWidth=e.width;P(e.iframe.contentWindow,t),e.trigger("load"),e.resizeOverlayToContent()}function F(e){var t=document.body.className||"";y===b?k(t,"thd-overlay__body--behind-mobile")&&g==="mobile"&&(p=setTimeout(function(){h&&(A(document.body,"thd-overlay__body--behind-mobile"),!m||window.scrollTo(0,m))},100),d=setTimeout(function(){h&&(m=window.pageYOffset,L(document.body,"thd-overlay__body--behind-mobile"))},200)):e.target!==b?P(y,{action:"cancel-refocus"},"*"):P(y,{action:"refocus"},"*")}function I(){clearTimeout(p),clearTimeout(d)}function q(e){this.initiated=0,this.init(e,!0)}function R(e){return e.modalType==="drawer"}function U(){var e=document.getElementsByClassName("thd-overlay-"+this.id)[0];e&&(L(e,"hide"),setTimeout(function(){var n=0;for(n=0;n<i.length;n++)q.prototype.resetCssProps.call(i[n]);o&&clearTimeout(o),o=setTimeout(function(){A(e,"hide"),o=null},200)},100))}var n=window.document.documentElement.offsetWidth<1e3?window.document.documentElement.offsetWidth:1e3,r=662,i=[],s,o,u,a=!1,f={},l=/^(http(s?):\/\/.*\.homedepot(dev)?.com(:?\d*)|http:\/\/localhost(:?\d*)+)$/,c=!1,h,p,d,v,m,g,y=window.top,b=window,w=window.parent;try{window.postMessage({toString:function(){c=!0}},"*")}catch(E){}return x(window,"focus",F,!0),x(window,"orientationchange",function(){var t,n,r,s;for(t=0;t<i.length;t++)n=i[t],n.isMobile&&n.opts.useContent&&(r=B(),s=H(),n.width=r,n.height=s,n.iframe.style.width=r+"px",n.initialProps.width=r,n.initialProps.height=s,n.opts=n.opts||{},n.opts.width=r,n.opts.height=s,n.el.style.width=r+"px",n.resizeOverlayToContent(),n.resetCssProps(s,r))}),q.prototype.init=function(t,s){var o,u,f,c,p,d=this,v=!1,m=!1,y,b,w=t.channel==="desktop"?"top":"bottom";this.initiated++;if(t){this.initiated===1&&(this.initialOpts=t);if(t.alterBrowserHistory){var E={page:"CURRENT_PAGE"};window.history.pushState(E,null,window.location.href)}if(typeof t.iframe!="undefined"&&!t.iframe||t.htmlNode)v=!0,t.useContent=!0;u=t.iframeSrc,o=t.title||"",f=t.speed||"0.3s",p=typeof t.header!="undefined"?t.header:!1,w=t.mobileDirection?t.mobileDirection||w:t.direction||w,b=typeof t.closeButton!="undefined"?t.closeButton:!1,c=t.channel||"mobile",this.viewType=t.viewType||null,this.modalType=t.modalType||null,this.width=t.width||n,this.height=t.height||r,g=c,c==="desktop-fullscreen"&&(c="mobile",this.isDesktopFullscreen=!0,this.width=document.body.offsetWidth,this.height=document.body.offsetHeight||H()),c==="mobile"&&(w=this.viewType==="auto"?"top":w),t.hidden&&(m=!0),this.initiated===1&&(this.initialProps={height:this.height,width:this.width,channel:c,isDesktopFullscreen:this.isDesktopFullscreen})}return h=!1,I(),A(document.body,"u__body--fixed"),A(document.body,"thd-overlay__body--behind-mobile"),A(document.body,"thd-desktop"),this.opts=t,this.isOpen=!1,this.id=this.id||S(),this.el=this.addHTMLTag({title:o,useContent:v,src:u,direction:w,channel:c,header:p,hidden:m,closeButton:b,iframe:t.iframe,height:this.height,width:this.width}),v?(this.iframe=this.el.getElementsByClassName("thd-overlay-content")[0],s&&d.toggleLoader()):(this.iframe=this.el.getElementsByClassName("thd-overlay-frame")[0],this.opts.useCustomFrameListner||(this.iframe.onload=function(){y=this,a?j.call(y,d):setTimeout(function(){j.call(y,d)},200)}),s&&x(window,"message",function(t){var n=t.data;if(typeof n=="string")try{n=JSON.parse(n)}catch(r){return}if(!l.test(t.origin))return;n&&d.iframe.getAttribute("src")&&d.handleIframeAction(n)},!1)),p&&(this.header=this.el.getElementsByClassName("thd-overlay__header")[0]),this.writeCssProps({speed:f}),setTimeout(function(){d.writeCssProps({speed:f})},100),this.bind(),s&&(i.push(this),this._EventEmitterEvents={},this._EventEmitterEventsComplete={}),this},t.extend(q),q.prototype.handleIframeAction=function(t){switch(t.action){case"close":this.trigger("close"),this.close();break;case"refocus":F();break;case"cancel-refocus":I();break;case"change-overlay-type":this.changeOverlayType(t.overlayType,t.url);break;case"scrollTop":this.scrollTop();break;case"set-background-color":this.setBackgroundColor(t.color);break;case"REST_OPEN_OVERLAY":this.loadedOnce=!1;break;case"log":this.log(t.message);break;case"event":this.trigger("frame",t),t.type==="iframe-ready"&&P(this.iframe.contentWindow,{action:"SET_PARENT_URL",data:{pathname:window.location.pathname,href:window.location.href}},"*");break;case"dimension-listner":this.trigger("dimension-listner",t);break;default:}},q.prototype.resizeOverlayToContent=function(){function h(e){e.el.style.position="absolute",e.el.style.top="0",e.el.style.msTransform=u,e.el.style.webkitTransform=u,e.el.style.MozTransform=u,e.el.style.transform=u,window.scrollTo(0,0),e.debouncedScroller=N(function(n){e.preventOverlayScroll(n)},50),x(window,"scroll",e.debouncedScroller)}if(R(this.opts))return;var t={action:"dimension-listner"},n=this,r,i,s,o,u,a=!1,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c;this.preventOverlayScroll=function(t){n.isOpen&&window.scrollY>n.height-window.innerHeight+100&&(t.preventDefault(),c=n.height-window.innerHeight+100,typeof window.scroll=="function"?window.scroll({top:c,left:0,behavior:"smooth"}):window.scrollTo(0,c))};if(!this.isOpen)return;if(this.opts.useContent&&this.opts.channel==="desktop"){s=this.iframe.children[0].offsetWidth,s>window.innerWidth&&(s=window.innerWidth-50),this.el.style.width=s+"px",r=(this.opts.header||0)&&D(this.header),i=this.iframe.children[0].offsetHeight+r,this.el.style.height=i+"px",this.height=i,this.width=s;var p=this.el.querySelector(".thd-overlay-content");p.style.width=s+"px"}else this.off("dimension-listner"),this.on("dimension-listner",function(t){var r,s,c=0;if(!t)return;if(b!==y){t.height>window.document.body.offsetHeight&&(c=60),P(w,{action:"dimension-listner",height:t.height+c,width:t.width});return}r=t.height,s=t.width,r&&(this.height=r),s&&(this.width=s),o=_(this.opts.channel,this.height,this.width),u="rotateX(0deg) scale(1) translate3d("+o.x1+"px, 30px, 0)",n.opts.channel==="desktop"&&this.isOpen?(r&&r+"px"!==this.el.style.height&&(this.el.style.height=r+"px",this.iframe.style.height=r+"px",this.height=r,r&&(f.height=r,this.height=r),s&&(f.width=s,this.width=s),l<=r+o.y1?h(this):n.writeCssProps()),s&&s+"px"!==this.el.style.width&&(this.width=s,this.el.style.width=s+"px",this.iframe.style.width=s+"px",l<=this.height+o.y1?(h(this),a=!0):n.writeCssProps(),this.writeCssProps())):n.opts.channel!=="desktop"&&this.isOpen&&(r+"px"!==this.iframe.style.height&&(this.opts.channel==="mobile"&&this.viewType==="auto"?this.iframe&&this.iframe.contentDocument&&(i=this.iframe.contentDocument.documentElement.offsetHeight,this.el.style.height=i+"px",this.height=i):this.iframe.style.height=r+"px"),s+"px"!==this.iframe.style.width&&(this.iframe.style.width=s+"px"))}),this.iframe.contentWindow&&P(this.iframe.contentWindow,t)},q.prototype.toggleLoader=function(t){var n=this.el.getElementsByClassName("thd-overlay__wrapper")[0],r=this.el.getElementsByClassName("pre-loader")[0];t?(A(r,"thd-overlay--hide"),L(n,"thd-overlay--invisible")):(L(r,"thd-overlay--hide"),A(n,"thd-overlay--invisible"))},q.prototype.setTitle=function(t){var n=this.el.querySelector(".thd-overlay__title");n.innerHTML=t},q.prototype.resetDimensionsToInitialSize=function(){this.height=this.initialProps.height,this.width=this.initialProps.width},q.prototype.addHTMLTag=function(t){var n,r,i="",o,u,a="",f,l,c="";t.channel==="desktop"||t.channel==="tablet"?u="thd-overlay-desktop":u="thd-overlay-mobile",this.isMobile=!1,t.channel==="mobile"&&(this.isMobile=!0,i=t.direction||"bottom"),t.useContent?(a='<div class="thd-overlay-content"></div>',t.height&&(c+="height: "+t.height+"px;"),t.width&&(c="width: "+t.width+"px;")):a='<iframe allowtransparency="true" scrolling="no" class="thd-overlay-frame" data-src="'+(t.src||"")+'"></iframe>',t.hidden&&(c+="display:none;"),t.header&&(o=['<header class="thd-overlay__header">','<div class="grid">','<div class="col__10-12">','<h2 class="u__husky thd-overlay__title">'+t.title+"</h2>","</div>",'<div class="col__2-12 u__text-align--right">','<a href="#" class="thd-overlay__close">','<svg class="" viewBox="0 0 32 32">','<path d="M27.229 8.391l-3.385-3.386-7.843 7.838-7.84-7.84-3.386 3.385 7.609 7.608-7.613 7.612 3.385 3.386 7.843-7.838 7.84 7.841 3.387-3.386-7.61-7.608z"></path>',"</svg>","</a>","</div>","</div>","</header>"].join("")),t.closeButton&&(f=['<a href="#" class="thd-overlay__close thd-overlay__close--standAlone">','<svg class="" viewBox="0 0 32 32">','<path d="M27.229 8.391l-3.385-3.386-7.843 7.838-7.84-7.84-3.386 3.385 7.609 7.608-7.613 7.612 3.385 3.386 7.843-7.838 7.84 7.841 3.387-3.386-7.61-7.608z"></path>',"</svg>","</a>"].join("")),n=document.createElement("div");var h=" col__12-12";return R(this.opts)&&(c+="z-index: 2147483638;",c+="min-height: -webkit-fill-available;",h=""),n.innerHTML=['<div data-direction="'+t.direction+'" class="thd-overlay--hide '+u+" thd-overlay thd-overlay-"+this.id+" "+i+'" style="'+c+'">','<div class="pre-loader"><div class="segment-spinner"></div></div>','<div class="thd-overlay__wrapper thd-overlay--invisible '+(t.useContent?"thd-overlay__wrapper--content":"")+'">','<div class="thd-overlay__content'+h+" loading"+(this.isDesktopFullscreen?" thd-overlay__content--fullscreen":"")+'">',o||"",f||"",t.iframe?"":a,"</div>","</div>"].join(""),t.iframe&&n.querySelector(".thd-overlay__content").appendChild(t.iframe),r=n.firstChild,!s&&!t.hidden&&(s=document.createElement("div"),s.id="thd-overlay__screen",document.body.appendChild(s)),l=document.querySelector(".thd-overlay-"+this.id),l&&l.parentElement.removeChild(l),document.body.appendChild(n.firstChild),r},q.prototype.changeOverlayType=function(t,n){var r=M({},this.opts),i=n||this.iframe.src;r.channel=t,t==="desktop-fullscreen"&&(r.direction="top",r.mobileDirection="top"),this.init(r),this.open(i)},q.prototype.bind=function(){var t=this.el.getElementsByClassName("thd-overlay__close")[0],n=this,r=this.opts||{},i=this.opts.alterBrowserHistory;this._closeOverlay=function(t){t.preventDefault();var r=n.isOpen;if(i){var s=window.history.state,o=s?s.page:"";i&&r&&o==="CURRENT_PAGE"&&window.history.back()}n.close()},this._resize=function(){var t,r;n.isDesktopFullscreen&&(n.isOpen||n.isOpening)&&(t=B(),r=H(),n.el.style.height=r+"px",n.iframe.style.width="100%",n.postMessage({action:"set-bounds",innerWidth:t,innerHeight:r}))},t&&x(t,"click",this._closeOverlay),i&&x(window,"popstate",this._closeOverlay),x(window,"resize",this._resize),s&&x(s,"click",this._closeOverlay)},q.prototype.scrollTop=function(){var t=this.el.querySelector(".thd-overlay__content");t&&(t.scrollTop=0)},q.prototype.open=function(t,n){var r,i,o,u=this,a,f,l=this;this.overlayCloseTimer&&clearTimeout(this.overlayCloseTimer);if(this._destroyed){console.log("you can not open an overlay after it has been destroyed");return}typeof t=="object"?r=t:r=n||{},h=!0,this.loadedOnce=!1,this.opts.useContent||(i=t||this.iframe.getAttribute("data-src")||this.opts.iframeSrc,this.on("frame",function(t){t&&t.type==="iframe-ready"&&!l.loadedOnce&&l.isOpen&&(j.call(l.iframe,l),l.loadedOnce=!0)})),o=parseFloat(this.opts.speed,10),/s$/.test(this.opts.speed)&&(o*=1e3),/ms$/.test(this.opts.speed)&&(o*=10),isNaN(o)&&(o=300);if(this.isOpening)return this;this.isOpening=!0,r.title&&this.setTitle(r.title),this.setIframeBounds(),this.opts.useContent&&(r.htmlNode?(u.iframe.innerHTML="",a=r.htmlNode):a=this.opts.htmlNode,u.iframe.appendChild(a),u.toggleLoader()),A(u.el,"thd-overlay--hide"),setTimeout(function(){u.isOpening=!1},2e3);if(R(u)){var c=300;u.initialOpts.speed&&(c=parseInt(u.initialOpts.speed.replace(/[^0-9]/g,""))),setTimeout(function(){var t=document.querySelector(".thd-overlay-desktop");t&&L(t,"no-transition")},c)}return setTimeout(function(){A(u.el,"thd-overlay--hide"),L(u.el,"open"),u.isOpen=!0},100),this.opts.useContent&&setTimeout(function(){u.resizeOverlayToContent(),u.resetCssProps(u.height,u.width)},100),setTimeout(function(){u.setIframeBounds(),L(document.body,"u__body--fixed"),u.isMobile?v=setTimeout(function(){m=window.pageYOffset;if(u.viewType==="auto"){var t=document.querySelector(".thd-overlay-mobile");L(t,"auto-scale--shadow"),u.iframe&&(Number(u.iframe.offsetHeight)>screen.height?t.style.height=screen.height+"px":t.style.height=Number(u.iframe.offsetHeight)+"px")}else L(document.body,"thd-overlay__body--behind-mobile");u.isDesktopFullscreen&&L(document.body,"thd-desktop")},u.viewType==="auto"?500:1e3):R(u)&&L(document.body,"thd-overlay__body--prevent-scroll"),u.opts.useContent||(u.iframe.src=C(i)),(u.isMobile&&u.opts.viewType==="auto"||!u.isMobile)&&s&&!u.opts.hidden&&L(s,"thd-overlay__screen")},1),f=_(this.opts.channel,this.height,this.width),f.y1===30&&!u.opts.hidden&&window.scrollTo(0,0),this.closeOverlayAfterTimeOut(),this},q.prototype.closeOverlayAfterTimeOut=function(){var t=this;this.overlayCloseTimer=setTimeout(function(){!t.opts.useContent&&t.opts.iframeSrc&&!t.iframe.src&&t.close()},1e4)},q.prototype.log=function(t){console.log(t)},q.prototype.changeDirection=function(t){var n;t&&(L(this.el,"thd-overlay--hide"),setTimeout(function(){n=this.el.dataset.direction,this.el.dataset.direction=t.direction,L(this.el,t.direction||"top"),A(this.el,n),A(this.el,"thd-overlay--hide")},200))},q.prototype.destroy=function(){var t=document.getElementById("thd-overlay-style-"+this.id);t&&t.parentElement&&t.parentElement.removeChild(t),this.el&&this.el.parentElement&&this.el.parentElement.removeChild(this.el),this._destroyed=!0},q.prototype.setBackgroundColor=function(t){this.el.style.backgroundColor=t},q.prototype.close=function(){var t=this,n=[],r=[];return h=!1,this.overlayCloseTimer&&clearTimeout(this.overlayCloseTimer),T(window,"scroll",this.debouncedScroller),this.isOpen?(this.isOpening=!1,this.toggleLoader("reset"),A(this.el,"open"),R(t)&&(A(document.body,"thd-overlay__body--prevent-scroll"),A(this.el,"no-transition")),u&&clearInterval(u),t._EventEmitterEvents["frame.default"]&&(n=t._EventEmitterEvents["frame.default"].slice()),t._EventEmitterEvents["dimension-listner.default"]&&(r=t._EventEmitterEvents["dimension-listner.default"].slice()),t.trigger("close"),t.off(),t._EventEmitterEvents["frame.default"]=n,t._EventEmitterEvents["dimension-listner.default"]=r,setTimeout(function(){L(t.el,"thd-overlay--hide"),t.iframe&&t.iframe.style&&t.iframe.setAttribute("style",""),t.el&&t.el.style&&t.el.setAttribute("style",""),t.opts=t.initialOpts,t.isDesktopFullscreen=t.initialProps.isDesktopFullscreen,t.isMobile=t.initialProps.isMobile,t.height=t.initialProps.height,t.width=t.initialProps.width,t.resetDimensionsToInitialSize(),t.resetCssProps(t.height,t.width),t.init(t.opts)},601),v&&clearTimeout(v),a=!1,A(document.body,"u__body--fixed"),this.isMobile&&(A(document.body,"thd-overlay__body--behind-mobile"),!m||window.scrollTo(0,m)),s&&A(s,"thd-overlay__screen"),t.isOpen=!1,this):this},q.prototype.setIframeBounds=function(){if(this.opts.channel!=="desktop")return;if(this.opts.useContent)return;var t=this.height+"px",n=this.width+"px";R(this.opts)&&(t="100vh"),this.opts.useContent||(this.iframe.style.height=t,this.iframe.style.width=n,R(this.opts)&&(this.iframe.style.height="100%")),this.el.style.height=t,this.el.style.width=n},q.prototype.resetIframeBounds=function(){this.el.setAttribute("style",""),this.opts.useContent||this.iframe.setAttribute("style","")},q.prototype.resetCssProps=function(t,n){var r=document.getElementById("thd-overlay-style-"+this.id);r&&r.parentElement.removeChild(r),this.opts.channel!=="mobile"&&(this.height=t||window.innerHeight,this.width=n||window.innerWidth),this.setIframeBounds(),this.writeCssProps()},q.prototype.postMessage=function(t){this.iframe&&this.iframe.contentWindow&&P(this.iframe.contentWindow,t)},q.prototype.writeCssProps=function(t){var n={speed:"500ms"},r=[".thd-overlay.top {","top: 100%;","}",".thd-overlay-"+this.id+".top.open {","top: 0;","display:block;","}",".thd-overlay-"+this.id+".right {","right: 200%;","left: -100%;","}",".thd-overlay-"+this.id+".right.open {","right: 0;","left: 0;","}",".thd-overlay-"+this.id+".bottom {","bottom: 100%;","}",".thd-overlay-"+this.id+".bottom.open {","bottom: 0;","}",".thd-overlay-"+this.id+".left {","left: 100%;","}",".thd-overlay-"+this.id+".left.open {","left: 0;","}",".thd-overlay.thd-overlay-desktop {","display:none;","margin:0 auto;","}",".thd-overlay.thd-overlay-desktop.open {","display:block;","}"].join("\n"),i=["-ms-","-webkit-",""],s=_(this.opts.channel,this.height,this.width),o,u,a,f,l=!1,c;typeof t=="string"?n.speed=t:n=M(n,t),c=n.speed||this.opts.speed||"0.3s",o=[".thd-overlay-"+this.id+".thd-overlay-desktop {",O(i,"transform: rotateX(90deg) scale(1) translate3d("+s.x1+"px, "+s.y1+"px, 200px);"),"}",".thd-overlay-"+this.id+".thd-overlay-desktop.open {",s.y1===30?"position:absolute;":"",O(i,"transform: rotateX(0deg) scale(1) translate3d("+s.x1+"px, "+s.y1+"px, 0px);"),"}"].join("\n"),R(this.opts)&&(o=[".thd-overlay-"+this.id+".thd-overlay-desktop {",O(i,"transform: translateX(100%);"),"left: auto;","}",".thd-overlay-"+this.id+".thd-overlay-desktop.open {",O(i,"transform: translateX(0);"),"left: auto;","}",".thd-overlay-"+this.id+".no-transition {",O(i,"transition: none;"),"}"].join("\n")),u=[".thd-overlay-"+this.id+".bottom {",O(i,"transform: translate(0, "+this.height+"px);"),"}",".thd-overlay-"+this.id+".bottom.open {",O(i,"transform: translate(0, 0);"),"}",".thd-overlay-"+this.id+".right {",O(i,"transform: translate( "+this.height+"px, 0);"),"}",".thd-overlay-"+this.id+".right.open {",O(i,"transform: translate( 0, 0);"),"}",".thd-overlay-"+this.id+".top {",O(i,"transform: translate(0, -"+this.height+"px);"),"}",".thd-overlay-"+this.id+".top.open {",O(i,"transform: translate(0, 0);"),"}",".thd-overlay-"+this.id+".left {",O(i,"transform: translate( -"+this.width+"px, 0);"),"}",".thd-overlay-"+this.id+".left.open {",O(i,"transform: translate(0, 0);"),"}",".thd-overlay-"+this.id+".thd-overlay-desktop {",O(i,"transform: rotateX(90deg) scale(1) translate3d("+s.x1+"px, "+s.y1+"px, 200px);"),"}",".thd-overlay-"+this.id+".thd-overlay-desktop.open {",O(i,"transform: rotateX(0deg) scale(1) translate3d("+s.x1+"px, "+s.y1+"px, 0px);"),"}"].join("\n"),a=[".thd-overlay-"+this.id+" {",O(i,"transition: height "+c+", width "+c+", transform "+c+", right "+c+", bottom "+c+", left "+c+";"),"}"].join("\n"),f=document.getElementById("thd-overlay-style-"+this.id),f||(f=document.createElement("style"),f.id="thd-overlay-style-"+this.id,l=!0),typeof f.style.transform!="undefined"?f.innerHTML=[u,a,o].join("\n"):f.innerHTML=[r,a].join("\n"),l&&document.body.appendChild(f)},window.onorientationchange=function(){if(i===undefined||i.length===0)return;var t;try{t=top.document.body.className,top.document.body.className="",setTimeout(function(){top.document.body.className=t},100),U()}catch(n){}},x(window,"resize",U),q.close=function(){window!==top?P(parent,{action:"close"}):window.close()},q.resize=function(t){var n=document.querySelector(".thd-overlay-iframe-wrapper");if(!t)return;n&&(t.height&&(n.style.height=t.height+"px"),t.width&&(n.style.width=t.width+"px")),q.postMessage({action:"dimension-listner",from:"resize",width:t.width,height:t.height})},q.postMessage=function(t){b!==y&&(P(y,t),top!==parent&&P(w,t))},q.setBackgroundColor=function(t){q.postMessage({action:"set-background-color",color:t})},q.resetOpenOverlay=function(){var t=0,n;for(t=0;t<i.length;t++)n=i[t],n.isOpen&&(n.loadedOnce=!1)},q.initFrame=function(t,n,r){function c(){var e,t,n,r=[],i;t=Math.min(Math.max(window.document.body.offsetHeight,window.document.body.scrollHeight),window.document.documentElement.scrollHeight),r=[Math.max(window.document.body.offsetWidth,window.document.body.scrollWidth),window.document.documentElement.scrollWidth],i=document.querySelector(".thd-overlay-iframe-wrapper"),i&&r.push(i.scrollWidth||1e5),n=Math.min.apply(null,r),e={action:"dimension-listner"},t&&s!==t&&t>100&&(e.height=t,s=t),n&&o!==n&&n>100&&(e.width=n,o=n),Object.keys(e).length>1&&(f.height=e.height,f.width=e.width,P(parent,e))}function h(e){var n;if(!l.test(e.origin)&&!r)return;n=e.data;if(typeof n=="string")try{n=JSON.parse(n)}catch(s){return}n.action==="set-bounds"&&n.innerWidth&&(t.style.width=n.innerWidth+"px",f.height=n.innerHeight,f.width=n.innerWidth),n.action==="dimension-listner"&&(u&&clearInterval(u),setTimeout(function(){u=setInterval(c,i)},200))}var i=n||200,s,o;(y!==b&&w===y||r)&&x(window,"message",h,!1),t.className+="thd-overlay-iframe-wrapper",a=!0},q});