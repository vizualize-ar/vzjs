if (typeof TurnTo == 'undefined'){TurnTo = {};TurnTo.matchData={"site":{"siteId":794,"siteName":"Lamps Plus","ask":true,"ps":true,"sm":true,"useNewCdnPath":true,"syndicationSiteType":0,"maxAnswerEmails":3,"daysToSendAnswers":14,"miq":false,"mia":false,"mobileTraPageUrl":"https://www.lampsplus.com/productreviews/","lpUrl":"http://www.lampsplus.com","enableThankingUsers":false,"traSkipTurntodoneInLocation":false,"questionsPageSize":30,"relatedQuestionsPageSize":5,"reviewsEnabled":true,"acceptedReviewsType":1,"reviewsMinLength":10,"reviewsMaxLength":5000,"reviewsPageSize":50,"relatedReviewsPageSize":10,"isSortByReviewRatingsEnabled":false,"skipDEifNoSku":false,"deviceFingerprintOn":true,"instAnsFromIngestedReviews":false,"serviceForJsFeedDetailsByApi":"","jsonLdMetadata":false,"fbAppId":"52786337232","vcSettings":{"activation":{"question":false,"answerReply":false,"review":true,"standAlone":true},"acceptedImageMimeTypes":["image/gif","image/jpeg","image/jpg","image/pjpeg","image/png","image/x-png"],"maxImageSize":10485760}}};} 
(function() {
  var mp = {"tra.qa.showMoreRelatedQuestions.other":"Show {0} More Questions For Similar Products","tra.qa.answer.linkLine.purchasedOneOfItemsFromSite":"(Purchased one of the attached items from {0})","tra.qaTeaser.link.browseQuestions.other":"Browse {0} questions","tra.settings.unconfirmed":"Unconfirmed","tra.qa.answer.linkLine.puchasedOnDate":"Purchased on {0}","tra.qa.answer.reg.header":"Thank you for answering!","tra.settings.header.emailAddresses":"Email Addresses","tra.qa.miqa.message.searchReturned.other":"Your search returned {0} results.","tra.qa.question.linkLine.hideAnswers":"Hide answers","tra.qa.answer.message.clickForMoreToAnswer":"Click here to see more questions that need answers.","tra.qaTeaser.header.inputTeaser":"Need advice? More information?","tra.settings.photo.cancel":"Cancel","tra.qa.askArea.info.instruction.howThisWorks2":"2. If there aren&#39;t any, submit a new question. You&#39;ll get fast answers from customers who really own the item(s) and from our product experts. (About half the time you&#39;ll get an answer in under 2 hours, depending on your question and the item you are asking about...)","tra.qa.askArea.info.goodTopics6":"Our store policies","tra.qa.askArea.info.instruction.howThisWorks1":"1. Type in your question. If there are matching questions in our Q&A database, we&#39;ll show them immediately.","tra.qa.askArea.info.goodTopics5":"General advice related to the types of products we sell","tra.qa.askArea.info.goodTopics4":"Product information","tra.qa.askArea.info.goodTopics3":"How to use, fix, or take care of an item","tra.wrev.reg.instruction.lookupProfileConnectOrProvide":"Please verify your information so we can post your comments.","tra.qa.askArea.info.goodTopics2":"What customers who own an item think of it","tra.qa.askArea.info.goodTopics1":"Which items will best meet your needs","tra.wrev.error.country.blank":"Please enter a country.","tra.wrev.error.title.maxLength":"Your review title must {0} characters or less in length.","tra.moreFeedback.prompt.shareMore.afterSubmission":"Thanks! Want to contribute more?","tra.qa.answer.prompt.tellMe":"Tell me when other people answer or comment on this.","tra.qa.miqa.alt.remove":"Remove","tra.settings.header.basicInfo":"Basic Information","tra.qa.askArea.info.header.goodTopics":"Good Topics To Ask About","tra.chatter.standalone.expandText":"Read More","tra.chatter.message.loadingMore":"Loading more...","tra.qa.title.relatedQuestions":"Questions For Similar Products","tra.revTeaser.or":"or","tra.common.expertBadge":"Expert","tra.rev.showMoreReviews.few":"Show {0} More Reviews For This Product","tra.wrev.error.stateother.blank":"Please enter a state/province/region","tra.amq.message.reviewSubmitThanks":"Thanks for submitting a review.","tra.qa.miqa.link.add":"Add","tra.profile.label.othersWithQuestionCount":"Others Had This Question","tra.rev.link.readMore":"Read More","tra.reg.error.passwordsDontMatch":"The passwords you entered did not match","tra.profile.label.helpfulCount":"Helpful Vote","tra.qa.askArea.message.receiveNumAnswers.few":"You will receive email notifications for up to {0} answers. After that, return to this page to see all responses.","tra.profile.tab.comments.mobile":"Comments","tra.profile.noSubmittedComments.thisUser":"This user has not submitted any checkout comments.","tra.rev.media.dateAdded":"Added {0}","tra.rev.linkLine.helpful.cantVote.hover":"You cannot vote on your own item","tra.qa.answer.error.dontIncludePhone":"Please do not include contact information in your posts, including phone numbers.","tra.rev.showMoreReviews.many":"Show {0} More Reviews For This Product","tra.qa.answer.message.answerSubmitted":"Your answer has been submitted.","tra.settings.changePhoto.button.cancel":"Cancel","tra.common.textErr.nonSiteLink":"Links to other sites are not allowed","tra.common.footer.link.feedback":"Feedback","tra.qa.commerceBanner.andOthersPurchasedProduct.other":"{0}, {1} and {3} other answerers purchased this or a similar product from {2}.","tra.shareMedia.paging":"Page {0} of {1}","tra.settings.newPwd":"New Password:","tra.shareMedia.prompt.review.after.rateIt":"Thanks! Would you like to include images with your review?","tra.qa.comments.whyDidYouChoose":"Why did you choose this?","tra.systemMessage.loConfirmWithoutEmail":"We have sent you a confirmation email.  Please go to your inbox and click on the link in this message.","tra.reg.login.fb":"Login With Facebook","tra.common.error.unexpected":"Unexpected error occurred","tra.reg.message.emailConfirmed":"Your email address has been confirmed. Thank you.","tra.qa.question.linkLine.readAnswer.mobile.other":"{0} Answers","tra.mediaModal.upvote":"Up Vote","tra.qa.answer.linkLine.youThanked":"You thanked {0}","tra.rev.noReviewsForItem":"There are no reviews for this item.","tra.settings.changePhoto.button.save":"Save","tra.rateIt.state":"State","tra.wrev.guidlines.terms":"All reviews are subject to our store&#39;s Terms of Use.","tra.settings.or":"or","tra.instantAnsResults.resultsCount.one":"1 Result:","tra.amq.noMoreReviews":"There are no items for you to review at this time.  Thank you!","tra.qa.button.submit":"Submit","tra.shareMedia.prompt.captions.reviewOnNextPg":"Note: If you&#39;d like to review this product you can do so on the next page.","tra.ppe.link.delete":"DELETE","tra.wrev.message.alreadyReviewed":"Thanks, we already have your review for this item.","tra.reg.error.emailInUse":"This email is already in use.","tra.rateIt.dimOptionErr.blank":"Please select an option.","tra.rev.summary.reviewCount.many":"{0} Reviews","tra.rev.search.reviewsAndQuestions":"Search reviews and questions","tra.qa.comment.askOnDateAtSite":"on {0} at {1}","tra.profile.header.yourPosts":"Your Posts","tra.revTeaser.link.readReviews.many":"Read {0} Reviews","tra.settings.email":"Email:","tra.profile.noSubmittedQuestions.you":"You have not submitted any questions.","tra.reg.message.confirmedByCustomerSystem":"Your email address has been confirmed for our customer Q&A system.","tra.wrev.reg.instruction.mustConfirmToWrite":"You must have a confirmed email address to write reviews. <a style=\"font-weight: bolder\" class=\"TT3resendConfirm\" id=\"TT3resendConfirm\" href=\"javascript:void(0)\">  Click here<\u002fa> to resend confirmation message.","tra.instantAnsResults.askedAbout":"Asked about {0}","tra.qa.miqa.addItems":"Add Items","tra.qa.reply.error.dontIncludePhone":"Please do not include contact information in your posts, including phone numbers.","tra.shareMedia.videosSelected.counts.other":", {0} videos selected","tra.revTeaser.link.writeReview":"Write a Review","tra.qa.askArea.info.link.viewSuggestions":"View some suggestions","tra.amq.message.moreToAnswerAndReview.mobile":"Below are some other items you purchased to review.","tra.qa.askArea.message.receiveAnswers":"We will email you your answers as soon as we receive them.","tra.settings.useCustomPhoto":"use custom photo","tra.settings.instruction.selectImage":"Select an image file on your computer (4MB max)","tra.qa.noQuestions":"No questions have been asked about this item.  Be the first!","tra.qa.question.linkLine.readAnswer.few":"Read All {0} Answers","tra.rev.showMoreReviews.one":"Show 1 More Review For This Product","tra.revTeaser.link.writeReviewFirst":"Be the first to write a review","tra.reg.header.findProfile":"Find your profile","tra.qa.showMoreQuestions.few":"Show {0} More Questions For This Product","tra.reg.instruction.nickName":"Leave blank to use your first name and last initial","tra.shareMedia.prompt.review":"Add photos and videos","tra.qa.button.submitDuplicate.accept":"Yes, I want to submit this one","tra.amq.message.moreToAnswerAndReview":"Below are some customer questions you may be able to help answer and other items you purchased to review.","tra.gallery.userSubmittedPhoto":"User submitted image","tra.ppe.commentSource":"&#8211;{0}, purchased {1}","tra.settings.useFBPhoto":"use your Facebook photo","tra.reg.message.idependentOfAccount":"(Note that this is independent of any account you have with our site.)","tra.qa.answer.instruction.connectOrProvide":"Please verify your information so we can post your answer.","tra.pp.link.delete":"Delete","tra.rev.linkLine.helpful.no":"No","tra.profile.label.questionsCount":"Questions","tra.qa.question.linkLine.readMoreAnswer.few":"Read {0} More Answers","tra.settings.createPwd":"Create password","tra.qa.askArea.message.receiveNumAnswers.one":"You will receive an email notifications for 1 answer. After that, return to this page to see all responses.","tra.reg.firstName":"First Name","tra.qa.askArea.message.receiveAnswersForDays.other":"You will receive email notifications for {0} days. After that, return to this page to see all responses.","tra.settings.photo":"Photo","tra.reg.message.additionalCustom":"","tra.qa.askArea.typeSwitcher.radio.particular":"particular items","tra.settings.doNotCreatePwd":"Do not create password","tra.shareMedia.uploadErr.invalidFileType":"Invalid image type (should be jpg, png, or gif)","tra.settings.resendConfirm":"(Resend confirmation email)","tra.settings.preferredLanguage":"Preferred Language:","tra.instantAnsResults.resultsCount.other":"{0} Results:","tra.moreFeedback.prompt.noShare":"There are no items to review or questions to answer at this time.","tra.wrev.message.noEligibleItemsReviewsForPurchasersOnly":"We didn&#39;t find any items that you are eligible to review. To ensure authenticity, you may only review items you&#39;ve purchased from this store. If you bought items using a different email address, you can find them by adding your other emails to your <a id=\"TT3MyQALink\" onclick=\"TurnTo.mySettings()\" href=\"javascript:void(0)\">profile<\u002fa>.","tra.revTeaser.link.readReviews.few":"Read {0} Reviews","tra.wrev.header.alreadyReviewed":"Review Received","tra.polling.reconfirm.emailSent":"Please check your inbox to confirm that {0} is your email address.","tra.amq.link.showMore":"Show More","tra.rateIt.profileDimSelectErr.blank":"Please select an option","tra.qa.answer.linkLine.inappropriate.hover":"Report as inaccurate or inappropriate","tra.reg.message.alreadyConfirmed":"Your email has already been confirmed.","tra.common.header.poweredBy":"Powered by TurnTo","tra.rev.sortReviews.option.mostRecent":"Sort by Most Recent Review","tra.rev.link.writeReview":"Write Review","tra.polling.reconfirm.problems":"Problems? Check your spam filter. <a href=\"#\" class=\"TTresendReconfirm\">Click Here<\u002fa> to resend the confirmation email. ","tra.qa.reply.linkLine.repliedAtSite":"(at {0})","tra.reg.error.firstName.blank":"Please enter a first name","tra.systemMessage.button.ok":"OK","tra.mediaModal.pinterest":"Pinterest","tra.mediaModal.button.previous":"Previous","tra.rateIt.prompt.rateIt.purchaseNotRequired":"Please share your experience.","tra.qa.question.linkLine.addAnswer":"Add Answer","tra.shareMedia.captionErr.max":"Cannot be more than 100 characters","tra.reg.header.optOut":"Email Opt-out","tra.gallery.button.previous":"Previous","tra.ppe.pagination.next":"NEXT","tra.profile.tab.reviews":"Reviews","tra.profile.link.showMore":"Show more","tra.rateIt.title":"Review title","tra.qa.askArea.error.isThisAQuestion":"Just checking: Is this a question? (We didn&#39;t see a question mark...)","tra.qa.askArea.error.dontIncludeEmail":"Please do not include your email address in your question. You will be able to enter an email on the next page.","tra.qaTeaser.link.seeQuestions.few":"See <strong>{0}<\u002fstrong> questions","tra.wrev.guidlines.link.close":"Close","tra.chatter.standalone.collapsedText":"Read Less","tra.rateIt.prompt.rateIt.purchaseRequired":"Please review your purchase.","tra.ppe.postToSocial":"Post to","tra.qa.miqa.message.searchReturned.few":"Your search returned {0} results.","tra.qa.question.linkLine.readAnswer.one":"Read 1 Answer","tra.ppe.pagination.count":"<span class=\"TTccCurItemNum\">1<\u002fspan> of {0} items","tra.qa.showMoreQuestions.one":"Show 1 More Question For This Product","tra.mediaModal.userSubmittedPhoto":"User submitted image","tra.profile.label.commentsCount":"Checkout Comments","tra.wrev.attachMedia.addVideo":"Add Video","tra.qa.askArea.message.receiveAnswersForDays.many":"You will receive email notifications for {0} days. After that, return to this page to see all responses.","tra.qa.question.linkLine.addAnswer.mobile":"Answer","tra.rateIt.age":"Age","tra.amq.header.writeReviews":"Write Reviews","tra.wrev.dimensionLabelPostfix":"{0}:","tra.revTeaser.link.comments.many":"{0} Buyer Comments","tra.soloQ.message.thankanswer":"Hi {0}, enter a reply to {1} below.","tra.pp.alsoPostTo":"Also post to","tra.qa.question.linkLine.readMoreAnswer.one":"Read 1 More Answer","tra.qaTeaser.link.browseAndAnswers.other":"and {0} answers","tra.qa.question.linkLine.skip":"Skip","tra.common.button.cancel":"Cancel","tra.flagMedia.prompt":"Why are you reporting this?","tra.rev.linkLine.inappropriate":"Flag as Inappropriate","tra.qa.reply.instruction.enterReply":"Enter a reply to {0}.","tra.instantAnsResults.link.answers.few":"{0} Answers","tra.revTeaser.link.readReviews.one":"Read 1 Review","tra.rev.showMoreRelatedReviews.few":"Show {0} More Reviews For Similar Products","tra.common.header.link.returnToProduct":"Return to Product Details","tra.systemMessage.unconfirmedEmail":"We have sent you an email to confirm that {0} is your email address. Please check your inbox and click on the confirmation link in the message to confirm your account. <br/> <br/>If the confirmation email does not arrive within a few minutes, check your spam filter or <a style=\"font-weight: bolder\" class=\"TT3resendConfirm\" id=\"TT3resendConfirm\" href=\"javascript:void(0)\">click here<\u002fa> to resend confirmation message.","tra.qa.askArea.link.learnMore":"Learn More","tra.instantAnsResults.link.answers.other":"{0} Answers","tra.qa.comments.storeBadge":"Store","tra.profile.tab.questions":"Questions","tra.revTeaser.link.comments.few":"{0} Buyer Comments","tra.qa.askArea.haveQuestion.mobile":"Have a question? Ask owners.","tra.qaTeaser.link.browseAndAnswers.many":"and {0} answers","tra.amq.header.answerQuestions":"Answer Questions","tra.qa.question.linkLine.readMoreAnswer.mobile.few":"{0} More Answers","tra.shareMedia.selectedVideo":"Selected video","tra.ppe.submitThanks":"Thank You!","tra.gallery.button.next":"Next","tra.ppe.link.edit":"EDIT","tra.shareMedia.linkedContent.error.notPubliclyAccessible":"{0} content does not appear to be publicly accessible","tra.common.mobile.header.close":"Close","tra.rev.summary.stars.other":"{0} Stars","tra.polling.reconfirm.secondAttemptFail":"You must confirm your email address in the email we sent before selecting Continue.","tra.reg.header.instruction.anonToHaveAnswersEmailed":"Please verify your information so we can have answers sent to you.","tra.qa.commerceBanner.purchasedProduct":"{0} purchased this or a similar product from {1}.","tra.pp.purchasedTimes":"(x{0})","tra.rev.incentivized":"This review was collected as part of a promotion","tra.qa.reply.reg.header":"Thank you for your reply.","tra.qaTeaser.link.seeQuestions.one":"See <strong>1<\u002fstrong> question","tra.qa.askArea.message.recentlySubmitted":"You recently submitted a different question about this item. Just checking you want to ask this one, too.","tra.settings.changePhoto":"Change Photo","tra.common.button.submit":"Submit","tra.qa.commerceBanner.twoPurchasedProduct":"{0} and {1} purchased this or a similar product from {2}.","tra.wrev.error.profileDimOption.blank":"Please select an option for {0}.","tra.common.header.link.mySettings":"My Settings","tra.revTeaser.link.read":"Read","tra.gallery.alt.loading":"Loading...","tra.reg.message.confirmationResent":"We have sent another confirmation email to {0}","tra.qa.miqa.message.searchReturned.one":"Your search returned 1 result.","tra.qa.commerceBanner.andOthersPurchasedProduct.many":"{0}, {1} and {3} other answerers purchased this or a similar product from {2}.","tra.qa.browse.sortQuestions.option.oldest":"Sort by Oldest Question","tra.shareMedia.linkedContent.error.notSupportedService":"Sorry, YouTube only.","tra.qa.reply.instruction.connectOrProvide":"Please verify your information so we can post your reply.","tra.shareMedia.button.addNewVideo":"Add New Video","tra.qa.askArea.error.dontIncludePhone":"Please do not include contact information in your posts, including phone numbers.","tra.qa.question.askOnDate":"on {0}","tra.qa.button.forward":"Submit New Question","tra.soloQ.customerQaLabel":"Customer Q&A:","tra.reg.message.questionOptOut":"You have been successfully removed from any further questions","tra.profile.noSubmittedAnswers.you":"You have not submitted any answers.","tra.shareMedia.tooManyMediaSelected.error.other":"Sorry, maximum {0} files. Please deselect {1} files.","tra.qaTeaser.header.getAnswers":"Get FAST answers from customers","tra.qa.answer.message.answerNotSubmitted":"Your answer has not yet been submitted.","tra.rateIt.dimRatingErr.blank":"Please select a rating.","tra.rateIt.titleErr.blank":"Please enter a short comment.","tra.rev.sortReviews.option.lowHigh":"Sort Lowest to Highest","tra.qa.answer.cantVote.hover":"You cannot vote on your own item","tra.shareMedia.tooManyMediaSelected.error.many":"Sorry, maximum {0} files. Please deselect {1} files.","tra.wrev.forProduct":"For:","tra.pp.message.willNotSaveUnlessSubmit":"Your comments will not be saved unless you click \"Submit\". Click \"Cancel\" to go back and save your comments. Click \"OK\" to continue without saving.","tra.shareMedia.uploadErr.photoNotYetUploaded":"This photo has not finished uploading yet. Please wait or remove this selection.","tra.qa.question.linkLine.readAnswer.many":"Read All {0} Answers","tra.instantAnsResults.link.answers.one":"1 Answer","tra.qa.showMoreRelatedQuestions.few":"Show {0} More Questions For Similar Products","tra.chatter.standalone.purchased":"purchased {0}","tra.shareMedia.prompt.reviewSubmission":"Please review your submissions.","tra.rev.showMoreRelatedReviews.one":"Show 1 More Review For Similar Products","tra.ppe.submittedBy":"submitted by {0}","tra.chatter.standalone.topcomment.title":"Why:","tra.qa.browse.sortQuestions.option.mostRecent":"Sort by Most Recent Question","tra.shareMedia.linkedContent.instruction.mustBePublic":"Your video must be public.","tra.polling.reconfirm.header":"Please confirm your email address","tra.qa.browse.browseAndAnswers.other":"and {0} answers","tra.qa.answer.instruction.vote":"Vote for the best answer above!","tra.qa.askArea.info.forQuestions":"For questions about an order you have placed, please contact customer support directly.","tra.systemMessage.genericError":"Our community Q&A and Ratings & Reviews systems are temporarily unavailable. We are working to restore service as soon as possible. Please try again later. Thanks for your patience.","tra.chatter.header.fullComments":"We asked people at checkout why they chose what they got. Here are their most recent answers.","tra.qa.askArea.message.receiveAnswersForDays.few":"You will receive email notifications for {0} days. After that, return to this page to see all responses.","tra.qa.button.submitNewQuestion":"Submit New Question","tra.revTeaser.link.comments.one":"1 Buyer Comment","tra.systemMessage.questionRemoved":"Sorry, this question has been removed.","tra.profile.label.bestAnswerVoteCount":"Best Answer Votes","tra.qa.answer.instruction.attachItem.other":"If your answer refers to other items in our catalog, you can attach them here.","tra.reg.error.importFail":"Could not complete import.","tra.qa.browse.browseAndAnswers.few":"and {0} answers","tra.qa.question.linkLine.readMoreAnswer.mobile.one":"1 More Answer","tra.wrev.rating":"My overall rating:","tra.instantAnsResults.resultsCount.many":"{0} Results:","tra.qa.button.cancelSubmitQuestion":"Cancel","tra.shareMedia.message.imagesWillBeAddedToGallery":"If you decide not to submit your review, these images will just be added to our product gallery.","tra.instantAnsResults.notWhatLookingFor":"Not what you were looking for?","tra.ppe.commentSourceLatest":"&#8211;{0}, last purchased {1}","tra.wrev.error.genericFieldIssue":"There are problems with fields below.","tra.qa.browse.browseQuestions.many":"Browse {0} questions","tra.shareMedia.prompt.addMoreFiles":"Add another? <span class=\"TTmediaSmallDesc\">Up to five files total<\u002fspan>","tra.polling.reconfirm.resendFail":"Sorry, there was a problem resending the email.","tra.qa.answer.linkLine.answeredOnDate":"on {0}","tra.qa.browse.sortQuestions.option.mostAnswers":"Sort by Most Answers","tra.polling.reconfirm.pollingTimeout":"Once you&#39;ve clicked the link in your email you can return here and press the continue button to continue.","tra.profile.label.reviewsCount":"Reviews","tra.flagMedia.type.ipViolation":"Intellectual Property Violation","tra.rev.linkLine.helpful":"Was this review helpful?","tra.shareMedia.uploadErr.animatedGif":"Animated gif not allowed","tra.reg.error.password.blank":"Please enter a password","tra.wrev.attachMedia":"Attach Media:","tra.chatter.header.recentComments":"Why people are buying","tra.pp.header.currentPurchases":"Current Purchases","tra.settings.photo.save":"Save","tra.instantAnsResults.reviewFor":"Review for {0}","tra.rateIt.province":"Province","tra.reg.error.securityCodeDoesntMatch":"The security code you entered did not match","tra.settings.firstName":"First Name:","tra.rateIt.prompt.shareAPhoto":"Would you like to include a rating of this item?","tra.wrev.error.dimOption.blank":"Please select an option for {0}.","tra.shareMedia.linkedContent.error.unexpected":"Could not retrieve content from {0}","tra.moreFeedback.prompt.shareMore":"Want to contribute more?","tra.soloQ.link.seeAllQA":"See all Q&A","tra.pp.purchasedOn":"Purchased on","tra.qa.question.linkLine.addAnswer.cantAnswer.hover":"You cannot answer your own question","tra.qa.question.askOnDateAtSite":"on {0} at {1}","tra.rev.shopperAge":"Age:","tra.shareMedia.tooManyMediaSelected.error.few":"Sorry, maximum {0} files. Please deselect {1} files.","tra.common.linkLine.moderate":"Moderate","tra.commom.alt.loading":"Loading...","tra.qa.showMoreRelatedQuestions.one":"Show 1 More Question For Similar Products","tra.qa.question.linkLine.readAnswer.mobile.many":"{0} Answers","tra.reg.header.instruction.toCompleteQuestionSubmission":"Please verify your information so we can have answers sent to you.","tra.polling.reconfirm.reportAProblem":"Report a problem","tra.qa.showMoreQuestions.other":"Show {0} More Questions For This Product","tra.shareMedia.uploadErr.unexpected":"There was a problem uploading your file","tra.settings.confirmPwd":"Confirm Password:","tra.qa.askArea.message.reviewQuestion":"Review your question to make any final changes. It may be sent to fellow customers so ask as if you were asking a friend.","tra.qa.question.aboutProduct":"About:","tra.rev.response.title":"Response from {0}","tra.ppe.error.blankComment":"Please enter a comment.","tra.qa.askArea.message.receiveAnswersForDays.one":"You will receive email notifications for 1 day. After that, return to this page to see all responses.","tra.settings.lastName":"Last Name:","tra.settings.header.qa":"Q & A","tra.shareMedia.videosSelected.counts.many":", {0} videos selected","tra.qa.browse.browseAndAnswers.one":"and 1 answer","tra.settings.displayName":"Display Name:","tra.moreFeedback.prompt.noShare.afterSubmission":"Thanks for your submission.","tra.soloQ.message.thanka":"Hi {0}, we just sent a \"Thank You\" email from you to {1}.","tra.mediaModal.twitter":"Twitter","tra.reg.login.gmail":"Login With Gmail","tra.common.staffBadge":"Staff","tra.common.mobile.header.profile":"Profile","tra.wrev.message.inviteToWriteWithName":"Hi {0}, we value your input and invite you to write a review on this product.","tra.shareMedia.note.addFiles":"Add up to five files","tra.shareMedia.link.noThanks":"No Thanks","tra.settings.age":"Age:","tra.pp.header.greeting":"Hello,","tra.reg.instruction.lookupProfileConnectOrProvide":"Please verify your information to view previous posts.","tra.wrev.country":"Country{0}:","tra.rateIt.title.placeholder":"Your overall impression (150 characters max)","tra.reg.error.lastName.blank":"Please enter a last name","tra.pp.header.previousPurchases":"Previous Purchases","tra.qaTeaser.instruction.typeYourQuestion":"Type in your question & press Enter.","tra.settings.receiveQuestions":"Receive questions from others","tra.qa.askArea.typeSwitcher.radio.topic":"a general topic","tra.wrev.guidlines.donts4":"Personal information such as email addresses, phone numbers or physical addresses","tra.wrev.guidlines.donts3":"Advertising, spam, references to other websites or retailers","tra.wrev.guidlines.donts2":"Critical or inappropriate comments about other reviews and shoppers","tra.qaTeaser.link.browseAndAnswers.few":"and {0} answers","tra.wrev.guidlines.donts1":"Obscene or discriminatory language","tra.wrev.province":"Province{0}:","tra.rev.media.userSubmitted":"User submitted image","tra.shareMedia.uploadErr.maxFileSize":"Images must be {0}MB or less","tra.qa.answer.linkLine.inappropriate":"Inaccurate","tra.rev.header.link.reviewMorePurchases":"Review More Purchases","tra.qa.answer.bestAnswer.caps":"BEST ANSWER:","tra.qaTeaser.link.browseQuestions.many":"Browse {0} questions","tra.settings.button.update":"Update","tra.qa.answer.linkLine.reply":"Reply","tra.qa.comment.askOnDate":"on {0}","tra.wrev.reviewBody":"Review (required):","tra.rev.showMoreRelatedReviews.many":"Show {0} More Reviews For Similar Products","tra.settings.changePwd":"Change password","tra.rev.summary.reviewCount.other":"{0} Reviews","tra.shareMedia.tooManyMediaSelected.error.one":"Sorry, maximum {0} files. Please deselect {1} file.","tra.rev.summary.stars.few":"{0} Stars","tra.profile.noSubmittedAnswers.thisUser":"This user has not submitted any answers.","tra.qaTeaser.link.browseQuestions.few":"Browse {0} questions","tra.shareMedia.label.addNew":"Add new:","tra.mediaModal.button.next":"Next","tra.wrev.error.reviewBody.maxLength":"Your review must not exceed 5000 characters including spaces.","tra.qa.answer.linkLine.thanked":"Thanked","tra.settings.doNotChangePwd":"Do not change password","tra.qa.askArea.error.question.blank":"Please enter your question below","tra.qaTeaser.link.seeAnswers.other":"<strong>{0}<\u002fstrong> answers","tra.shareMedia.linkedContent.instruction.youtube":"Enter a YouTube link.","tra.irrelevantWidget.button.close":"Close","tra.irrelevantWidget.message.feedbackThanks":"<b>{0}<\u002fb>, you indicated this question should not have been sent out. Thanks for the information - we&#39;ll use it to improve our filtering.","tra.reg.error.displayName.invalid":"Invalid display name. Must be between 5 and 15 characters.","tra.soloQ.message.answerview":"Below are all the answers received in response to the question.","tra.wrev.sweepstakes.optin":"Enter my name into the weekly drawing to win a gift card.","tra.qa.answer.upvote.hover":"Up-voting makes sure the good stuff appears first.  And it shows appreciation for thoughtful contributions.  Please vote often!","tra.reg.emailAddress":"Email Address","tra.chatter.link.seeAll":"See all","tra.mediaModal.flagInappropriate":"Flag as Inappropriate","tra.reg.header.emailConfirmation":"Email Confirmation","tra.pp.header.yourPurchases":"Your Purchases","tra.pp.whyDidYouChoose":"Why did you choose this?","tra.moreFeedback.prompt.shareMore.afterSubmission.alreadyReviewed":"Thanks, we already have your review for this item. Want to contribute more?","tra.qa.question.linkLine.readMoreAnswer.mobile.many":"{0} More Answers","tra.instantAnsResults.link.answers.many":"{0} Answers","tra.wrev.city":"City{0}:","tra.polling.reconfirm.confirmed.header":"Thanks! Your email has been verified.","tra.reg.button.ok":"OK","tra.qaTeaser.link.seeQuestions.many":"See <strong>{0}<\u002fstrong> questions","tra.qa.showMoreRelatedQuestions.many":"Show {0} More Questions For Similar Products","tra.qaTeaser.link.browseAndAnswers.one":"and 1 answer","tra.qa.browse.browseQuestions.few":"Browse {0} questions","tra.wrev.instruction.reviewTitle":"Headline or summary for your review","tra.qa.reply.message.replyNotSubmitted":"Your reply has not yet been submitted.","tra.moreFeedback.siteAttribution":"at {0}","tra.systemMessage.checkInboxToConfirm":"Please check your inbox to confirm your email address.","tra.wrev.link.guidlines":"Review Guidelines","tra.wrev.guidlines.header.donts":"Please refrain from including any of the following in your review:","tra.reg.message.pleaseWait":"Please wait while we are connecting you...","tra.systemMessage.loConfirmEmail":"We have sent you an email to confirm that {0} is yours.  Please go to your inbox and click on the link in this message.","tra.qa.question.linkLine.haveThisQuestionToo":"I Have This Question Too","tra.chatter.fromLastHours":"From the last {0} hours","tra.reg.or":"or","tra.chatter.whatsThis":"What&#39;s this?","tra.settings.header.profileDims":"More About Me","tra.common.header.link.notUser":"not {0}?","tra.rev.summary.stars.one":"1 Star","tra.wrev.error.rating.blank":"Please select an overall rating.","tra.qaTeaser.link.browseQuestions.one":"Browse 1 question","tra.shareMedia.photosSelected.counts.few":"{0} photos selected","tra.settings.province":"Province:","tra.flagMedia.type.offensive":"Offensive","tra.common.anonUser":"A shopper","tra.settings.city":"City:","tra.ppe.placeholder.comment":"Comment","tra.reg.link.dontSendAnswers":"No thanks, I&apos;ll check back later for answers.","tra.qa.reply.message.replySubmitted":"Your reply has been submitted.","tra.qa.question.linkLine.haveThisQuestionToo.cantVote.hover":"You cannot vote on your own item","tra.rateIt.titleErr.max":"Cannot be more than 150 characters.","tra.qa.answer.linkLine.purchasedItemFromSite":"(Purchased this item from {0})","tra.rateIt.instruction.state":"Enter your state","tra.qa.browse.browseQuestions.other":"Browse {0} questions","tra.qa.sqv.button.close":"Close","tra.qa.answer.linkLine.thank":"Thank {0}","tra.wrev.requiredIndicator":"&nbsp;(required)","tra.rev.askOnDate":"on {0}","tra.addComment.error.dontIncludeEmail":"Please do not include your email address in your comment","tra.settings.currentPwd":"Current Password:","tra.wrev.attachMedia.addPhoto":"Add Photo","tra.instantAnsResults.showMore.other":"Show {0} more matches","tra.wrev.error.unableToSubmit":"Sorry, we are unable to submit your review.","tra.flagMedia.type.offTopic":"Off-Topic","tra.wrev.other":"State/Province/Region{0}:","tra.qaTeaser.link.seeAnswers.few":"<strong>{0}<\u002fstrong> answers","tra.instantAnsResults.reviseSearch":"Revise your search or","tra.instantAnsResults.showMore.few":"Show {0} more matches","tra.reg.message.askedToApproveConnection":"You will be asked to approve a connection to TurnTo, our service provider.","tra.shareMedia.videosSelected.counts.few":", {0} videos selected","tra.revTeaser.link.comments.other":"{0} Buyer Comments","tra.wrev.error.age.blank":"Please enter an age range.","tra.common.header.greeting":"Hi, {0}","tra.pp.header.helpShoppers":"to help other shoppers make good choices, would you say a few words about why you picked these items?  Thank you!","tra.rev.sortReviews.option.mostHelpful":"Sort by Most Helpful","tra.rateIt.city":"City","tra.wrev.guidlines.inviteToWriteReview":"We value your input and invite you to rate and review your purchases. Be sure to explain why you like or dislike the product and focus on the product&#39;s features and your own experience using it.","tra.mediaModal.facebook":"Facebook","tra.settings.makePrimary":"(make primary)","tra.instantAnsResults.link.goToArticle":"Go to Article","tra.qa.question.linkLine.readAnswer.mobile.few":"{0} Answers","tra.settings.country":"Country:","tra.polling.reconfirm.reconfirmedAndSubmitted":"{0} has been confirmed as your email address.","tra.qa.browse.browseQuestions.one":"Browse 1 question","tra.qa.question.linkLine.readMoreAnswer.mobile.other":"{0} More Answers","tra.qa.askArea.message.receiveNumAnswers.many":"You will receive email notifications for up to {0} answers. After that, return to this page to see all responses.","tra.profile.tab.comments":"Checkout Comments","tra.common.instruction.invalidText":"Do not include HTML, links, references to other stores, pricing or contact info.","tra.rateIt.instruction.city":"Enter your city","tra.shareMedia.button.addVideo":"Add Video","tra.qa.askArea.instruction.addMoreItems":"If your question is about more than one item, click + to add them.","tra.qa.answer.instruction.enterAnswer":"Enter an answer to this question.","tra.rev.originallyPostedAt":"Originally posted at","tra.wrev.error.province.blank":"Please enter a province","tra.qa.question.linkLine.readMoreAnswer.many":"Read {0} More Answers","tra.profile.noSubmittedComments.you":"You have not submitted any checkout comments.","tra.profile.noSubmittedReviews.you":"You have not submitted any reviews.","tra.rev.sortReviews.option.highLow":"Sort Highest to Lowest","tra.amq.noMoreQuestions":"There are no questions for you to answer at this time.  Thank you!","tra.wrev.error.state.blank":"Please enter a state.","tra.shareMedia.photosSelected.counts.one":"{0} photo selected","tra.chatter.whatsThisToolTip":"When customers check out, we ask them to say why they chose what they bought.  Here&#39;s what they are saying, unfiltered.","tra.shareMedia.prompt.addFiles":"Add up to five files:","tra.qa.noQuestions.similarQuestions":"No questions have been asked about this item but questions about similar items are shown below.","tra.wrev.guidlines.contactSupport":"If you wish to comment about product selection, pricing, ordering, delivery or other issues, please contact our customer support.","tra.moreFeedback.prompt.rateIt":"Rate it:","tra.reg.message.reviewsOptout":"You have been successfully removed from any further review requests","tra.common.youBadge":"You","tra.wrev.instruction.state":"Enter your state","tra.shareMedia.button.addNewPhoto":"Add New Photo","tra.wrev.reviewTitle":"Review Title:{0}","tra.qa.button.submitDuplicate.cancel":"Cancel this one - the previous one covers it","tra.qa.askArea.message.recenetPreviousQuestion":"Previous Question:","tra.qa.answer.linkLine.inappropriateThanks":"Thanks","tra.qa.commerceBanner.andOthersPurchasedProduct.few":"{0}, {1} and {3} other answerers purchased this or a similar product from {2}.","tra.irrelevantWidget.askedAbout":"{0} asked about {1}:","tra.wrev.message.inviteToWrite":"We value your input and invite you to write a review on this product.","tra.wrev.instruction.reviewBody":"Write your review here.  It must be at least {0} characters long.  Consider whether you would recommend this product and what you like or dislike about it.","tra.qa.askArea.myQuestionAbout":"My question is about:","tra.amq.link.writeReview":"Write a Review","tra.ppe.whyDidYouChoose":"Why did you choose this?","tra.reg.error.email.invalid":"Please enter a valid email address","tra.qaTeaser.link.seeAnswers.one":"<strong>1<\u002fstrong> answer","tra.instantAnsResults.showMore.one":"Show 1 more match","tra.qa.button.answer.submit":"Submit","tra.shareMedia.photosSelected.counts.many":"{0} photos selected","tra.rev.summary.reviewCount.few":"{0} Reviews","tra.shareMedia.videosSelected.counts.one":", {0} video selected","tra.rev.purchased":"Purchased","tra.common.button.skip":"Skip","tra.qa.miqa.message.searchReturned.many":"Your search returned {0} results.","tra.wrev.error.reviewBody.minLength":"Your review must be at least {0} characters in length.","tra.qa.askArea.startTyping":"Start typing your question and we&#39;ll check if it was already asked and answered.","tra.rev.aboutProduct":"About:","tra.shareMedia.selectedImage":"Selected image","tra.qa.question.linkLine.readAnswer.mobile.one":"1 Answer","tra.settings.other":"State/Province/Region:","tra.shareMedia.photosSelected.counts.other":"{0} photos selected","tra.qa.answer.charactersLeft":"{0} characters left","tra.common.textErr.phoneNotAllowed":"Please do not include phone numbers","tra.chatter.standalone.paginationPrevText":"Previous","tra.common.header.link.myPosts":"My Posts","tra.qa.comment.linkLine.hideAnswers":"Hide answers","tra.qa.header.link.questionsNeedAnswers":"Questions that need answers","tra.wrev.reg.instruction.reviewsForPurchasersOnly":"To ensure authenticity you may only write reviews for items you&#39;ve purchased.  Please let us know who you are so we can look up your purchases.","tra.wrev.state":"State{0}:","tra.answerWidget.message.thanksForHelping":"Hi {0}, thanks for helping {1}.","tra.qa.commerceBanner.message.clickToShop":"Click <a target=\"_blank\" href=\"{0}\" title=\"{1}\">here<\u002fa> to shop.","tra.reg.header.haveAnswersEmailed":"Have Answers Emailed To You","tra.qa.button.back":"Back","tra.shareMedia.prompt.addCaption":"Please add captions.","tra.gallery.button.cancel":"Cancel","tra.rateIt.reviewBody":"Review","tra.rev.linkLine.inappropriateThanks":"Thanks","tra.shareMedia.termsOfUse":"Your submission is subject to our terms of use. Do not link or upload copyrighted material without the copyright owner&#39;s permission.","tra.wrev.error.city.blank":"Please enter a city.","tra.wrev.link.closeWindow":"Close Window","tra.qa.browse.sortQuestions.option.fewestAnswers":"Sort by Fewest Answers","tra.reg.nickName":"Nick Name","tra.qa.button.search":"Search","tra.reg.lastName":"Last Name","tra.qa.itemPicker.instruction.search":"Search by product name or ID to add additional items","tra.settings.addEmail":"Add Email:","tra.qa.miqa.message.searchShown":"The first {0} are shown.","tra.shareMedia.photosOutOf":"{0}-{1} out of {2}","tra.wrev.customDim.option.selectOne":"-- Select One --","tra.profile.label.answersCount":"Answers","tra.qa.askArea.message.checkBack":"<i>Please check back here to see your answers<\u002fi>.","tra.wrev.age":"Age{0}:","tra.shareMedia.label.selectPrevious":"Select previous:","tra.common.label.close":"Close","tra.wrev.message.reviewSubmitted":"Your review has been submitted.","tra.shareMedia.placeholder.caption":"Add caption","tra.qa.askArea.cancelDuplicate":"Cancel this one - the previous one covers it","tra.qa.commerceBanner.andOthersPurchasedProduct.one":"{0}, {1} and 1 other answerer purchased this or a similar product from {2}.","tra.reg.button.submit":"Submit","tra.qa.answer.button.submit":"Submit","tra.rev.title.relatedReviews":"Reviews for Similar Products","tra.qa.askArea.message.questionSubmittied":"Your question has been submitted.  Thank you.","tra.qa.askArea.confirmDuplicate":"Yes, I want to ask this one","tra.qa.askArea.info.header.howThisWorks":"How This Works","tra.rateIt.reviewBody.placeholder":"Write your review here. It must be at least {0} characters long. Consider whether you would recommend this product and what you like or dislike about it.","tra.shareMedia.prompt":"Please contribute to our customer gallery for this product!","tra.qa.question.linkLine.readAnswer.other":"Read All {0} Answers","tra.pp.link.edit":"Edit","tra.shareMedia.linkedContent.error.notAvailable":"{0} content could not be found","tra.profile.noSubmittedQuestions.thisUser":"This user has not submitted any questions.","tra.rev.summary.reviewCount.one":"1 Review","tra.soloQ.answer":"Answer:","tra.rev.linkLine.helpful.yes":"Yes","tra.reg.fb.message.processingRequest":"Processing Your Request","tra.pp.error.dontIncludeLinks":"Please do not include links.","tra.polling.reconfirm.resendSuccess":"We have sent another confirmation email to {0}.","tra.settings.fbLoginUsePhoto":"to use your Facebook photo","tra.settings.addPhoto":"Add Photo","tra.shareMedia.mediaAssocErr.max":"Cannot have more than {0} files.  Please remove {1}.","tra.soloQ.message.replyview":"Hi {0}, below is all the dialog for this question.","tra.rateIt.profileDimFreeFormErr.blank":"Please enter a response","tra.qa.browse.sortQuestions.option.mostCommon":"Sort by Most Common","tra.qa.askArea.message.receiveNumAnswers.other":"You will receive email notifications for up to {0} answers. After that, return to this page to see all responses.","tra.chatter.standalone.title":"Why I Chose This:","tra.qa.showMoreQuestions.many":"Show {0} More Questions For This Product","tra.wrev.submit":"Submit","tra.instantAnsResults.noResults":"No results found.","tra.reg.instruction.checkInboxToConfirm":"Please check your email inbox to confirm your identity","tra.rev.summary.stars.many":"{0} Stars","tra.wrev.instruction.city":"Enter your city","tra.qaTeaser.askQuestion":"<u>ASK<\u002fu> a Question","tra.pp.charactersLeft":"(<span class=\"TT2charLimitCount\">{0}<\u002fspan> characters left)","tra.systemMessage.link.dismiss":"Dismiss","tra.polling.reconfirm.onceConfirmed":"Once verified, the change will be reflected on this page and you can continue.","tra.shareMedia.uploadErr.fileNotFound":"Could not find uploaded file","tra.qa.askArea.addItem":"Add Item","tra.rateIt.other":"State/Province/Region","tra.rev.showMoreReviews.other":"Show {0} More Reviews For This Product","tra.settings.primaryEmail":"Primary Email:","tra.qaTeaser.link.seeAnswers.many":"<strong>{0}<\u002fstrong> answers","tra.soloQ.message.answerreply":"Hi {0}, enter a reply to {1} below.","tra.qa.answer.instruction.attachItem.specific":"If your answer refers to specific items in our catalog, you can attach them here.","tra.qa.answer.linkLine.answeredAtSite":"(at {0})","tra.wrev.error.title.blank":"Please enter a review title.","tra.qa.answer.error.dontIncludeEmail":"Please do not include your email address in your answer.<br>","tra.rateIt.rating":"Overall rating","tra.wrev.error.dimRating.blank":"Please select a rating for {0}.","tra.ppe.charactersLeft":"<span class=\"TT2charLimitCount\">{0}<\u002fspan> characters left","tra.qaTeaser.link.seeQuestions.other":"See <strong>{0}<\u002fstrong> questions","tra.flagMedia.type.spam":"Spam","tra.qa.question.linkLine.readMoreAnswer.other":"Read {0} More Answers","tra.settings.fbLogin.hover":"Connect","tra.instantAnsResults.fromKnowledgeBase":"From our Knowledge Base","tra.qa.button.done":"Done","tra.revTeaser.link.readReviews.other":"Read {0} Reviews","tra.qa.browse.browseAndAnswers.many":"and {0} answers","tra.profile.tab.answers":"Answers","tra.qa.askArea.haveQuestion":"Have a question about this? Ask people who own it.","tra.qa.reply.linkLine.repliedOnDate":"on {0}","tra.settings.state":"State:","tra.qa.reply.charactersLeft":"{0} characters left","tra.rateIt.country":"Country","tra.systemMessage.notAcceptingCookies":"It looks like your browser is not accepting cookies. This feature will not work without cookies. If you accept cookies selectively, please accept those from \"TurnTo.com\", which is our service provider for this feature. Thanks.","tra.qa.askArea.charactersLeft":"{0} characters left","tra.rev.showMoreRelatedReviews.other":"Show {0} More Reviews For Similar Products","tra.instantAnsResults.showMore.many":"Show {0} more matches","tra.shareMedia.linkedContent.instruction.allowedServices":"Allowed services","tra.instantAnsResults.resultsCount.few":"{0} Results:","tra.moreFeedback.prompt.answer":"Answer this question:","tra.profile.noSubmittedReviews.thisUser":"This user has not submitted any reviews.","tra.qa.reply.linkLine.reply":"Reply","tra.settings.instruction.displayName":"If blank, your first name and last initial will be used. Must be at least 5 characters","tra.qa.reply.error.dontIncludeEmail":"Please do not include your email address in your reply. You will be able to enter an email on the next page.","tra.chatter.standalone.paginationNextText":"Next","tra.common.textErr.emailNotAllowed":"Please do not include email addresses"};
  if(typeof TurnToMessageProps == "undefined") {
    TurnToMessageProps = mp;
  } else {
    for(var p in mp) {
      TurnToMessageProps[p] = mp[p];
    }
  }
})();


/* TurnTo tra.v4.3.10878a292ff3f4d1e94295573a7b607abf7b2b99 master.10878a292ff3f4d1e94295573a7b607abf7b2b99 Mon Jun 29 11:20:21 EDT 2020 (c) 2017, TurnTo Networks, Inc. http://www.turnto.com/tra4/licenses.html */ TurnTo.traVersion = "TurnTo tra.v4.3.10878a292ff3f4d1e94295573a7b607abf7b2b99 master.10878a292ff3f4d1e94295573a7b607abf7b2b99 Mon Jun 29 11:20:21 EDT 2020";if (typeof TurnToLoaded=="undefined" && typeof TurnTo!='undefined'){TurnToLoaded=true;(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!cj[a]){var b=f("<"+a+">").appendTo("body"),d=b.css("display");b.remove();if(d==="none"||d===""){ck||(ck=c.createElement("iframe"),ck.frameBorder=ck.width=ck.height=0),c.body.appendChild(ck);if(!cl||!ck.createElement)cl=(ck.contentWindow||ck.contentDocument).document,cl.write("<!doctype><html><body></body></html>");b=cl.createElement(a),cl.body.appendChild(b),d=f.css(b,"display"),c.body.removeChild(ck)}cj[a]=d}return cj[a]}function cu(a,b){var c={};f.each(cp.concat.apply([],cp.slice(0,b)),function(){c[this]=a});return c}function ct(){cq=b}function cs(){setTimeout(ct,0);return cq=f.now()}function ci(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ch(){try{return new a.XMLHttpRequest}catch(b){}}function cb(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function ca(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function b_(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bF.test(a)?d(a,e):b_(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)b_(a+"["+e+"]",b[e],c,d);else d(a,b)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bU,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bQ),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bD(a,b,c){var d=b==="width"?bx:by,e=b==="width"?a.offsetWidth:a.offsetHeight;if(c==="border")return e;f.each(d,function(){c||(e-=parseFloat(f.css(a,"padding"+this))||0),c==="margin"?e+=parseFloat(f.css(a,"margin"+this))||0:e-=parseFloat(f.css(a,"border"+this+"Width"))||0});return e}function bn(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bm(a){f.nodeName(a,"input")?bl(a):a.getElementsByTagName&&f.grep(a.getElementsByTagName("input"),bl)}function bl(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bk(a){return"getElementsByTagName"in a?a.getElementsByTagName("*"):"querySelectorAll"in a?a.querySelectorAll("*"):[]}function bj(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bi(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c=f.expando,d=f.data(a),e=f.data(b,d);if(d=d[c]){var g=d.events;e=e[c]=f.extend({},d);if(g){delete e.handle,e.events={};for(var h in g)for(var i=0,j=g[h].length;i<j;i++)f.event.add(b,h+(g[h][i].namespace?".":"")+g[h][i].namespace,g[h][i],g[h][i].data)}}}}function bh(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function X(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(S.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function W(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function O(a,b){return(a&&a!=="*"?a+".":"")+b.replace(A,"`").replace(B,"&")}function N(a){var b,c,d,e,g,h,i,j,k,l,m,n,o,p=[],q=[],r=f._data(this,"events");if(!(a.liveFired===this||!r||!r.live||a.target.disabled||a.button&&a.type==="click")){a.namespace&&(n=new RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)")),a.liveFired=this;var s=r.live.slice(0);for(i=0;i<s.length;i++)g=s[i],g.origType.replace(y,"")===a.type?q.push(g.selector):s.splice(i--,1);e=f(a.target).closest(q,a.currentTarget);for(j=0,k=e.length;j<k;j++){m=e[j];for(i=0;i<s.length;i++){g=s[i];if(m.selector===g.selector&&(!n||n.test(g.namespace))&&!m.elem.disabled){h=m.elem,d=null;if(g.preType==="mouseenter"||g.preType==="mouseleave")a.type=g.preType,d=f(a.relatedTarget).closest(g.selector)[0],d&&f.contains(h,d)&&(d=h);(!d||d!==h)&&p.push({elem:h,handleObj:g,level:m.level})}}}for(j=0,k=p.length;j<k;j++){e=p[j];if(c&&e.level>c)break;a.currentTarget=e.elem,a.data=e.handleObj.data,a.handleObj=e.handleObj,o=e.handleObj.origHandler.apply(e.elem,arguments);if(o===!1||a.isPropagationStopped()){c=e.level,o===!1&&(b=!1);if(a.isImmediatePropagationStopped())break}}return b}}function L(a,c,d){var e=f.extend({},d[0]);e.type=a,e.originalEvent={},e.liveFired=b,f.event.handle.call(c,e),e.isDefaultPrevented()&&d[0].preventDefault()}function F(){return!0}function E(){return!1}function m(a,c,d){var e=c+"defer",g=c+"queue",h=c+"mark",i=f.data(a,e,b,!0);i&&(d==="queue"||!f.data(a,g,b,!0))&&(d==="mark"||!f.data(a,h,b,!0))&&setTimeout(function(){!f.data(a,g,b,!0)&&!f.data(a,h,b,!0)&&(f.removeData(a,e,!0),i.resolve())},0)}function l(a){for(var b in a)if(b!=="toJSON")return!1;return!0}function k(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(j,"$1-$2").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNaN(d)?i.test(d)?f.parseJSON(d):d:parseFloat(d)}catch(g){}f.data(a,c,d)}else d=b}return d}var c=a.document,d=a.navigator,e=a.location,f=function(){function H(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(H,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/\d/,n=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,o=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,q=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,s=/(webkit)[ \/]([\w.]+)/,t=/(opera)(?:.*version)?[ \/]([\w.]+)/,u=/(msie) ([\w.]+)/,v=/(mozilla)(?:.*? rv:([\w.]+))?/,w=d.userAgent,x,y,z,A=Object.prototype.toString,B=Object.prototype.hasOwnProperty,C=Array.prototype.push,D=Array.prototype.slice,E=String.prototype.trim,F=Array.prototype.indexOf,G={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=n.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.6.1",length:0,size:function(){return this.length},toArray:function(){return D.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?C.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),y.done(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(D.apply(this,arguments),"slice",D.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:C,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;y.resolveWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").unbind("ready")}},bindReady:function(){if(!y){y=e._Deferred();if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",z,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",z),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&H()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNaN:function(a){return a==null||!m.test(a)||isNaN(a)},type:function(a){return a==null?String(a):G[A.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;if(a.constructor&&!B.call(a,"constructor")&&!B.call(a.constructor.prototype,"isPrototypeOf"))return!1;var c;for(c in a);return c===b||B.call(a,c)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw a},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(o.test(b.replace(p,"@").replace(q,"]").replace(r,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(b,c,d){a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b)),d=c.documentElement,(!d||!d.nodeName||d.nodeName==="parsererror")&&e.error("Invalid XML: "+b);return c},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:E?function(a){return a==null?"":E.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?C.call(c,a):e.merge(c,a)}return c},inArray:function(a,b){if(F)return F.call(b,a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=D.call(arguments,2),g=function(){return a.apply(c,f.concat(D.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=s.exec(a)||t.exec(a)||u.exec(a)||a.indexOf("compatible")<0&&v.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){G["[object "+b+"]"]=b.toLowerCase()}),x=e.uaMatch(w),x.browser&&(e.browser[x.browser]=!0,e.browser.version=x.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?z=function(){c.removeEventListener("DOMContentLoaded",z,!1),e.ready()}:c.attachEvent&&(z=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",z),e.ready())});return e}(),g="done fail isResolved isRejected promise then always pipe".split(" "),h=[].slice;f.extend({_Deferred:function(){var a=[],b,c,d,e={done:function(){if(!d){var c=arguments,g,h,i,j,k;b&&(k=b,b=0);for(g=0,h=c.length;g<h;g++)i=c[g],j=f.type(i),j==="array"?e.done.apply(e,i):j==="function"&&a.push(i);k&&e.resolveWith(k[0],k[1])}return this},resolveWith:function(e,f){if(!d&&!b&&!c){f=f||[],c=1;try{while(a[0])a.shift().apply(e,f)}finally{b=[e,f],c=0}}return this},resolve:function(){e.resolveWith(this,arguments);return this},isResolved:function(){return!!c||!!b},cancel:function(){d=1,a=[];return this}};return e},Deferred:function(a){var b=f._Deferred(),c=f._Deferred(),d;f.extend(b,{then:function(a,c){b.done(a).fail(c);return this},always:function(){return b.done.apply(b,arguments).fail.apply(this,arguments)},fail:c.done,rejectWith:c.resolveWith,reject:c.resolve,isRejected:c.isResolved,pipe:function(a,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[c,"reject"]},function(a,c){var e=c[0],g=c[1],h;f.isFunction(e)?b[a](function(){h=e.apply(this,arguments),h&&f.isFunction(h.promise)?h.promise().then(d.resolve,d.reject):d[g](h)}):b[a](d[g])})}).promise()},promise:function(a){if(a==null){if(d)return d;d=a={}}var c=g.length;while(c--)a[g[c]]=b[g[c]];return a}}),b.done(c.cancel).fail(b.cancel),delete b.cancel,a&&a.call(b,b);return b},when:function(a){function i(a){return function(c){b[a]=arguments.length>1?h.call(arguments,0):c,--e||g.resolveWith(g,h.call(b,0))}}var b=arguments,c=0,d=b.length,e=d,g=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred();if(d>1){for(;c<d;c++)b[c]&&f.isFunction(b[c].promise)?b[c].promise().then(i(c),g.reject):--e;e||g.resolveWith(g,b)}else g!==a&&g.resolveWith(g,d?[a]:[]);return g.promise()}}),f.support=function(){var a=c.createElement("div"),b=c.documentElement,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;a.setAttribute("className","t"),a.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=a.getElementsByTagName("*"),e=a.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};f=c.createElement("select"),g=f.appendChild(c.createElement("option")),h=a.getElementsByTagName("input")[0],j={leadingWhitespace:a.firstChild.nodeType===3,tbody:!a.getElementsByTagName("tbody").length,htmlSerialize:!!a.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55$/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:h.value==="on",optSelected:g.selected,getSetAttribute:a.className!=="t",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},h.checked=!0,j.noCloneChecked=h.cloneNode(!0).checked,f.disabled=!0,j.optDisabled=!g.disabled;try{delete a.test}catch(s){j.deleteExpando=!1}!a.addEventListener&&a.attachEvent&&a.fireEvent&&(a.attachEvent("onclick",function b(){j.noCloneEvent=!1,a.detachEvent("onclick",b)}),a.cloneNode(!0).fireEvent("onclick")),h=c.createElement("input"),h.value="t",h.setAttribute("type","radio"),j.radioValue=h.value==="t",h.setAttribute("checked","checked"),a.appendChild(h),k=c.createDocumentFragment(),k.appendChild(a.firstChild),j.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,a.innerHTML="",a.style.width=a.style.paddingLeft="1px",l=c.createElement("body"),m={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};for(q in m)l.style[q]=m[q];l.appendChild(a),b.insertBefore(l,b.firstChild),j.appendChecked=h.checked,j.boxModel=a.offsetWidth===2,"zoom"in a.style&&(a.style.display="inline",a.style.zoom=1,j.inlineBlockNeedsLayout=a.offsetWidth===2,a.style.display="",a.innerHTML="<div style='width:4px;'></div>",j.shrinkWrapBlocks=a.offsetWidth!==2),a.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",n=a.getElementsByTagName("td"),r=n[0].offsetHeight===0,n[0].style.display="",n[1].style.display="none",j.reliableHiddenOffsets=r&&n[0].offsetHeight===0,a.innerHTML="",c.defaultView&&c.defaultView.getComputedStyle&&(i=c.createElement("div"),i.style.width="0",i.style.marginRight="0",a.appendChild(i),j.reliableMarginRight=(parseInt((c.defaultView.getComputedStyle(i,null)||{marginRight:0}).marginRight,10)||0)===0),l.innerHTML="",b.removeChild(l);if(a.attachEvent)for(q in{submit:1,change:1,focusin:1})p="on"+q,r=p in a,r||(a.setAttribute(p,"return;"),r=typeof a[p]=="function"),j[q+"Bubbles"]=r;return j}(),f.boxModel=f.support.boxModel;var i=/^(?:\{.*\}|\[.*\])$/,j=/([a-z])([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!l(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g=f.expando,h=typeof c=="string",i,j=a.nodeType,k=j?f.cache:a,l=j?a[f.expando]:a[f.expando]&&f.expando;if((!l||e&&l&&!k[l][g])&&h&&d===b)return;l||(j?a[f.expando]=l=++f.uuid:l=f.expando),k[l]||(k[l]={},j||(k[l].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?k[l][g]=f.extend(k[l][g],c):k[l]=f.extend(k[l],c);i=k[l],e&&(i[g]||(i[g]={}),i=i[g]),d!==b&&(i[f.camelCase(c)]=d);if(c==="events"&&!i[c])return i[g]&&i[g].events;return h?i[f.camelCase(c)]:i}},removeData:function(b,c,d){if(!!f.acceptData(b)){var e=f.expando,g=b.nodeType,h=g?f.cache:b,i=g?b[f.expando]:f.expando;if(!h[i])return;if(c){var j=d?h[i][e]:h[i];if(j){delete j[c];if(!l(j))return}}if(d){delete h[i][e];if(!l(h[i]))return}var k=h[i][e];f.support.deleteExpando||h!=a?delete h[i]:h[i]=null,k?(h[i]={},g||(h[i].toJSON=f.noop),h[i][e]=k):g&&(f.support.deleteExpando?delete b[f.expando]:b.removeAttribute?b.removeAttribute(f.expando):b[f.expando]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d=null;if(typeof a=="undefined"){if(this.length){d=f.data(this[0]);if(this[0].nodeType===1){var e=this[0].attributes,g;for(var h=0,i=e.length;h<i;h++)g=e[h].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),k(this[0],g,d[g]))}}return d}if(typeof a=="object")return this.each(function(){f.data(this,a)});var j=a.split(".");j[1]=j[1]?"."+j[1]:"";if(c===b){d=this.triggerHandler("getData"+j[1]+"!",[j[0]]),d===b&&this.length&&(d=f.data(this[0],a),d=k(this[0],a,d));return d===b&&j[1]?this.data(j[0]):d}return this.each(function(){var b=f(this),d=[j[0],c];b.triggerHandler("setData"+j[1]+"!",d),f.data(this,a,c),b.triggerHandler("changeData"+j[1]+"!",d)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,c){a&&(c=(c||"fx")+"mark",f.data(a,c,(f.data(a,c,b,!0)||0)+1,!0))},_unmark:function(a,c,d){a!==!0&&(d=c,c=a,a=!1);if(c){d=d||"fx";var e=d+"mark",g=a?0:(f.data(c,e,b,!0)||1)-1;g?f.data(c,e,g,!0):(f.removeData(c,e,!0),m(c,d,"mark"))}},queue:function(a,c,d){if(a){c=(c||"fx")+"queue";var e=f.data(a,c,b,!0);d&&(!e||f.isArray(d)?e=f.data(a,c,f.makeArray(d),!0):e.push(d));return e||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e;d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),d.call(a,function(){f.dequeue(a,b)})),c.length||(f.removeData(a,b+"queue",!0),m(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(){var c=this;setTimeout(function(){f.dequeue(c,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f._Deferred(),!0))h++,l.done(m);m();return d.promise()}});var n=/[\n\t\r]/g,o=/\s+/,p=/\r/g,q=/^(?:button|input)$/i,r=/^(?:button|input|object|select|textarea)$/i,s=/^a(?:rea)?$/i,t=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,u=/\:/,v,w;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.addClass(a.call(this,b,c.attr("class")||""))});if(a&&typeof a=="string"){var b=(a||"").split(o);for(var c=0,d=this.length;c<d;c++){var e=this[c];if(e.nodeType===1)if(!e.className)e.className=a;else{var g=" "+e.className+" ",h=e.className;for(var i=0,j=b.length;i<j;i++)g.indexOf(" "+b[i]+" ")<0&&(h+=" "+b[i]);e.className=f.trim(h)}}}return this},removeClass:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.removeClass(a.call(this,b,c.attr("class")))});if(a&&typeof a=="string"||a===b){var c=(a||"").split(o);for(var d=0,e=this.length;d<e;d++){var g=this[d];if(g.nodeType===1&&g.className)if(a){var h=(" "+g.className+" ").replace(n," ");for(var i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){var d=f(this);d.toggleClass(a.call(this,c,d.attr("class"),b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(o);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ";for(var c=0,d=this.length;c<d;c++)if((" "+this[c].className+" ").replace(n," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e=this[0];if(!arguments.length){if(e){c=f.valHooks[e.nodeName.toLowerCase()]||f.valHooks[e.type];if(c&&"get"in c&&(d=c.get(e,"value"))!==b)return d;return(e.value||"").replace(p,"")}return b}var g=f.isFunction(a);return this.each(function(d){var e=f(this),h;if(this.nodeType===1){g?h=a.call(this,d,e.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c=a.selectedIndex,d=[],e=a.options,g=a.type==="select-one";if(c<0)return null;for(var h=g?c:0,i=g?c+1:e.length;h<i;h++){var j=e[h];if(j.selected&&(f.support.optDisabled?!j.disabled:j.getAttribute("disabled")===null)&&(!j.parentNode.disabled||!f.nodeName(j.parentNode,"optgroup"))){b=f(j).val();if(g)return b;d.push(b)}}if(g&&!d.length&&e.length)return f(e[c]).val();return d},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attrFix:{tabindex:"tabIndex"},attr:function(a,c,d,e){var g=a.nodeType;if(!a||g===3||g===8||g===2)return b;if(e&&c in f.attrFn)return f(a)[c](d);if(!("getAttribute"in a))return f.prop(a,c,d);var h,i,j=g!==1||!f.isXMLDoc(a);c=j&&f.attrFix[c]||c,i=f.attrHooks[c],i||(!t.test(c)||typeof d!="boolean"&&d!==b&&d.toLowerCase()!==c.toLowerCase()?v&&(f.nodeName(a,"form")||u.test(c))&&(i=v):i=w);if(d!==b){if(d===null){f.removeAttr(a,c);return b}if(i&&"set"in i&&j&&(h=i.set(a,d,c))!==b)return h;a.setAttribute(c,""+d);return d}if(i&&"get"in i&&j)return i.get(a,c);h=a.getAttribute(c);return h===null?b:h},removeAttr:function(a,b){var c;a.nodeType===1&&(b=f.attrFix[b]||b,f.support.getSetAttribute?a.removeAttribute(b):(f.attr(a,b,""),a.removeAttributeNode(a.getAttributeNode(b))),t.test(b)&&(c=f.propFix[b]||b)in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(q.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},tabIndex:{get:function(a){var c=a.getAttributeNode("tabIndex");return c&&c.specified?parseInt(c.value,10):r.test(a.nodeName)||s.test(a.nodeName)&&a.href?0:b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e=a.nodeType;if(!a||e===3||e===8||e===2)return b;var g,h,i=e!==1||!f.isXMLDoc(a);c=i&&f.propFix[c]||c,h=f.propHooks[c];return d!==b?h&&"set"in h&&(g=h.set(a,d,c))!==b?g:a[c]=d:h&&"get"in h&&(g=h.get(a,c))!==b?g:a[c]},propHooks:{}}),w={get:function(a,c){return a[f.propFix[c]||c]?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=b),a.setAttribute(c,c.toLowerCase()));return c}},f.attrHooks.value={get:function(a,b){if(v&&f.nodeName(a,"button"))return v.get(a,b);return a.value},set:function(a,b,c){if(v&&f.nodeName(a,"button"))return v.set(a,b,c);a.value=b}},f.support.getSetAttribute||(f.attrFix=f.propFix,v=f.attrHooks.name=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&d.nodeValue!==""?d.nodeValue:b},set:function(a,b,c){var d=a.getAttributeNode(c);if(d){d.nodeValue=b;return b}}},f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})})),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}})),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var x=Object.prototype.hasOwnProperty,y=/\.(.*)$/,z=/^(?:textarea|input|select)$/i,A=/\./g,B=/ /g,C=/[^\w\s.|`]/g,D=function(a){return a.replace(C,"\\$&")};f.event={add:function(a,c,d,e){if(a.nodeType!==3&&a.nodeType!==8){if(d===!1)d=E;else if(!d)return;var g,h;d.handler&&(g=d,d=g.handler),d.guid||(d.guid=f.guid++);var i=f._data(a);if(!i)return;var j=i.events,k=i.handle;j||(i.events=j={}),k||(i.handle=k=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.handle.apply(k.elem,arguments):b}),k.elem=a,c=c.split(" ");var l,m=0,n;while(l=c[m++]){h=g?f.extend({},g):{handler:d,data:e},l.indexOf(".")>-1?(n=l.split("."),l=n.shift(),h.namespace=n.slice(0).sort().join(".")):(n=[],h.namespace=""),h.type=l,h.guid||(h.guid=d.guid);var o=j[l],p=f.event.special[l]||{};if(!o){o=j[l]=[];if(!p.setup||p.setup.call(a,e,n,k)===!1)a.addEventListener?a.addEventListener(l,k,!1):a.attachEvent&&a.attachEvent("on"+l,k)}p.add&&(p.add.call(a,h),h.handler.guid||(h.handler.guid=d.guid)),o.push(h),f.event.global[l]=!0}a=null}},global:{},remove:function(a,c,d,e){if(a.nodeType!==3&&a.nodeType!==8){d===!1&&(d=E);var g,h,i,j,k=0,l,m,n,o,p,q,r,s=f.hasData(a)&&f._data(a),t=s&&s.events;if(!s||!t)return;c&&c.type&&(d=c.handler,c=c.type);if(!c||typeof c=="string"&&c.charAt(0)==="."){c=c||"";for(h in t)f.event.remove(a,h+c);return}c=c.split(" ");while(h=c[k++]){r=h,q=null,l=h.indexOf(".")<0,m=[],l||(m=h.split("."),h=m.shift(),n=new RegExp("(^|\\.)"+f.map(m.slice(0).sort(),D).join("\\.(?:.*\\.)?")+"(\\.|$)")),p=t[h];if(!p)continue;if(!d){for(j=0;j<p.length;j++){q=p[j];if(l||n.test(q.namespace))f.event.remove(a,r,q.handler,j),p.splice(j--,1)}continue}o=f.event.special[h]||{};for(j=e||0;j<p.length;j++){q=p[j];if(d.guid===q.guid){if(l||n.test(q.namespace))e==null&&p.splice(j--,1),o.remove&&o.remove.call(a,q);if(e!=null)break}}if(p.length===0||e!=null&&p.length===1)(!o.teardown||o.teardown.call(a,m)===!1)&&f.removeEvent(a,h,s.handle),g=null,delete t[h]}if(f.isEmptyObject(t)){var u=s.handle;u&&(u.elem=null),delete s.events,delete s.handle,f.isEmptyObject(s)&&f.removeData(a,b,!0)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){var h=c.type||c,i=[],j;h.indexOf("!")>=0&&(h=h.slice(0,-1),j=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if(!!e&&!f.event.customEvent[h]||!!f.event.global[h]){c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.exclusive=j,c.namespace=i.join("."),c.namespace_re=new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)");if(g||!e)c.preventDefault(),c.stopPropagation();if(!e){f.each(f.cache,function(){var a=f.expando,b=this[a];b&&b.events&&b.events[h]&&f.event.trigger(c,d,b.handle.elem
)});return}if(e.nodeType===3||e.nodeType===8)return;c.result=b,c.target=e,d=d?f.makeArray(d):[],d.unshift(c);var k=e,l=h.indexOf(":")<0?"on"+h:"";do{var m=f._data(k,"handle");c.currentTarget=k,m&&m.apply(k,d),l&&f.acceptData(k)&&k[l]&&k[l].apply(k,d)===!1&&(c.result=!1,c.preventDefault()),k=k.parentNode||k.ownerDocument||k===c.target.ownerDocument&&a}while(k&&!c.isPropagationStopped());if(!c.isDefaultPrevented()){var n,o=f.event.special[h]||{};if((!o._default||o._default.call(e.ownerDocument,c)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)){try{l&&e[h]&&(n=e[l],n&&(e[l]=null),f.event.triggered=h,e[h]())}catch(p){}n&&(e[l]=n),f.event.triggered=b}}return c.result}},handle:function(c){c=f.event.fix(c||a.event);var d=((f._data(this,"events")||{})[c.type]||[]).slice(0),e=!c.exclusive&&!c.namespace,g=Array.prototype.slice.call(arguments,0);g[0]=c,c.currentTarget=this;for(var h=0,i=d.length;h<i;h++){var j=d[h];if(e||c.namespace_re.test(j.namespace)){c.handler=j.handler,c.data=j.data,c.handleObj=j;var k=j.handler.apply(this,g);k!==b&&(c.result=k,k===!1&&(c.preventDefault(),c.stopPropagation()));if(c.isImmediatePropagationStopped())break}}return c.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){if(a[f.expando])return a;var d=a;a=f.Event(d);for(var e=this.props.length,g;e;)g=this.props[--e],a[g]=d[g];a.target||(a.target=a.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);if(a.pageX==null&&a.clientX!=null){var h=a.target.ownerDocument||c,i=h.documentElement,j=h.body;a.pageX=a.clientX+(i&&i.scrollLeft||j&&j.scrollLeft||0)-(i&&i.clientLeft||j&&j.clientLeft||0),a.pageY=a.clientY+(i&&i.scrollTop||j&&j.scrollTop||0)-(i&&i.clientTop||j&&j.clientTop||0)}a.which==null&&(a.charCode!=null||a.keyCode!=null)&&(a.which=a.charCode!=null?a.charCode:a.keyCode),!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey),!a.which&&a.button!==b&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);return a},guid:1e8,proxy:f.proxy,special:{ready:{setup:f.bindReady,teardown:f.noop},live:{add:function(a){f.event.add(this,O(a.origType,a.selector),f.extend({},a,{handler:N,guid:a.handler.guid}))},remove:function(a){f.event.remove(this,O(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}}},f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!this.preventDefault)return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?F:E):this.type=a,b&&f.extend(this,b),this.timeStamp=f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=F;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=F;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=F,this.stopPropagation()},isDefaultPrevented:E,isPropagationStopped:E,isImmediatePropagationStopped:E};var G=function(a){var b=a.relatedTarget;a.type=a.data;try{if(b&&b!==c&&!b.parentNode)return;while(b&&b!==this)b=b.parentNode;b!==this&&f.event.handle.apply(this,arguments)}catch(d){}},H=function(a){a.type=a.data,f.event.handle.apply(this,arguments)};f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={setup:function(c){f.event.add(this,b,c&&c.selector?H:G,a)},teardown:function(a){f.event.remove(this,b,a&&a.selector?H:G)}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(a,b){if(!f.nodeName(this,"form"))f.event.add(this,"click.specialSubmit",function(a){var b=a.target,c=b.type;(c==="submit"||c==="image")&&f(b).closest("form").length&&L("submit",this,arguments)}),f.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,c=b.type;(c==="text"||c==="password")&&f(b).closest("form").length&&a.keyCode===13&&L("submit",this,arguments)});else return!1},teardown:function(a){f.event.remove(this,".specialSubmit")}});if(!f.support.changeBubbles){var I,J=function(a){var b=a.type,c=a.value;b==="radio"||b==="checkbox"?c=a.checked:b==="select-multiple"?c=a.selectedIndex>-1?f.map(a.options,function(a){return a.selected}).join("-"):"":f.nodeName(a,"select")&&(c=a.selectedIndex);return c},K=function(c){var d=c.target,e,g;if(!!z.test(d.nodeName)&&!d.readOnly){e=f._data(d,"_change_data"),g=J(d),(c.type!=="focusout"||d.type!=="radio")&&f._data(d,"_change_data",g);if(e===b||g===e)return;if(e!=null||g)c.type="change",c.liveFired=b,f.event.trigger(c,arguments[1],d)}};f.event.special.change={filters:{focusout:K,beforedeactivate:K,click:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(c==="radio"||c==="checkbox"||f.nodeName(b,"select"))&&K.call(this,a)},keydown:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(a.keyCode===13&&!f.nodeName(b,"textarea")||a.keyCode===32&&(c==="checkbox"||c==="radio")||c==="select-multiple")&&K.call(this,a)},beforeactivate:function(a){var b=a.target;f._data(b,"_change_data",J(b))}},setup:function(a,b){if(this.type==="file")return!1;for(var c in I)f.event.add(this,c+".specialChange",I[c]);return z.test(this.nodeName)},teardown:function(a){f.event.remove(this,".specialChange");return z.test(this.nodeName)}},I=f.event.special.change.filters,I.focus=I.beforeactivate}f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){function e(a){var c=f.event.fix(a);c.type=b,c.originalEvent={},f.event.trigger(c,null,c.target),c.isDefaultPrevented()&&a.preventDefault()}var d=0;f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.each(["bind","one"],function(a,c){f.fn[c]=function(a,d,e){var g;if(typeof a=="object"){for(var h in a)this[c](h,d,a[h],e);return this}if(arguments.length===2||d===!1)e=d,d=b;c==="one"?(g=function(a){f(this).unbind(a,g);return e.apply(this,arguments)},g.guid=e.guid||f.guid++):g=e;if(a==="unload"&&c!=="one")this.one(a,d,e);else for(var i=0,j=this.length;i<j;i++)f.event.add(this[i],a,g,d);return this}}),f.fn.extend({unbind:function(a,b){if(typeof a=="object"&&!a.preventDefault)for(var c in a)this.unbind(c,a[c]);else for(var d=0,e=this.length;d<e;d++)f.event.remove(this[d],a,b);return this},delegate:function(a,b,c,d){return this.live(b,c,d,a)},undelegate:function(a,b,c){return arguments.length===0?this.unbind("live"):this.die(b,null,c,a)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f.data(this,"lastToggle"+a.guid)||0)%d;f.data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var M={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};f.each(["live","die"],function(a,c){f.fn[c]=function(a,d,e,g){var h,i=0,j,k,l,m=g||this.selector,n=g?this:f(this.context);if(typeof a=="object"&&!a.preventDefault){for(var o in a)n[c](o,d,a[o],m);return this}if(c==="die"&&!a&&g&&g.charAt(0)==="."){n.unbind(g);return this}if(d===!1||f.isFunction(d))e=d||E,d=b;a=(a||"").split(" ");while((h=a[i++])!=null){j=y.exec(h),k="",j&&(k=j[0],h=h.replace(y,""));if(h==="hover"){a.push("mouseenter"+k,"mouseleave"+k);continue}l=h,M[h]?(a.push(M[h]+k),h=h+k):h=(M[h]||h)+k;if(c==="live")for(var p=0,q=n.length;p<q;p++)f.event.add(n[p],"live."+O(h,m),{data:d,selector:m,handler:e,origType:h,origHandler:e,preType:l});else n.unbind("live."+O(h,m),e)}return this}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.bind(b,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0)}),function(){function u(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}if(i.nodeType===1){f||(i.sizcache=c,i.sizset=g);if(typeof b!="string"){if(i===b){j=!0;break}}else if(k.filter(b,[i]).length>0){j=i;break}}i=i[a]}d[g]=j}}}function t(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}i.nodeType===1&&!f&&(i.sizcache=c,i.sizset=g);if(i.nodeName.toLowerCase()===b){j=i;break}i=i[a]}d[g]=j}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d=0,e=Object.prototype.toString,g=!1,h=!0,i=/\\/g,j=/\W/;[0,0].sort(function(){h=!1;return 0});var k=function(b,d,f,g){f=f||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return f;var i,j,n,o,q,r,s,t,u=!0,w=k.isXML(d),x=[],y=b;do{a.exec(""),i=a.exec(y);if(i){y=i[3],x.push(i[1]);if(i[2]){o=i[3];break}}}while(i);if(x.length>1&&m.exec(b))if(x.length===2&&l.relative[x[0]])j=v(x[0]+x[1],d);else{j=l.relative[x[0]]?[d]:k(x.shift(),d);while(x.length)b=x.shift(),l.relative[b]&&(b+=x.shift()),j=v(b,j)}else{!g&&x.length>1&&d.nodeType===9&&!w&&l.match.ID.test(x[0])&&!l.match.ID.test(x[x.length-1])&&(q=k.find(x.shift(),d,w),d=q.expr?k.filter(q.expr,q.set)[0]:q.set[0]);if(d){q=g?{expr:x.pop(),set:p(g)}:k.find(x.pop(),x.length===1&&(x[0]==="~"||x[0]==="+")&&d.parentNode?d.parentNode:d,w),j=q.expr?k.filter(q.expr,q.set):q.set,x.length>0?n=p(j):u=!1;while(x.length)r=x.pop(),s=r,l.relative[r]?s=x.pop():r="",s==null&&(s=d),l.relative[r](n,s,w)}else n=x=[]}n||(n=j),n||k.error(r||b);if(e.call(n)==="[object Array]")if(!u)f.push.apply(f,n);else if(d&&d.nodeType===1)for(t=0;n[t]!=null;t++)n[t]&&(n[t]===!0||n[t].nodeType===1&&k.contains(d,n[t]))&&f.push(j[t]);else for(t=0;n[t]!=null;t++)n[t]&&n[t].nodeType===1&&f.push(j[t]);else p(n,f);o&&(k(o,h,f,g),k.uniqueSort(f));return f};k.uniqueSort=function(a){if(r){g=h,a.sort(r);if(g)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},k.matches=function(a,b){return k(a,null,null,b)},k.matchesSelector=function(a,b){return k(b,null,null,[a]).length>0},k.find=function(a,b,c){var d;if(!a)return[];for(var e=0,f=l.order.length;e<f;e++){var g,h=l.order[e];if(g=l.leftMatch[h].exec(a)){var j=g[1];g.splice(1,1);if(j.substr(j.length-1)!=="\\"){g[1]=(g[1]||"").replace(i,""),d=l.find[h](g,b,c);if(d!=null){a=a.replace(l.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},k.filter=function(a,c,d,e){var f,g,h=a,i=[],j=c,m=c&&c[0]&&k.isXML(c[0]);while(a&&c.length){for(var n in l.filter)if((f=l.leftMatch[n].exec(a))!=null&&f[2]){var o,p,q=l.filter[n],r=f[1];g=!1,f.splice(1,1);if(r.substr(r.length-1)==="\\")continue;j===i&&(i=[]);if(l.preFilter[n]){f=l.preFilter[n](f,j,d,i,e,m);if(!f)g=o=!0;else if(f===!0)continue}if(f)for(var s=0;(p=j[s])!=null;s++)if(p){o=q(p,f,s,j);var t=e^!!o;d&&o!=null?t?g=!0:j[s]=!1:t&&(i.push(p),g=!0)}if(o!==b){d||(j=i),a=a.replace(l.match[n],"");if(!g)return[];break}}if(a===h)if(g==null)k.error(a);else break;h=a}return j},k.error=function(a){throw"Syntax error, unrecognized expression: "+a};var l=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!j.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&k.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!j.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&k.filter(b,a,!0)}},"":function(a,b,c){var e,f=d++,g=u;typeof b=="string"&&!j.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("parentNode",b,f,a,e,c)},"~":function(a,b,c){var e,f=d++,g=u;typeof b=="string"&&!j.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("previousSibling",b,f,a,e,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(i,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(i,"")},TAG:function(a,b){return a[1].replace(i,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||k.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&k.error(a[0]);a[0]=d++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(i,"");!f&&l.attrMap[g]&&(a[1]=l.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(i,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=k(b[3],null,null,c);else{var g=k.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(l.match.POS.test(b[0])||l.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!k(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=l.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||k.getText([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}k.error(e)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case"only":case"first":while(d=d.previousSibling)if(d.nodeType===1)return!1;if(c==="first")return!0;d=a;case"last":while(d=d.nextSibling)if(d.nodeType===1)return!1;return!0;case"nth":var e=b[2],f=b[3];if(e===1&&f===0)return!0;var g=b[0],h=a.parentNode;if(h&&(h.sizcache!==g||!a.nodeIndex)){var i=0;for(d=h.firstChild;d;d=d.nextSibling)d.nodeType===1&&(d.nodeIndex=++i);h.sizcache=g}var j=a.nodeIndex-f;return e===0?j===0:j%e===0&&j/e>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=l.attrHandle[c]?l.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=l.setFilters[e];if(f)return f(a,c,b,d)}}},m=l.match.POS,n=function(a,b){return"\\"+(b-0+1)};for(var o in l.match)l.match[o]=new RegExp(l.match[o].source+/(?![^\[]*\])(?![^\(]*\))/.source),l.leftMatch[o]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.match[o].source.replace(/\\(\d+)/g,n));var p=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(q){p=function(a,b){var c=0,d=b||[];if(e.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var f=a.length;c<f;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var r,s;c.documentElement.compareDocumentPosition?r=function(a,b){if(a===b){g=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(r=function(a,b){if(a===b){g=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],h=a.parentNode,i=b.parentNode,j=h;if(h===i)return s(a,b);if(!h)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return s(e[k],f[k]);return k===c?s(a,f[k],-1):s(e[k],b,1)},s=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),k.getText=function(a){var b="",c;for(var d=0;a[d];d++)c=a[d],c.nodeType===3||c.nodeType===4?b+=c.nodeValue:c.nodeType!==8&&(b+=k.getText(c.childNodes));return b},function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(l.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},l.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(l.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(l.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=k,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){k=function(b,e,f,g){e=e||c;if(!g&&!k.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return p(e.getElementsByTagName(b),f);if(h[2]&&l.find.CLASS&&e.getElementsByClassName)return p(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return p([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return p([],f);if(i.id===h[3])return p([i],f)}try{return p(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var m=e,n=e.getAttribute("id"),o=n||d,q=e.parentNode,r=/^\s*[+~]/.test(b);n?o=o.replace(/'/g,"\\$&"):e.setAttribute("id",o),r&&q&&(e=e.parentNode);try{if(!r||q)return p(e.querySelectorAll("[id='"+o+"'] "+b),f)}catch(s){}finally{n||m.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)k[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}k.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!k.isXML(a))try{if(e||!l.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return k(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;l.order.splice(1,0,"CLASS"),l.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?k.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?k.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:k.contains=function(){return!1},k.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var v=function(a,b){var c,d=[],e="",f=b.nodeType?[b]:b;while(c=l.match.PSEUDO.exec(a))e+=c[0],a=a.replace(l.match.PSEUDO,"");a=l.relative[a]?a+"*":a;for(var g=0,h=f.length;g<h;g++)k(a,f[g],d);return k.filter(e,d)};f.find=k,f.expr=k.selectors,f.expr[":"]=f.expr.filters,f.unique=k.uniqueSort,f.text=k.getText,f.isXMLDoc=k.isXML,f.contains=k.contains}();var P=/Until$/,Q=/^(?:parents|prevUntil|prevAll)/,R=/,/,S=/^.[^:#\[\.,]*$/,T=Array.prototype.slice,U=f.expr.match.POS,V={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(X(this,a,!1),"not",a)},filter:function(a){return this.pushStack(X(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h,i,j={},k=1;if(g&&a.length){for(d=0,e=a.length;d<e;d++)i=a[d],j[i]||(j[i]=U.test(i)?f(i,b||this.context):i);while(g&&g.ownerDocument&&g!==b){for(i in j)h=j[i],(h.jquery?h.index(g)>-1:f(g).is(h))&&c.push({selector:i,elem:g,level:k});g=g.parentNode,k++}}return c}var l=U.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(l?l.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a||typeof a=="string")return f.inArray(this[0],a?f(a):this.parent().children());return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(W(c[0])||W(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c),g=T.call(arguments);P.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!V[a]?f.unique(e):e,(this.length>1||R.test(d))&&Q.test(a)&&(e=e.reverse());return this.pushStack(e,a,g.join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var Y=/ jQuery\d+="(?:\d+|null)"/g,Z=/^\s+/,$=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,_=/<([\w:]+)/,ba=/<tbody/i,bb=/<|&#?\w+;/,bc=/<(?:script|object|embed|option|style)/i,bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){f(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f(arguments[0]).toArray());return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(Y,""):null;if(typeof a=="string"&&!bc.test(a)&&(f.support.leadingWhitespace||!Z.test(a))&&!bg[(_.exec(a)||["",""])[1].toLowerCase()]){a=a.replace($,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bh(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bn)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i=b&&b[0]?b[0].ownerDocument||b[0]:c;a.length===1&&typeof a[0]=="string"&&a[0].length<512&&i===c&&a[0].charAt(0)==="<"&&!bc.test(a[0])&&(f.support.checkClone||!bd.test(a[0]))&&(g=!0,h=f.fragments[a[0]],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[a[0]]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,g,h;if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bj(a,d),e=bk(a),g=bk(d);for(h=0;e[h];++h)bj(e[h],g[h])}if(b){bi(a,d);if(c){e=bk(a),g=bk(d);for(h=0;e[h];++h)bi(e[h],g[h])}}return d},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||
b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!bb.test(k))k=b.createTextNode(k);else{k=k.replace($,"<$1></$2>");var l=(_.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=ba.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&Z.test(k)&&o.insertBefore(b.createTextNode(Z.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof (r=k.length)=="number")for(i=0;i<r;i++)bm(k[i]);else bm(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.expando,g=f.event.special,h=f.support.deleteExpando;for(var i=0,j;(j=a[i])!=null;i++){if(j.nodeName&&f.noData[j.nodeName.toLowerCase()])continue;c=j[f.expando];if(c){b=d[c]&&d[c][e];if(b&&b.events){for(var k in b.events)g[k]?f.event.remove(j,k):f.removeEvent(j,k,b.handle);b.handle&&(b.handle.elem=null)}h?delete j[f.expando]:j.removeAttribute&&j.removeAttribute(f.expando),delete d[c]}}}});var bo=/alpha\([^)]*\)/i,bp=/opacity=([^)]*)/,bq=/-([a-z])/ig,br=/([A-Z]|^ms)/g,bs=/^-?\d+(?:px)?$/i,bt=/^-?\d/,bu=/^[+\-]=/,bv=/[^+\-\.\de]+/g,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB,bC=function(a,b){return b.toUpperCase()};f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0,widows:!0,orphans:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d;if(h==="number"&&isNaN(d)||d==null)return;h==="string"&&bu.test(d)&&(d=+d.replace(bv,"")+parseFloat(f.css(a,c))),h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]},camelCase:function(a){return a.replace(bq,bC)}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){a.offsetWidth!==0?e=bD(a,b,d):f.swap(a,bw,function(){e=bD(a,b,d)});if(e<=0){e=bz(a,b,b),e==="0px"&&bB&&(e=bB(a,b,b));if(e!=null)return e===""||e==="auto"?"0px":e}if(e<0||e==null){e=a.style[b];return e===""||e==="auto"?"0px":e}return typeof e=="string"?e:e+"px"}},set:function(a,b){if(!bs.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bp.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle;c.zoom=1;var e=f.isNaN(b)?"":"alpha(opacity="+b*100+")",g=d&&d.filter||c.filter||"";c.filter=bo.test(g)?g.replace(bo,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,c){var d,e,g;c=c.replace(br,"-$1").toLowerCase();if(!(e=a.ownerDocument.defaultView))return b;if(g=e.getComputedStyle(a,null))d=g.getPropertyValue(c),d===""&&!f.contains(a.ownerDocument.documentElement,a)&&(d=f.style(a,c));return d}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;!bs.test(d)&&bt.test(d)&&(c=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":d||0,d=f.pixelLeft+"px",f.left=c,e&&(a.runtimeStyle.left=e));return d===""?"auto":d}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bE=/%20/g,bF=/\[\]$/,bG=/\r?\n/g,bH=/#.*$/,bI=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bJ=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bK=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/,bL=/^(?:GET|HEAD)$/,bM=/^\/\//,bN=/\?/,bO=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bP=/^(?:select|textarea)/i,bQ=/\s+/,bR=/([?&])_=[^&]*/,bS=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bT=f.fn.load,bU={},bV={},bW,bX;try{bW=e.href}catch(bY){bW=c.createElement("a"),bW.href="",bW=bW.href}bX=bS.exec(bW.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bT)return bT.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bO,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bP.test(this.nodeName)||bJ.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bG,"\r\n")}}):{name:b.name,value:c.replace(bG,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.bind(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?f.extend(!0,a,f.ajaxSettings,b):(b=a,a=f.extend(!0,f.ajaxSettings,b));for(var c in{context:1,url:1})c in b?a[c]=b[c]:c in f.ajaxSettings&&(a[c]=f.ajaxSettings[c]);return a},ajaxSettings:{url:bW,isLocal:bK.test(bX[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML}},ajaxPrefilter:bZ(bU),ajaxTransport:bZ(bV),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a?4:0;var o,r,u,w=l?ca(d,v,l):b,x,y;if(a>=200&&a<300||a===304){if(d.ifModified){if(x=v.getResponseHeader("Last-Modified"))f.lastModified[k]=x;if(y=v.getResponseHeader("Etag"))f.etag[k]=y}if(a===304)c="notmodified",o=!0;else try{r=cb(d,w),c="success",o=!0}catch(z){c="parsererror",u=z}}else{u=c;if(!c||a)c="error",a<0&&(a=0)}v.status=a,v.statusText=c,o?h.resolveWith(e,[r,c,v]):h.rejectWith(e,[v,c,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.resolveWith(e,[v,c]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f._Deferred(),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bI.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.done,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bH,"").replace(bM,bX[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bQ),d.crossDomain==null&&(r=bS.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bX[1]&&r[2]==bX[2]&&(r[3]||(r[1]==="http:"?80:443))==(bX[3]||(bX[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bU,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bL.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bN.test(d.url)?"&":"?")+d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bR,"$1_="+x);d.url=y+(y===d.url?(bN.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", */*; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bV,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){status<2?w(-1,z):f.error(z)}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)b_(g,a[g],c,e);return d.join("&").replace(bE,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cc=f.now(),cd=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cc++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(cd.test(b.url)||e&&cd.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(cd,l),b.url===j&&(e&&(k=k.replace(cd,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var ce=a.ActiveXObject?function(){for(var a in cg)cg[a](0,1)}:!1,cf=0,cg;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ch()||ci()}:ch,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,ce&&delete cg[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cf,ce&&(cg||(cg={},f(a).unload(ce)),cg[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cj={},ck,cl,cm=/^(?:toggle|show|hide)$/,cn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,co,cp=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cq,cr=a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);for(var d=0,e=this.length;d<e;d++)if(this[d].style){var g=f.css(this[d],"display");g!=="none"&&!f._data(this[d],"olddisplay")&&f._data(this[d],"olddisplay",g)}for(d=0;d<e;d++)this[d].style&&(this[d].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return this[e.queue===!1?"each":"queue"](function(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(f.support.inlineBlockNeedsLayout?(j=cv(this.nodeName),j==="inline"?this.style.display="inline-block":(this.style.display="inline",this.style.zoom=1)):this.style.display="inline-block"))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)k=new f.fx(this,b,i),h=a[i],cm.test(h)?k[h==="toggle"?d?"show":"hide":h]():(l=cn.exec(h),m=k.cur(),l?(n=parseFloat(l[2]),o=l[3]||(f.cssNumber[i]?"":"px"),o!=="px"&&(f.style(this,i,(n||1)+o),m=(n||1)/k.cur()*m,f.style(this,i,m+o)),l[1]&&(n=(l[1]==="-="?-1:1)*n+m),k.custom(m,n,o)):k.custom(m,h,""));return!0})},stop:function(a,b){a&&this.queue([]),this.each(function(){var a=f.timers,c=a.length;b||f._unmark(!0,this);while(c--)a[c].elem===this&&(b&&a[c](!0),a.splice(c,1))}),b||this.dequeue();return this}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default,d.old=d.complete,d.complete=function(a){d.queue!==!1?f.dequeue(this):a!==!1&&f._unmark(this),f.isFunction(d.old)&&d.old.call(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,b,c){function h(a){return d.step(a)}var d=this,e=f.fx,g;this.startTime=cq||cs(),this.start=a,this.end=b,this.unit=c||this.unit||(f.cssNumber[this.prop]?"":"px"),this.now=this.start,this.pos=this.state=0,h.elem=this.elem,h()&&f.timers.push(h)&&!co&&(cr?(co=1,g=function(){co&&(cr(g),e.tick())},cr(g)):co=setInterval(e.tick,e.interval))},show:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop),this.options.show=!0,this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b=cq||cs(),c=!0,d=this.elem,e=this.options,g,h;if(a||b>=e.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),e.animatedProperties[this.prop]=!0;for(g in e.animatedProperties)e.animatedProperties[g]!==!0&&(c=!1);if(c){e.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){d.style["overflow"+b]=e.overflow[a]}),e.hide&&f(d).hide();if(e.hide||e.show)for(var i in e.animatedProperties)f.style(d,i,e.orig[i]);e.complete.call(d)}return!1}e.duration==Infinity?this.now=b:(h=b-this.startTime,this.state=h/e.duration,this.pos=f.easing[e.animatedProperties[this.prop]](this.state,h,0,1,e.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){for(var a=f.timers,b=0;b<a.length;++b)a[b]()||a.splice(b--,1);a.length||f.fx.stop()},interval:13,stop:function(){clearInterval(co),co=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=a.now}}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);f.offset.initialize();var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.offset.supportsFixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.offset.doesNotAddBorder&&(!f.offset.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.offset.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.offset.supportsFixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={initialize:function(){var a=c.body,b=c.createElement("div"),d,e,g,h,i=parseFloat(f.css(a,"marginTop"))||0,j="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";f.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"}),b.innerHTML=j,a.insertBefore(b,a.firstChild),d=b.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,this.doesNotAddBorder=e.offsetTop!==5,this.doesAddBorderForTableAndCells=h.offsetTop===5,e.style.position="fixed",e.style.top="20px",this.supportsFixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",this.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==i,a.removeChild(b),f.offset.initialize=f.noop},bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.offset.initialize(),f.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){return this[0]?parseFloat(f.css(this[0],d,"padding")):null},f.fn["outer"+c]=function(a){return this[0]?parseFloat(f.css(this[0],d,a?"margin":"border")):null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c];return e.document.compatMode==="CSS1Compat"&&g||e.document.body["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var h=f.css(e,d),i=parseFloat(h);return f.isNaN(i)?h:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f})(window);var TurnTojQuery=jQuery.noConflict(true);TurnToHTML={amqNoMoreQs:new Function("obj","var p=[];with(obj){p.push('<div style=\"font-size:16px;vertical-align:center;text-align:center;\">',TurnTo.S.amqNoMoreQuestions,'</div>');}return p.join('');"),amqNoMoreRs:new Function("obj","var p=[];with(obj){p.push('<div style=\"font-size:16px;vertical-align:center;text-align:center;\">',TurnTo.S.amqNoMoreReviews,'</div>');}return p.join('');"),confirmationMessageScreen:new Function("obj","var p=[];with(obj){p.push('<div style=\"margin:20px 0; font-size:12px;\">',message,'</div><input type=\"submit\" id=\"confirmationMessageScreenBtn\" class=\"TTsubmitButton TTdoneBtn\" value=\"\">');}return p.join('');"),mobileConfirmationMessageScreen:new Function("obj","var p=[];with(obj){p.push('<div style=\"margin-bottom: 10px; padding: 10px; font-size:12px; border: 1px solid #ccc\">',message,'<br/><br/> <a href=\"javascript:void(0)\" rel=\"nofollow\" id=\"confirmationMessageScreenBtn\">',TurnTo.msg('tra.systemMessage.link.dismiss'),'</a></div>');}return p.join('');"),youBadge:new Function("obj","var p=[];with(obj){p.push('<span class=\"TT3youBadge\">',TurnTo.msg('tra.common.youBadge'),'</span>');}return p.join('');"),answerSubmittedConfMessage:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3answerSubmitted-',aid,'\" class=\"TT4SysMsgBody\" style=\"margin-top:2px;width:99%;\"><a id=\"TT3dismissSubmitted-',aid,'\" class=\"TT3tabClose\" title=\"',TurnTo.msg('tra.systemMessage.link.dismiss'),'\" href=\"javascript:void(0)\" rel=\"nofollow\"></a>',messageTxt,'</div>');}return p.join('');"),partnerRegOverlay:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3partnerRegCont\" style=\"background:white;width:100%;height:100%;\"><a id=\"TTpartnerRegWindowClose\" href=\"javascript:void(0)\" rel=\"nofollow\">close</a><iframe id=\"TTpartnerRegFrame\" name=\"TTpartnerRegFrame\" src=\"',pregUrl,'\" style=\"border:none;height:100%;width:100%;overflow:auto;\"></div>');}return p.join('');"),miqaItem:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT3miqaItem\" title=\"',item.title,'\" catimgid=\"',item.imgId,'\" catitemid=\"',item.id,'\"><div class=\"TT3add\" style=\"display:none\">',TurnTo.msg('tra.qa.miqa.link.add'),'</div><span class=\"TT3added\" style=\"display:none\"><div class=\"TT3addedText\"></div><div class=\"TT3transparent\"></div></span><img alt=\"',item.title,'\" src=\"',TurnTo.getProductImage(item.imgId, 'SS'),'\" title=\"',item.title,'\"/><div title=\"',item.title,'\" class=\"TT3miqaItemTitle\">',item.title.length >= 34 ? item.title.substring(0, 34) + \"...\" : item.title,'</div><div class=\"TThiddenForADA\"><input type=\"checkbox\" class=\"TTadaItemPicker\" id=\"',checkboxId,'\" catitemid=\"',item.id,'\"/><label for=\"',checkboxId,'\">',TurnTo.msg('tra.qa.miqa.link.add'),' ',item.title,'</input></div></div>');}return p.join('');"),miqaAttachedItem:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT3miqaAttachedItem\"><a class=\"TT3removeAttachedItem\" catitemid=\"',catItemId,'\" href=\"javascript:void(0)\" rel=\"nofollow\" style=\"position: absolute; right: -2px; top: -5px;;',typeof hideRemove != \"undefined\" && hideRemove ? \"display:none\" : \"\",'\"><img style=\"vertical-align:middle;padding-right:8px;\" src=\"',TurnTo.getStaticUrl(\"/tra4/images/1.gif\"),'\" alt=\"',TurnTo.msg('tra.qa.miqa.alt.remove'),'\"/></a><img class=\"TT3miqaAttachedImg\" alt=\"',title,'\" src=\"',TurnTo.getProductImage(imgId, \"SS\"),'\" title=\"',title,'\"/></div>');}return p.join('');"),miqaQuestionItems:new Function("obj","var p=[];with(obj){p.push(' <div class=\"TT3miqaQuestionItem\" title=\"',title,'\" onclick=\"window.open(&quot;',itemUrl,'&quot;, &quot;_blank&quot;)\"><img alt=\"',title,'\" src=\"',TurnTo.getProductImage(imgId, \"SS\"),'\" title=\"',title,'\"/><div style=\"font-size:10px;line-height:1.2;\" class=\"TT3metaText\">',title,'</div></div>');}return p.join('');"),suggestedQuestion:new Function("obj","var p=[];with(obj){p.push('<li class=\"TT4sqLI\"><div class=\"TT4sqLeft\"></div><div class=\"TTsqRight\"><a href=\"javascript:void(0)\" class=\"TT3qText\" rel=\"nofollow\">',text,'</a></div><div class=\"TT2clearBoth\"></div></li>');}return p.join('');"),miqaPickerBubble:new Function("obj","var p=[];with(obj){p.push('<div class=\"TTmiqaBubble\"><div class=\"TTmiqaInline\"></div></div>');}return p.join('');"),recentlySubmittedQuestionMsg:new Function("obj","var p=[];with(obj){p.push('',TurnTo.msg('tra.qa.askArea.message.recentlySubmitted'),'<br />',TurnTo.msg('tra.qa.askArea.message.recenetPreviousQuestion'),' <i>\"',prevQuestion,'\"</i><br /><input type=\"button\" id=\"TT2acceptDup\" style=\"margin-top:4px;\" class=\"TTconfirmDupBtn\" aria-label=\"',TurnTo.msg('tra.qa.askArea.confirmDuplicate'),'\"/>&nbsp;&nbsp;&nbsp;<input type=\"button\" id=\"TT2cancelDup\" class=\"TTcancelDupBtn\"  aria-label=\"',TurnTo.msg('tra.qa.askArea.cancelDuplicate'),'\"/>');}return p.join('');"),hiHeaderMsg:new Function("obj","var p=[];with(obj){p.push('<span class=\"TT3hiMsgTxt\">',TurnTo.msg('tra.common.header.greeting', [displayName]),'</span> <span class=\"TTlogoutLink\">(<a id=\"TT3loLink\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.common.header.link.notUser', [displayName]),'</a>)</span></span>');}return p.join('');"),syndicationLogoImg:new Function("obj","var p=[];with(obj){p.push('<img src=\"',logoUrl,'\" alt=\"',name,'\">');}return p.join('');"),TTtraLoggedInMain:'<div id="TTtraDialogTitleBar" class="TT-ui-helper-clearfix TurnToWidgetBarColor" unselectable="on"style="-moz-user-select: none;"><a id="TTtraWindowClose" aria-label="Close" title="Close" href="javascript:void(0)" role="button" unselectable="on"style="-moz-user-select: none;" rel="nofollow"></a></div><div id="TTmainContent" class="TTdialog TTtra-ui-dialog-content"style="height: auto; min-height: 93px; width: auto;padding:0 24px 0 24px;"><div id="TT3overlayHeader"></div><div id="TTscrollArea"><div id="TT2MainSection" style="overflow: inherit"><div id="TTLImessageArea" style="display:none;"></div><div class="TT2sectionHeader"><div id="TTnetworkTitle" style="float:left;"></div><div id="TT2zipbox" style="float:right;"></div><div class="TTclearN"></div></div><div id="TT2myNetworkSection"><div id="TT-regflow"></div><div id="TTtraLoggedInMain"></div><div id="TTtraLayout" style="position:relative;width:650px"><div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div></div></div><p>&nbsp;</p></div></div></div><div id="TT2footer" class="TurnToWidgetBarColor"><a id="TT2footerFeedback" style="font-size: 10px;" rel="nofollow">Feedback</a><span id="TTtraFooterLogo">&nbsp;</span></div>',TTtraLoggedOutMain:'<div id="TTtraDialogTitleBar" class="TT-ui-helper-clearfix TurnToWidgetBarColor" unselectable="on"style="-moz-user-select: none;"><a id="TTtraWindowClose" aria-label="Close" title="Close" href="javascript:void(0)" role="button" unselectable="on"style="-moz-user-select: none;" rel="nofollow"></a></div><div id="TTmainContent" class="TTdialog TTtra-ui-dialog-content"style="height: auto; min-height: 93px; width: auto; min-width:650px;padding:0 24px;"><div id="TT3overlayHeader"></div><div id="TTscrollArea"><div id="TT2MainSection"><div id="TT2myNetworkSection" style="position: relative;"><div id="TTtraLayout" style="position:relative;width:650px" ><div style="text-align:center;"><div style="font-weight: bold;padding-top:10px;padding-bottom:10px;font-size:19px">Processing...</div><div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div></div></div></div></div></div></div><div id="TT2footer" class="TurnToWidgetBarColor"><span id="TTtraFooterLogo">&nbsp;</span></div>',mainscreen:'<div id="TTtraBackOverlay" class="TTui-widget-overlay" style="display:none;z-index: 120001;"></div><div id="TTtraWindow" class="TTtra-ui-dialog TT2mainDialog"style="overflow: hidden; display: none; z-index: 120002; outline-color: -moz-use-text-color; outline-style: none; outline-width: 0px; width: 717px; top: 20px;"tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-TTsigninWrapper"><div id="TTtraUserStateMain" style="position: relative;"></div><div id="TTtraInsideOverlay" class="TTsub-ui-widget-overlay" style="display:none;z-index: 120001;"></div><div id="TTtraSubWindow" class="TTtra-ui-dialog TTSubDialog"style="overflow: hidden; display: none; position: absolute; z-index: 120005; outline-color: -moz-use-text-color; outline-style: none; outline-width: 0px; height: auto; width: 577px; top: 75px; left:75px"tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-TTSubWrapper"><div id="TTtrasubtop"><a id="TTSubWindowClose" aria-label="Close" title="Close" href="javascript:void(0)" role="button" unselectable="on" style="-moz-user-select: none;" rel="nofollow"></a></div><div id="TTtrasubmid"><div id="TTSubDialogSection"  class="TTdialog"style="height: auto; min-height: 93px; width: auto;"><div id="TTSubScreen"></div></div></div><div id="TTtrasubbot"></div></div><div id="TTtraBubbleWindow" class="TTtra-ui-dialog"style="overflow: hidden; display: none; position: absolute; z-index: 120005; outline-color: -moz-use-text-color; outline-style: none; outline-width: 0px; height: 352px; width: 462px; top: 22%; left:126px"tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-TTSubWrapper"><a id="TTBubbleWindowClose" href="javascript:void(0)" role="button" unselectable="on" style="-moz-user-select: none;" rel="nofollow"></a><div id="TTBubbleDialogSection"style="height: auto; min-height: 93px; width: auto;margin-top:40px;"><div id="TTBubbleScreen"></div></div></div><div id="TTtoolTip" class="TTtipCopy"></div></div>',spinscreen:'<div id="TTtraBackOverlay" class="TTui-widget-overlay" style="display:block;z-index: 120001;"></div><div id="TTtraWindow" class="TTtra-ui-dialog TT2mainDialog"style="overflow: hidden; display: block; position: absolute; z-index: 120002; outline-color: -moz-use-text-color; outline-style: none; outline-width: 0px; width: 715px; top: 10px;"tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-TTsigninWrapper"><div id="TTtraUserStateMain" style="position: relative;"><div id="TTtraDialogTitleBar" class="TT-ui-helper-clearfix TurnToWidgetBarColor" unselectable="on"style="-moz-user-select: none;"><span id="TTtraDialogTitle" unselectable="on" style="-moz-user-select: none;"></span><a id="TTspinnerClose" href="javascript:void(0)" rel="nofollow" role="button" unselectable="on"style="-moz-user-select: none;float:left;position: absolute; left: .3em; top: 50%; width: 25px; margin: -15px 1px 0 -3px; padding: 1px; height: 25px;"></a></div><div id="TTmainContent" class="TTdialog TTtra-ui-dialog-content"style="height: auto; min-height: 93px; width: auto; min-width:670px"><div id="TT2MainSection"><div class="TT2sectionHeader" style="position: relative;"><div id="TTnetworkTitle" style="text-align:center;width:620px;"><div style="padding-top:10px;padding-bottom:10px;font-size:19px"></div><div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div></div></div></div></div><div id="TT2footer" class="TurnToWidgetBarColor"><span id="TTtraFooterLogo">&nbsp;</span></div></div></div>',_connectAndSourceSelector:new Function("obj","var p=[];with(obj){p.push('    <div style=\"float:left\">    <ul id=\"TTimportLogos\">        ');if (!hideFacebook) {p.push('        <li>             <a href=\"javascript:void(0)\" rel=\"nofollow\" id=\"TTfbConnect2\"  style=\"display:block;height:40px;width:120px;text-align:center;line-height:40px\">                Facebook            </a>        </li>        ');}p.push('    ');        var prevType = TurnTo.matchData.importSrc[0].type;        for (var i=0; i < TurnTo.matchData.importSrc.length; i++) {            var impSrc = TurnTo.matchData.importSrc[i];        p.push('        <li id=\"TT2importSrc-',impSrc.id,'\">         <a href=\"javascript:void(0)\" rel=\"nofollow\" id=\"TT2importSrcLink',impSrc.id,'\" style=\"display:block;height:40px;width:120px;text-align:center;line-height:40px;',i == TurnTo.matchData.importSrc.length - 1 ? 'border-bottom:#DDD 1px solid' : '','\">            ', impSrc.disp ,'        </a>        </li>        '); } p.push('    </ul>        '); if (!TurnTo.matchData.user) { p.push('    <br/>             <a href=\"javascript:void(0)\" rel=\"nofollow\" id=\"TT2NoImportLink\">I don&#39;t use any of these</a>        '); } p.push('    </div>    <!--Put a empty cell here (TT2importedEmptyMsg) if no msg so the pick on image stay at the same position-->    <div id=\"',showConfirm && matches.delAuthImportMsg ? 'TT2importedMsg' : 'TT2importedEmptyMsg','\">        '); if (showConfirm && matches.delAuthImportMsg) { p.push('            ', matches.delAuthImportMsg,'            '); if (matches.importHistory && matches.importHistory[0].src == 'Facebook' && matches.importHistory.length == 1) { p.push('                <span style=\"font-weight:bold;font-size:10px\">Be sure to add friends from other sources as well.</span>                <span style=\"font-size:10px\" id=\"TTtipWhy\">(Why?)</span>                <div id=\"TTtipWhy-tip\" class=\"TTtip\">TurnTo uses email addresses to make connections, and Facebook doesn&#39;t                    provide your friends&#39; email addresses.                    So if you only add friends from Facebook,we might miss lots of your friends.                </div>            '); } p.push('        '); } else { p.push('             <br/><br/>        '); } p.push('    </div>     <div id=\"TT2ImportSrcForm\" style=\"margin-left: 35%;\">        <ul id=\"TTSubDialogErrors\"></ul>        <div id=\"TTpickone\"></div>    </div>    ');if (matches.importHistory && matches.importHistory.length > 0) {p.push('    <div id=\"TT2importHistory\">        Currently checking for ',matches.totalFriends,' friends.<br/>        Most recent additions:<br/>        ');for (var i = 0; i < matches.importHistory.length; i++) {p.push('            <span style=\"font-weight:bold;padding-left:25px\">',matches.importHistory[i].src,'</span> on ',matches.importHistory[i].date,'            <br/>        ');}p.push('    </div>    ');}p.push('    <div class=\"TT2clearBoth\"></div>    <div id=\"TT2importRegForm\" style=\"display:none;margin-top:20px;\">        ', TurnToHTML.regform({matches:TurnTo.matchData, getUrl:TurnTo.getUrl, getStaticUrl:TurnTo.getStaticUrl,regflow:null}) ,'    </div>');}return p.join('');"),answerBlock:new Function("obj","var p=[];with(obj){p.push('');var answererName = TurnTo.formatName(answerer);var atSiteLink = \"\";var showSyndLink = syndicationSource && syndicationSource.settings.attributionTag;if (showSyndLink) {atSiteLink = TurnTo.genSyndSiteLink('sa', aid, siteId, syndicationSource);    }p.push('<input type=\"hidden\" id=\"TT2qid4answer-',aid,'\" name=\"TT2qid4answer-',aid,'\" value=\"',qid,'\"/><div class=\"TT4ansAndReplies\">    <div id=\"TT3answer-',aid,'\" class=\"TT3ansArea\"    '); if (typeof isSqv != 'undefined' && isSqv) { if (typeof bestAnswer != 'undefined' && bestAnswer) {    p.push('sqvbestanswer=\"true\"');} } else { if (typeof bestAnswer != 'undefined' && bestAnswer) { p.push('bestanswer=\"true\"'); } }    p.push('>    '); if (aid != \"SYSTEM\" && !isNew) { p.push('    <div class=\"TT2left TT4vUpCnt\">    <a id=\"TT3vUpLnka',aid,'\" ',answerer.uid ? 'tt3-uid=\"'+answerer.uid+'\"' : '' ,' href=\"javascript:void(0)\"        onclick=\"TurnTo.ilv(1,',aid,',true,this)\" title=\"',TurnTo.msg('tra.qa.answer.upvote.hover'),'\"        class=\"TT3yesVote TT4answerVote\" rel=\"nofollow\"></a>    <div class=\"TT3vcntUp\">',upVotes - downVotes,'</div></div>'); } p.push('<div class=\"TT2left TT4respAnsWidth\">    <div class=\"TT3ansCntr\">        <div class=\"TT3itemBox2 ', hasReplys ? ' TT3replyBorder' : '','\" style=\"'); if (aid == \" SYSTEM        \") {p.push('margin-left:5px;');}p.push('position:relative\">        '); if (typeof bestAnswer != 'undefined' && bestAnswer) {p.push('        <span class=\"TTbestAnswer\">',TurnTo.S.bestAnswerText ? TurnTo.S.bestAnswerText : TurnTo.msg('tra.qa.answer.bestAnswer.caps'),'</span>        ');}p.push('        <span id=\"TT3aText',aid,'\" class=\"TT3aText\">',answerText,'</span>        '); if (aid != \"SYSTEM\") { p.push('        <ul class=\"TT3linkLine\">            <li><a id=\"TT3replyLink',aid,'\" href=\"javascript:void(0)\" rel=\"nofollow\"                   onclick=\"TurnTo.ilr(',qid,', ',aid,', null, this ',(hasReplys ? ', null, ' + replyCnt : ''),')\">',TurnTo.msg('tra.qa.answer.linkLine.reply')                + (hasReplys ? ' (' + replyCnt + ')' : ''),'</a>            </li>            <li class=\"TTflagAnswer\"><a id=\"TT3inappropriateLink',aid,'\" href=\"javascript:void(0)\" rel=\"nofollow\"                                            onclick=\"TurnTo.ilf(',aid,', this)\"                                            title=\"',TurnTo.msg('tra.qa.answer.linkLine.inappropriate.hover'),'\">',TurnTo.msg('tra.qa.answer.linkLine.inappropriate'),'</a>                </li>            '); if (TurnTo.matchData.user && TurnTojQuery.inArray(TurnTo.siteModerator,            TurnTo.matchData.user.userSiteRoles) >= 0) { p.push('            <li class=\"TTmoderateAnswer\"><a class=\"TT3Moderate\" tabindex=\"0\" target=\"_blank\" rel=\"nofollow\"                                            href=\"',TurnTo.partnerProtocol + '//' + TurnTo.S.host + '/moderation/qsolo?id=' + aid,'\">',TurnTo.msg('tra.common.linkLine.moderate'),'</a>            </li>            '); } p.push('                '); if (TurnTo.matchData.site.enableThankingUsers === true && TurnTo.matchData.user &&                TurnTo.matchData.user.id == askerId && answerer.uid != askerId) { p.push('            <li class=\"TT3sendThanks\"            ',answerer.uid ? 'tt3-uid=\"'+answerer.uid+'\"' : '' ,'>            ');if(thanked){p.push('            ',TurnTo.msg('tra.qa.answer.linkLine.youThanked', [answererName]),'            ');}else{p.push('            <a href=\"javascript:void(0)\" rel=\"nofollow\" onclick=\"TurnTo.ilt(',aid,',this)\">',TurnTo.msg('tra.qa.answer.linkLine.thank',                [answererName]),'</a>            ');}p.push('            </li>            '); } p.push('                <li class=\"TT3askedBy\">                    '); if (answerer.uid) { p.push('                    <a href=\"javascript:void(0)\" tt3-uid=\"',answerer.uid,'\" rel=\"nofollow\">',answererName,'</a>                    '); } else { p.push('                    ',answererName,'                    '); } p.push('                    '); if(showSyndLink && syndicationAnswerSource == 1) {                    var purchasedMsgKey = isMultiItemQuestion ? 'tra.qa.answer.linkLine.purchasedOneOfItemsFromSite' :                    'tra.qa.answer.linkLine.purchasedItemFromSite';                    p.push('                    <span class=\"TT3purchased\">',TurnTo.msg(purchasedMsgKey, [atSiteLink]),'</span>                    '); } else if (showSyndLink && syndicationAnswerSource != 1) { p.push('                      <span class=\"TT3atLabel\">',TurnTo.msg('tra.qa.answer.linkLine.answeredAtSite', [atSiteLink]),'                    '); } p.push('                    <span class=\"TT3youHolder\" ',answerer.uid ? 'tt3-uid=\"'+answerer.uid+'\"' : '' ,'></span>                    '); if (answerer.expertLabel) { p.push('                    <span class=\"TT3expertBadge\">',answerer.expertLabel,'</span>                    '); } else if(answerer.isStaff) { p.push('                    <span class=\"TT3staffBadge\">',TurnTo.msg('tra.common.staffBadge'),'</span>                    '); } p.push('                    <span class=\"TT3timeStamp\">',TurnTo.msg('tra.qa.answer.linkLine.answeredOnDate', [dateCreated]),'</span>                    '); if (typeof siteName != 'undefined' && siteName) { p.push('                    <span class=\"TTsiteAttribution\">',TurnTo.msg('tra.moreFeedback.siteAttribution', [siteName]),'</span>                    '); } p.push('                </li>                '); if (purchaseDate) { p.push('            <li class=\"TT4purchaseText\">',TurnTo.msg('tra.qa.answer.linkLine.puchasedOnDate',                [purchaseDate]),'</span></li>                '); } p.push('        </ul>        '); } p.push('        '); if(miqaCatItems && miqaCatItems.length > 0) { p.push('        <div class=\"TT4miqaContainer\">            <div class=\"TT4miqaScrollLContainer\">                <div class=\"TT4miqaScrollL\"></div>                    </div>            <div class=\"TT4miqaScrollRContainer\">                <div class=\"TT4miqaScrollR\"></div>            </div>            <div class=\"TT3miqaSection\" style=\"margin:20px 0 0 0\">                '); for (var i = 0; i < miqaCatItems.length; i++) { p.push('                ', TurnToHTML.miqaQuestionItems(miqaCatItems[i]) ,'                '); } p.push('            </div>            <div class=\"TT2clearBoth\"></div>        </div>        '); } p.push('            </div>            <div class=\"TTclear\"></div>        </div>    </div>    <div class=\"TTclear\"></div>',(aid ? '' : TurnToHTML.inlineAnswerInputBox({qid:qid, aid:aid, defaultText:TurnTo.msg('tra.qa.answer.instruction.enterAnswer'), rid:null, show:true, replyInput:false, related:false, replyToUid:null})),'    <div id=\"TT3IRContainer-',qid,'-',aid,'\" class=\"TT3IRContainer TT3Indent\" style=\"display:none\"></div></div></div>');}return p.join('');"),answerWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2answerWidget\">    <div class=\"TTsoloQuestionMsg\" style=\"display:block;\">        '); var ansName = TurnTo.formatName(answerer, false, 'nickFirstEmail');            /* When the asker is anonymous, the id and last_name is null and the format operation returns whitespace at the end.              Additionally, the lastName can be null, in which case the formatter adds a space. */           var askerName = TurnTo.formatName(asker, false).trim();            /* When the asker is anonymous, askerName is populated as 'A shopper'. On this page, it needs to be displayed in lower case in               greeting, but as is elsewhere on the page. */            var lcAskerName = asker.id ? askerName : askerName.toLowerCase();         p.push('        ',TurnTo.msg('tra.answerWidget.message.thanksForHelping', [ansName, lcAskerName]),'    </div>    <div id=\"TTawQWrap\" style=\"position: relative;\">        <div id=\"TT2awQuestionSection\" class=\"TT3itemBox\">            <div class=\"TT3aboutLine\">',TurnTo.msg('tra.qa.question.aboutProduct'),' <a id=\"TT2itemLink-title-',item.id,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTojQuery.trim(item.title),'</a></div>            <div class=\"TT3qText',(miqCatItems && miqCatItems.length > 0) ? '' : ' TTproductImgPresent','\">                ',question.text,'            </div>            <span class=\"TT4askedByBlock TT3metaText\">', askerName,'            <span class=\"TT3timeStamp\">',TurnTo.msg('tra.qa.answer.linkLine.answeredOnDate', [question.dateCreated]),'</span></span>            <div class=\"TT2clearBoth\"></div>            '); if(miqCatItems && miqCatItems.length > 0) { p.push('                <div id=\"TT3awMiq\" style=\"position:relative\">                    <div class=\"TT3scrollL\" style=\"display:none;\" onclick=\"TurnTo.miqaScrollL(this)\"><div class=\"TT3carouselLeft\"></div></div>                    <div class=\"TT3scrollR\" ',miqCatItems.length <= 3 ? 'style=\"display:none\"' : '',' onclick=\"TurnTo.miqaScrollR(this)\"><div class=\"TT3carouselRight\"></div></div>                    <div class=\"TT3miqaSection\" style=\"text-align: center;\">                        ', TurnToHTML.miqaQuestionItems({title: item.title, itemUrl: item.itemUrl, imgId: item.imgId}) ,'                        '); for (var i = 0; i < miqCatItems.length; i++) { p.push('                            ', TurnToHTML.miqaQuestionItems(miqCatItems[i]) ,'                        '); } p.push('                    </div>                    <div class=\"TT2clearBoth\"></div>                </div>            '); } p.push('        </div>        <div id=\"TT3awItemImageDiv\" class=\"TT4QProductImg\" style=\"',(miqCatItems && miqCatItems.length > 0) ? 'display:none' : '','\">            <a id=\"TT2itemLink-image-',item.id,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\" rel=\"nofollow\"><img src=\"',TurnTo.getProductImage(item.imgId,'L'),'\" alt=\"',item.title,'\" class=\"TTcatImg\" style=\"width:100px;height:100px;\"></a>        </div>    </div>    <div class=\"TT2clearBoth\"></div>    <div id=\"TT2answerPanel\" class=\"TT3answersBlock TTanswerInputArea\">        <div id=\"TT2error\" class=\"TT4SysMsgBody\"></div>        <!--<div style=\"padding-bottom: 10px;\">Please enter your answer:</div>-->        <textarea id=\"TT2answerText\" rows=\"3\" style=\"width:100%;\" ttinputlabeltext=\"',TurnTo.msg('tra.qa.answer.instruction.enterAnswer'),'\"                  onfocus=\"TurnTo.showInlineAnswerInput(this)\"                  onblur=\"TurnTo.inputLoseFocus(this)\"                  class=\"TT3inlineAnswer TTdefaultInput\">',TurnTo.msg('tra.qa.answer.instruction.enterAnswer'),'</textarea>        <div id=\"TT2anwerCharCount\" class=\"TT2charLimitCount TT2right\"></div>        <div id=\"TT2answerBtns\" class=\"TT4answerBtns\">            <div class=\"TT4answerInstructions\">',TurnTo.msg('tra.common.instruction.invalidText'),'</div>            <div class=\"TT2clearBoth\"></div>            <div class=\"TT4ansMiqaAnsBtns\">                <div class=\"TT4ansBtns\">                    <a style=\"display:none\" id=\"TT2cancelBtn\" class=\"TT2cancelBtn\" href=\"javascript:void(0)\" rel=\"nofollow\">Cancel</a>                    <img id=\"TT2imgLoading\" class=\"TT2imgLoading\"                         src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\"                         style=\"display: none;\">                    <div id=\"TT2answerBtn\" class=\"TT3answerBtn TTbigSubmitBtn\" tabindex=\"0\" role=\"button\" aria-label=\"',TurnTo.msg('tra.common.button.submit'),'\"></div>                    <input id =\"answSourceId\" type=\"hidden\" value=\"',sourceId,'\"/>                    <input id =\"iqrlId\" type=\"hidden\" value=\"',iqrlId,'\"/>                </div>              '); if (TurnTo.matchData.site.mia) { p.push('              <div id=\"TT3miqaAnswer\" class=\"TT3miqaAnswer\" style=\"display:none;\"></div>              <div class=\"TT3answerMiqa TTrespDesktopLandscapeDisp\">',TurnTo.msg('tra.qa.miqa.addItems'),'</div>              <div class=\"TTanswerMiqaHelp TT3metaText TTrespDesktopDisp\">                <div class=\"TTanswerMiqaHelpArrow\">&laquo;</div>                <div class=\"TTanswerMiqaHelpText\">                    ',TurnTo.msg('tra.qa.answer.instruction.attachItem.' + (TurnToCatItemType == 2 ? 'specific' : 'other')),'                </div>                <div class=\"TT2clearBoth\"></div>              </div>              '); } p.push('                <div class=\"TT2clearBoth\"></div>            </div>            <div class=\"TT2clearBoth\"></div>        </div>        <div class=\"TT2clearBoth\"></div>    </div>    <div id=\"TT2answerSubmittedPanel\" style=\"display:none;\" class=\"TT4ansAndReplies\">        <div class=\"TT3ansArea\">            <div class=\"TT3ansCntr\">                <div class=\"TT4SysMsgBody\" style=\"display:block\">                    <span>',TurnTo.msg('tra.qa.answer.message.answerSubmitted'),'</span>                    <div id=\"TT2answerRewardMsg\"                         style=\"margin-top:10px;margin-bottom:5px;',rewardConfig.preText ? '' : 'display:none' ,'\">                        ',rewardConfig.preText,'                    </div>                </div>            </div>            <div class=\"TT3itemBox2\">                <span id=\"TT2answerSubmittedPanelTxt\" class=\"TT3aText\"></span>                <div class=\"TT3linkLine\">                    <span class=\"TT3askedBy\">',TurnTo.formatName(answerer, false),'</span><span class=\"TT3youBadge\">',TurnTo.msg('tra.common.youBadge'),'</span>                </div>            </div>        </div>    </div>    <div style=\"margin-top: 20px;\">        <div class=\"TTdoneBtn TT2doneSub\" style=\"display:none;margin-left:auto; margin-right: auto;\"></div>    </div></div>');}return p.join('');"),commentBlock:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT3chatterFullBox\" style=\"position:absolute;width:',TurnTo.S.fullComments.boxWidth ? TurnTo.S.fullComments.boxWidth : \"180px\",';\">    <div style=\"text-align:center;position: relative;margin-bottom: 30px;\">        <a class= \"TT3chatterFullLink\"  target=\"_blank\"  href=\"', comments[0].catItem.url ,'\" onclick=\"window.open(&#39;',TurnTo.getUrl('/transLink/14/ci/' + comments[0].siteCatalogItemId + '/' + TurnTo.S.locale + '?sid=' + comments[0].siteId),'&#39, &#39_blank&#39); TurnTo.pbItemClicked(); return false\" rel=\"nofollow\">            <img class=\"TT3commentImg\" style=\"border:none;width:100%\"                 src=\"',TurnTo.getProductImage(comments[0].catItem.imageId, 'L'),'\" />        </a>        <div class=\"TT3infoBox\" style=\"background-color: white;bottom: -20px;height: auto;position: absolute;width: 100%;\">            <div style=\"border-bottom: 1px solid #999999;text-align: center;padding-bottom:4px;\"><a class=\"TT3fullChatterItemLink\" href=\"', comments[0].catItem.url ,'\" onclick=\"window.open(&#39;',TurnTo.getUrl('/transLink/14/ci/' + comments[0].siteCatalogItemId + '/' + TurnTo.S.locale + '?sid=' + comments[0].siteId),'&#39, &#39_blank&#39);; return false\" target=\"_blank\" rel=\"nofollow\">', comments[0].catItem.title.substring(0, Math.min(comments[0].catItem.title.length, (TurnTo.S.fullComments.titleMaxLength ? TurnTo.S.fullComments.titleMaxLength : 1000))) ,'</a></div>            <span class=\"TT3price\" tt3-sku=\"',comments[0].catItem.sku,'\" style=\"text-align: center;display:none;\"></span><br>            <div class=\"TT3shareBtns\" siteCatalogItemId=\"',comments[0].siteCatalogItemId,'\" siteId=\"',comments[0].siteId,'\" catItemImageId=\"',comments[0].catItem.imageId,'\" catItemtitle=\"',comments[0].catItem.title,'\">            </div>        </div>    </div>    '); for(var i = 0; i < comments.length && i < TurnTo.S.fullComments.maxCommentsPerBox; i++) { p.push('        <span class=\"TT3fullChatterAskedBy\">',!TurnTo.S.noProfiles ? '<a tt3-uid=\"'+comments[i].user.id+'\" href=\"javascript:void(0)\" rel=\"nofollow\">' : '<span>','            ');              var name = TurnTo.formatName(comments[i].user, false);            p.push('            ', name.substring(0, Math.min(name.length, TurnTo.S.fullComments.nameMaxLength ? TurnTo.S.fullComments.nameMaxLength : 1000)) ,'        ',TurnTo.S.noProfiles ? '</span>' : '</a>','</span><span class=\"TT3ccTimeStamp\">',comments[i].timeStamp,'</span><br>        <span class=\"TT3chatterFullCommentText\">',comments[i].text,'</span><br><br>    '); } p.push('</div>');}return p.join('');"),commentBlockShareButtons:new Function("obj","var p=[];with(obj){p.push('<div style=\"float:left\"><iframe src=\"//www.facebook.com/plugins/like.php?href=',encodeURIComponent(TurnTo.getUrl('/transLink/9/ci/' + siteCatalogItemId + '/' + TurnTo.S.locale + '?sid=' + siteId)),'&amp;send=true&amp;layout=button_count&amp;width=450&amp;show_faces=true&amp;font&amp;colorscheme=light&amp;action=like&amp;height=24\" scrolling=\"no\" frameborder=\"0\" style=\"border:none; overflow:hidden; width:48px; height:24px;\" allowTransparency=\"true\"></iframe></div><div style=\"float:right\"><iframe allowtransparency=\"true\" frameborder=\"0\" scrolling=\"no\" src=\"https://platform.twitter.com/widgets/tweet_button.html?count=none&url=',encodeURIComponent(TurnTo.getUrl('/transLink/10/ci/' + siteCatalogItemId + '/' + TurnTo.S.locale + '?sid=' + siteId)),'&text=',encodeURIComponent(catItemTitle),'\" style=\"width:55px; height:20px;\"></iframe></div><div style=\"margin-left:auto;margin-right:auto;width:43px\"><a class=\"TT3pinterest\" data-pin-config=\"beside\" href=\"javascript:void(0)\" rel=\"nofollow\" onclick=\"TurnTo.openPopupWindow(&quot;//pinterest.com/pin/create/button/?url=',encodeURIComponent(TurnTo.getUrl('/transLink/16/ci/' + siteCatalogItemId + '/' + TurnTo.S.locale + '?sid=' + siteId)),'&media=',encodeURIComponent(TurnTo.getProductImage(catItemImageId, 'L')),'&description=',encodeURIComponent(catItemTitle),'&quot;, &quot;Pinterest&quot;)\" data-pin-do=\"buttonPin\" ><img src=\"//assets.pinterest.com/images/pidgets/pin_it_button.png\" /></a></div><div style=\"clear:both;\"></div>');}return p.join('');"),commentCapture:new Function("obj","var p=[];with(obj){p.push('<header class=\"TTcommentCaptureHeader\">    <p>        ',firstName ? firstName+\",\" : TurnTo.msg('tra.pp.header.greeting'),'        ',TurnTo.S.ppcHeader,'        ');TurnTo.newSharePastPurchases = false;p.push('    </p>    <input type=\"hidden\" name=\"TTccGreetName\" value=\"',firstName,'\"/></header><div id=\"TTcommentCaptureContainer\">    ');if (newItems.length > 0 && pastItems.length > 0) {p.push('        <div class=\"TTccSectionHeader\">',TurnTo.msg('tra.pp.header.currentPurchases'),'</div>        ');for (var i = 0; i < newItems.length; i++) {p.push('            ',TurnToHTML.commentCaptureBlock({item: newItems[i], getStaticUrl:getStaticUrl, hideCommentBlock: hideCommentBlock, connectedTwitter: connectedTwitter, firstName: firstName, lastName: lastName}),'        ');}p.push('        <div class=\"TTccSectionHeader\">',TurnTo.msg('tra.pp.header.previousPurchases'),'</div>        ');for (var i = 0; i < pastItems.length; i++) {p.push('            ',TurnToHTML.commentCaptureBlock({item: pastItems[i], getStaticUrl:getStaticUrl, hideCommentBlock: hideCommentBlock, connectedTwitter: connectedTwitter, firstName: firstName, lastName: lastName}),'        ');}p.push('    ');} else if (items) {        if(!TurnTo.S.embedCommentCapture) {p.push('            <div class=\"TTccSectionHeader\">',TurnTo.msg('tra.pp.header.yourPurchases'),'</div>        ');}        for (var i = 0; i < items.length; i++) {            var hideCommentBlock = (i > 0) && TurnTo.S.paginateCommentCapture; p.push('            ',TurnToHTML.commentCaptureBlock({item: items[i], getStaticUrl:getStaticUrl, hideCommentBlock: hideCommentBlock, connectedTwitter: connectedTwitter, firstName: firstName, lastName: lastName}),'        ');}p.push('    ');}p.push('</div>');if (items && items.length > 1 && TurnTo.S.paginateCommentCapture) {p.push('    <div id=\"TTccPaginationContainer\">        <div class=\"TTccPaginationCount\">',TurnTo.msg('tra.ppe.pagination.count', [items.length]),'</div>           <a class=\"TTccNext\" href=\"\" rel=\"nofollow\">',TurnTo.msg('tra.ppe.pagination.next'),'</a>    </div>');}p.push('<!-- This page fails without something following the closing of the if -->');}return p.join('');"),commentCaptureBlock:new Function("obj","var p=[];with(obj){p.push('<div class=\"TTcommentCaptureBlock\" data-sid=\"',item.siteId,'\"    style=\"',hideCommentBlock ? 'display:none' : '' ,'\">    <input type=\"hidden\" name=\"TT2stiIds\" value=\"',item.id,'\"/>    <input type=\"hidden\" name=\"TTccPurchasedDate\" value=\"',item.latestDate,'\"/>    <input type=\"hidden\" name=\"TTccNumOfOrders\" value=\"',item.ordersCount,'\"/>    <div class=\"TTCommentCaptureContent\">        <label for=\"comment\">',item.title,'</label>        <p class=\"TTccPrompt\" style=\"display:none;\">            ',TurnTo.S.whyDidYouChooseMessage,'            <span class=\"TT4metaGray\">',TurnTo.msg('tra.ppe.charactersLeft', ['500']),'</span>        </p>        '); if(item.raveComment) { p.push('        <div class=\"TTccCommentArea\" style=\"display: none\">        </div>        <div class=\"TTccSavedCommentArea\">', item.raveComment ,'</div>        '); } else { p.push('        <div class=\"TTccCommentArea\">            <textarea class=\"TTccComment\" name=\"comment\" placeholder=\"',TurnTo.S.whyDidYouChooseMessage,'\" rows=\"1\"></textarea>        </div>        <div class=\"TTccSavedCommentArea\" style=\"display: none\"></div>        '); } p.push('        <div class=\"TT4SysMsgBody\"></div>        <div class=\"TTccBottom\"  style=\"display: none;\">            <div class=\"TTccSocialPost\">                <span>',TurnTo.msg('tra.ppe.postToSocial'),'</span>                 <div class=\"TTfacebookNoShare TTccFB\"></div>                <div class=\"',connectedTwitter ? 'TTtwitterShare' : 'TTtwitterNoShare',' TTccTW\"></div>            </div>            <img class=\"TT2submitImgLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\" style=\"display: none;\">            <input class=\"TTbigSubmitBtn\" type=\"button\" value=\"\"/>            '); if(TurnTo.S.commentCaptureShowUsername) { p.push('                <div class=\"TTccSubmittedBy\">',TurnTo.msg('tra.ppe.submittedBy', [firstName + ' ' + (lastName ? (lastName[0] + '.') : '')]),'</div>            '); } p.push('        </div>    </div>    <div class=\"TTccItemImage\">        <a href=\"javascript:void(0)\" onclick=\"window.open(&#39;',item.url,'&#39);\" rel=\"nofollow\">            <img src=\"', TurnTo.getProductImage(item.catImgId, 'L') ,'\" alt=\"',item.title,'\"/>        </a>    </div></div>');}return p.join('');"),commentCaptureSaved:new Function("obj","var p=[];with(obj){p.push('<p class=\"TTccThanks\">',TurnTo.msg(\"tra.ppe.submitThanks\"),'</p> <blockquote class=\"TT4quote\">    <p class=\"TT4quote-body\">',commentText,'</p>  <p class=\"TT4quote-links\">  <a id=\"TTccEditLink-',itemId,'\" class=\"TTccEditLink\" href=\"javascript:void(0)\" rel=\"nofollow\" tabindex=\"0\">',TurnTo.msg(\"tra.ppe.link.edit\"),'</a>  <a id=\"TTccDeleteLink-',itemId,'\" class=\"TTccDeleteLink\" href=\"javascript:void(0)\" rel=\"nofollow\" tabindex=\"0\">',TurnTo.msg(\"tra.ppe.link.delete\"),'</a> </p>    <cite class=\"TT4quote-source\">         '); var sourceMsgKey = 'tra.ppe.commentSource' + (orderCount > 1 ? 'Latest' : ''); p.push('        ',TurnTo.msg(sourceMsgKey, [commenterName, datePurchased]),'    </cite> </blockquote>                                        ');}return p.join('');"),diagnostics:new Function("obj","var p=[];with(obj){p.push('<div id=\"turnto-tra-dev-diag\"     style=\"position: fixed; top: 0; left: 0;display:block; width: 600px; height: 400px; margin: 0; margin-left: 10px; margin-top: 50px; border: solid #A0A0A0; 1px;padding: 4px;z-index: 2147483647;background-color:white;overflow-y:scroll;\">    <div id=\"turnto-tra-dev-diag-title-bar\" style=\"display:inline-block;width: 592px;height: 20px;margin:0;margin-left:auto;margin-right:auto;margin-bottom: 4px;padding-left: 4px;padding-right: 4px;padding-top:4px;padding-bottom:0;vertical-align: middle;background-color:red;color:white;\">        <div style=\"float:left;\">TurnTo Diagnostics</div>        <div style=\"float:right;\">[<a style=\"color:white;text-decoration:none;\"                                      href=\"javascript:TurnTo.diagnostics.closeDevDiag();\" rel=\"nofollow\">X</a>]        </div>    </div>    <div id=\"turnto-tra-dev-diag-content\" style=\"display:inline;width: 100%;color:black;\"><b>Summary: </b><br><br>Site Id: ',siteId,'<br>Site Name: ',siteName,'<br><br/>Build Version: ',traVersion,'<br>Setup Type: ',setupType,'<br/>Multi-Item Question: ',miq,'<br>Ratings and Reviews: ',reviewsEnabled,'<br><br>Current Item SKU: ',sku,'<br>Current URL: ',url,'<br><br>Browser Agent/Version: ',userAgent,'<br><br>CDN Server: ',cdn,'<br><br>Cookies Found:<br><br>'); for (var i=0; i<cookieSz; i++) {        var pair = cookies[i].trim().split('='); p.push('',pair[0]+': '+pair[1]+'<br>',''); } p.push('<br><br><b>Complete TurnTo Config Object:</b><br><br>'); for (var key in config) { p.push('', '<span class=\"ttConfigLabel\" style=\"color:#A0A0A0\">'+key+'</span>: ' + ((config[key]) ? new String(config[key]).replace(/</mg,'&lt;').replace(/>/mg,'&gt;') : 'null') + '<br><br>' ,''); } p.push('        <br></div>    <div id=\"turnto-tra-dev-diag-button\">',copyButton,'</div></div>');}return p.join('');"),informationOverlayDefault:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT4infoCol1\" class=\"TTinfoColMobile\">    <div id=\"TT4infoCol1cont\">        <span>',TurnTo.msg('tra.qa.askArea.info.header.howThisWorks'),'</span>        <p>',TurnTo.msg('tra.qa.askArea.info.instruction.howThisWorks1'),'</p>        <p>',TurnTo.msg('tra.qa.askArea.info.instruction.howThisWorks2'),'</p>    </div></div><div id=\"TT4infoCol2\" class=\"TTinfoColMobile\">    <div id=\"TT4infoCol2cont\">        <span>',TurnTo.msg('tra.qa.askArea.info.header.goodTopics'),'</span>        <ul>            <li>',TurnTo.msg('tra.qa.askArea.info.goodTopics1'),'</li>            <li>',TurnTo.msg('tra.qa.askArea.info.goodTopics2'),'</li>            <li>',TurnTo.msg('tra.qa.askArea.info.goodTopics3'),'</li>            <li>',TurnTo.msg('tra.qa.askArea.info.goodTopics4'),'</li>            <li>',TurnTo.msg('tra.qa.askArea.info.goodTopics5'),'</li>            <li>',TurnTo.msg('tra.qa.askArea.info.goodTopics6'),'</li>        </ul>        <p>',TurnTo.msg('tra.qa.askArea.info.forQuestions'),'</p>        '); if (hasSuggested) { p.push('            <p><a id=\"TTviewSuggested\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.qa.askArea.info.link.viewSuggestions'),'</a></p>        '); } p.push('    </div></div><div class=\"TTclear\"></div>');}return p.join('');"),inlineAnswerInputBox:new Function("obj","var p=[];with(obj){p.push('');var qarid = qid + (aid?'-' + aid : '') + (rid ? '-' + rid : '');var smallInputBox = typeof smallInputBox != 'undefined' && smallInputBox !== null && smallInputBox;p.push('<div id=\"TT2answersBlock-',qarid,'\" ',aid?'class=\"TT3replyInputBlock\"':'class=\"TT3answersBlock\"',' style=\"',!show ? 'display:none;':'','\">    <input type=\"hidden\" name=\"TT2replyToUid\" id=\"TT2replyToUid-',qarid,'\" value=\"',replyToUid,'\"/>    <div class=\"TTanswerInputArea\">        <textarea id=\"TT2inlineAnswer-',qarid,'\" name=\"TT2inlineAnswer-',qarid,'\"                  ttinputlabeltext=\"',defaultText,'\"                  onfocus=\"TurnTo.showInlineAnswerInput(this, ',smallInputBox,')\"                  onblur=\"TurnTo.inputLoseFocus(this)\"                  class=\"TT3inlineAnswer TTdefaultInput TT3inlineAnswerIB\"                  rows=\"', smallInputBox ? '1' : '3','\">',defaultText,'</textarea>        <div id=\"TT2anwerCharCount-',qarid,'\" class=\"TT2charLimitCount TT2right\"></div>        <div id=\"TT2error-',qarid,'\" class=\"TT4SysMsgBody TT4inlAnsErrors\"></div>        <div class=\"TT2clearBoth\"></div>        <div id=\"TT2answerBtns-',qarid,'\" class=\"TT4answerBtns\" style=\"',smallInputBox ? 'display:none' : '','\">            <div style=\"display:none\">                <input type=\"checkbox\" id=\"TT2answerNotify-',qarid,'\" checked=\"true\"/>                ',TurnTo.msg('tra.qa.answer.prompt.tellMe'),'            </div>            <div class=\"TT4answerInstructions\">',TurnTo.msg('tra.common.instruction.invalidText'),'</div>            <div class=\"TT2clearBoth\"></div>            <div class=\"TT4ansMiqaAnsBtns\">                <div class=\"TT4ansBtns\">                    <a id=\"TT2cancelBtn-',qarid,'\" class=\"TT2cancelBtn\" href=\"javascript:void(0)\"                       style=\"display:block;float:left;margin-right:15px;padding-top:7px;position:relative;\" rel=\"nofollow\">',TurnTo.msg('tra.common.button.cancel'),'</a>                    <img id=\"TT2imgLoading-',qarid,'\" class=\"TT2imgLoading\"                         src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\"                         alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\"                         style=\"display: none;\">                    <div id=\"TT2answerBtn-',qarid,'\" class=\"TT3answerBtn TTbigSubmitBtn\" tabindex=\"0\"></div>                </div>                '); if (TurnTo.matchData.site.mia && !aid) { p.push('                <div id=\"TT3miqaAnswer-',qarid,'\" class=\"TT3miqaAnswer\" style=\"display:none;\"></div>                <div class=\"TT3answerMiqa TTrespDesktopLandscapeDisp\" tabindex=\"0\" aria-label=\"',TurnTo.msg('tra.qa.askArea.addItem'),'\" role=\"button\">                    <div class=\"TT4miqAdd\"></div>                </div>                <div class=\"TTanswerMiqaHelp TT3metaText TTrespDesktopDisp\">                    <div class=\"TTanswerMiqaHelpArrow\">&laquo;</div>                    '); var instrMsgKey = 'tra.qa.answer.instruction.attachItem.';                    instrMsgKey += (typeof TurnToCatItemType != 'undefined' && TurnToCatItemType == 2) ? 'specific' :                    'other';                    p.push('                    <div class=\"TTanswerMiqaHelpText\">',TurnTo.msg(instrMsgKey),'</div>                    <div class=\"TT2clearBoth\"></div>                </div>                '); } p.push('                <div class=\"TT2clearBoth\"></div>            </div>            <div class=\"TT2clearBoth\"></div>        </div>        <div class=\"TT2clearBoth\"></div>    </div>    <div class=\"TT2clearBoth\"></div></div>');}return p.join('');"),inputTeaser:new Function("obj","var p=[];with(obj){p.push('<div>    <div class=\"TTinputTeaserHeader\">',TurnTo.S.inputTeaserHeader,'</div>    <div>        <div id=\"TTinputTeaserBox\">            <a class=\"TTinputTeaserBubble1\" href=\"javascript:void(0)\" rel=\"nofollow\"></a>            <input type=\"text\" id=\"TTinputTeaserQ\" placeholder=\"',TurnTo.msg('tra.qaTeaser.instruction.typeYourQuestion'),'\"/>        </div>        <div class=\"TT2clearBoth\"></div>        <div class=\"TTinputTeaserSearchline\">        '); if (TurnToItemData.counts.q > 0) { p.push('            or <a class=\"TTteaSearchLink\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.qaTeaser.link.browseQuestions.' + TurnTo.getPlural(TurnToItemData.counts.q), [TurnToItemData.counts.q]) + ' ' + TurnTo.msg('tra.qaTeaser.link.browseAndAnswers.' + TurnTo.getPlural(TurnToItemData.counts.a), [TurnToItemData.counts.a]),'</a>        '); } p.push('        </div>    </div></div>');}return p.join('');"),instantAnswersResults:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT4iaResults',postfix,'\">    '); if (iaRsltCount > 0) { p.push('    <div class=\"TT4instAnsUL\">        ');  for (var i = 0; i < rs.items.length; i++) {  var iaItem = rs.items[i]; p.push('        <div class=\"TT3questBorder\" ', ((i+1) > TurnTo.S.iaExpandCnt) ? 'style=\"display:none\"' : '' ,' >            <div class=\"TT3itemBox\" id=\"', iaItem.id ,'\" ugctype=\"', iaItem.ugcType ,'\">                <div class=\"TT4iaItemLeftCol\">                    <div>                        <span class=\"TT3qText\">', truncateFn(iaItem.ugcType == 'ir' ? (iaItem.title ? iaItem.title : iaItem.text) : iaItem.text, 250,'...') ,' </span>                    </div>                    <div class=\"TT4askedByBlock TT3metaText\">                        <span class=\"TT3askedBy\">                            '); if (iaItem.ugcType == 'k') { p.push('                                ',TurnTo.msg('tra.instantAnsResults.fromKnowledgeBase'),'                            '); } else if (iaItem.ugcType == 'q') { p.push('                                ',TurnTo.msg('tra.instantAnsResults.askedAbout', [iaItem.itemTitle]),'                            '); } else { p.push('                                ',TurnTo.msg('tra.instantAnsResults.reviewFor', [iaItem.itemTitle]),'                            '); } p.push('                        </span>                    </div>                </div>                <div class=\"TT2right TTrespDesktopDisp\">                    '); if (iaItem.ugcType == 'ir') { p.push('                    <div class=\"TTratingBoxBorder\">                        <div class=\"TTratingBox TTrating-',iaItem.rating,'-0\"></div>                    </div>                    '); } else if (iaItem.ugcType == 'q') { p.push('                    <div class=\"TTanswerCount\">                        ',TurnTo.msg('tra.instantAnsResults.link.answers.' + TurnTo.getPlural(iaItem.answerCount), [iaItem.answerCount]),'                    </div>                    '); } else if (iaItem.ugcType == 'k') { p.push('                        <div class=\"TTgoToArticle\">',TurnTo.msg('tra.instantAnsResults.link.goToArticle'),'</div>                    '); } p.push('                </div>                <div class=\"TT2clearBoth\"></div>            </div>        </div>        ');  }  p.push('    </div>        <div class=\"TT3ShowMore\" id=\"TT3iaShowMore',postfix,'\" >            <a href=\"javascript:void(0)\" rel=\"nofollow\"><img class=\"TT4showMoreSmallImg\" src=\"',TurnTo.getStaticUrl('/tra4/images/1.gif'),'\"><span style=\"padding-left:20px;\"></span></a>        </div>    '); } else if(postfix === 'R') { p.push('        <div id=\"TT4askQResultsLine\" class=\"TT-ui-helper-clearfix\">            <span class=\"TTinstAnsresultCountText\"> ',noResultText,'  </span>        </div>    '); } p.push('</div>');}return p.join('');"),irrelevantWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2irrelevantWidget\">    <div class=\"TT2iwHeader\">        '); var ansName = TurnTo.formatName(answerer, false, 'nickFirstEmail'); p.push('        ',TurnTo.msg('tra.irrelevantWidget.message.feedbackThanks', [ansName]),'        <div>            <div id=\"TT2iwQuestionSection\" style=\"float:left;margin-top:10px;\">                <div class=\"TT2askedUserPhoto\">                    <img style=\"display:inline\" src=\"', TurnTo.getUserPhoto(asker.id, asker.pid) ,'\" alt=\"\"/>                </div>                <div style=\"margin-left:63px\">                    '); var askerName = TurnTo.formatName(asker, false);                       var prodLink = '<a id=\"TT2itemLink-title-' + item.id + '\" class=\"TT2itemLink\" href=\"javascript:void(0)\" style=\"font-size:12px;font-weight:bold;color:#314C9B\" rel=\"nofollow\">' + TurnTojQuery.trim(item.title) + '</a>';                    p.push('                    <span class=\"TT2bold\">',TurnTo.msg('tra.irrelevantWidget.askedAbout', [askerName, prodLink]),'</span>                    <br>                    <span>',question.text,'</span>                </div>                <div class=\"TT2clearBoth\"></div>            </div>            <div style=\"float:right;margin-right:20px;\">                <a id=\"TT2itemLink-image-',item.id,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\" rel=\"nofollow\"><img src=\"',TurnTo.getProductImage(item.imgId,'L'),'\" alt=\"',item.title,'\" style=\"width:165px;height:165px;\"></a>            </div>        </div>        <div class=\"TT2clearBoth\"></div>        <div id=\"TT2closeGroup\" class=\"TT2ppBtnGroup\">            <input id=\"TT2ppCloseBtn\" type=\"button\" value=\"',TurnTo.msg('tra.irrelevantWidget.button.close'),'\">        </div>    </div></div>');}return p.join('');"),itemPicker:new Function("obj","var p=[];with(obj){p.push('<div class=\"TTitemPicker\">    <div style=\"margin-top:10px;\">        <div class=\"TTitemPickerClose TT4closeIcon\" tabindex=\"0\" role=\"button\" aria-label=\"',TurnTo.msg('tra.common.label.close'),'\"></div>        <form class=\"TTmiqaForm\" action=\"#\" onsubmit=\"return false;\">            <div class=\"TT3searchDivMiq\">                <div class=\"TT3searchDiv-srchTrm\">                    <input type=\"text\" class=\"TT3SearchTermMiqa\"                           placeholder=\"',TurnTo.msg('tra.qa.itemPicker.instruction.search'),'\"/>                    <a class=\"TT3clearSearchMiqa\" href=\"javascript:void(0)\" rel=\"nofollow\"></a>                </div>                <img class=\"TT2imgLoading\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\"                     alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\"                     style=\"display: none;\">                <div class=\"TT3searchBtn TTsearchBtn\" tabindex=\"0\" role=\"button\" aria-label=\"',TurnTo.msg('tra.common.button.submit'),'\"></div>                <div class=\"TT2clearBoth\"></div>            </div>        </form>    </div>    <div class=\"TT3miqaRsltsCnt\" style=\"display:none;\"></div>    <div class=\"TT4miqaScrollLContainer\">        <div class=\"TT4miqaScrollL\"></div>    </div>    <div class=\"TT4miqaScrollRContainer\">        <div class=\"TT4miqaScrollR\"></div>    </div>    <div class=\"TT4miqaRsltsContainer\">        <div class=\"TT3miqaRslts TT3miqaRsltsRow1\"></div>        <div class=\"TT3miqaRslts TT3miqaRsltsRow2\"></div>    </div></div>');}return p.join('');"),mainMessage:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2mainMessage\">    <h3>',message,'</h3>    <br/><br/>    <input type=\"button\" id=\"TT2bttn1\" class=\"TTblankBtn\" style=\"font-size:15px;width:150px;height:30px;\" name=\"TT2bttn1\" value=\"',bttn1Label,'\"/>    <input type=\"button\" id=\"TT2bttn2\" class=\"TTblankBtn\" style=\"font-size:15px;width:150px;height:30px;\" name=\"TT2bttn2\" value=\"',bttn2Label,'\"/></div>');}return p.join('');"),mediaBlockPhoto:new Function("obj","var p=[];with(obj){p.push(''); if(addDataAttrs) { p.push(' <div class=\"TTmediaBlock\" data-id=\"',photo.id,'\" data-tmp-id=\"',photo.tmpId,'\" data-type=\"',photo.type,'\" tabindex=\"0\">'); } else { p.push(' <div class=\"TTmediaBlock\">'); } p.push('    '); var orientationClass = \"\";       if(photo.imageId) {p.push('     ', TurnTo.getMediaImg(photo, 'PZ-88'),'    '); } else if(photo.file) {       var src = URL.createObjectURL(photo.file);      if(!isIOS && photo.orientation && photo.orientation !== 1) {       orientationClass = 'TTorientation-' + photo.orientation;      } p.push('        <img src=\"',src,'\" alt=\"',photo.caption ? photo.caption : TurnTo.msg('tra.shareMedia.selectedImage'),'\" class=\"',orientationClass,'\" style=\"',photo.imgStyles ? photo.imgStyles : '','\"> '); } p.push('  '); if(!photo.imageId && !photo.imgLoaded) {p.push('     <div class=\"TTtransSpinner\"></div> ');}p.push('</div>');}return p.join('');"),mediaBlockVideo:new Function("obj","var p=[];with(obj){p.push('<div class=\"TTmediaBlock\" data-id=\"',video.id,'\" data-tmp-id=\"',video.tmpId,'\" data-type=\"',video.type,'\" tabindex=\"0\"> <img src=\"', video.thumbnailUrl ,'\"   style=\"left:',video.s88thumbDims.targetLeft,'px; top: ',video.s88thumbDims.targetTop,'; width:',video.s88thumbDims.width,'px; height:',video.s88thumbDims.height,'px;\"   alt=\"',video.caption ? video.catpion : TurnTo.msg('tra.shareMedia.selectedVideo'),'\"></div>');}return p.join('');"),mediaBlocksAttached:new Function("obj","var p=[];with(obj){p.push(''); for(var i = 0; i < media.length; i++) { p.push(' <div class=\"TTattachedMediaBlock\">     <div class=\"TTmediaBlock\" data-id=\"',media[i].id,'\" data-type=\"',media[i].type,'\">  '); if(media[i].type === 'photo') { p.push('   ', TurnTo.getMediaImg(media[i], 'PZ-64') ,'  '); } else if(media[i].type === 'video') { p.push('   <img src=\"', media[i].thumbnailUrl ,'\"     style=\"left:',media[i].s64thumbDims.targetLeft,'px; top: ',media[i].s64thumbDims.targetTop,'; width:',media[i].s64thumbDims.width,'px; height:',media[i].s64thumbDims.height,'px;\"     alt=\"',media[i].caption,'\">  '); } p.push('  </div>  <div class=\"TTvc-x-media-sm TTmediaRemove\"></div> </div>'); } p.push('<!-- comment for template -->');}return p.join('');"),mediaLists:new Function("obj","var p=[];with(obj){p.push('<div class=\"TTmediaList\"> '); if(type == 'photo') { p.push('  <div class=\"TTmediaBlock TTaddPhoto\">    <div class=\"TTuploadArea\">   <form id=\"TTuploadForm\" method=\"POST\" enctype=\"multipart/form-data\" encoding=\"multipart/form-data\" target=\"upload_target\">    <div class=\"TTvc-add-new-photo\" role=\"button\" aria-label=\"',TurnTo.msg('tra.shareMedia.button.addNewPhoto'),'\" tabindex=\"0\"></div>    <input type=\"file\" name=\"TTimgFile\" accept=\"image/gif,image/jpeg,image/jpg,image/pjpeg,image/png\" multiple>    <input type=\"hidden\" name=\"uploadData\">   </form>    </div>  </div>  ');  var photos = model.allMediaMap.photo;   for(var i = 0; i < photos.length; i++) { p.push('    ',TurnToHTML.mediaBlockPhoto({photo: photos[i], addDataAttrs: true, isIOS: isIOS}),'  ');  } p.push('  '); for(var i = 0; i < 5; i++) { p.push('   <div class=\"TTnoMediaPlaceholder\"></div>  '); } p.push(' '); } else if(type == 'video') { p.push('  <div class=\"TTmediaBlock TTaddVideo\" tabindex=\"0\">   <div class=\"TTvc-add-new-video\" role=\"button\" aria-label=\"',TurnTo.msg('tra.shareMedia.button.addNewVideo'),'\"></div>  </div>  '); var videos = model.allMediaMap.video;  for(var i = 0; i < videos.length; i++) {   p.push('    <div class=\"TTmediaBlock\" data-id=\"',videos[i].id,'\" data-tmp-id=\"',videos[i].tmpId,'\" data-type=\"',videos[i].type,'\">   <img src=\"', videos[i].thumbnailUrl ,'\"     style=\"left:',videos[i].s88thumbDims.targetLeft,'px; top: ',videos[i].s88thumbDims.targetTop,'; width:',videos[i].s88thumbDims.width,'px; height:',videos[i].s88thumbDims.height,'px;\"     alt=\"',videos[i].caption ? videos[i].caption : TurnTo.msg('tra.shareMedia.selectedVideo'),'\">    </div>  '); } p.push('  '); for(var i = 0; i < 5; i++) { p.push('  <div class=\"TTnoMediaPlaceholder\"></div>  '); } p.push(' '); } p.push('</div><div class=\"TTmediaNavCntrls\"> <div class=\"TTvc-back-disabled\"></div> <div class=\"TTnavCtrlLine\"><hr/></div> <div class=\"TTvc-next-disabled\"></div></div>&nbsp;');}return p.join('');"),mobileHeader:new Function("obj","var p=[];with(obj){p.push('<div id=\"TTmobileHeader\"> <div class=\"TTleftHeader\"><a href=\"#\" rel=\"nofollow\">',TurnTo.msg('tra.common.mobile.header.close'),'</a></div> <div class=\"TTcenterHeader\"><a href=\"',TurnTo.matchData.site.lpUrl,'\" rel=\"nofollow\">',TurnTo.matchData.site.siteName,'</a></div> <div class=\"TTrightHeader\" style=\"display: none\"><a href=\"#\" rel=\"nofollow\">',TurnTo.msg('tra.common.header.link.myPosts'),'</a></div></div>');}return p.join('');"),moreFeedback:new Function("obj","var p=[];with(obj){p.push('<div id=\"TTmoreFeedback\"> <p class=\"TTmoreFeedbackPrompt\">  '); if(afterSubmission && afterSubmission.alreadyReviewed) { p.push('   ',list.length == 0 ? TurnTo.S.visualContentDoMorePromptAfterAlreadyReceivedSubmissionWhenNothingMore : TurnTo.S.visualContentDoMorePromptAfterAlreadyReceivedSubmission,'  '); } else if(afterSubmission) { p.push('   ',list.length == 0 ? TurnTo.S.visualContentDoMorePromptAfterSubmissionWhenNothingMore : TurnTo.S.visualContentDoMorePromptAfterSubmission,'  '); } else { p.push('   ',list.length == 0 ? TurnTo.S.visualContentDoMorePromptWhenNothingMore : TurnTo.S.visualContentDoMorePrompt,'  '); } p.push(' </p>  <div class=\"TTfeedbackBlockCont\">  '); for(var i = 0; i < list.length; i++) {  var catItem = list[i].catItem ? list[i].catItem : list[i];  catItem.imageId = catItem.imageId ? catItem.imageId : catItem.imgId;  p.push('  <div class=\"TTfeedbackBlock\" data-qid=\"', list[i].text ? list[i].id : '','\" data-sku=\"',catItem.sku,'\">   <div class=\"TTfeedbackBlockProdImg\">    <img style=\"width:100px; margin: 1px\" src=\"', TurnTo.getProductImage(catItem.imageId, 'L', list[i].siteKey) ,'\" alt=\"',catItem.title,'\">   </div>   <div class=\"TTfeedbackSpecifics\">    <p class=\"TTprodName\">',catItem.title,'</p>    '); if(list[i].siteName) { p.push('     <p class=\"TTsiteAttribution TT4metaGray\">      ',TurnTo.msg('tra.moreFeedback.siteAttribution', [list[i].siteName]),'     </p>    '); } p.push('    '); if(list[i].text) { p.push('      <p class=\"TT4metaGray\">',TurnTo.msg('tra.moreFeedback.prompt.answer'),'</p>      <p class=\"TTqText\">',list[i].text,'</p>     '); } else { p.push('      <p class=\"TT4metaGray\">',TurnTo.msg('tra.moreFeedback.prompt.rateIt'),'</p>      <ul class=\"TTrateItStars\" data-site-key=\"',list[i].siteKey,'\">     <li class=\"TTvc-star-lg-empty\"></li>     <li class=\"TTvc-star-lg-empty\"></li>     <li class=\"TTvc-star-lg-empty\"></li>     <li class=\"TTvc-star-lg-empty\"></li>     <li class=\"TTvc-star-lg-empty\"></li>      </ul>    '); } p.push('   </div>  </div>  '); } p.push(' </div></div>');}return p.join('');"),pollingReconfirm:new Function("obj","var p=[];with(obj){p.push('<div id=\"TTpollingConfirm\"> <div class=\"TTpollingConfirmHeader\">',TurnTo.msg('tra.polling.reconfirm.header'),'</div> <div class=\"TTdivider\"></div>          <div id=\"TTinitialReconfirmMsg\">  <p>     ',TurnTo.msg('tra.polling.reconfirm.emailSent', [email]),'     <span id=\"TTconfirmWaitMsg\">',TurnTo.msg('tra.polling.reconfirm.onceConfirmed'),'</span>  <p> </div> <div class=\"TTvc-continue\" style=\"display:none;\"></div> <div id=\"TTpollingProblems\">  <p>',TurnTo.msg('tra.polling.reconfirm.problems'),'</p>  <p id=\"TTresendRslt\"></p> </div></div>');}return p.join('');"),profileCommentBlock:new Function("obj","var p=[];with(obj){p.push('');var name = TurnTo.formatName(user, false);var showSyndLink = syndicationSource && syndicationSource.settings.attributionTag;var atSiteLink;if (showSyndLink) {atSiteLink = TurnTo.genSyndSiteLink('sa', aid, siteId, syndicationSource);}p.push('<div class=\"TT4commentArea\">    <div class=\"TT2left TT4commentWidth\">        <div class=\"TT3aboutLine\"><a href=\"',catItem.itemUrl,'\" target=\"_blank\" rel=\"nofollow\">',catItem.title,'</a></div>        <div class=\"TT3ansCntr\">            <div class=\"TT3itemBox2\">                <div style=\"position:relative\">                    <div class=\"TT4cText\">',commentText,'</div>                    <span class=\"TT3askedBy\">                    ',name,'                    <span class=\"TT3youHolder\" ',user.uid ? 'tt3-uid=\"'+user.uid+'\"' : '' ,'></span>                    '); if(showSyndLink) { p.push('                    <span class=\"TT3atLabel\">',TurnTo.msg('tra.qa.answer.linkLine.answeredAtSite', [atSiteLink]),'</span>                    '); } p.push('                    <span class=\"TT3timeStamp\">',TurnTo.msg('tra.qa.answer.linkLine.answeredOnDate', [dateCreated]),'</span>                    '); if (typeof siteName != 'undefined' && siteName) { p.push('                    <span class=\"TTsiteAttribution\">',TurnTo.msg('tra.moreFeedback.siteAttribution', [siteName]),'</span>                    '); } p.push('                    </span>                    <div class=\"TTclear\"></div>                </div>            </div>        </div>    </div>    <div class=\"TTclear\"></div>    <div class=\"TT4QProductImg\" style=\"\"><a href=\"',catItem.itemUrl,'\" target=\"_blank\" rel=\"nofollow\"><img class=\"TTcatImg\" style=\"width:100px;height:100px;\" src=\"',TurnTo.getProductImage(catItem.imageId, 'L'),'\"/></a></div>    <div class=\"TTclear\"></div></div>');}return p.join('');"),profileReviewBlock:new Function("obj","var p=[];with(obj){p.push('<div class=\"TTreview\">    <div class=\"TTreviewLeft\" style=\"position:relative\">        <div class=\"TT3aboutLine\">',TurnTo.msg('tra.rev.aboutProduct'),' <a href=\"',catItem.itemUrl,'\" rel=\"nofollow\"                                                                             target=\"_blank\">',(catItem.title.length >=            60 ? catItem.title.substring(0,60) + \"...\" : catItem.title),'</a>        </div>        <div class=\"TTreviewTitle\">',title,'</div>        <div class=\"TTreviewBody\">',text,'</div>        <div class=\"TT4askedByBlock TT3metaText\">            <span class=\"TT3askedBy\"><a href=\"javascript:void(0)\" tt3-uid=\"',user.id,'\" rel=\"nofollow\">',TurnTo.formatName(user,                false),'</a></span>            <span class=\"TT3timeStamp\">',TurnTo.msg('tra.rev.askOnDate', [dateCreated]),'</span>            '); if(typeof siteName != 'undefined' && siteName) { p.push(' <span class=\"TTsiteAttribution\">',TurnTo.msg('tra.moreFeedback.siteAttribution', [siteName]),'</span> '); } p.push('        </div>    </div>    <div class=\"TT4QProductImg\">        <a href=\"',catItem.itemUrl,'\" target=\"_blank\" rel=\"nofollow\"><img class=\"TTcatImg\" style=\"width:100px;height:100px;\" src=\"',TurnTo.getProductImage(catItem.imageId, 'L'),'\"/></a>    </div>    <div class=\"TTratingBox TTrating-',rating,'-0\"></div>    '); /* TT-4853: commenting out subdimensions until new artwork/spec is developed    if (customDimensionValues) { p.push('    <div class=\"TT4profileDims\">        '); for (var i = 0; i < customDimensionValues.length; i++) {            var customDim = customDimensionValues[i];            p.push('            '); if (customDim.type == 1) { p.push('                <div class=\"TTprofileReviewDims\">                    <div class=\"TTcustomSmall-',customDim.value,'-0\"></div><div class=\"TT2clearBoth\"></div>                    <div class=\"TTprofileReviewDimsTitle\">',customDim.dimensionLabel,'</div>                </div>            '); } else { p.push('                <div class=\"TTprofileReviewDimsRange\">                    <div class=\"TT4reviewRangeSmall\">                        <div class=\"TT4reviewRangeDot\" style=\"margin-left:',customDim.sortOrder == 0 ? '0' : (customDim.sortOrder == 1 ? '48' : '98'),'%\"></div>                    </div>                    '); for (var j = 0; j < customDim.dimensionValueDefinitionLabels.length; j++) {                    var dimLabel = customDim.dimensionValueDefinitionLabels[j];                    p.push('                    <div class=\"TTprofileReviewDimsTitle\">',customDim.dimensionLabel,'</div>                    <!--'); if (customDim.dimensionValueDefinitionLabels && j == customDim.dimensionValueDefinitionLabels.length-1 && i == j) {p.push('<div class=\"TT4reviewDimRangeLabel\">&nbsp;</div>'); } p.push('-->                    <!--<div class=\"TT4reviewDimRangeLabel ',j == 0 ? 'TT4reviewDimRangeLabelLeft' : (customDim.dimensionValueDefinitionLabels && j == customDim.dimensionValueDefinitionLabels.length-1) ? 'TT4reviewDimRangeLabelRight' : 'TT4reviewDimRangeLabelMid','\">-->                        <!--',dimLabel,'-->                    <!--</div>-->                    <!--'); } p.push('-->                    <div class=\"TT2clearBoth\"></div>                </div>            '); } p.push('        '); } p.push('    </div>    '); }*/ p.push('    <div class=\"TTclear\"></div></div>');}return p.join('');"),questionAnswerBlock:new Function("obj","var p=[];with(obj){p.push('');var askerName = TurnTo.formatName(asker);var siteNameLabel = typeof siteName != 'undefined' && siteName ? '<span class=\"TTsiteAttribution\">' + TurnTo.msg('tra.moreFeedback.siteAttribution', [siteName]) +'</span>' : '';var siteKey = typeof siteKey != 'undefined' ? siteKey : '';p.push('<div id=\"TT3quest-',qid,'\"     class=\"TT3questWrp TT3questBorder\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '' ,' answers=\"',aCnt,'\" date=\"',dateInMs,'\" upVotes=\"',upVotes,'\" downVotes=\"',downVotes,'\"      style=\"', hide ? 'display:none' : '','\" data-site-key=\"',siteKey,'\">    <div class=\"TT3questCntr\">        <div class=\"TT3itemBox\" ttqid=\"',qid,'\">            ', showAbout ? '            <div class=\"TT3aboutLine\">' + TurnTo.msg('tra.qa.question.aboutProduct') +                ' <a href=\"'+catItem.url+'\" rel=\"nofollow\" target=\"_blank\">'+(catItem.title.length>= 60 ? catItem.title.substring(0,60) + \"...\" : catItem.title)+'</a></div>' : '' ,'          <div id=\"TT3qText',qid,'\"               class=\"TT3qText'); if (showImg && !(hideDefaultImg && catItem.imageProcessed != 1) && catItem.itemType == 0) { p.push(' TTproductImgPresent');}p.push('\">              ',questionText,'          </div>          <div class=\"TT4askedByBlock TT3metaText\">            '); if(asker.uid) { p.push('              <span class=\"TT3askedBy\"><a href=\"javascript:void(0)\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '',' rel=\"nofollow\">',asker.uid ? askerName : TurnTo.msg('tra.common.anonUser'),'</a>                  <span class=\"TT3youHolder\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '' ,' ',asker.isStaff ? 'style=\"margin-right:4px\"':'','></span>',asker.uid              ? (asker.isStaff ? '<span class=\"TT3staffBadge\">'+TurnTo.msg('tra.common.staffBadge')+'</span>' :              (asker.expertLabel ? '<span class=\"TT3expertBadge\">'+asker.expertLabel+'</span>' : '')) : '','</span>            '); } else { p.push('              <span class=\"TT3askedBy TT3askedByAnon\">', qNickName ? qNickName : (shopperName ? shopperName : TurnTo.msg('tra.common.anonUser')),'</span>            '); } p.push('            <span class=\"TT3timeStamp\">                '); if (syndicationSource && syndicationSource.settings.attributionTag) {                    var atSiteLink = TurnTo.genSyndSiteLink('sq', qid, siteId, syndicationSource);p.push('                    ', TurnTo.msg('tra.qa.comment.askOnDateAtSite', [dateCreated, atSiteLink]) ,'                '); } else { p.push('                    ', TurnTo.msg('tra.qa.comment.askOnDate', [dateCreated]) ,'                '); } p.push('            </span>            ', siteNameLabel ,'        </div>        '); if(miqCatItems && miqCatItems.length > 0) { p.push('        <div class=\"TT4miqaContainer\">            <div class=\"TT4miqaScrollLContainer\">                <div class=\"TT4miqaScrollL\"></div>            </div>            <div class=\"TT4miqaScrollRContainer\">                <div class=\"TT4miqaScrollR\"></div>            </div>            <div class=\"TT3miqaSection\">                ', TurnToHTML.miqaQuestionItems({title: catItem.title, itemUrl: catItem.itemUrl, imgId: catItem.imageId}) ,'                '); for (var i = 0; i < miqCatItems.length; i++) { p.push('                    ', TurnToHTML.miqaQuestionItems(miqCatItems[i]) ,'                '); } p.push('            </div>            <div class=\"TT2clearBoth\"></div>        </div>        '); } p.push('        <div id=\"TT4bestAnswerBlock-',qid,'\" class=\"TT4bestAnswerBlock\"></div>            <div id=\"TT4shownAnswerBlock-',qid,'\" class=\"TT4shownAnswerBlock\"></div>        <div class=\"TTclear\"></div>        <ul class=\"TT3linkLine TT3questionLinkLine\">            <li id=\"TT3expand-',qid,'\"            ',isNew || aCnt <= 1 ? 'style=\"display:none\"' : '',' class=\"TT3expand\">            <span class=\"TT3showText\" ',aCnt <= 1 ? 'style=\"display:none\"' : '','>            <div class=\"TT4expand\" onclick=\"TurnTo.showAllAnswers(this, ',qid,')\"></div>            <a href=\"javascript:void(0)\" onclick=\"TurnTo.showAllAnswers(this, ',qid,')\" rel=\"nofollow\" aria-expanded=\"false\">                '); var moreCnt = aCnt === 0 ? 0 : aCnt - 1;                var pluralSuffix = TurnTo.getPlural(moreCnt); p.push('                <span class=\"TTrespDesktopDisp\">',TurnTo.msg('tra.qa.question.linkLine.readMoreAnswer.'+pluralSuffix, [moreCnt]),'</span>                <span class=\"TTrespMobileDisp\">',TurnTo.msg('tra.qa.question.linkLine.readMoreAnswer.mobile.'+pluralSuffix, [moreCnt]),'</span>            </a>            </span>              <span class=\"TT3hideText\" style=\"display:none\">                <div class=\"TT4collapse\" onclick=\"TurnTo.hideAnswers(this, ',qid,')\"></div>                <a href=\"javascript:void(0)\" onclick=\"TurnTo.hideAnswers(this, ',qid,')\" rel=\"nofollow\"                   title=\"',TurnTo.msg('tra.qa.question.linkLine.hideAnswers'),'\"                   aria-expanded=\"true\">',TurnTo.msg('tra.qa.question.linkLine.hideAnswers'),'</a>              </span>            </li>            <li>                <a class=\"TT4addAnswer\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '','                   href=\"javascript:void(0)\" onclick=\"TurnTo.showInputBox(this, ',qid,')\" rel=\"nofollow\"                   title=\"',TurnTo.msg('tra.qa.question.linkLine.addAnswer'),'\">                <div class=\"TT4pen\"></div>                <span class=\"TTrespDesktopDisp\">',TurnTo.msg('tra.qa.question.linkLine.addAnswer'),'</span>                <span class=\"TTrespMobileDispInline\">',TurnTo.msg('tra.qa.question.linkLine.addAnswer.mobile'),'</span>                </a>            </li>            <li class=\"TT3helpful\"            ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '','>            <a onclick=\"TurnTo.ilv(0,',qid,',true,this)\" href=\"javascript:void(0)\" rel=\"nofollow\">                <div class=\"TT4thumb\"></div>                <span class=\"TTrespDesktopDisp\">',TurnTo.msg('tra.qa.question.linkLine.haveThisQuestionToo'),' </span>                <span class=\"TT3vcntUp\">(',upVotes,')</span>            </a>            </li>            '); if(typeof insertInputBox == \"undefined\" || insertInputBox) { p.push(''); if(showSkip){ p.push('            <li><a href=\"javascript:void(0)\" onclick=\"TurnTo.skipQ(',qid,')\" rel=\"nofollow\">',TurnTo.msg('tra.qa.question.linkLine.skip'),'</a>            </li>            ');}p.push('');}p.push('        </ul>    </div>      '); if (showImg && !(hideDefaultImg && catItem.imageProcessed != 1) && catItem.itemType == 0) { p.push('      <div class=\"TT4QProductImg\" style=\"\"><a href=\"',catItem.url,'\" target=\"_blank\" rel=\"nofollow\"><img class=\"TTcatImg\" style=\"width:100px;height:100px;\" src=\"',TurnTo.getProductImage(catItem.imageId, 'L', siteKey),'\"/></a></div>    <div class=\"TTclear\"></div>      '); } p.push('    </div>',(typeof insertInputBox == \"undefined\" || insertInputBox) ? TurnToHTML.inlineAnswerInputBox({qid:qid, defaultText:TurnTo.msg('tra.qa.answer.instruction.enterAnswer'), aid:null, rid:null, show:false, replyInput:false, related:false, replyToUid:null, smallInputBox: smallInputBox}) : '','    <div id=\"TT3IAContainer-',qid,'\" class=\"TT3IAContainer\">        <div id=\"TT3answerVoteCall-',qid,'\" class=\"TT3ansArea TT4answVoteCall\">            <div class=\"TT4answVoteCallArrow\" style=\"padding-right: 15px\"></div>            <span>',TurnTo.msg('tra.qa.answer.instruction.vote'),'</span>        </div>    </div>    <div class=\"TTclear\"></div></div>');}return p.join('');"),questionAnswerBlockSQV:new Function("obj","var p=[];with(obj){p.push('');var askerName = TurnTo.formatName(asker);p.push('<div id=\"TT3quest-',qid,'\"     class=\"TT3questWrp TT3questBorder TT4questSqv\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '' ,' answers=\"',aCnt,'\" date=\"',dateInMs,'\" upVotes=\"',upVotes,'\" downVotes=\"',downVotes,'\" >    <div class=\"TT3questCntr\">      <div class=\"TT3itemBox\">          ', showAbout ? '          <div class=\"TT3aboutLine\">' + TurnTo.msg('tra.qa.question.aboutProduct') + ' <a href=\"'+catItem.url+'\" rel=\"nofollow\"                                                                                          target=\"_blank\">'+(catItem.title.length              >= 60 ? catItem.title.substring(0,60) + \"...\" : catItem.title)+'</a></div>          ' : '' ,'          <div id=\"TT3qText',qid,'\"               class=\"TT3qText'); if (showImg && !(hideDefaultImg && catItem.imageProcessed != 1) && catItem.itemType == 0) { p.push(' TTproductImgPresent');}p.push('\">              ',questionText,'          </div>          <div class=\"TT4askedByBlock TT3metaText\">            '); if(asker.uid) { p.push('              <span class=\"TT3askedBy\"><a href=\"javascript:void(0)\"  rel=\"nofollow\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '','>',asker.uid ? askerName : TurnTo.msg('tra.common.anonUser'),'</a>                  <span class=\"TT3youHolder\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '' ,' ',asker.isStaff ? 'style=\"margin-right:4px\"':'','></span>',asker.uid              ? (asker.isStaff ? '<span class=\"TT3staffBadge\">'+TurnTo.msg('tra.common.staffBadge')+'</span>' :              (asker.expertLabel ? '<span class=\"TT3expertBadge\">'+asker.expertLabel+'</span>' : '')) : '','</span>            '); } else { p.push('              <span class=\"TT3askedBy TT3askedByAnon\">', qNickName ? qNickName : (shopperName ? shopperName : TurnTo.msg('tra.common.anonUser')),'</span>            '); } p.push('            <span class=\"TT3timeStamp\">                '); if (syndicationSource && syndicationSource.settings.attributionTag) {                    var atSiteLink = TurnTo.genSyndSiteLink('sq', qid, siteId, syndicationSource);p.push('                    ', TurnTo.msg('tra.qa.comment.askOnDateAtSite', [dateCreated, atSiteLink]) ,'                '); } else { p.push('                    ', TurnTo.msg('tra.qa.comment.askOnDate', [dateCreated]) ,'                '); } p.push('            </span>        </div>        '); if(miqCatItems && miqCatItems.length > 0) { p.push('        <div class=\"TT4miqaContainer\">            <div class=\"TT4miqaScrollLContainer\">                <div class=\"TT4miqaScrollL\"></div>            </div>            <div class=\"TT4miqaScrollRContainer\">                <div class=\"TT4miqaScrollR\"></div>            </div>            <div class=\"TT3miqaSection\">                ', TurnToHTML.miqaQuestionItems({title: catItem.title, itemUrl: catItem.itemUrl, imgId: catItem.imageId}) ,'                '); for (var i = 0; i < miqCatItems.length; i++) { p.push('                    ', TurnToHTML.miqaQuestionItems(miqCatItems[i]) ,'                '); } p.push('            </div>            <div class=\"TT2clearBoth\"></div>        </div>        '); } p.push('        </div>        <div id=\"TT4bestAnswerBlock-',qid,'\" class=\"TT4bestAnswerBlock\"></div>        <div id=\"TT4shownAnswerBlock-',qid,'\" class=\"TT4shownAnswerBlock\"></div>        <div class=\"TTclear\"></div>        <ul class=\"TT3linkLine TT3questionLinkLine\" style=\"display: none\">            <li id=\"TT3expand-',qid,'\"            ',isNew ? 'style=\"display:none\"' : '',' class=\"TT3expand\">            <span class=\"TT3showText\" ',aCnt <= 1 ? 'style=\"display:none\"' : '','>            <div class=\"TT4expand\" onclick=\"TurnTo.showAllAnswers(this, ',qid,')\"></div>            <a href=\"javascript:void(0)\" rel=\"nofollow\" onclick=\"TurnTo.showAllAnswers(this, ',qid,')\" aria-expanded=\"false\">                '); var moreCnt = aCnt === 0 ? 0 : aCnt - 1;                var pluralSuffix = TurnTo.getPlural(moreCnt); p.push('                <span class=\"TTrespDesktopDisp\">',TurnTo.msg('tra.qa.question.linkLine.readMoreAnswer.'+pluralSuffix, [moreCnt]),'</span>                <span class=\"TTrespMobileDisp\">',TurnTo.msg('tra.qa.question.linkLine.readMoreAnswer.mobile.'+pluralSuffix, [moreCnt]),'</span>            </a>            </span>              <span class=\"TT3hideText\" style=\"display:none\">                <div class=\"TT4collapse\" onclick=\"TurnTo.hideAnswers(this, ',qid,')\"></div>                <a href=\"javascript:void(0)\" rel=\"nofollow\" onclick=\"TurnTo.hideAnswers(this, ',qid,')\"                   title=\"',TurnTo.msg('tra.qa.question.linkLine.hideAnswers'),'\"                   aria-expanded=\"true\">',TurnTo.msg('tra.qa.question.linkLine.hideAnswers'),'</a>              </span>            </li>            <li>                <a class=\"TT4addAnswer\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '',' href=\"javascript:void(0)\"                onclick=\"TurnTo.showInputBox(this, ',qid,')\" rel=\"nofollow\"                title=\"',TurnTo.msg('tra.qa.question.linkLine.addAnswer'),'\">                <div class=\"TT4pen\"></div>                <span class=\"TTrespDesktopDisp\">',TurnTo.msg('tra.qa.question.linkLine.addAnswer'),'</span>                <span class=\"TTrespMobileDispInline\">',TurnTo.msg('tra.qa.question.linkLine.addAnswer.mobile'),'</span>                </a>            </li>            <li class=\"TT3helpful\"            ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '','>            <a onclick=\"TurnTo.ilv(0,',qid,',true,this)\" rel=\"nofollow\" href=\"javscript:void(0)\">                <div class=\"TT4thumb\"></div>                <span class=\"TTrespDesktopDisp\">',TurnTo.msg('tra.qa.question.linkLine.haveThisQuestionToo'),' </span>                <span class=\"TT3vcntUp\">(',upVotes,')</span>            </a>            </li>            '); if(typeof insertInputBox == \"undefined\" || insertInputBox) { p.push(''); if(showSkip){ p.push('            <li>                <a href=\"javascript:void(0)\" onclick=\"TurnTo.skipQ(',qid,')\" rel=\"nofollow\">',TurnTo.msg('tra.qa.question.linkLine.skip'),'</a>            </li>            ');}p.push('');}p.push('        </ul>      '); if (showImg && !(hideDefaultImg && catItem.imageProcessed != 1) && catItem.itemType == 0) { p.push('      <div class=\"TT4QProductImg\" style=\"\"><a href=\"',catItem.url,'\" target=\"_blank\" rel=\"nofollow\"><img class=\"TTcatImg\" style=\"width:100px;height:100px;\" src=\"',TurnTo.getProductImage(catItem.imageId, 'L'),'\"/></a></div>    <div class=\"TTclear\"></div>      '); } p.push('    </div>',(typeof insertInputBox == \"undefined\" || insertInputBox) ? TurnToHTML.inlineAnswerInputBox({qid:qid, defaultText:TurnTo.msg('tra.qa.answer.instruction.enterAnswer'), aid:null, rid:null, show:false, replyInput:false, related:false, replyToUid:null, smallInputBox: smallInputBox}) : '','<div id=\"TT3IAContainer-',qid,'\" class=\"TT3IAContainer\">    <div id=\"TT3answerVoteCall-',qid,'\" class=\"TT3ansArea TT4answVoteCall\">        <div class=\"TT4answVoteCallArrow\" style=\"padding-right: 15px\"></div>        <span>',TurnTo.msg('tra.qa.answer.instruction.vote'),'</span>    </div></div>    <div class=\"TTclear\"></div></div>');}return p.join('');"),questionWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2askWidget\"><div id=\"TT3ugcContent4item\"></div></div>');}return p.join('');"),rateIt:new Function("obj","var p=[];with(obj){p.push('<div id=\"TTrateItScreen\">  <div id=\"TTrateIt\">    <div class=\"TTrateItPrompt\">      '); if(initData.startAction === 'rateIt') { p.push('          <p>',ratingPrompt,'</p>      '); } else { p.push('          <p>',TurnTo.S.visualContentRateItPromptForRatingAfterShare,'             <a class=\"TTskipLink\" href=\"#\" rel=\"nofollow\">',TurnTo.msg('tra.shareMedia.link.noThanks'),'</a>          </p>      '); } p.push('      <p class=\"TTmediaSmallDesc\">',catItem.title,'</p>    </div>    <div class=\"TT4QProductImg\">                  <img style=\"width:100px\" src=\"', TurnTo.getProductImage(catItem.imageId, 'L', initData.siblingSiteKey) ,'\" alt=\"',catItem.title,'\">    </div>    <div class=\"TTdivider\"></div>    <div class=\"TTformGroup\">      <label class=\"TTrequired\">',TurnTo.msg('tra.rateIt.rating'),'</label>      <ul class=\"TTrateItStars\" id=\"TToverallRatingStars\">        <li class=\"', initData.preSelectedRating >= 1 ? 'TTvc-star-lg-filled' : 'TTvc-star-lg-empty','\" data-rating=\"1\"></li>        <li class=\"', initData.preSelectedRating >= 2 ? 'TTvc-star-lg-filled' : 'TTvc-star-lg-empty','\" data-rating=\"2\"></li>        <li class=\"', initData.preSelectedRating >= 3 ? 'TTvc-star-lg-filled' : 'TTvc-star-lg-empty','\" data-rating=\"3\"></li>        <li class=\"', initData.preSelectedRating >= 4 ? 'TTvc-star-lg-filled' : 'TTvc-star-lg-empty','\" data-rating=\"4\"></li>        <li class=\"', initData.preSelectedRating >= 5 ? 'TTvc-star-lg-filled' : 'TTvc-star-lg-empty','\" data-rating=\"5\"></li>      </ul>    </div>    <div class=\"TTformGroup\">      <label class=\"TTrequired\">',TurnTo.msg('tra.rateIt.reviewBody'),'</label>      <textarea name=\"text\" placeholder=\"',TurnTo.S.visualContentRateItPlaceholderForFullReview,'\"></textarea>    </div>    <div class=\"TTformGroup\">      <label class=\"',initData.reviewTitleMandatory ? 'TTrequired' : '','\">',TurnTo.msg('tra.rateIt.title'),'</label>      <textarea name=\"title\" placeholder=\"',TurnTo.S.visualContentPlaceholderForRateItOverallImpression,'\"></textarea>    </div>    <!-- custom dims -->    '); for (var i = 0; i < initData.dimensionDefinitions.length; i++) {    var custDim = initData.dimensionDefinitions[i];    var dimValueDefs = custDim.itemReviewDimensionValueDefinitions; p.push('        <div class=\"TTformGroup\" id=\"TTcustDim-',custDim.id,'\" data-dim-id=\"',custDim.id,'\" data-dim-type=\"',custDim.type,'\" >            <label class=\"',custDim.required ? 'TTrequired' : '','\">',custDim.label,'</label>            '); if (custDim.type == 1) { p.push('<!--ratings-->              <ul class=\"TTrateItStars\">                <li class=\"TTvc-star-lg-empty\" data-rating=\"1\"></li>                <li class=\"TTvc-star-lg-empty\" data-rating=\"2\"></li>                <li class=\"TTvc-star-lg-empty\" data-rating=\"3\"></li>                <li class=\"TTvc-star-lg-empty\" data-rating=\"4\"></li>                <li class=\"TTvc-star-lg-empty\" data-rating=\"5\"></li>              </ul>            '); } else if (custDim.type == 2 && dimValueDefs.length == 2) { p.push('<!--range with only 2-->                '); for (var ii = 0; ii < dimValueDefs.length; ii++) {                   var custDimValueDef = dimValueDefs[ii]; p.push('                   <label class=\"TTradio\">                     <input type=\"radio\" name=\"TTcustDim-',custDim.id,'\" value=\"',custDimValueDef.id,'\">                     <span class=\"TTouter\"><span class=\"TTinner\"></span></span>',custDimValueDef.label,'                   </label>                '); } p.push('            '); } else if (custDim.type == 2) { p.push('<!--range with 3 or 5-->              '); var barCells = '<td></td><td></td>';                  barCells = dimValueDefs.length == 5 ? barCells + barCells : barCells;              p.push('                <div class=\"TTsliderCont\" data-value=\"\">                <table class=\"TTsliderBar\">                    <tr>                        ',barCells,'                    </tr>                    <tr>                        ',barCells,'                    </tr>                </table>                <div class=\"TTsliderLabels TT-',dimValueDefs.length,'\">                    '); for (var ii = 0; ii < dimValueDefs.length; ii++) {                         var custDimValueDef = dimValueDefs[ii]; p.push('                         <div>',custDimValueDef.label,'</div>                    '); } p.push('                </div>                <div class=\"TTsliderDot TTempty\"></div>              </div>            '); } else if (custDim.type == 3 && dimValueDefs.length <= 3) { p.push('<!-- single-select with <=3 options -->                '); for (var ii = 0; ii < dimValueDefs.length; ii++) {                   var custDimValueDef = dimValueDefs[ii]; p.push('                   <label class=\"TTradio\">                     <input type=\"radio\" name=\"TTcustDim-',custDim.id,'\" value=\"',custDimValueDef.id,'\">                     <span class=\"TTouter\"><span class=\"TTinner\"></span></span>',custDimValueDef.label,'                   </label>                '); } p.push('            '); } else if (custDim.type == 3) { p.push('<!--single-select with >3 options-->              <select id=\"TTcustDim-',custDim.id,'\" class=\"TTselect\">                <option value=\"\">',TurnTo.msg('tra.wrev.customDim.option.selectOne'),'</option>                '); for (var ii = 0; ii < dimValueDefs.length; ii++) {                var custDimValueDef = dimValueDefs[ii]; p.push('                <option value=\"',custDimValueDef.id,'\">',custDimValueDef.label,'</option>                '); } p.push('              </select>            '); } else if (custDim.type == 4) { p.push(' <!-- multi-select -->              '); var verticalDisp = dimValueDefs.length > 3; p.push('                  '); for (var ii = 0; ii < dimValueDefs.length; ii++) {                   var custDimValueDef = dimValueDefs[ii]; p.push('                  <label class=\"TTmdCheckbox\" style=\"',verticalDisp ? 'display:block;' : '','\">                    <input type=\"checkbox\" name=\"TTcustDim-',custDim.id,'\" value=\"',custDimValueDef.id,'\">                    <span class=\"TTouterBox\"><span class=\"TTcheck\"></span></span>',custDimValueDef.label,'                  </label>                          '); } p.push('            '); } p.push('        </div>    '); } p.push(' <!-- end custom dims -->    <!-- Start city/state profile data  -->    '); var sp = initData.shopperProfile;       if (!sp.shopperCityStateHidden && sp.cityStateCollectDuringContentSubmit) {           var userCountry = initData.user && initData.user.country ? initData.user.country : sp.defaultShopperCountry;    p.push('      <div class=\"TTformGroup\" style=\"', sp.defaultShopperCountry ? 'display:none;' : '' ,'\">          <label class=\"',sp.cityStateRequired ? 'TTrequired' : '','\">',TurnTo.msg('tra.rateIt.country'),'</label>          <select id=\"TTreviewCountry\" class=\"TTselect\" onchange=\"TurnTo.shopperProfileCountryChange(this);\">                <option value=\"\"></option>                '); for (var countryCd in initData.countries) {                   var country = initData.countries[countryCd]; p.push('                     <option value=\"', countryCd ,'\" ', userCountry == countryCd ? \"selected='selected'\" : '' ,'>', country ,'</option>                '); } p.push('          </select>      </div>      <div class=\"TTformGroup\">          <label class=\"',sp.cityStateRequired ? 'TTrequired' : '','\">',TurnTo.msg('tra.rateIt.city'),'</label>          <input id=\"TTcity\" type=\"text\" placeholder=\"',TurnTo.msg('tra.rateIt.instruction.city'),'\" value=\"',initData.user ? initData.user.city : '','\">      </div>      <div class=\"TTformGroup\" id=\"TTstateUSdisplay\" style=\"', userCountry != 'US' ? 'display:none;' : '' ,'\">          <label class=\"',sp.cityStateRequired ? 'TTrequired' : '','\">',TurnTo.msg('tra.rateIt.state'),'</label>          <select id=\"TTstateUS\" class=\"TTselect\">              <option value=\"\"></option>              '); for (var stateCd in initData.usStates) {                 var state = initData.usStates[stateCd]; p.push('                  <option value=\"', stateCd ,'\" ', initData.user && initData.user.state == stateCd ? \"selected='selected'\" : '' ,'>', state ,'</option>              '); } p.push('          </select>      </div>      <div class=\"TTformGroup\" id=\"TTstateCAdisplay\" style=\"', userCountry != 'CA' ? 'display:none;' : '' ,'\">          <label class=\"',sp.cityStateRequired ? 'TTrequired' : '','\">',TurnTo.msg('tra.rateIt.province'),'</label>          <select id=\"TTstateCA\" class=\"TTselect\">              <option value=\"\"></option>              '); for (var stateCd in initData.caStates) {                 var state = initData.caStates[stateCd]; p.push('                  <option value=\"', stateCd ,'\" ', initData.user && initData.user.state == stateCd ? \"selected='selected'\" : '' ,'>', state ,'</option>              '); } p.push('          </select>      </div>      <div class=\"TTformGroup\" id=\"TTstateOtherdisplay\" style=\"',(userCountry == 'US' || userCountry == 'CA') ? 'display:none;' : '' ,'\">          <label class=\"',sp.cityStateRequired ? 'TTrequired' : '','\">',TurnTo.msg('tra.rateIt.other'),'</label>          <input type=\"text\" id=\"TTstate\" placeholder=\"',TurnTo.msg('tra.rateIt.instruction.state'),'\" value=\"',initData.user ? initData.user.state : '','\">      </div>    '); } p.push('<!-- End city/state profile data -->    <!-- Start age profile data -->    '); if (!sp.shopperAgeRangeHidden && sp.ageRangeCollectDuringContentSubmit) { p.push('      <div class=\"TTformGroup\">          <label class=\"',sp.ageRangeRequired ? 'TTrequired' : '','\">',TurnTo.msg('tra.rateIt.age'),'</label>          <select id=\"TTreviewAge\" class=\"TTselect\">              <option value=\"\"></option>              <option value=\"0\" ',initData.user ? (initData.user.ageRange == '0' ? 'selected' : '' ) : '',' >',initData.ageRanges['0'],'</option>              <option value=\"1\" ',initData.user ? (initData.user.ageRange == '1' ? 'selected' : '' ) : '',' >',initData.ageRanges['1'],'</option>              <option value=\"2\" ',initData.user ? (initData.user.ageRange == '2' ? 'selected' : '' ) : '',' >',initData.ageRanges['2'],'</option>              <option value=\"3\" ',initData.user ? (initData.user.ageRange == '3' ? 'selected' : '' ) : '',' >',initData.ageRanges['3'],'</option>          </select>      </div>    '); } p.push('<!-- End age profile data -->    <!-- Start custom profile dimensions -->    '); for (var i = 0; i < initData.profileAttrs.length; i++) {       var profileDimsSelected = initData.userSelections ? initData.userSelections : {};       var profileAttr = initData.profileAttrs[i];         if(profileAttr.type == 0 && profileAttr.collectDuringContentSubmit) {    p.push('          <div class=\"TTformGroup\">              <label class=\"',profileAttr.required ? 'TTrequired' : '','\" for=\"TTprofileDim-',profileAttr.id,'\">',profileAttr.label,'</label>              <select id=\"TTprofileDim-',profileAttr.id,'\" class=\"TTselect\" data-oldvalue=\"',profileDimsSelected[profileAttr.id] ? profileDimsSelected[profileAttr.id].valDefId : '','\">                  <option value=\"\"></option>                  '); for (var j = 0; j < profileAttr.values.length; j++) {                        var selected = '';                        if (profileDimsSelected[profileAttr.id] && profileDimsSelected[profileAttr.id].valDefId == profileAttr.values[j].id) {                            selected = 'selected';                        }                      p.push('                      <option value=\"',profileAttr.values[j].id,'\" ',selected,'>',profileAttr.values[j].label,'</option>                  '); } p.push('              </select>          </div>        '); } else if (profileAttr.collectDuringContentSubmit) { p.push('          <div class=\"TTformGroup\">              <label class=\"',profileAttr.required ? 'TTrequired' : '','\" for=\"TTprofileDim-',profileAttr.id,'\">',profileAttr.label,'</label>              <textarea maxlength=\"50\" id=\"TTprofileDim-',profileAttr.id,'\">',profileDimsSelected[profileAttr.id] ? profileDimsSelected[profileAttr.id].freeformText : '','</textarea>          </div>        '); } p.push('      '); } p.push('<!-- End custom profile dimensions -->      '); if (initData.showSweepstakesOptIn) { p.push('      <div id=\"TTsweepstakesOptIn\" class=\"TTformGroup\">          <div class=\"TTrateItSweepstakesChkBoxContainer\">              <label class=\"TTmdCheckbox\" style=\"',verticalDisp ? 'display:block;' : '','\">                  <input type=\"checkbox\" id=\"TTsweepstakesOptInChkBox\" name=\"TTsweepstakesOptIn\">                  <span class=\"TTouterBox\"><span class=\"TTcheck\"></span></span>              </label>          </div>          <div class=\"TTrateItSweepstakesLabel\">',TurnTo.msg('tra.wrev.sweepstakes.optin'),'          </div>      </div>      '); } p.push('  </div>  <div class=\"TTrateItSubmitBtns\">    <div id=\"TTrateItSubmitBtn\" class=\"TTvc-submit\">      <img class=\"TTimgLoading\"         src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\"          alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\"         style=\"display: none;\">    </div>    <div><a class=\"TTskipLink\" style=\"display:none;\" href=\"#\" rel=\"nofollow\">',TurnTo.msg('tra.common.button.skip'),'</a></div>    <div class=\"TTclear\"><a id=\"TTwriteRevGuideLn\" class=\"TTrevGuidelineLink\" rel=\"nofollow\">',TurnTo.msg('tra.wrev.link.guidlines'),'</a></div>  </div>  <div id=\"TTmobileWriteRevGuideLines\" class=\"TTclear\"></div></div>');}return p.join('');"),recentComment:new Function("obj","var p=[];with(obj){p.push('');  var name = TurnTo.formatName(comment.user, false);p.push('<div class=\"TT3chatterComment\">    <a href=\"', comment.catItem.url ,'\" rel=\"nofollow\" onclick=\"window.open(&#39;',TurnTo.getUrl('/transLink/14/ci/' + comment.siteCatalogItemId + '/' + TurnTo.S.locale + '?sid=' + comment.siteId),'&#39, &#39_blank&#39); TurnTo.fwItemClicked(); return false\" target=\"_blank\">        <img style=\"float:left;display:inline-block;width:60px;height:60px;border:none\"             src=\"',TurnTo.getProductImage(comment.catItem.imageId, 'SS'),'\" width=\"60\" height=\"60\"/>    </a>    <div class=\"TT3comment\" style=\"margin-left:65px;\">        <a class= \"TT3chatterLink\" href=\"', comment.catItem.url ,'\" rel=\"nofollow\" onclick=\"window.open(&#39;',TurnTo.getUrl('/transLink/14/ci/' + comment.siteCatalogItemId + '/' + TurnTo.S.locale + '?sid=' + comment.siteId),'&#39, &#39_blank&#39); TurnTo.fwItemClicked();return false\" target=\"_blank\">', comment.catItem.title.substring(0, Math.min(comment.catItem.title.length, (TurnTo.S.recentComments.titleMaxLength ? TurnTo.S.recentComments.titleMaxLength : 1000))) ,'</a><br/>        <span class=\"TT3askedBy\">',!TurnTo.S.noProfiles ? '<a tt3-uid=\"'+comment.user.id+'\" href=\"javascript:void(0)\" rel=\"nofollow\">' : '<span>','', name.substring(0, Math.min(name.length, TurnTo.S.recentComments.nameMaxLength ? TurnTo.S.recentComments.nameMaxLength : 1000)) ,'',TurnTo.S.noProfiles ? '</span>' : '</a>',':</span>        <span class=\"TT3commentText\" style=\"font-weight: bold\">',comment.text,'</span>        <br />        '); if(TurnTo.S.recentComments.frequency == \"high\"){ p.push('            <span style=\"float:right;margin-right:4px;\" class=\"TT3chatterTime\">',comment.timeStamp,'</span>        ');}p.push('    </div>    <div style=\"clear:both\"></div></div>');}return p.join('');"),recentCommentsBlock:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3chatterBox\" style=\"width:',width ? width : '300px',';height:',height ? height : '400px',';position: relative;\">    <div id=\"TT3chatterHeader\" style=\"position: relative;\">        <h2 style=\"float:left;\">',TurnTo.S.recentComments.header,'</h2>        <a id=\"TT3whatsThis\" href=\"javascript:void(0)\" rel=\"nofollow\" style=\"float:right;font-size:10px;margin-top:10px;\">',TurnTo.msg('tra.chatter.whatsThis'),'</a>        <div id=\"TT3whatsThisDialog\">            ',TurnTo.S.recentComments.whatsThisTooltipText,'        </div>        <div style=\"clear:both\"></div>    </div>    <a id=\"TT3nextBtn\" style=\"position: absolute; top:45%;right:10px;\" href=\"javascript:void(0)\" rel=\"nofollow\"><img height=\"70\" width=\"39\" style=\"border:none;\" src=\"',TurnTo.getStaticUrl('/tra4/images/1.gif'),'\" /></a>    <a id=\"TT3prevBtn\" style=\"position: absolute; top:45%;left:10px;\" href=\"javascript:void(0)\" rel=\"nofollow\"><img height=\"70\" width=\"39\" style=\"border:none;\" src=\"',TurnTo.getStaticUrl('/tra4/images/1.gif'),'\" /></a>    <div id=\"TT3chatterCont\" style=\"width:',width ? width : '300px',';overflow:hidden;position:relative;\">        <div id=\"TT3chatter\" style=\"width:100%;position:absolute;top:0px;\"></div>    </div>    <div id=\"TT3chatterFooter\" style=\"padding: 10px 5px 5px 5px;position: absolute; bottom:0px;width:98%;\">        <span id=\"TT3timeWindow\" style=\"float:left;\">            '); if(TurnTo.S.recentComments.frequency == \"low\"){ p.push('              ',TurnTo.msg('tra.chatter.fromLastHours', [TurnTo.S.recentComments.timeWindowInHours]),'            ');}p.push('        </span>        '); if(TurnTo.S.recentComments && TurnTo.S.recentComments.fullPageUrl) { p.push('<a style=\"float:right;\" href=\"',TurnTo.S.recentComments.fullPageUrl,'\" rel=\"nofollow\">',TurnTo.msg('tra.chatter.link.seeAll'),'</a>'); } p.push('        <div style=\"clear:both\"></div>    </div></div>');}return p.join('');"),registrationScreen:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT8 TT2bold\">',header,'</div><div class=\"TT4SysMsgBody\" id=\"TTSubDialogErrors\" style=\"display: none;\"></div><div id=\"TTregInstrText\">',instructionalText,'</div><div>    <div id=\"TTrespRegLeft\">        <div id=\"TTregCenter\">            <div class=\"TTgmailDelAuth TTdelAuth\" domain=\"gmail.com\" tabindex=\"0\" role=\"button\" aria-label=\"',TurnTo.msg('tra.reg.login.fb'),'\"></div>            <div id=\"TTfacebookDelAuth\" class=\"TTfacebookDelAuth\" tabindex=\"0\" role=\"button\" aria-label=\"',TurnTo.msg('tra.reg.login.gmail'),'\"></div>            <div class=\"TTclear\"></div>        </div>        <div id=\"TTregInfoText\">',TurnTo.msg('tra.reg.message.askedToApproveConnection'),'</div>    </div>    <div id=\"TTauthOr\">',TurnTo.msg('tra.reg.or'),'</div>    <div id=\"TTrespRegRight\">        <input id=\"TTregFirstName\" type=\"text\" class=\"TTdefaultInput TTrespDefaultInput\"               onblur=\"TurnTo.inputLoseFocus(this)\" onfocus=\"TurnTo.inputFocus(this)\" aria-label=\"',TurnTo.msg('tra.reg.firstName'),'\"               value=\"',TurnTo.msg('tra.reg.firstName'),'\" ttinputlabeltext=\"',TurnTo.msg('tra.reg.firstName'),'\"/>        <input id=\"TTregLastName\" type=\"text\" class=\"TTdefaultInput TTrespDefaultInput\"               onblur=\"TurnTo.inputLoseFocus(this)\" onfocus=\"TurnTo.inputFocus(this)\" aria-label=\"',TurnTo.msg('tra.reg.lastName'),'\"               value=\"',TurnTo.msg('tra.reg.lastName'),'\" ttinputlabeltext=\"',TurnTo.msg('tra.reg.lastName'),'\"/>        <input id=\"TTregEmail\" type=\"text\" class=\"TTdefaultInput TTrespDefaultInput\" aria-label=\"',TurnTo.msg('tra.reg.emailAddress'),'\"               onblur=\"TurnTo.inputLoseFocus(this)\" onfocus=\"TurnTo.inputFocus(this)\"               value=\"',TurnTo.msg('tra.reg.emailAddress'),'\"               ttinputlabeltext=\"',TurnTo.msg('tra.reg.emailAddress'),'\"/>        '); if (showNickname) { p.push('        <input id=\"TTregNickname\" type=\"text\" class=\"TTdefaultInput TTrespDefaultInput\"               onblur=\"TurnTo.inputLoseFocus(this)\" onfocus=\"TurnTo.inputFocus(this)\" aria-label=\"',TurnTo.msg('tra.reg.nickName'),'\"               value=\"',TurnTo.msg('tra.reg.nickName'),'\" ttinputlabeltext=\"',TurnTo.msg('tra.reg.nickName'),'\"/>        <div id=\"TTnicknameInfo\" class=\"TT3metaText\">',TurnTo.msg('tra.reg.instruction.nickName'),'</div>        '); } p.push('    </div>    <div class=\"TTclear\"></div></div><div id=\"TTregBtns\">    <div id=\"TTregSubmit\" class=\"TTbigSubmitBtn TT2right\" tabindex=\"0\" aria-label=\"',TurnTo.msg('tra.common.button.submit'),'\"></div>    '); if (showSkip) {p.push('    <a id=\"TTregSkip\" class=\"TT2left TTregCancel\" href=\"javascript:void(0)\" rel=\"nofollow\">        ',TurnTo.msg('tra.reg.link.dontSendAnswers'),'    </a>    <span class=\"TTrespMobileDisp\"><br/></span>    ');}p.push('    '); if(showCancel) {p.push('    <a id=\"TTregCancel\" class=\"TT2right TTregCancel\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.common.button.cancel'),'</a>    ');}p.push('    <div class=\"TTclear\"></div></div>'); if (customClientMsg) { p.push('  <div id=\"TTregClientCustomText\">',customClientMsg,'</div>'); } p.push('<input type=\"hidden\" value=\"',regSource,'\" id=\"TTregSource\"/>');}return p.join('');"),replyBlock:new Function("obj","var p=[];with(obj){p.push('');var replierName = TurnTo.formatName(replier);var showSyndLink = syndicationSource && syndicationSource.settings.attributionTag;var atSiteLink;if (showSyndLink) {atSiteLink = TurnTo.genSyndSiteLink('sr', rid, siteId, syndicationSource);}p.push('<div id=\"TT3reply-',rid,'\" class=\"TT3rplyCntr TT3replyBorder\">    <div id=\"TT3replySubmitted-',rid,'\" class=\"TT4SysMsgBody\" style=\"margin-top:2px;\">        <a id=\"TT3dismissReplied-',rid,'\" class=\"TT3tabClose\"           title=\"',TurnTo.msg('tra.systemMessage.link.dismiss'),'\" href=\"javascript:void(0)\" rel=\"nofollow\"></a> ',confirmMsg,'    </div>    ',reply,'    <ul class=\"TT3linkLine\">        '); if (typeof hideReply == \"undefined\" || !hideReply) { p.push('        <li><a id=\"TT3replyLink',aid,'-',rid,'\" href=\"javascript:void(0)\" rel=\"nofollow\"               onclick=\"TurnTo.ilr(',qid,', ',aid,', ',rid,', this ',(replyCnt > 0 ? ', null, ' + replyCnt : ''),')\">',TurnTo.msg('tra.qa.reply.linkLine.reply')            + (replyCnt > 0 ? ' (' + replyCnt + ')' : ''),'</a>        </li>        '); } p.push('        <li class=\"TT3askedBy\">            <a href=\"javascript:void(0)\" ',replier.uid ? 'tt3-uid=\"'+replier.uid+'\"' : '' ,' rel=\"nofollow\">',replierName,'</a>            '); if (showSyndLink) {p.push('            <span class=\"TT3atLabel\">',TurnTo.msg('tra.qa.reply.linkLine.repliedAtSite', [atSiteLink]),'</span>            '); } p.push('            <span class=\"TT3youHolder\" ',replier.uid ? 'tt3-uid=\"'+replier.uid+'\"' : '' ,'></span>            '); if(replier.isStaff) { p.push('            <span class=\"TT3staffBadge\" style=\"margin-left: 4px;\">Staff</span>            '); } else if (replier.expertLabel) { p.push('            <span class=\"TT3expertBadge\" style=\"margin-left: 4px;\">',replier.expertLabel,'</span>            '); } p.push('            <span class=\"TT3timeStamp\">',TurnTo.msg('tra.qa.reply.linkLine.repliedOnDate', [replyDate]),'</span>        </li>    </ul></div><div id=\"TT3IRContainer-',qid,'-',aid,'-',rid,'\" class=\"TT3IRContainer ', depth < 3 ? 'TT3Indent' : '','\"></div>');}return p.join('');"),responsiveMainscreen:new Function("obj","var p=[];with(obj){p.push('<div id=\"TurnToMobileSubWindow\"></div><div id=\"TurnToMobileContent\"></div><div id=\"TurnToReviewsContent\"></div><div id=\"TurnToMobileRegistration\"></div>');}return p.join('');"),reviewBlock:new Function("obj","var p=[];with(obj){p.push('<div class=\"TTreview\" reviewId=\"',id,'\" date=\"',dateCreatedInMillis,'\" upvotes=\"',upVotes,'\" downVotes=\"',downVotes,'\" rating=\"',rating,'\" style=\"', hide ? 'display:none' : '','\">    '); if (catItem) { p.push('    <div class=\"TT3aboutLine\">',TurnTo.msg('tra.rev.aboutProduct'),' <a href=\"',catItem.itemUrl,'\" target=\"_blank\" rel=\"nofollow\">',(catItem.title.length        >= 60 ?        catItem.title.substring(0,60) + \"...\" : catItem.title),'</a>    </div>    <div class=\"TT4QProductImg TTrespMobileDispPortrait\">        <a href=\"',catItem.itemUrl,'\" target=\"_blank\" rel=\"nofollow\"><img class=\"TTcatImg\" style=\"width:100px;height:100px;\"                                                            src=\"',TurnTo.getProductImage(catItem.imageId, 'L'),'\"/></a>    </div>    '); } p.push('  <div class=\"TTrevCol1\">      <div class=\"TTratingBoxBorder\"><div class=\"TTratingBox TTrating-',rating,'-0\"></div></div>      '); if (customDimensionValues) { p.push('          '); for (var i = 0; i < customDimensionValues.length; i++) {                var customDim = customDimensionValues[i];          p.push('                '); if (customDim.type == 1) { p.push('                  <div class=\"TTreviewDims TTresponsiveReviewDims\">                      <div class=\"TTreviewDimsTitle\">',customDim.dimensionLabel,'</div>                      <div class=\"TTcustomImg TTcustom',(useSmallImgs ? 'Small' : ''),'-',customDim.value,'-0\" ttrating=\"',customDim.value,'\"></div><div class=\"TTcustomRating\">',customDim.value,' / 5</div><div class=\"TT2clearBoth\"></div>                  </div>      '); } else if (customDim.type == 2) { p.push('                  <div class=\"TTreviewDimsRange TTresponsiveReviewDims\">                      ',customDim.dimensionLabel,'                      <div class=\"TT4reviewRange',useSmallImgs ? 'Small' : '','\">                          '); var rangeOffset = (customDim.sortOrder / (customDim.dimensionValueDefinitionLabels.length - 1) * 100); p.push('                          <div class=\"TT4reviewRangeDot\" style=\"margin-left:calc(', rangeOffset ,'% - ', rangeOffset == 0 ? '4' : '5' ,'px)\"></div>                      </div>                      '); for (var j = 0; j < customDim.dimensionValueDefinitionLabels.length; j++) {                          if (!(customDim.dimensionValueDefinitionLabels.length > 3 && (j == 1 || j == 3))) {                            var dimLabel = customDim.dimensionValueDefinitionLabels[j];                            if (customDim.dimensionValueDefinitionLabels && j == customDim.dimensionValueDefinitionLabels.length-1 && j == 1) {p.push('<div class=\"TT4reviewDimRangeLabel',useSmallImgs ? 'Small' : '','\">&nbsp;</div>'); } p.push('                          <div class=\"TT4reviewDimRangeLabel',useSmallImgs ? 'Small' : '',' ',j == 0 ? 'TT4reviewDimRangeLabelLeft' : (customDim.dimensionValueDefinitionLabels && j == customDim.dimensionValueDefinitionLabels.length-1) ? 'TT4reviewDimRangeLabelRight' : 'TT4reviewDimRangeLabelMid','\">                              '); if ((customDim.dimensionValueDefinitionLabels.length == 3 && j == 1) || (customDim.dimensionValueDefinitionLabels.length == 5 && j == 2)) {                                if (dimLabel.length > 7) { p.push('                                  <span style=\"font-weight: normal\">&nbsp;</span>                              '); } else { p.push('                                <span style=\"font-weight: normal\">', dimLabel ,'</span>                              '); } } else { p.push('                                <span style=\"font-weight: normal\">', dimLabel ,'</span>                              '); } p.push('                          </div>                      '); } } p.push('                      <div class=\"TT2clearBoth\"></div>                  </div>      '); } else if (customDim.type == 4) { p.push('          <div class=\"TTreviewDimsSingleSelect TTresponsiveReviewDims\">              <div class=\"TTreviewDimsTitle\">',customDim.dimensionLabel,'</div>              '); for (var j = 0; j < customDim.valueLabel.length; j++) { p.push('                <div class=\"TTreviewDimsSingleSelectValue\">',customDim.valueLabel[j],'</div>              '); } p.push('          </div>      '); } else { p.push('      <div class=\"TTreviewDimsSingleSelect TTresponsiveReviewDims\">          <div class=\"TTreviewDimsTitle\">',customDim.dimensionLabel,'</div>          <div class=\"TTreviewDimsSingleSelectValue\">',customDim.valueLabel,'</div>      </div>      '); } p.push('          '); } p.push('      '); } p.push('  </div>  <div class=\"TTrevCol2\">    <div class=\"TTreviewTitle\">',title,'</div>    <div class=\"TTreviewBody\">',text,'</div>    ');if(incentivized) {p.push('      <div class=\"TTreviewIncentivized\">',TurnTo.msg('tra.rev.incentivized'),'</div>    ');}p.push('      ', TurnToHTML.visualContentForUgc({mediaList: mediaContent, ugcId: id, ugcType: 'review'}) ,'      '); if (!preferences.hideCtrls && !preferences.ctrlsBelowReview) { p.push('      ', TurnToHTML.reviewBlockLinkLine({id: id, user: user, upVotes: upVotes, downVotes: downVotes, addLinkLineClass:      'TTrespDesktopDisp'}) ,'      '); } p.push('  </div>  <div class=\"TTrevCol3\">      '); if (catItem) { p.push('      <div class=\"TT4QProductImg TTrespDesktopLandscapeDisp\">          <a href=\"',catItem.itemUrl,'\" target=\"_blank\" rel=\"nofollow\"><img class=\"TTcatImg\" style=\"width:100px;height:100px;\"                                                              src=\"',TurnTo.getProductImage(catItem.imageId, 'L'),'\"/></a>      </div>      '); } p.push('    <div>',dateCreated,'</div>    '); if (TurnTo.matchData.site.instAnsFromIngestedReviews && user) { p.push('      <div>',TurnTo.formatName(user, false),'</div>    '); } else { p.push('        '); if (user) {            var profileCal;            if(user.id) {              profileCall = 'TurnTo.displayProfile(' + user.id + ')';            } else {              profileCall = 'TurnTo.displayReviewerProfile(' + id + ')';            }        p.push('          <div><a href=\"javascript:void(0)\" onclick=\"',profileCall,'\" rel=\"nofollow\">            <span itemprop=\"reviewer\">',TurnTo.formatName(user, false),'</span></a>          </div>        '); } else { p.push('          <div>',TurnTo.formatName(user, false),'</div>        '); } p.push('        '); if(shopperProfile && !shopperProfile.shopperCityStateHidden && shopperProfile.cityStateDisplayPublic) { p.push('          <div>                '); if (user.location) { p.push('                   ',user.location,'                '); } p.push('                '); if (user.city) { p.push('                   ',user.city,'',user.state ? ',' : '','                '); } p.push('                '); if(user.state) { p.push('                    ',user.state,'',(user.country && !shopperProfile.defaultShopperCountry) ? ',' : '','                '); } p.push('                '); if(user.country && !shopperProfile.defaultShopperCountry) { p.push('                    ',user.country,'                '); } p.push('            </div>        '); } p.push('        ');  if (shopperProfile && !shopperProfile.shopperAgeRangeHidden && shopperProfile.ageRangeDisplayPublic && user && user.ageRange) { p.push('          <div>',TurnTo.msg('tra.rev.shopperAge'),' ',user.ageRanges[user.ageRange],'</div>        '); } p.push('    '); } p.push('    '); if (purchaseDate) { p.push('      <div class=\"TTrevPurchaseDate\">',TurnTo.msg('tra.rev.purchased'),'<br/>',purchaseDate,'</div>    '); } p.push('    '); if (customProfileDimensionValues) { p.push('        '); for (var i = 0; i < customProfileDimensionValues.length; i++) {            var profileDim = customProfileDimensionValues[i];            if (profileDim.type == 0) {        p.push('            <div class=\"TTrevProfileDim\">                <div class=\"TTrevProfileDimLabel\">',profileDim.dimensionLabel,':</div>                <div class=\"TTrevProfileDimValue\">',profileDim.valueLabel,'</div>            </div>        '); } else { p.push('            <div class=\"TTrevProfileDim\">                <div class=\"TTrevProfileDimLabel\">',profileDim.dimensionLabel,':</div>                <div class=\"TTrevProfileDimValue\">',profileDim.freeformText,'</div>            </div>    '); } } } p.push('    '); if (syndicationData && syndicationData.inboundAttributionOn == true ) { p.push('      '); var logoImg = syndicationData.logoUrl ? TurnToHTML.syndicationLogoImg(syndicationData) : ''; p.push('      <div class=\"TTrevAttribution\">        <span class=\"TTrevAttributionPreText\">',TurnTo.msg('tra.rev.originallyPostedAt'),'</span>        '); if (!syndicationData.logoUrl) { p.push('          <span class=\"TTrevAttributionSiteName\">            '); if (syndicationData.siteUrl) { p.push('               <a href=\"',syndicationData.siteUrl,'\" target=\"_blank\">',syndicationData.name,'</a>            '); } else { p.push('              ',syndicationData.name,'            '); } p.push('           </span>        '); } else if (syndicationData.siteUrl) { p.push('           <a href=\"',syndicationData.siteUrl,'\" target=\"_blank\">',logoImg,'</a>            '); } else { p.push('          ',logoImg,'          '); } p.push('       </div>    '); } p.push('      </div>    '); if (!preferences.hideCtrls && !preferences.ctrlsBelowReview) { p.push('    ', TurnToHTML.reviewBlockLinkLine({id: id, user: user, upVotes: upVotes, downVotes: downVotes, addLinkLineClass:    'TTrespMobileDisp'}) ,'    '); } p.push('    <div class=\"TTclear\"></div>    '); if (itemReviewResponses) { p.push('    <div class=\"TTreviewResponses\">        '); for (var i = 0; i < itemReviewResponses.length; i++) {        var response = itemReviewResponses[i];        p.push('        <div class=\"TTresponseCol1\">            <div class=\"TTreviewResponse\">                <!--TurnTo.matchData.site.siteName-->                <div class=\"TTreviewResponseTitle\">',TurnTo.msg('tra.rev.response.title', [TurnTo.matchData.site.siteName]),'</div>                <div class=\"TTreviewResponseBody\">',response.text ,'</div>            </div>        </div>        <div class=\"TTresponseCol2\">            <div class=\"TTresponseDate\">',response.dateCreated ,'</div>            <div class=\"TTresponseUser\">',TurnTo.formatName(response.user, false),'            </div>        </div>        '); } p.push('    </div>    <div class=\"TTclear\"></div>    '); } p.push('</div>'); if (!preferences.hideCtrls && preferences.ctrlsBelowReview) { p.push('', TurnToHTML.reviewBlockLinkLine({id: id, user: user, upVotes: upVotes, downVotes: downVotes, addLinkLineClass: ''}) ,''); } p.push('<span style=\"display:none\"></span>');}return p.join('');"),reviewBlockLinkLine:new Function("obj","var p=[];with(obj){p.push('<ul class=\"TTrevLinkLine ',addLinkLineClass,'\">    <li class=\"TThelpful\" tt-uid=\"',user.id,'\">',TurnTo.msg('tra.rev.linkLine.helpful'),'        <a id=\"TT3vUpLnkr',id,'\"           onclick=\"TurnTo.ilv(2,',id,',true,this)\" href=\"javascript:void(0)\"           style=\"cursor:pointer\" rel=\"nofollow\">',TurnTo.msg('tra.rev.linkLine.helpful.yes'),' (<span                class=\"TT3vcntUp\">',upVotes,'</span>)</a>        <a id=\"TT3vDownLnkr',id,'\"           onclick=\"TurnTo.ilv(2,',id,',false,this)\" href=\"javascript:void(0)\"           style=\"cursor:pointer\" rel=\"nofollow\">',TurnTo.msg('tra.rev.linkLine.helpful.no'),' (<span class=\"TT3vcntDown\">',downVotes,'</span>)</a>    </li>    <li class=\"TTflagReview\"><a href=\"javascript:void(0)\" rel=\"nofollow\" onclick=\"TurnTo.flagReview(',id,', this)\">',TurnTo.msg('tra.rev.linkLine.inappropriate'),'</a>    </li></ul>');}return p.join('');"),reviewGuidelines:new Function("obj","var p=[];with(obj){p.push('<div id=\"TTReviewGuide\">    ',TurnTo.msg('tra.wrev.guidlines.inviteToWriteReview'),'    <p>',TurnTo.msg('tra.wrev.guidlines.contactSupport'),'</p>    <p>',TurnTo.msg('tra.wrev.guidlines.header.donts'),'</p>    <ul>        <li>',TurnTo.msg('tra.wrev.guidlines.donts1'),'</li>        <li>',TurnTo.msg('tra.wrev.guidlines.donts2'),'</li>        <li>',TurnTo.msg('tra.wrev.guidlines.donts3'),'</li>        <li>',TurnTo.msg('tra.wrev.guidlines.donts4'),'</li>    </ul>    <p>',TurnTo.msg('tra.wrev.guidlines.terms'),'</p>    <p class=\"TTmobileHideWriteReviewGuideLines\">        <a href=\"javascript:void(0)\" onclick=\"TurnTo.mobileHideReviewGuidelines();\" rel=\"nofollow\">',TurnTo.msg('tra.wrev.guidlines.link.close'),'</a>    </p></div>');}return p.join('');"),reviewTeaser:new Function("obj","var p=[];with(obj){p.push('<div>    <div class=\"TT2left TTratingBox TTrating-',rating,'\">    </div>    <div class=\"TTratingLinks\">        '); if(TurnToItemData.counts.r == 0 && (typeof showCommentsLink !== 'undefined' && !showCommentsLink)) { p.push('        <a class=\"TTwriteReview\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.revTeaser.link.writeReviewFirst'),'</a>        '); } else { p.push('        '); if(TurnToItemData.counts.r > 0) { p.push('            <a class=\"TTreadReviews\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.revTeaser.link.readReviews.' + TurnTo.getPlural(TurnToItemData.counts.r), [TurnToItemData.counts.r]),'</a>        '); } p.push('            '); if(typeof showCommentsLink !== 'undefined' && showCommentsLink) {                var commentsCnt = loadRteaserAfterChatter ? TurnToItemData.counts.ccWdgtC : TurnToItemData.counts.c;            p.push('                '); if(TurnToItemData.counts.r > 0) { p.push('                    |                '); } p.push('                <a class=\"TTreadComments\" href=\"javascript:void(0)\" rel=\"nofollow\">', TurnToItemData.counts.r == 0 ? TurnTo.msg('tra.revTeaser.link.read')+' ' : '' ,'',TurnTo.msg('tra.revTeaser.link.comments.' + TurnTo.getPlural(commentsCnt), [commentsCnt]),'</a>            '); } p.push('            ',TurnTo.msg('tra.revTeaser.or'),'            <a class=\"TTwriteReview\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.revTeaser.link.writeReview'),'</a>        '); } p.push('    </div>    <div class=\"TTclear\"></div></div>');}return p.join('');"),reviewWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT4reviewWidget\"><div id=\"TT3reviewContent4item\"></div></div>');}return p.join('');"),shareMediaBtns:new Function("obj","var p=[];with(obj){p.push('<div class=\"TTmediaButtons\"> <div class=\"TTvc-bar-media-lg-photo', mediaType == 'photo' ? '-on' : '',' TTmediaBtn\" data-type=\"photo\" aria-label=\"', TurnTo.msg('tra.wrev.attachMedia.addPhoto') ,'\" role=\"button\" tabindex=\"0\"></div><div class=\"TTvc-bar-media-lg-video', mediaType == 'video' ? '-on' : '',' TTmediaBtn\" data-type=\"video\" aria-label=\"', TurnTo.msg('tra.wrev.attachMedia.addVideo') ,'\" role=\"button\" tabindex=\"0\"></div></div>');}return p.join('');"),shareMediaCaptions:new Function("obj","var p=[];with(obj){p.push(''); for(var i = 0; i < media.length; i++) { p.push(' <div class=\"TTcaptionBlock\" data-id=\"',media[i].id,'\" data-tmp-id=\"',media[i].tmpId,'\" data-type=\"',media[i].type,'\">  '); if(type === 'photo') { p.push('   ',TurnToHTML.mediaBlockPhoto({photo: media[i], addDataAttrs : false, isIOS: isIOS}),'  '); } else if(type === 'video') { p.push('    <div class=\"TTmediaBlock\">     <img src=\"', media[i].thumbnailUrl ,'\"       style=\"left:',media[i].s88thumbDims.targetLeft,'px; top: ',media[i].s88thumbDims.targetTop,'; width:',media[i].s88thumbDims.width,'px; height:',media[i].s88thumbDims.height,'px;\"       alt=\"',media[i].caption,'\"/>    </div>  '); } p.push(' <div class=\"TTmediaCaption\">  '); if(media[i].id){ p.push('  ',media[i].caption,'  '); } else { p.push('  <textarea name=\"caption\" placeholder=\"',TurnTo.S.visualContentPlaceholderForCaption,'\">',media[i].caption,'</textarea>  '); } p.push(' </div> <div class=\"TTvc-x-media TTmediaRemove\"></div>  </div>'); } p.push('<!-- keep this comment instead of &nbsp; at end of this, as &nbsp; causes us to not get siblings so spacing from collapsing is not consistent -->');}return p.join('');"),shareMediaScreen:new Function("obj","var p=[];with(obj){p.push(' <div class=\"TTmediaRow TTproductPrompt\">  <div class=\"TTmediaPrompt\">   <p>    ',shareMediaPromptText,'    '); if(onMobile) { p.push('      <a class=\"TTskipLink\" href=\"#\" style=\"display:none;\" rel=\"nofollow\">',TurnTo.msg('tra.shareMedia.link.noThanks'),'</a>    '); } p.push('   </p>   <p class=\"TTmediaSmallDesc\">',catItem.title,'</p>   <p id=\"TTcaptionOtherNote\" style=\"display:none\">',TurnTo.msg('tra.shareMedia.prompt.captions.reviewOnNextPg'),'</p>  </div>  <div class=\"TT4QProductImg\">   <img style=\"width:100px\" src=\"', TurnTo.getProductImage(catItem.imageId, 'L') ,'\" alt=\"',catItem.title,'\">  </div> </div> <div></div> <div id=\"TTcaptionAddCont\" class=\"TTmediaRow\" style=\"display:none;\"> </div> <div class=\"TTmediaRow\">  <p class=\"TTaddFilesPrompt\">',TurnTo.msg('tra.shareMedia.prompt.addFiles'),'</p>  <div id=\"TTmediaBtnsCont\">   ', TurnToHTML.shareMediaBtns({mediaType: mediaType}) ,'  </div> </div> <div id=\"TTmediaAddCont\">  <div class=\"TTnewVideo\">   <div class=\"TTlinkedContent\" style=\"display: none\">    <input id=\"providedLink\" name=\"providedLink\" value=\"\" placeholder=\"http://\" aria-labelledby=\"TTmediaLinkInputInstYT\"/>    <hr class=\"TTmediaLinkInputSep\">    <p id=\"TTmediaLinkInputInstYT\" class=\"TTmediaLinkInputInst\">',TurnTo.msg('tra.shareMedia.linkedContent.instruction.youtube'),'     ',TurnTo.msg('tra.shareMedia.linkedContent.instruction.mustBePublic'),'    </p>    <p class=\"TTmediaLinkInputError\" style=\"display: none\">    </p>    <div class=\"TTaddLinkedContentCtrls\">    <div class=\"TTvc-add-video-disabled TTsubmitLinkedContentBtn\" role=\"button\" aria-label=\"',TurnTo.msg('tra.shareMedia.button.addVideo'),'\" tabindex=\"-1\"></div>    <a class=\"TTcancelLink\" href=\"#\" rel=\"nofollow\">',TurnTo.msg('tra.common.button.cancel'),'</a>    </div>   </div>  </div> </div> <div id=\"TTmediaListCont\">  <div id=\"TTmediaListCont-photo\" style=\"', mediaType != 'photo' ? 'display:none' : '','\"></div>  <div id=\"TTmediaListCont-video\" style=\"', mediaType != 'video' ? 'display:none' : '','\"></div> </div> <div id=\"TTselectedMediaInfo\" class=\"TTmediaRow\">   <p id=\"TTselectedMediaCnts\">',TurnTo.msg('tra.shareMedia.photosSelected.counts.'+TurnTo.getPlural(0), [0]),'    ',TurnTo.msg('tra.shareMedia.videosSelected.counts.' + TurnTo.getPlural(0), [0]),'</p>   <p id=\"TTtooManyMediaSelected\" class=\"TTfieldErr\" style=\"display: none\"></p> </div> <div class=\"TTmediaRow\">   <div class=\"TTmediaSubmitBtns\">  <div id=\"TTmediaSubmitBtn\" class=\"TTvc-submit-disabled\" tabindex=\"-1\" aria-label=\"',TurnTo.msg('tra.common.button.submit'),'\">   <img class=\"TTimgLoading\"    src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\"    alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\"    style=\"display: none;\">  </div>  <a class=\"TTcancelLink\" href=\"#\" style=\"display:none;\" rel=\"nofollow\">',TurnTo.msg('tra.common.button.cancel'),'</a>  <a class=\"TTskipLink\" href=\"#\" style=\"display:none;\" rel=\"nofollow\">', onMobile ? TurnTo.msg('tra.common.button.skip') : TurnTo.msg('tra.common.button.cancel'),'</a>   </div> </div> '); if(imagesWillBeAddedMsg) { p.push('   <div class=\"TTmediaSmallDesc  TTimagesWillBeAddedMsg\">',imagesWillBeAddedMsg,'</div> '); } p.push(' <div id=\"TTshareMediaTermsOfUse\"><p>',TurnTo.S.visualContentTermsOfUse,'</p></div>');}return p.join('');"),siteVisitsAdmin:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2siteVisitsAdmin\">    ');if (blocking) {p.push('        <h3 style=\"color:#cc0000\">This browser will not send site visit data to TurnTo.        This browser will now be excluded from TurnTo reports.        Keep this setting if you are internal at ',siteDisplayName,'.        </h3>        <br/><br/>        <input type=\"button\" id=\"TT2clear\" class=\"TT2button\" style=\"font-size:16px;width:150px;height:30px;\" name=\"TT2clear\" value=\"Resume Sending\"/>    ');} else {p.push('        <h3 style=\"color:#cc0000\">Block this browser from sending site visit data to TurnTo.        This will exclude activity on this browser from TurnTo reports.        Use this if you are internal at ',siteDisplayName ? siteDisplayName : \"this site\",'.         </h3>        <br/><br/>        <input type=\"button\" id=\"TT2block\" class=\"TT2button\" style=\"font-size:16px;width:150px;height:30px;\" name=\"TT2block\" value=\"Yes\"/>    ');}p.push('</div>');}return p.join('');"),soloArticleViewWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3soloQuestionView',postfix,'\">    <div class=\"TT3soloQuestHeader\">        <div id=\"TT3soloQuestion',postfix,'\">            <div class=\"TT3artWrp TT3questBorder\">                <div class=\"TT3questCntr\">                  <div class=\"TT3saAnchorLeft\"></div>                  <div class=\"TT3artBox\">                    <span class=\"TT3qText\">',titleHtml,'</span>                  </div>                  <div class=\"TTclear\"></div>                </div>                <div class=\"TTclear\"></div>            </div>        </div>        <div class=\"TTartBody\">            <div class=\"TT3ansArea\">                <div class=\"TT3aAnchorLeft\"></div>                <div class=\"TT3artCntr\">                    <div class=\"TT3itemBox2\">                        <div style=\"position:relative\">                            <span class=\"TT3aText\">',bodyHtml,'</span>                        </div>                    </div>                    <div class=\"TTclear\"></div>                </div>            </div>        </div>    </div></div>');}return p.join('');"),soloQuestionViewWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3soloQuestionView',postfix,'\">    '); if (showHeader) { p.push('    <div class=\"TT3\">        <span class=\"TT3customerQaLabel\">',TurnTo.S.customerQaLabel,'</span>&nbsp;<span class=\"TT7\" id=\"TT3CustomerQaLabelItemTitle\">',catItem.title,'</span>        <div class=\"TTclear\"></div>    </div>    '); } p.push('    '); if  (showBackBtn) { p.push('      <div class=\"TTsqvBorder\">        <div class=\"TTsqvBack\"></div>        <div class=\"TTsqvForward\"></div>        <div class=\"TTclear\"></div>      </div>    '); } else if (!hideSeeAll)  { p.push('      <div style=\"float:right;height:25px;\">        <a id=\"TT3soloSeeAll\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.soloQ.link.seeAllQA'),'</a>        <div class=\"TT2clearBoth\"></div>      </div>      <div class=\"TT2clearBoth\"></div>    ');  } p.push('    '); if (statusMsg) { p.push('      <div class=\"TTsoloQuestionMsg\">',statusMsg,'</div>    '); } p.push('    <div class=\"TT3soloQuestHeader\">        <div id=\"TT3soloQuestion',postfix,'\"></div>        <div id=\"TT2closeGroup',postfix,'\" style=\"text-align:center; margin-top:15px;', hideClose  ? 'display:none' : '','\">            <div id=\"TT2ppCloseBtn',postfix,'\" href=\"javascript:void(0)\" class=\"TTcloseBtn\" tabindex=\"0\" aria-label=\"',TurnTo.msg('tra.common.label.close'),'\"></div>        </div>    </div></div>');}return p.join('');"),subSpinScreen:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2subSpinScreen\" style=\"text-align: center;\">    <p style=\"font-weight: bold; margin-top: 10px; margin-bottom: 10px;\">',description,'</p>    <img src=\"',TurnTo.getStaticUrl('/tra2/images/traspin.gif'),'\" alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\"/></div>');}return p.join('');"),userProfile:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3UPContent\">    <input id=\"TT3UPuid\" type=\"hidden\" value=\"',uid,'\"/>    <div id=\"TT4UPSummary\">        <div id=\"TT4UPPostsHeader\">',isOtherUser ? TurnTo.formatName(user, false, 'nickFull') :            TurnTo.msg('tra.profile.header.yourPosts'),'        </div>        <div id=\"TT4UPBreakdown\">            '); if (TurnTo.matchData.site.reviewsEnabled) { p.push('            <div class=\"TT4UPBreakdownCol\" id=\"TT4UPBreakdownCol-reviews\">                <div class=\"TT4UPCnt\">',rCnt,'</div>                <div class=\"TT4UPType\">',TurnTo.msg('tra.profile.label.reviewsCount'),'</div>                <div class=\"TT4UPCnt TTpad20 TT4metaGray\">',rCntGood,'</div>                <div class=\"TT4UPType TT4metaGray\">',TurnTo.msg('tra.profile.label.helpfulCount'),'</div>            </div>            '); } p.push('            <div class=\"TT4UPBreakdownCol\">                <div class=\"TT4UPCnt\">',qCnt,'</div>                <div class=\"TT4UPType\">',TurnTo.msg('tra.profile.label.questionsCount'),'</div>                <div class=\"TT4UPCnt TTpad20 TT4metaGray\">',qCntGood,'</div>                <div class=\"TT4UPType TT4metaGray\">',TurnTo.msg('tra.profile.label.othersWithQuestionCount'),'</div>            </div>            <div class=\"TT4UPBreakdownCol\">                <div class=\"TT4UPCnt\">',aCnt,'</div>                <div class=\"TT4UPType\">',TurnTo.msg('tra.profile.label.answersCount'),'</div>                <div class=\"TT4UPCnt TTpad20 TT4metaGray\">',aCntGood,'</div>                <div class=\"TT4UPType TT4metaGray\">',TurnTo.msg('tra.profile.label.bestAnswerVoteCount'),'</div>            </div>            <div class=\"TT4UPBreakdownCol\" id=\"TT4UPBreakdownCol-comments\">                <div class=\"TT4UPCnt\">',cCnt,'</div>                <div class=\"TT4UPType\">',TurnTo.msg('tra.profile.label.commentsCount'),'</div>            </div>        </div>        <div class=\"TTclear\"></div>    </div>    <div id=\"TT4UPtabs\">        <ul id=\"TTprofileTabs\">            '); if (TurnTo.matchData.site.reviewsEnabled) { p.push('            <li id=\"TTreviewsTab\" class=\"TTtab TTactiveTab TTtitle\" tabindex=\"0\">',TurnTo.msg('tra.profile.tab.reviews'),'</li>            <li id=\"TTquestionsTab\" class=\"TTtab TTtitle\" tabindex=\"0\">',TurnTo.msg('tra.profile.tab.questions'),'</li>            '); } else { p.push('            <li id=\"TTquestionsTab\" class=\"TTtab TTactiveTab TTtitle\" tabindex=\"0\">',TurnTo.msg('tra.profile.tab.questions'),'</li>            '); } p.push('            <li id=\"TTanswersTab\" class=\"TTtab TTtitle\" tabindex=\"0\">',TurnTo.msg('tra.profile.tab.answers'),'</li>            <li id=\"TTchatterTab\" class=\"TTtab TTtitle\" tabindex=\"0\">',TurnTo.msg('tra.profile.tab.comments'),'</li>            <div class=\"TTclear\"></div>        </ul>    </div>    <div id=\"TTquestionsTabContent\" class=\"TTtabContent\" style=\"',TurnTo.matchData.site.reviewsEnabled ? 'display:none' : '','\">        '); var noneSuffix = isOtherUser ? 'thisUser' : 'you'; p.push('        <div id=\"TT3UPquestSec\">            '); if(qCnt == 0) { p.push('            <span class=\"TT4UPnoUGC\">',TurnTo.msg('tra.profile.noSubmittedQuestions.' + noneSuffix),'</span>            '); } p.push('        </div>        <div id=\"TT3UPqShowMore\" class=\"TT3ShowMore\"> <a href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.profile.link.showMore'),'</a>        </div>        <input id=\"TT3UPqOffset\" type=\"hidden\" value=\"0\"/>    </div>    <div id=\"TTanswersTabContent\" class=\"TTtabContent\" style=\"display:none;\">        <div id=\"TT3UPAnsSec\">            '); if(aCnt == 0) { p.push('            <span class=\"TT4UPnoUGC\">',TurnTo.msg('tra.profile.noSubmittedAnswers.' + noneSuffix),'</span>            '); } p.push('        </div>        <div id=\"TT3UPaShowMore\" class=\"TT3ShowMore\"> <a href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.profile.link.showMore'),'</a>        </div>        <input id=\"TT3UPaOffset\" type=\"hidden\" value=\"0\"/>    </div>    '); if (TurnTo.matchData.site.reviewsEnabled) { p.push('    <div id=\"TTreviewsTabContent\" class=\"TTtabContent\" style=\"',TurnTo.matchData.site.reviewsEnabled ? '' : 'display:none','\">        <div id=\"TTUPReviewSec\">            '); if(rCnt == 0) { p.push('            <span class=\"TT4UPnoUGC\">',TurnTo.msg('tra.profile.noSubmittedReviews.' + noneSuffix),'</span>            '); } p.push('        </div>        <div id=\"TT3UPrShowMore\" class=\"TT3ShowMore\"> <a href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.profile.link.showMore'),'</a>        </div>        <input id=\"TT3UPrOffset\" type=\"hidden\" value=\"0\"/>    </div>    '); } p.push('    <div id=\"TTchatterTabContent\" class=\"TTtabContent\" style=\"display:none;\">        <div id=\"TT3UPCommentSec\">            '); if(cCnt == 0) { p.push('            <span class=\"TT4UPnoUGC\">',TurnTo.msg('tra.profile.noSubmittedComments.' + noneSuffix),'</span>            '); } p.push('        </div>        <div id=\"TT3UPcShowMore\" class=\"TT3ShowMore\"> <a href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.profile.link.showMore'),'</a>        </div>        <input id=\"TT3UPcOffset\" type=\"hidden\" value=\"0\"/>    </div></div><div id=\"TT3MobileCancelSub\" style=\"text-align:right;display:none;padding:15px;margin-top:15px;\">    <input type=\"button\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),') no-repeat scroll left center #FFFFFF;height:25px;width:72px;\" /></div>');}return p.join('');"),userSetting:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2userSetting\">    <div id=\"TT4userSettingErrors\" class=\"TT4SysMsgBody\"></div>    <form id=\"TT3profileForm\" name=\"profileForm\" method=\"post\">          <input type=\"hidden\" value=\"',matches.user.id,'\" name=\"TT3id\" id=\"TT3id\">          <div class=\"dialog\" style=\"margin-bottom: 5px;\">          <div class=\"TT10\">              <table>                <tbody>                  <tr class=\"prop\">                        <td valign=\"top\" colspan=\"2\" style=\"text-align: left;\" class=\"nameRF\">                            <b>',TurnTo.msg('tra.settings.header.basicInfo'),'</b>                        </td>                  </tr>                  <tr class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                        <label for=\"TT3firstName\">*',TurnTo.msg('tra.settings.firstName'),'</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"text\" value=\"',matches.user.firstName,'\" maxlength=\"200\" name=\"TT3firstName\" id=\"TT3firstName\">                    </td>                  </tr>                  <tr class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                        <label for=\"TT3lastName\">*',TurnTo.msg('tra.settings.lastName'),'</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"text\" value=\"',matches.user.lastName,'\" maxlength=\"200\" id=\"TT3lastName\" name=\"TT3lastName\">                    </td>                  </tr>                  <tr class=\"prop\">                      <td valign=\"top\" class=\"nameRF\">                          <label for=\"TT3nickName\">',TurnTo.msg('tra.settings.displayName'),'</label>                      </td>                      <td valign=\"top\" class=\"valueL \">                          <input type=\"text\" value=\"',matches.user.nickName,'\" maxlength=\"200\" id=\"TT3nickName\"                                 name=\"TT3nickName\">                          <span>',TurnTo.msg('tra.settings.instruction.displayName'),'</span>                      </td>                  </tr>                  <!--<tr class=\"prop\">-->                    <!--<td valign=\"top\" class=\"nameRF\">-->                      <!--<label for=\"postalCode\">Postal Code:</label>-->                    <!--</td>-->                    <!--<td valign=\"top\" style=\"width: 175px\" class=\"valueL \">-->                        <!--<input type=\"text\" value=\"',matches.user.setting.postalCode,'\" maxlength=\"200\" name=\"postalCode\" id=\"postalCode\">-->                    <!--</td>-->                  <!--</tr>-->                  ');                    var userCountry = (matches.user.country || typeof matches.user.country === 'undefined') ? matches.user.country : matches.site.defaultShopperCountry;                    if (userCountry == undefined || userCountry == '') {                        userCountry = 'US';                    }                  p.push('                  <tr class=\"prop\" ', matches.site.defaultShopperCountry ? 'style=\"display:none;\"' : '' ,'>                      <td valign=\"top\" class=\"nameRF\" ', onMobile ? \"colspan='2'\" : \"\" ,'>                      <label for=\"TT3city\">',TurnTo.msg('tra.settings.country'),'</label>                      </td>                      '); if (onMobile) { p.push('                        </tr><tr class=\"prop\">                      '); } p.push('                      <td valign=\"top\" style=\"width: 175px\" class=\"valueL \" ', onMobile ? \"colspan='2'\" : \"\" ,'>                          <select id=\"TT3country\" name=\"TT3country\" onchange=\"TurnTo.shopperProfileCountryChange(this);\">                              '); for (var countryCd in matches.user.setting.countries) {                                  var country = matches.user.setting.countries[countryCd]; p.push('                                  <option value=\"', countryCd ,'\" ', userCountry === countryCd ? \"selected='selected'\" : '' ,'>', country ,'</option>                              '); } p.push('                          </select>                      </td>                  </tr>                  <tr class=\"prop\">                      <td valign=\"top\" class=\"nameRF\">                          <label for=\"TT3city\">',TurnTo.msg('tra.settings.city'),'</label>                      </td>                      <td valign=\"top\" style=\"width: 175px\" class=\"valueL \">                          <input type=\"text\" value=\"',matches.user.city,'\" maxlength=\"200\" name=\"TT3city\" id=\"TT3city\">                      </td>                  </tr>                  <tr class=\"prop\" id=\"TTstateUSdisplay\" ', userCountry != 'US' ? 'style=\"display:none;\"' : '' ,'>                      <td valign=\"top\" class=\"nameRF\">                          <label for=\"TT3state\">',TurnTo.msg('tra.settings.state'),'</label>                      </td>                      <td valign=\"top\" style=\"width: 175px\" class=\"valueL \">                          <select name=\"TT3state\" id=\"TT3stateUS\">                              '); for (var stateCd in matches.user.setting.usStates) {                                  var state = matches.user.setting.usStates[stateCd]; p.push('                                  <option value=\"', stateCd ,'\" ', matches.user.state === stateCd ? \"selected='selected'\" : '' ,'>', state ,'</option>                              '); } p.push('                          </select>                      </td>                  </tr>                  <tr class=\"prop\" id=\"TTstateCAdisplay\" ', userCountry != 'CA' ? 'style=\"display:none;\"' : '' ,'>                      <td valign=\"top\" class=\"nameRF\">                          <label for=\"TT3state\">',TurnTo.msg('tra.settings.province'),'</label>                      </td>                      <td valign=\"top\" style=\"width: 175px\" class=\"valueL \">                          <select name=\"TT3state\" id=\"TT3stateCA\">                              '); for (var stateCd in matches.user.setting.caStates) {                                  var state = matches.user.setting.caStates[stateCd]; p.push('                                  <option value=\"', stateCd ,'\" ', matches.user.state === stateCd ? \"selected='selected'\" : '' ,'>', state ,'</option>                              '); } p.push('                          </select>                      </td>                  </tr>                  <tr class=\"prop\" id=\"TTstateOtherdisplay\" ', (userCountry == 'US' || userCountry == 'CA') ? 'style=\"display:none;\"' : '' ,'>                      <td valign=\"top\" class=\"nameRF\">                          <label for=\"TT3state\">',TurnTo.msg('tra.settings.other'),'</label>                      </td>                      <td valign=\"top\" style=\"width: 175px\" class=\"valueL \">                          <input type=\"text\" value=\"',matches.user.state,'\" maxlength=\"200\" name=\"TT3state\" id=\"TT3state\">                      </td>                  </tr>                  <tr class=\"prop\">                      <td valign=\"top\" class=\"nameRF\">                          <label for=\"TT3ageRange\">',TurnTo.msg('tra.settings.age'),'</label>                      </td>                      <td valign=\"top\" style=\"width: 175px\" class=\"valueL \">                          <select id=\"TT3ageRange\">                              <option value=\"\"></option>                              <option value=\"0\" ',matches.user ? (matches.user.ageRange == '0' ? 'selected' : '' ) : '',' >',matches.user.setting.ageRanges['0'],'</option>                              <option value=\"1\" ',matches.user ? (matches.user.ageRange == '1' ? 'selected' : '' ) : '',' >',matches.user.setting.ageRanges['1'],'</option>                              <option value=\"2\" ',matches.user ? (matches.user.ageRange == '2' ? 'selected' : '' ) : '',' >',matches.user.setting.ageRanges['2'],'</option>                              <option value=\"3\" ',matches.user ? (matches.user.ageRange == '3' ? 'selected' : '' ) : '',' >',matches.user.setting.ageRanges['3'],'</option>                          </select>                      </td>                  </tr>                '); if (matches.user.setting.siteLocales.length > 0) {                   var siteLocales = matches.user.setting.siteLocales;                  p.push('                    <tr class=\"prop\">                      <td valign=\"top\" class=\"nameRF\">                          <label for=\"TTlocale\">',TurnTo.msg('tra.settings.preferredLanguage'),'</label>                      </td>                      <td valign=\"top\" style=\"width: 175px\" class=\"valueL \">                          <select id=\"TTlocaleSelect\">                              '); for (var i = 0; i < matches.user.setting.siteLocales.length; i++) { p.push('                                   <option value=\"',siteLocales[i].locale,'\" ',matches.user ? (matches.user.locale == siteLocales[i].locale ? 'selected' : '' ) : '',' >',siteLocales[i].name,'</option>                              '); } p.push('                          </select>                      </td>                  </tr>                '); } else { p.push('                  <input id=\"TTlocaleSelect\" type=\"hidden\" value=\"',matches.user.locale,'\"/>                '); } p.push('                  <tr class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                    </td>                    <td valign=\"top\" class=\"valueL\">                        <a href=\"javascript:void(0)\" rel=\"nofollow\"id=\"pwd_change\">',matches.user.setting.defaultPassword ?                            TurnTo.msg('tra.settings.createPwd') : TurnTo.msg('tra.settings.changePwd'),'</a>                        <a style=\"display: none;\" href=\"javascript:void(0)\" rel=\"nofollow\" id=\"pwd_nochange\">',matches.user.setting.defaultPassword                            ? TurnTo.msg('tra.settings.doNotCreatePwd') :                            TurnTo.msg('tra.settings.doNotChangePwd'),'</a>                        <input type=\"hidden\" value=\"false\" id=\"TT3editingPasswd\" name=\"TT3editingPasswd\">                    </td>                  </tr>                  ');if (!matches.user.setting.defaultPassword) {p.push('                  <tr style=\"display: none;\" id=\"TT3currpasswd\" class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                        <label for=\"TT3currpasswd\">',TurnTo.msg('tra.settings.currentPwd'),'</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"password\" maxlength=\"200\" value=\"\" name=\"TT3currpasswd\">                    </td>                  </tr>                  ');}p.push('                  <tr style=\"display: none;\" id=\"TT3pwd_1\" class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                        <label for=\"TT3newpasswd\">',TurnTo.msg('tra.settings.newPwd'),'</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"password\" maxlength=\"200\" value=\"\" name=\"TT3passwd\">                    </td>                  </tr>                  <tr style=\"display: none;\" id=\"TT3pwd_2\" class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                        <label for=\"TT3repasswd\">',TurnTo.msg('tra.settings.confirmPwd'),'</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"password\" maxlength=\"200\" value=\"\" id=\"TT3repasswd\" name=\"TT3repasswd\">                    </td>                  </tr>                </tbody>              </table>          </div>          <div>            <table>                <tbody>                <tr class=\"prop\">                    <td valign=\"top\" style=\"text-align: left;\" class=\"nameRF\">                        <b>',TurnTo.msg('tra.settings.photo'),'</b>                    </td>                    <td valign=\"top\" class=\"valueL\">                        <a id=\"showPhotoEditorLink1\" href=\"javascript:void(0)\" rel=\"nofollow\" style=\"',matches.user.setting.hasPhoto ? '' : 'display:none','\">                            <img style=\"float: left; border: 1px solid rgb(204, 204, 204); width: 45px; height: 45px;\"                                 src=\"',TurnTo.getUserPhoto(matches.user.id, matches.user.pid),'\" id=\"userImg\">                        </a>                        <img style=\"float: left; border: 1px solid rgb(204, 204, 204); width: 45px; height: 45px; display: none;\"                             alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\"                             src=\"',getStaticUrl('/images/spinner.gif'),'\" id=\"userImgLoading\">                        &nbsp;<a href=\"javascript:void(0)\" rel=\"nofollow\"id=\"showPhotoEditorLink2\">',matches.user.setting.hasPhoto ?                        TurnTo.msg('tra.settings.changePhoto') : TurnTo.msg('tra.settings.addPhoto'),'</a>                    </td>                </tr>                <tr id=\"editPhoto\" style=\"display:none\" class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                                            </td>                    <td valign=\"top\" class=\"valueL\">                        <img id=\"tmpUserImg\" src=\"');if (matches.user.setting.hasPhoto) {p.push('',TurnTo.getUserPhoto(TurnTo.matchData.user.id, TurnTo.matchData.user.pid),'');}p.push('\"                             style=\"border: 1px solid rgb(204, 204, 204); width:45px;height:45px;',matches.user.setting.hasPhoto? '' :'display:none','\"/>                        <img id=\"tmpUserImgLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\"                             alt=\"Loading...\"                             style=\"border: 1px solid rgb(204, 204, 204); width:45px;height:45px; display: none;\">                        <br/>                        &nbsp;<input type=\"file\" name=\"TT2userImgFile\" id=\"TT2userImgFile\"                               onchange=\"TurnTo.inputUserImageForUserSetting(this)\"/><br/>                        &nbsp;',TurnTo.msg('tra.settings.instruction.selectImage'),'                        <div style=\"clear:both\"/>                        <span id=\"TT2customUserImgRadio\" style=\"',matches.user.setting.hasPhoto ? '' : 'display:none','\">                            <input type=\"radio\" name=\"userImgSelection\" value=\"custom\" ',matches.user.setting.hasPhoto && matches.user.setting.photoId.indexOf('fb') < 0 ? 'checked=\"checked\"' : '','/> ',TurnTo.msg('tra.settings.useCustomPhoto'),'                        </span>                        <br/><br/>                        &nbsp;&nbsp;&nbsp;&nbsp;',TurnTo.msg('tra.settings.or'),'                        <br/><br/>                        <span id=\"TT2fbNotConnected\" style=\"',matches.user.isFbConnected ? 'display:none' : '','\">                            <a href=\"javascript:void(0)\" rel=\"nofollow\"id=\"TT2userSettingFbConnect\" style=\"vertical-align:middle\">                                <img src=\"',TurnTo.getStaticUrl('/tra2/images/fb-login-s1.png') ,'\"                                     alt=\"',TurnTo.msg('tra.settings.fbLogin.hover'),'\" style=\"border:none\"/>                            </a>                            ',TurnTo.msg('tra.settings.fbLoginUsePhoto'),'                        </span>                        <span id=\"TT2fbConnected\" style=\"',!matches.user.isFbConnected ? 'display:none' : '','\">                            <span><input type=\"radio\" name=\"userImgSelection\" value=\"facebook\" ',matches.user.setting.hasPhoto && matches.user.setting.photoId.indexOf('fb') > 0 ? 'checked=\"checked\"' : '','/> ',TurnTo.msg('tra.settings.useFBPhoto'),'</span>                        </span>                    </td>                </tr>                <tr id=\"editPhotoButtons\" style=\"display:none\" class=\"prop\">                    <td>                    </td>                    <td>                        <div id=\"closePhotoButton\" class=\"TTcancelBtn\" tabindex=\"0\" aria-label=\"',TurnTo.msg('tra.settings.photo.cancel'),'\"></div>                        <div id=\"savePhotoButton\" class=\"TTsaveBtn\" tabindex=\"0\" aria-label=\"',TurnTo.msg('tra.settings.photo.save'),'\"></div>                    </td>                </tr>                </tbody>            </table>          </div>          <div class=\"TT10\" id=\"contactInfo\">          </div>          <div class=\"TT10\" id=\"TT4profileDims\"></div>          <div>          ');if (matches.user.setting.showAskPref) {p.push('          <div>              <table>                  <tbody>                  <tr class=\"prop\">                      <td valign=\"top\" style=\"text-align: left;\" class=\"nameRF\">                          <b>',TurnTo.msg('tra.settings.header.qa'),'</b>                      </td>                      <td valign=\"top\" class=\"valueL\" style=\"width: 200px;\">                          <input type=\"checkbox\" name=\"TT3askMe\" id=\"TT3askMe\" class=\"TTcheckbox\" value=\"true\"                          ',matches.user.setting.askOptOut ? '' : 'checked=\"checked\"',' /><label for=\"TT3askMe\"                                                                                                  class=\"TTlabel\">',TurnTo.msg('tra.settings.receiveQuestions'),'</label>                      </td>                  </tr>                  </tbody>              </table>          </div>          ');}p.push('          </div>        </div>            <div style=\"float: right;\" class=\"buttons TTuserSetting-buttons\">              <span class=\"TTuserSetting-button\">                  <input id=\"TT3updateButton\" type=\"button\" value=\"\" name=\"update\" class=\"TTupdateBtn\"/>                  <img style=\"float: left; border: 1px solid rgb(204, 204, 204); width: 16px; height: 16px; display: none;\"                       alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\" src=\"',getStaticUrl('/images/spinner.gif'),'\"                       id=\"TT3updateLoading\"/>              </span>            </div>            <div style=\"clear: both;\"></div>      </form></div><div id=\"TT3MobileCancelSub\" style=\"text-align:right;display:none;padding:15px;margin-top:15px;\">    <input type=\"button\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),') no-repeat scroll left center #FFFFFF;height:25px;width:72px;\" /></div>');}return p.join('');"),userSettingEmailAddresses:new Function("obj","var p=[];with(obj){p.push('      <table style=\"border: medium none; width: 490px;\">        <tbody>            <tr class=\"prop\">                <td valign=\"top\" colspan=\"2\" style=\"text-align: left;\" class=\"nameRF\">                    <b>',TurnTo.msg('tra.settings.emailAddresses'),'</b>                </td>            </tr>              '); var confirmedEmails = [];                 var unconfirmedEmails = [];                p.push('              ');for (var i = 0; i < matches.user.setting.emailIdentifiers.length; i++) {                        if (!matches.user.setting.emailIdentifiers[i].isPrimary && matches.user.setting.emailIdentifiers[i].isConfirmed) {                            confirmedEmails[confirmedEmails.length] = matches.user.setting.emailIdentifiers[i];                        } else if (!matches.user.setting.emailIdentifiers[i].isConfirmed) {                            unconfirmedEmails[unconfirmedEmails.length] = matches.user.setting.emailIdentifiers[i];                        } else if (matches.user.setting.emailIdentifiers[i].isPrimary) {p.push('                          <tr class=\"prop\">                            <td valign=\"top\" class=\"nameRF\" style=\"width:112px\">                                <label for=\"email\">',TurnTo.msg('tra.settings.primaryEmail'),'</label>                            </td>                            <td valign=\"top\" class=\"valueL\">                            ',matches.user.setting.emailIdentifiers[i].ident,'                            </td>                          </tr>              ');        }               }p.push('              ');for (var i = 0; i < confirmedEmails.length; i++) {p.push('              <tr class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                    <label for=\"email\">',TurnTo.msg('tra.settings.email'),'</label>                </td>                <td valign=\"top\" class=\"valueL\">                            ',confirmedEmails[i].ident,'                    <a onclick=\"TurnTo.makePrimaryIdent(',confirmedEmails[i].id,')\" href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.settings.makePrimary'),'</a>                    &nbsp;<a onclick=\"TurnTo.removeIdent(',confirmedEmails[i].id,')\" href=\"javascript:void(0)\" rel=\"nofollow\"><img border=\"0\" alt=\"remove\" src=\"',getStaticUrl('/images/tabClose.gif'),'\" style=\"margin-left: 5px; vertical-align: middle;\"></a>                </td>              </tr>              ');}p.push('              ');for (var i = 0; i < unconfirmedEmails.length; i++) {p.push('              <tr class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                    <label for=\"email\">',TurnTo.msg('tra.settings.email'),'</label>                </td>                <td valign=\"top\" class=\"valueL\">                    ',unconfirmedEmails[i].ident,' - ',TurnTo.msg('tra.settings.unconfirmed'),'                    <a onclick=\"TurnTo.resendEmailConfirmation(&#39;',unconfirmedEmails[i].ident,'&#39;, function(){})\"                       href=\"javascript:void(0)\" rel=\"nofollow\">',TurnTo.msg('tra.settings.resendConfirm'),'</a>                    &nbsp;<a onclick=\"TurnTo.removeIdent(',unconfirmedEmails[i].id,')\" href=\"javascript:void(0)\" rel=\"nofollow\"><img border=\"0\" alt=\"remove\" src=\"',getStaticUrl('/images/tabClose.gif'),'\" style=\"margin-left: 5px; vertical-align: middle;\"></a>                </td>              </tr>              ');}p.push('         </tbody>      </table>      <table style=\"border: medium none; float: left; width: 315px; padding-top: 0pt;\">        <tbody>            <tr style=\"padding-top: 0pt;\" class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                    <label for=\"email\">',TurnTo.msg('tra.settings.addEmail'),'</label>                </td>                <td valign=\"top\" class=\"valueL \" style=\"width: 175px\">                    <input type=\"text\" value=\"\" maxlength=\"200\" name=\"newEmail0\" id=\"newEmail0\">                </td>            </tr>            <tr class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                </td>                <td valign=\"top\" class=\"valueL \" style=\"width: 175px\">                    <input type=\"text\" value=\"\" maxlength=\"200\" name=\"newEmail1\" id=\"newEmail1\">                </td>            </tr>            <tr class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                </td>                <td valign=\"top\" class=\"valueL \" style=\"width: 175px\">                    <input type=\"text\" value=\"\" maxlength=\"200\" name=\"newEmail2\" id=\"newEmail2\">                </td>            </tr>        </tbody>      </table>      <div style=\"clear: both;\"></div>');}return p.join('');"),userSettingsProfileDims:new Function("obj","var p=[];with(obj){p.push('<table>    <tr class=\"prop\">        <td class=\"nameRF TT2bold\">',TurnTo.msg('tra.settings.header.profileDims'),'</td>    </tr>    '); for (var i = 0; i < profileDims.length; i++) { p.push('    '); if (profileDims[i].type == 0) { p.push('        <tr>            <td><label for=\"TTprofileDim-',profileDims[i].id,'\">',profileDims[i].required ? '*' : '','',profileDims[i].label,'</label></td>            <td>            <select id=\"TTprofileDim-',profileDims[i].id,'\" class=\"TTprofileDim\" data-id=\"',profileDims[i].id,'\" data-oldvalue=\"',profileDimsSelected[profileDims[i].id] ? profileDimsSelected[profileDims[i].id].valDefId : '','\">                <option value=\"\"></option>                '); for (var j = 0; j < profileDims[i].values.length; j++) { p.push('                ');                    var selected = '';                    if (profileDimsSelected[profileDims[i].id]) {                        if (profileDimsSelected[profileDims[i].id].valDefId == profileDims[i].values[j].id) {                            selected = 'selected';                        }                    }                p.push('                <option value=\"',profileDims[i].values[j].id,'\" ',selected,'>',profileDims[i].values[j].label,'</option>                '); } p.push('            </select>            </td>        </tr>    '); } else { p.push('        <tr>            <td>                <label for=\"TTprofileDim-',profileDims[i].id,'\">',profileDims[i].required ? '*' : '','',profileDims[i].label,'</label>            </td>            <td>                <textarea maxlength=\"50\" id=\"TTprofileDim-',profileDims[i].id,'\" class=\"TTdefaultInput\" onblur=\"TurnTo.inputLoseFocus(this)\" onfocus=\"TurnTo.TT2questionTextFocus(this)\" ttinputlabeltext=\"',profileDimsSelected[profileDims[i].id] ? profileDimsSelected[profileDims[i].id].freeformText: '','\">',profileDimsSelected[profileDims[i].id] ? profileDimsSelected[profileDims[i].id].freeformText : '','</textarea>            </td>        </tr>    '); } } p.push('</table>');}return p.join('');"),visualContentForUgc:new Function("obj","var p=[];with(obj){p.push('<div class=\"TTmediaForUgc\" data-ugc-id=\"',ugcId,'\" data-ugc-type=\"',ugcType,'\"> ');for(var i = 0; i < mediaList.length; i++) {     var media = mediaList[i]; p.push('  <div class=\"TTmediaBlock\" data-media-id=\"',media.id,'\" tabindex=\"0\">   '); if(media.type == 'video') { p.push('       <div class=\"TTvc-icon-md-video\"></div>   '); } p.push('   ', TurnTo.getMediaImg(media, 'PZ-128') ,'      </div>  '); if(mediaList.length == 1) { p.push('   <div class=\"TTsingleMediaCaption\">',media.caption ? media.caption : TurnTo.msg('tra.rev.media.dateAdded', [media.dateCreated]),'</div>  '); } p.push(' '); } p.push('</div>');}return p.join('');"),writeReviewScreen:new Function("obj","var p=[];with(obj){p.push(''); var requiredInd = TurnTo.msg('tra.wrev.requiredIndicator'); p.push('<div id=\"TTwriteReviewScreen\">    <div class=\"TT4QProductImg TTrespDesktopDisp\">        <img id=\"TTrevCatItemImg\" src=\"', TurnTo.getProductImage(initData.catalogItem.imageId, 'L', initData.siblingSiteKey) ,'\" alt=\"',initData.catalogItem.title,'\" style=\"width: 100px;\" />    </div>    <div id=\"TTwriteRevHeader\">        <div id=\"TTwriteRevGreet\">            <p>              ',reviewPrompt,'              <a class=\"TTskipLink\" href=\"#\" style=\"display:none;\" rel=\"nofollow\">',TurnTo.msg('tra.shareMedia.link.noThanks'),'</a>            </p>            <p class=\"TTmediaSmallDesc\">',initData.catalogItem.title,'</p>        </div>    </div>    <ul id=\"TTwriteRevErrs\" style=\"display:none;\"></ul>    <div id=\"TTwriteRevForm\">        <div class=\"TTwriteRevRow\">            <div class=\"TTwriteRevLeftCol\">                <div id=\"TTrevRatingLabel\">',TurnTo.msg('tra.wrev.rating'),'</div>            </div>            <div class=\"TTresponsivePortraitClear\"></div>            <div class=\"TTwriteRevRightCol\">                <div id=\"TTrevRating\" class=\"TTratingBox TTrating-0-0\" onmouseout=\"TurnTo.chooseReviewRatingMouseout(this)\" onmousemove=\"TurnTo.chooseReviewRatingHover(event, this)\" onclick=\"TurnTo.chooseReviewRatingClick(this)\"></div>                <!--the following hidden elements are for ADA compliance-->                <input class=\"TThiddenForADA\" type=\"radio\" value=\"1\" name=\"TTrevRating-ADA\" id=\"TTrevRating-one\" onchange=\"TurnTo.chooseReviewRatingAda(this)\" onfocus=\"TurnTo.chooseReviewRatingAdaFocus(this)\" onblur=\"TurnTo.chooseReviewRatingAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTrevRating-one\">One out of five stars</label>                <input class=\"TThiddenForADA\" type=\"radio\" value=\"2\" name=\"TTrevRating-ADA\" id=\"TTrevRating-two\" onchange=\"TurnTo.chooseReviewRatingAda(this)\" onfocus=\"TurnTo.chooseReviewRatingAdaFocus(this)\" onblur=\"TurnTo.chooseReviewRatingAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTrevRating-two\">Two out of five stars</label>                <input class=\"TThiddenForADA\" type=\"radio\" value=\"3\" name=\"TTrevRating-ADA\" id=\"TTrevRating-three\" onchange=\"TurnTo.chooseReviewRatingAda(this)\" onfocus=\"TurnTo.chooseReviewRatingAdaFocus(this)\" onblur=\"TurnTo.chooseReviewRatingAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTrevRating-three\">Three out of five stars</label>                <input class=\"TThiddenForADA\" type=\"radio\" value=\"4\" name=\"TTrevRating-ADA\" id=\"TTrevRating-four\" onchange=\"TurnTo.chooseReviewRatingAda(this)\" onfocus=\"TurnTo.chooseReviewRatingAdaFocus(this)\" onblur=\"TurnTo.chooseReviewRatingAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTrevRating-four\">Four out of five stars</label>                <input class=\"TThiddenForADA\" type=\"radio\" value=\"5\" name=\"TTrevRating-ADA\" id=\"TTrevRating-five\" onchange=\"TurnTo.chooseReviewRatingAda(this)\" onfocus=\"TurnTo.chooseReviewRatingAdaFocus(this)\" onblur=\"TurnTo.chooseReviewRatingAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTrevRating-five\">Five out of five stars</label>            </div>            <div class=\"TTclear\"></div>        </div>        '); for (var i = 0; i < initData.dimensionDefinitions.length; i++) {        var custDim = initData.dimensionDefinitions[i];        var dimValueDefs = custDim.itemReviewDimensionValueDefinitions; p.push('              <div class=\"TTwriteRevRow\">                    <div class=\"TTwriteRevLeftCol\">                        <div id=\"TTcustDimLbl-',custDim.id,'\">',custDim.label,'',TurnTo.msg('tra.wrev.dimensionLabelPostfix', [custDim.required ? requiredInd : '']),'</div>                    </div>                    <div class=\"TTresponsivePortraitClear\"></div>                    <div class=\"TTwriteRevRightCol\">                        '); if (custDim.type == 1) { p.push('                            <div id=\"TTcustDim-',custDim.id,'\" ttcustdimid=\"',custDim.id,'\" ttcustomdimtype=\"',custDim.type,'\" class=\"TTwriteRevCustomDimBox TTcustom-0-0\" onmouseout=\"TurnTo.chooseCustomDimensionMouseout(this)\" onmousemove=\"TurnTo.chooseCustomDimensionHover(event, this)\" onclick=\"TurnTo.chooseCustomDimensionClick(this)\"></div>                            <!--the following hidden elements are for ADA compliance-->                            <input class=\"TThiddenForADA\" type=\"radio\" value=\"1\" name=\"TTcustDim-ADA-',custDim.id,'\" id=\"TTcustDim-',custDim.id,'-one\" onchange=\"TurnTo.chooseCustomDimensionAda(this)\" onfocus=\"TurnTo.chooseCustomDimensionAdaFocus(this)\" onblur=\"TurnTo.chooseCustomDimensionAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTcustDim-',custDim.id,'-one\">One out of five ',custDim.label,'</label>                            <input class=\"TThiddenForADA\" type=\"radio\" value=\"2\" name=\"TTcustDim-ADA-',custDim.id,'\" id=\"TTcustDim-',custDim.id,'-two\" onchange=\"TurnTo.chooseCustomDimensionAda(this)\" onfocus=\"TurnTo.chooseCustomDimensionAdaFocus(this)\" onblur=\"TurnTo.chooseCustomDimensionAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTcustDim-',custDim.id,'-two\">Two out of five ',custDim.label,'</label>                            <input class=\"TThiddenForADA\" type=\"radio\" value=\"3\" name=\"TTcustDim-ADA-',custDim.id,'\" id=\"TTcustDim-',custDim.id,'-three\" onchange=\"TurnTo.chooseCustomDimensionAda(this)\" onfocus=\"TurnTo.chooseCustomDimensionAdaFocus(this)\" onblur=\"TurnTo.chooseCustomDimensionAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTcustDim-',custDim.id,'-three\">Three out of five ',custDim.label,'</label>                            <input class=\"TThiddenForADA\" type=\"radio\" value=\"4\" name=\"TTcustDim-ADA-',custDim.id,'\" id=\"TTcustDim-',custDim.id,'-four\" onchange=\"TurnTo.chooseCustomDimensionAda(this)\" onfocus=\"TurnTo.chooseCustomDimensionAdaFocus(this)\" onblur=\"TurnTo.chooseCustomDimensionAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTcustDim-',custDim.id,'-four\">Four out of five ',custDim.label,'</label>                            <input class=\"TThiddenForADA\" type=\"radio\" value=\"5\" name=\"TTcustDim-ADA-',custDim.id,'\" id=\"TTcustDim-',custDim.id,'-five\" onchange=\"TurnTo.chooseCustomDimensionAda(this)\" onfocus=\"TurnTo.chooseCustomDimensionAdaFocus(this)\" onblur=\"TurnTo.chooseCustomDimensionAdaBlur(this)\"/><label class=\"TThiddenForADA\" for=\"TTcustDim-',custDim.id,'-five\">Five out of five ',custDim.label,'</label>                        '); } else if (custDim.type == 4 ) { p.push('                        <div id=\"TTcustDim-',custDim.id,'\" class=\"TTMultiSelectDimensionTable\">                            <div class=\"TTMultiSelectDimensionRow TTcustDim-',custDim.id,'-row\">                                '); for (var ii = 0; ii < dimValueDefs.length; ii++) {                                        var custDimValueDef = dimValueDefs[ii]; p.push('                                    <div class=\"TTMultiSelectDimensionColumn TTcustDim-',custDim.id,'-column\">                                        <div class=\"TTMultiSelectDimensionColumnLabel\"> <input type=\"checkbox\" name=\"TTcustDim-',custDim.id,'\" class=\"TTcustDim-',custDim.id,'\" value=\"',custDimValueDef.id,'\" aria-labelledby=\"TTcustDimLbl-',custDim.id,' TTcustDimLbl-',custDim.id,'-',ii,'\"/></div>                                        <div class=\"TTMultiSelectDimensionColumnValue\" id=\"TTcustDimLbl-',custDim.id,'-',ii,'\">',custDimValueDef.label,'</div>                                    </div>                                '); if( (ii+1)%3==0 ) { p.push('                                  </div><div class=\"TTMultiSelectDimensionRow TTcustDim-',custDim.id,'-row\">                                '); } p.push('                                '); } p.push('                            </div>                        </div>                        '); } else if (custDim.type == 2 || (custDim.type == 3 && dimValueDefs.length <= 3)) { p.push('                            <div id=\"TTcustDim-',custDim.id,'\">                                '); for (var ii = 0; ii < dimValueDefs.length; ii++) {                                var custDimValueDef = dimValueDefs[ii]; p.push('                                <label id=\"TTcustDimLbl-',custDim.id,'-',ii,'\">                                    <span class=\"TTcustDimRngCont\"><input type=\"radio\" name=\"TTcustDim-',custDim.id,'\" class=\"TTcustDim-',custDim.id,'\" value=\"',custDimValueDef.id,'\" aria-labelledby=\"TTcustDimLbl-',custDim.id,' TTcustDimLbl-',custDim.id,'-',ii,'\">&nbsp; ',custDimValueDef.label,'</span>                                    </label>                                '); } p.push('                            </div>                        '); } else { p.push('                        <select id=\"TTcustDim-',custDim.id,'\" aria-labelledby=\"TTcustDimLbl-',custDim.id,'\">                            <option value=\"\">',TurnTo.msg('tra.wrev.customDim.option.selectOne'),'</option>                            '); for (var ii = 0; ii < dimValueDefs.length; ii++) {                            var custDimValueDef = dimValueDefs[ii]; p.push('                            <option value=\"',custDimValueDef.id,'\">',custDimValueDef.label,'</option>                            '); } p.push('                        </select>                        '); } p.push('                    </div>                    <div class=\"TTclear\"></div>              </div>        '); } p.push('        <div class=\"TTwriteRevRow\">            <div class=\"TTwriteRevLeftCol\">                <div id=\"TTwriteRevTitleLbl\">',TurnTo.msg('tra.wrev.reviewTitle', [initData.reviewTitleMandatory ? requiredInd : '' ]),'</div>            </div>            <div class=\"TTresponsivePortraitClear\"></div>            <div class=\"TTwriteRevRightCol\">                <div><input aria-labelledby=\"TTwriteRevTitleLbl\" id=\"TTreviewTitle\" type=\"text\" class=\"TTdefaultInput\" onblur=\"TurnTo.inputLoseFocus(this)\" onfocus=\"TurnTo.inputFocus(this)\" value=\"',TurnTo.S.reviewTitleInstruction,'\" ttinputlabeltext=\"',TurnTo.S.reviewTitleInstruction,'\" /></div>            </div>            <div class=\"TTclear\"></div>        </div>        <div class=\"TTwriteRevRow\">            <div class=\"TTwriteRevLeftCol\">                <div id=\"TTwriteRevBodyLbl\">',TurnTo.msg('tra.wrev.reviewBody'),'</div>            </div>            <div class=\"TTresponsivePortraitClear\"></div>            <div class=\"TTwriteRevRightCol\">                <div><textarea id=\"TTreviewText\" aria-labelledby=\"TTwriteRevBodyLbl\" class=\"TTdefaultInput\" onblur=\"TurnTo.inputLoseFocus(this)\" onfocus=\"TurnTo.TT2reviewTextFocus(this)\" ttinputlabeltext=\"',TurnTo.S.reviewBodyInstruction,'\" >',TurnTo.S.reviewBodyInstruction,'</textarea></div>            </div>            <div class=\"TTclear\"></div>        </div>        '); var vcSettings = TurnTo.matchData.site.vcSettings;           if(vcSettings && vcSettings.activation && vcSettings.activation.review){ p.push('            <div class=\"TTwriteRevRow\">              <div class=\"TTwriteRevLeftCol\">                  <div>',TurnTo.msg('tra.wrev.attachMedia'),'</div>                  <div class=\"TTmediaSmallDesc\">',TurnTo.msg('tra.shareMedia.note.addFiles'),'</div>              </div>              <div class=\"TTresponsivePortraitClear\"></div>              <div class=\"TTwriteRevRightCol\">                  <div id=\"TTattachedMedia\" style=\"display:none\"></div>                  <div class=\"TTclear\"></div>                  <div id=\"TTwriteRevMediaSelectedLabel\" class=\"TTmediaSmallDesc\">                      <p id=\"TTwriteRevMediaCnts\" style=\"display:none\"></p>                  </div>                  <div class=\"TTclear\"></div>                  ', TurnToHTML.shareMediaBtns({mediaType: ''}) ,'              </div>              <div class=\"TTclear\"></div>            </div>        '); } p.push('    </div>    '); if ( (!initData.shopperProfile.shopperCityStateHidden && initData.shopperProfile.cityStateCollectDuringContentSubmit)            || (!initData.shopperProfile.shopperAgeRangeHidden && initData.shopperProfile.ageRangeCollectDuringContentSubmit)            || initData.profileAttrs.length > 0) { p.push('    <div id=\"TTwriteRevUserForm\">        '); if (!initData.shopperProfile.shopperCityStateHidden && initData.shopperProfile.cityStateCollectDuringContentSubmit) {             var userCountry = initData.user && initData.user.country ? initData.user.country : initData.shopperProfile.defaultShopperCountry;            if (userCountry == undefined || userCountry == '') {                userCountry = 'US';            }        p.push('        <div class=\"TTwriteRevRow\" ', initData.shopperProfile.defaultShopperCountry ? 'style=\"display:none;\"' : '' ,'>           <div class=\"TTwriteRevLeftCol\">               <div id=\"TTwriteRevCountryLbl\">',TurnTo.msg('tra.wrev.country', [initData.shopperProfile.cityStateRequired ? requiredInd : '']),'</div>           </div>           <div class=\"TTresponsivePortraitClear\"></div>           <div class=\"TTwriteRevRightCol\">               <select id=\"TTreviewCountry\" onchange=\"TurnTo.shopperProfileCountryChange(this);\" aria-labelledby=\"TTwriteRevCountryLbl\">                   '); for (var countryCd in initData.countries) {                       var country = initData.countries[countryCd]; p.push('                       <option value=\"', countryCd ,'\" ', userCountry == countryCd ? \"selected='selected'\" : '' ,'>', country ,'</option>                   '); } p.push('               </select>           </div>           <div class=\"TTclear\"></div>       </div>       <div class=\"TTwriteRevRow\">           <div class=\"TTwriteRevLeftCol\">               <div id=\"TTwriteRevCityLbl\">',TurnTo.msg('tra.wrev.city', [initData.shopperProfile.cityStateRequired ? requiredInd : '']),'</div>           </div>           <div class=\"TTresponsivePortraitClear\"></div>           <div class=\"TTwriteRevRightCol\">               <div><input id=\"TTcity\" type=\"text\" placeholder=\"',TurnTo.msg('tra.wrev.instruction.city'),'\" value=\"',initData.user ? initData.user.city : '','\" aria-labelledby=\"TTwriteRevCityLbl\"></div>           </div>           <div class=\"TTclear\"></div>       </div>       <div class=\"TTwriteRevRow\" id=\"TTstateUSdisplay\" ', (userCountry != '' && userCountry != 'US') ? 'style=\"display:none;\"' : '' ,'>            <div class=\"TTwriteRevLeftCol\">                <div id=\"TTwriteRevStateLbl\">',TurnTo.msg('tra.wrev.state', [initData.shopperProfile.cityStateRequired ? requiredInd : '']),'</div>            </div>            <div class=\"TTresponsivePortraitClear\"></div>            <div class=\"TTwriteRevRightCol\">                <select id=\"TTstateUS\" aria-labelledby=\"TTwriteRevStateLbl\">                    <option value=\"\"></option>                    '); for (var stateCd in initData.usStates) {                        var state = initData.usStates[stateCd]; p.push('                        <option value=\"', stateCd ,'\" ', initData.user && initData.user.state == stateCd ? \"selected='selected'\" : '' ,'>', state ,'</option>                    '); } p.push('                </select>            </div>            <div class=\"TTclear\"></div>        </div>        <div class=\"TTwriteRevRow\" id=\"TTstateCAdisplay\" ', userCountry != 'CA' ? 'style=\"display:none;\"' : '' ,'>            <div class=\"TTwriteRevLeftCol\">                <div id=\"TTwriteRevProvinceLbl\">',TurnTo.msg('tra.wrev.province', [initData.shopperProfile.cityStateRequired ? requiredInd : '']),'</div>            </div>            <div class=\"TTresponsivePortraitClear\"></div>            <div class=\"TTwriteRevRightCol\">                <select id=\"TTstateCA\" aria-labelledby=\"TTwriteRevProvinceLbl\">                    <option value=\"\"></option>                    '); for (var stateCd in initData.caStates) {                        var state = initData.caStates[stateCd]; p.push('                        <option value=\"', stateCd ,'\" ', initData.user && initData.user.state == stateCd ? \"selected='selected'\" : '' ,'>', state ,'</option>                    '); } p.push('                </select>            </div>            <div class=\"TTclear\"></div>        </div>        <div class=\"TTwriteRevRow\" id=\"TTstateOtherdisplay\" ', ( userCountry == '' || userCountry == 'US' || userCountry == 'CA') ? 'style=\"display:none;\"' : '' ,'>           <div class=\"TTwriteRevLeftCol\">               <div id=\"TTwriteRevOtherLbl\">',TurnTo.msg('tra.wrev.other', [initData.shopperProfile.cityStateRequired ? requiredInd : '']),'</div>           </div>           <div class=\"TTresponsivePortraitClear\"></div>           <div class=\"TTwriteRevRightCol\">               <div><input type=\"text\" id=\"TTstate\" placeholder=\"',TurnTo.msg('tra.wrev.instruction.state'),'\" value=\"',initData.user ? initData.user.state : '','\" aria-labelledby=\"TTwriteRevOtherLbl\"></div>           </div>           <div class=\"TTclear\"></div>       </div>       '); } p.push('       '); if (!initData.shopperProfile.shopperAgeRangeHidden && initData.shopperProfile.ageRangeCollectDuringContentSubmit) { p.push('       <div class=\"TTwriteRevRow\">           <div class=\"TTwriteRevLeftCol\">               <div id=\"TTwriteRevAgeLbl\">',TurnTo.msg('tra.wrev.age', [initData.shopperProfile.ageRangeRequired ? requiredInd : '']),'</div>           </div>           <div class=\"TTresponsivePortraitClear\"></div>           <div class=\"TTwriteRevRightCol\">               <select id=\"TTreviewAge\" aria-labelledby=\"TTwriteRevAgeLbl\">                   <option value=\"\"></option>                   <option value=\"0\" ',initData.user ? (initData.user.ageRange == '0' ? 'selected' : '' ) : '',' >',initData.ageRanges['0'],'</option>                   <option value=\"1\" ',initData.user ? (initData.user.ageRange == '1' ? 'selected' : '' ) : '',' >',initData.ageRanges['1'],'</option>                   <option value=\"2\" ',initData.user ? (initData.user.ageRange == '2' ? 'selected' : '' ) : '',' >',initData.ageRanges['2'],'</option>                   <option value=\"3\" ',initData.user ? (initData.user.ageRange == '3' ? 'selected' : '' ) : '',' >',initData.ageRanges['3'],'</option>               </select>           </div>           <div class=\"TTclear\"></div>       </div>       '); } p.push('       '); for (var i = 0; i < initData.profileAttrs.length; i++) {            var profileDimsSelected = initData.userSelections ? initData.userSelections : {};            if (initData.profileAttrs[i].type == 0 && initData.profileAttrs[i].collectDuringContentSubmit) {       p.push('       <div class=\"TTwriteRevRow\">           <div class=\"TTwriteRevLeftCol\">               <div><label for=\"TTprofileDim-',initData.profileAttrs[i].id,'\">',initData.profileAttrs[i].label,'',initData.profileAttrs[i].required ? requiredInd : '',':</label></div>           </div>           <div class=\"TTresponsivePortraitClear\"></div>           <div class=\"TTwriteRevRightCol\">               <select id=\"TTprofileDim-',initData.profileAttrs[i].id,'\" class=\"TTprofileDim\" data-id=\"',initData.profileAttrs[i].id,'\" data-oldvalue=\"',profileDimsSelected[initData.profileAttrs[i].id] ? profileDimsSelected[initData.profileAttrs[i].id].valDefId : '','\">                   <option value=\"\"></option>                   '); for (var j = 0; j < initData.profileAttrs[i].values.length; j++) {                        var selected = '';                        if (profileDimsSelected[initData.profileAttrs[i].id]) {                            if (profileDimsSelected[initData.profileAttrs[i].id].valDefId == initData.profileAttrs[i].values[j].id) {                                selected = 'selected';                            }                        }                   p.push('                   <option value=\"',initData.profileAttrs[i].values[j].id,'\" ',selected,'>',initData.profileAttrs[i].values[j].label,'</option>                   '); } p.push('               </select>           </div>           <div class=\"TTclear\"></div>       </div>       '); } else { p.push('       '); if (initData.profileAttrs[i].collectDuringContentSubmit) { p.push('       <div class=\"TTwriteRevRow\">           <div class=\"TTwriteRevLeftCol\">               <div><label for=\"TTprofileDim-',initData.profileAttrs[i].id,'\">',initData.profileAttrs[i].label,'',initData.profileAttrs[i].required ? requiredInd : '',':</label></div>           </div>           <div class=\"TTresponsivePortraitClear\"></div>           <div class=\"TTwriteRevRightCol\">               <textarea maxlength=\"50\" id=\"TTprofileDim-',initData.profileAttrs[i].id,'\" class=\"TTdefaultInput\" onblur=\"TurnTo.inputLoseFocus(this)\" onfocus=\"TurnTo.TT2reviewTextFocus(this)\" ttinputlabeltext=\"',profileDimsSelected[initData.profileAttrs[i].id] ? profileDimsSelected[initData.profileAttrs[i].id].freeformText : '','\">',profileDimsSelected[initData.profileAttrs[i].id] ? profileDimsSelected[initData.profileAttrs[i].id].freeformText : '','</textarea>           </div>           <div class=\"TTclear\"></div>       </div>       '); } } } p.push('    </div>    '); } p.push('    '); if (initData.showSweepstakesOptIn) { p.push('    <div class=\"TT3left TTwriteRevTallRow\">        <div id=\"TTsweepstakesOptIn\">            <input type=\"checkbox\" id=\"TTsweepstakesOptInChkBox\" name=\"TTsweepstakesOptIn\"/>            <label class=\"TTwriteRevPaddedLabel\" for=\"TTsweepstakesOptInChkBox\">',TurnTo.msg('tra.wrev.sweepstakes.optin'),'</label>        </div>    </div>    <div class=\"TTclear\"></div>    '); } p.push('    <div class=\"TT3left\">      <div id=\"TTsubmitReview\" class=\"TTbigSubmitBtn\" role=\"button\" aria-label=\"',TurnTo.msg('tra.wrev.submit'),'\" tabindex=\"0\"></div>      <img class=\"TTimgLoading\"         src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\"          alt=\"',TurnTo.msg('tra.commom.alt.loading'),'\"         style=\"display: none;\">      <a class=\"TTskipLink\" href=\"#\" style=\"display:none;\"rel=\"nofollow\">',TurnTo.msg('tra.common.button.skip'),'</a>    </div>    <div class=\"TTclear\"></div>    <div class=\"TT3left\">            <a id=\"TTwriteRevGuideLn\" class=\"TTrevGuidelineLink\" rel=\"nofollow\" tabindex=\"0\">',TurnTo.msg('tra.wrev.link.guidlines'),'</a>    </div></div>');}return p.join('');")};if(typeof TurnToBoot=="undefined"){TurnToBoot={};TurnToBoot.E={};TurnToBoot.getTurnToConfig=function(){var a=function(b){b=b||{};for(var d=1;d<arguments.length;d++){if(!arguments[d]){continue}for(var c in arguments[d]){if(arguments[d].hasOwnProperty(c)){b[c]=arguments[d][c]}}}return b};return a(turnToConfig,TurnToBoot.E)};TurnToBoot.a=function(){var d="static.www.turnto.com";var c={};c["static.www.turnto.com"]={host:"www.turnto.com",imageStoreBase:"wac.edgecastcdn.net/001A39/prod",locale:"en_US"};c["static.www.turnto.eu"]={host:"www.turnto.eu",imageStoreBase:"wac.edgecastcdn.net/005E122/eu1/prod",locale:"en_US"};var b=turnToConfig;TurnToBoot.E.staticHost=b.staticHost||d;var a=(c[b.staticHost])?b.staticHost:d;TurnToBoot.E.host=b.host||c[a].host;TurnToBoot.E.imageStoreBase=b.imageStoreBase||c[a].imageStoreBase;TurnToBoot.E.locale=b.locale||c[a].locale};TurnToBoot.a()};TurnToTrack={};TurnToTrack.init=function(){q();TurnToTrack.partnerProtocol=document.location.protocol;TurnToTrack.xhrIntervals=[];var e=TurnToBoot.getTurnToConfig();e.usesMixpanel=e.usesMixpanel||false;var m=(new Date()).getTime();TurnToTrack.baseEventUrl=ac("/webEvent/s.gif?siteKey="+e.siteKey+"&et=visit&e=500&cid="+m);TurnToTrack.onload=ad;TurnToTrack.visitTeaserShown=V;TurnToTrack.visitTeaserClick=b;TurnToTrack.visitEmbeddedReg=M;TurnToTrack.disableGlobal=af;TurnToTrack.makeVisitorPartsQS=u;TurnToTrack.newUserRegistration=j;TurnToTrack.isSiteVisitTrackingBlock=ae;TurnToTrack.blockSiteVisitTracking=r;TurnToTrack.unblockSiteVisitTracking=x;TurnToTrack.getSiteVisitId=F;TurnToTrack.visitSearchRun=L;TurnToTrack.visitFWItemClick=v;TurnToTrack.visitPBShown=E;TurnToTrack.visitPBItemClick=w;TurnToTrack.visitQAskedIRClicked=d;TurnToTrack.visitAnswerSubmitted=a;TurnToTrack.metrics;TurnToTrack.addErrorMetric=p;TurnToTrack.addCloseLinkMetrics=aa;TurnToTrack.identify=y;TurnToTrack.track=A;TurnToTrack.trackScreenExited=W;TurnToTrack.startAction="";var B="TURNTO_VISITOR_COOKIE";var T="TURNTO_VISITOR_SESSION";var n=0;var s=1;var J=2;var l=3;var U=4;var t=5;var N=6;var H=7;var i=8;var ab=9;var g=10;var Q=11;var R=12;var O=13;var Y="TURNTO_SITEVISIT_BLOCKED";var h=30;var C=true;TurnToTrack.getVisitorParts=K;function ad(){if(C){var ag=K();var S=(ag==null);ag=z(ag);if(S){I(ag)}c(ag)}if(TurnTo.S.sendExternalMetricsEnabled&&window.mixpanel){mixpanel.init(TurnTo.S.turntoMixpanelToken,{persistence:"localStorage"},TurnTo.S.turntoMixpanelLibname);TurnToTrack.metrics=mixpanel;k()}}function af(){C=false}function z(S){if(f(T)==null){o(T,1,-1);S=null}if(S==null){S=new Array(14);S[n]=Z();S[s]=0;S[J]=0;S[l]=0;S[U]=0;S[t]="";S[N]="";S[H]=0;S[i]=0;S[ab]=0;S[g]=0;S[Q]=0;S[R]=0;S[O]=0}if(S.length==8){S[i]=0;S[ab]=0;S[g]=0;S[Q]=0;S[R]=0;S[O]=0}return S}function b(S){var ah=K();ah=z(ah);if(ah[J]==0&&S=="g"){ah[J]=1;var ag=document.location+"";var ai=ag.indexOf("#");if(ai>0){ag=ag.substring(0,ai)}ah[t]=ag;I(ah)}else{if(ah[H]==0&&S=="a"){ah[H]=1;I(ah)}}c(ah)}function V(ah){var ag=K();ag=z(ag);var S=null;if(ag[s]==0){ag[s]=1;ag[U]=f("turnto_teaser_variant");if(ah){I(ag)}S=ag}c(ag);return S}function j(ag){var ah=K();ah=z(ah);var S=null;ah[N]=ag;I(ah);S=ah;c(ah);P();return S}function M(){var S=K();S=z(S);if(S[l]==0){S[l]=1;I(S)}c(S)}function L(){var S=K();S=z(S);if(S[i]==0){S[i]=1;I(S);c(S)}}function v(){var S=K();S=z(S);if(S[ab]==0){S[ab]=1;I(S);c(S)}}function E(){var S=K();S=z(S);if(S[g]==0){S[g]=1;I(S);c(S)}}function w(){var S=K();S=z(S);if(S[Q]==0){S[Q]=1;I(S);c(S)}}function d(){var S=K();S=z(S);if(S[R]==0){S[R]=1;I(S);c(S)}}function a(){var S=K();S=z(S);if(S[O]==0){S[O]=1;I(S);c(S)}}function F(){var S=z(K());return S[n]}function c(S){o(B,S[n]+","+S[s]+","+S[J]+","+S[l]+","+S[U]+","+S[t]+","+S[N]+","+S[H]+","+S[i]+","+S[ab]+","+S[g]+","+S[Q]+","+S[R]+","+S[O],h*60)}function I(S){if(ae()){return}D("&vid="+S[n]+"&vshown="+S[s]+"&vclick="+S[J]+"&vembeddedReg="+S[l]+"&variId="+S[U]+"&vclurl="+S[t]+"&vregId="+S[N]+"&vaclick="+S[H]+"&vsearch="+S[i]+"&vfwclick="+S[ab]+"&vpbshown="+S[g]+"&vpbclick="+S[Q]+"&vqaskircl="+S[R]+"&vanswr="+S[O])}function u(S){if(S==undefined){return""}if(ae()){return""}return"&vid="+S[n]+"&vshown="+S[s]+"&vclick="+S[J]+"&vembeddedReg="+S[l]+"&variId="+S[U]+"&vclurl="+S[t]+"&vregId="+S[N]+"&vaclick="+S[H]+"&vsearch="+S[i]+"&vfwclick="+S[ab]+"&vpbshown="+S[g]+"&vpbclick="+S[Q]+"&vqaskircl="+S[R]+"&vanswr="+S[O]}function K(){var S=f(B);if(S==null){return null}return S.split(",")}function ac(ah,ai){var S=e.urlPref||"";var ag=(ai)?"http:":TurnToTrack.partnerProtocol;return ag+"//"+e.host+S+ah}var X=0;function D(ag){var ai=document.createElement("img");ai.width="1";ai.width="1";ai.border="0";ai.style.position="absolute";ai.style.left="-100px";var ah=X++;ai.id="TTTrackEvent"+ah;document.body.appendChild(ai);var S=document.getElementById("TTTrackEvent"+ah);S.src=TurnToTrack.baseEventUrl+ag}function Z(){var ai="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var aj=15;var ah="";for(var ag=0;ag<aj;ag++){var S=Math.floor(Math.random()*ai.length);ah+=ai.substring(S,S+1)}return ah}function ae(){var S=f(Y);if(S==null){return false}if(S==1){return true}return false}function r(){o(Y,1,946080000)}function x(){o(Y)}function o(S,ai,ah){var ag=S+"=";if(typeof ai!="undefined"){ag+=ai+"; path=/";if(typeof ah!="undefined"){if(ah!=-1){var aj=new Date();aj.setTime(aj.getTime()+ah*1000);ag+="; Expires="+aj.toUTCString()}}}else{ag+="; path=/; Expires="+new Date(0).toUTCString()}document.cookie=ag}function f(S){var aj=null;var ah=document.cookie;var ai=ah.indexOf(S+"=");if(ai>=0){ai+=S.length+1;var ag=ah.indexOf(";",ai);if(ag==-1){ag=ah.length}aj=ah.substring(ai,ag)}return aj}function q(){var ah=(typeof window.console!="undefined");var ag=(ah&&("dirxml" in window.console));if(!ag){var ai=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];window.console={};for(var S=0;S<ai.length;++S){window.console[ai[S]]=function(){}}}}function P(){if(!TurnToTrack.metrics||!TurnTo.matchData.user.uIdents[0].ident){return}var S=G();TurnToTrack.metrics[TurnTo.S.turntoMixpanelLibname].alias(S.id);TurnToTrack.metrics[TurnTo.S.turntoMixpanelLibname].people.set(S)}function y(){if(!TurnToTrack.metrics){return}var S=G();TurnToTrack.metrics[TurnTo.S.turntoMixpanelLibname].identify(S.id);TurnToTrack.metrics[TurnTo.S.turntoMixpanelLibname].people.set(S)}function G(){var S={};S.id=TurnTo.matchData.user.uIdents[0].ident;S.$name=TurnTo.matchData.user.firstName+" "+TurnTo.matchData.user.lastName;S.$email=TurnTo.matchData.user.uIdents[0].ident;S.nickName=TurnTo.matchData.user.nickName;S.counts=TurnTo.matchData.counts;return S}function A(S,ag){if(!TurnToTrack.metrics){return}if(!ag){ag=[]}ag.startAction=TurnToTrack.startAction;TurnToTrack.metrics[TurnTo.S.turntoMixpanelLibname].track(S,ag)}var k=function(){if(!TurnToTrack.metrics){return}var S=TurnTo.matchData.site.vcSettings;TurnToTrack.metrics[TurnTo.S.turntoMixpanelLibname].register({onMobile:TurnTo.isMobile,reviewsSetupType:TurnTo.S.reviewsSetupType,reviewsEnabled:TurnTo.matchData.site.reviewsEnabled,setupType:TurnTo.S.setupType,siteId:TurnTo.matchData.site.siteId,siteVisitId:F(),traVersion:TurnTo.traVersion?TurnTo.traVersion:e.siteKey,user:TurnTo.matchData.user?TurnTo.matchData.user:"Anonymous",vcReviewsEnabled:(S&&S.activation&&S.activation.review)})};function p(S,ag){var ah=TurnTojQuery("#"+S).data();if(!("errorList" in ah)){ah.errorList=[]}ah.errorList.push(ag)}function W(S,ag,ah){var ai=TurnTojQuery("#"+S).data("errorList");if(!ai){ai=[]}if(!ah){ah=[]}ah.exitType=ag;ah.errors=ai;TurnToTrack.track(S+" Exited",ah)}function aa(S,ah){var ag=S.find(".TTleftHeader a");ag.data("currDiv",ah)}};TurnToTrack.init();TurnTojQuery(document).ready(TurnToTrack.onload);if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(N,d,p,K,k,H){var b=this;var n=Math.floor(Math.random()*10000);var q=Function.prototype;var Q=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/;var R=/[\-\w]+\/\.\.\//;var F=/([^:])\/\//g;var I="";var o={};var M=N.easyXDM;var U="easyXDM_";var E;var y=false;var i;var h;function C(X,Z){var Y=typeof X[Z];return Y=="function"||(!!(Y=="object"&&X[Z]))||Y=="unknown"}function u(X,Y){return !!(typeof(X[Y])=="object"&&X[Y])}function r(X){return Object.prototype.toString.call(X)==="[object Array]"}function c(){var Z="Shockwave Flash",ad="application/x-shockwave-flash";if(!t(navigator.plugins)&&typeof navigator.plugins[Z]=="object"){var ab=navigator.plugins[Z].description;if(ab&&!t(navigator.mimeTypes)&&navigator.mimeTypes[ad]&&navigator.mimeTypes[ad].enabledPlugin){i=ab.match(/\d+/g)}}if(!i){var Y;try{Y=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");i=Array.prototype.slice.call(Y.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1);Y=null}catch(ac){}}if(!i){return false}var X=parseInt(i[0],10),aa=parseInt(i[1],10);h=X>9&&aa>0;return true}var v,x;if(C(N,"addEventListener")){v=function(Z,X,Y){Z.addEventListener(X,Y,false)};x=function(Z,X,Y){Z.removeEventListener(X,Y,false)}}else{if(C(N,"attachEvent")){v=function(X,Z,Y){X.attachEvent("on"+Z,Y)};x=function(X,Z,Y){X.detachEvent("on"+Z,Y)}}else{throw new Error("Browser not supported")}}var W=false,J=[],L;if("readyState" in d){L=d.readyState;W=L=="complete"||(~navigator.userAgent.indexOf("AppleWebKit/")&&(L=="loaded"||L=="interactive"))}else{W=!!d.body}function s(){if(W){return}W=true;for(var X=0;X<J.length;X++){J[X]()}J.length=0}if(!W){if(C(N,"addEventListener")){v(d,"DOMContentLoaded",s)}else{v(d,"readystatechange",function(){if(d.readyState=="complete"){s()}});if(d.documentElement.doScroll&&N===top){var g=function(){if(W){return}try{d.documentElement.doScroll("left")}catch(X){K(g,1);return}s()};g()}}v(N,"load",s)}function G(Y,X){if(W){Y.call(X);return}J.push(function(){Y.call(X)})}function m(){var Z=parent;if(I!==""){for(var X=0,Y=I.split(".");X<Y.length;X++){Z=Z[Y[X]]}}return Z.easyXDM}function e(X){N.easyXDM=M;I=X;if(I){U="easyXDM_"+I.replace(".","_")+"_"}return o}function z(X){return X.match(Q)[3]}function f(X){return X.match(Q)[4]||""}function j(Z){var X=Z.toLowerCase().match(Q);var aa=X[2],ab=X[3],Y=X[4]||"";if((aa=="http:"&&Y==":80")||(aa=="https:"&&Y==":443")){Y=""}return aa+"//"+ab+Y}function B(X){X=X.replace(F,"$1/");if(!X.match(/^(http||https):\/\//)){var Y=(X.substring(0,1)==="/")?"":p.pathname;if(Y.substring(Y.length-1)!=="/"){Y=Y.substring(0,Y.lastIndexOf("/")+1)}X=p.protocol+"//"+p.host+Y+X}while(R.test(X)){X=X.replace(R,"")}return X}function P(X,aa){var ac="",Z=X.indexOf("#");if(Z!==-1){ac=X.substring(Z);X=X.substring(0,Z)}var ab=[];for(var Y in aa){if(aa.hasOwnProperty(Y)){ab.push(Y+"="+H(aa[Y]))}}return X+(y?"#":(X.indexOf("?")==-1?"?":"&"))+ab.join("&")+ac}var S=(function(X){X=X.substring(1).split("&");var Z={},aa,Y=X.length;while(Y--){aa=X[Y].split("=");Z[aa[0]]=k(aa[1])}return Z}(/xdm_e=/.test(p.search)?p.search:p.hash));function t(X){return typeof X==="undefined"}var O=function(){var Y={};var Z={a:[1,2,3]},X='{"a":[1,2,3]}';if(typeof JSON!="undefined"&&typeof JSON.stringify==="function"&&JSON.stringify(Z).replace((/\s/g),"")===X){return JSON}if(Object.toJSON){if(Object.toJSON(Z).replace((/\s/g),"")===X){Y.stringify=Object.toJSON}}if(typeof String.prototype.evalJSON==="function"){Z=X.evalJSON();if(Z.a&&Z.a.length===3&&Z.a[2]===3){Y.parse=function(aa){return aa.evalJSON()}}}if(Y.stringify&&Y.parse){O=function(){return Y};return Y}return null};function T(X,Y,Z){var ab;for(var aa in Y){if(Y.hasOwnProperty(aa)){if(aa in X){ab=Y[aa];if(typeof ab==="object"){T(X[aa],ab,Z)}else{if(!Z){X[aa]=Y[aa]}}}else{X[aa]=Y[aa]}}}return X}function a(){var Y=d.body.appendChild(d.createElement("form")),X=Y.appendChild(d.createElement("input"));X.name=U+"TEST"+n;E=X!==Y.elements[X.name];d.body.removeChild(Y)}function A(X){if(t(E)){a()}var Z;if(E){Z=d.createElement('<iframe name="'+X.props.name+'"/>')}else{Z=d.createElement("IFRAME");Z.name=X.props.name}Z.id=Z.name=X.props.name;delete X.props.name;if(X.onLoad){v(Z,"load",X.onLoad)}if(typeof X.container=="string"){X.container=d.getElementById(X.container)}T(Z.style,{position:"absolute",top:"-2000px",left:"0px"});if(!X.container){X.container=d.body}var Y=X.props.src;X.props.src="javascript:false";T(Z,X.props);Z.border=Z.frameBorder=0;Z.allowTransparency=true;X.container.appendChild(Z);Z.src=Y;X.props.src=Y;return Z}function V(aa,Z){if(typeof aa=="string"){aa=[aa]}var Y,X=aa.length;while(X--){Y=aa[X];Y=new RegExp(Y.substr(0,1)=="^"?Y:("^"+Y.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"));if(Y.test(Z)){return true}}return false}function l(Z){var ae=Z.protocol,Y;Z.isHost=Z.isHost||t(S.xdm_p);y=Z.hash||false;if(!Z.props){Z.props={}}if(!Z.isHost){Z.channel=S.xdm_c.replace(/["'<>\\]/g,"");Z.secret=S.xdm_s;Z.remote=S.xdm_e.replace(/["'<>\\]/g,"");ae=S.xdm_p;if(Z.acl&&!V(Z.acl,Z.remote)){throw new Error("Access denied for "+Z.remote)}}else{Z.remote=B(Z.remote);Z.channel=Z.channel||"default"+n++;Z.secret=Math.random().toString(16).substring(2);if(t(ae)){if(j(p.href)==j(Z.remote)){ae="4"}else{if(C(N,"postMessage")||C(d,"postMessage")){ae="1"}else{if(Z.swf&&C(N,"ActiveXObject")&&c()){ae="6"}else{if(navigator.product==="Gecko"&&"frameElement" in N&&navigator.userAgent.indexOf("WebKit")==-1){ae="5"}else{if(Z.remoteHelper){Z.remoteHelper=B(Z.remoteHelper);ae="2"}else{ae="0"}}}}}}}Z.protocol=ae;switch(ae){case"0":T(Z,{interval:100,delay:2000,useResize:true,useParent:false,usePolling:false},true);if(Z.isHost){if(!Z.local){var ac=p.protocol+"//"+p.host,X=d.body.getElementsByTagName("img"),ad;var aa=X.length;while(aa--){ad=X[aa];if(ad.src.substring(0,ac.length)===ac){Z.local=ad.src;break}}if(!Z.local){Z.local=N}}var ab={xdm_c:Z.channel,xdm_p:0};if(Z.local===N){Z.usePolling=true;Z.useParent=true;Z.local=p.protocol+"//"+p.host+p.pathname+p.search;ab.xdm_e=Z.local;ab.xdm_pa=1}else{ab.xdm_e=B(Z.local)}if(Z.container){Z.useResize=false;ab.xdm_po=1}Z.remote=P(Z.remote,ab)}else{T(Z,{channel:S.xdm_c,remote:S.xdm_e,useParent:!t(S.xdm_pa),usePolling:!t(S.xdm_po),useResize:Z.useParent?false:Z.useResize})}Y=[new o.stack.HashTransport(Z),new o.stack.ReliableBehavior({}),new o.stack.QueueBehavior({encode:true,maxLength:4000-Z.remote.length}),new o.stack.VerifyBehavior({initiate:Z.isHost})];break;case"1":Y=[new o.stack.PostMessageTransport(Z)];break;case"2":Y=[new o.stack.NameTransport(Z),new o.stack.QueueBehavior(),new o.stack.VerifyBehavior({initiate:Z.isHost})];break;case"3":Y=[new o.stack.NixTransport(Z)];break;case"4":Y=[new o.stack.SameOriginTransport(Z)];break;case"5":Y=[new o.stack.FrameElementTransport(Z)];break;case"6":if(!i){c()}Y=[new o.stack.FlashTransport(Z)];break}Y.push(new o.stack.QueueBehavior({lazy:Z.lazy,remove:true}));return Y}function D(aa){var ab,Z={incoming:function(ad,ac){this.up.incoming(ad,ac)},outgoing:function(ac,ad){this.down.outgoing(ac,ad)},callback:function(ac){this.up.callback(ac)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var Y=0,X=aa.length;Y<X;Y++){ab=aa[Y];T(ab,Z,true);if(Y!==0){ab.down=aa[Y-1]}if(Y!==X-1){ab.up=aa[Y+1]}}return ab}function w(X){X.up.down=X.down;X.down.up=X.up;X.up=X.down=null}T(o,{version:"2.4.15.0",query:S,stack:{},apply:T,getJSONObject:O,whenReady:G,noConflict:e});o.DomHelper={on:v,un:x,requiresJSON:function(X){if(!u(N,"JSON")){d.write('<script type="text/javascript" src="'+X+'"><\/script>')}}};(function(){var X={};o.Fn={set:function(Y,Z){X[Y]=Z},get:function(Z,Y){var aa=X[Z];if(Y){delete X[Z]}return aa}}}());o.Socket=function(Y){var X=D(l(Y).concat([{incoming:function(ab,aa){Y.onMessage(ab,aa)},callback:function(aa){if(Y.onReady){Y.onReady(aa)}}}])),Z=j(Y.remote);this.origin=j(Y.remote);this.destroy=function(){X.destroy()};this.postMessage=function(aa){X.outgoing(aa,Z)};X.init()};o.Rpc=function(Z,Y){if(Y.local){for(var ab in Y.local){if(Y.local.hasOwnProperty(ab)){var aa=Y.local[ab];if(typeof aa==="function"){Y.local[ab]={method:aa}}}}}var X=D(l(Z).concat([new o.stack.RpcBehavior(this,Y),{callback:function(ac){if(Z.onReady){Z.onReady(ac)}}}]));this.origin=j(Z.remote);this.destroy=function(){X.destroy()};X.init()};o.stack.SameOriginTransport=function(Y){var Z,ab,aa,X;return(Z={outgoing:function(ad,ae,ac){aa(ad);if(ac){ac()}},destroy:function(){if(ab){ab.parentNode.removeChild(ab);ab=null}},onDOMReady:function(){X=j(Y.remote);if(Y.isHost){T(Y.props,{src:P(Y.remote,{xdm_e:p.protocol+"//"+p.host+p.pathname,xdm_c:Y.channel,xdm_p:4}),name:U+Y.channel+"_provider"});ab=A(Y);o.Fn.set(Y.channel,function(ac){aa=ac;K(function(){Z.up.callback(true)},0);return function(ad){Z.up.incoming(ad,X)}})}else{aa=m().Fn.get(Y.channel,true)(function(ac){Z.up.incoming(ac,X)});K(function(){Z.up.callback(true)},0)}},init:function(){G(Z.onDOMReady,Z)}})};o.stack.FlashTransport=function(aa){var ac,X,ab,ad,Y,ae;function af(ah,ag){K(function(){ac.up.incoming(ah,ad)},0)}function Z(ah){var ag=aa.swf+"?host="+aa.isHost;var aj="easyXDM_swf_"+Math.floor(Math.random()*10000);o.Fn.set("flash_loaded"+ah.replace(/[\-.]/g,"_"),function(){o.stack.FlashTransport[ah].swf=Y=ae.firstChild;var ak=o.stack.FlashTransport[ah].queue;for(var al=0;al<ak.length;al++){ak[al]()}ak.length=0});if(aa.swfContainer){ae=(typeof aa.swfContainer=="string")?d.getElementById(aa.swfContainer):aa.swfContainer}else{ae=d.createElement("div");T(ae.style,h&&aa.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0});d.body.appendChild(ae)}var ai="callback=flash_loaded"+ah.replace(/[\-.]/g,"_")+"&proto="+b.location.protocol+"&domain="+z(b.location.href)+"&port="+f(b.location.href)+"&ns="+I;ae.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+aj+"' data='"+ag+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+ag+"'></param><param name='flashvars' value='"+ai+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+ai+"' allowScriptAccess='always' wmode='transparent' src='"+ag+"' height='1' width='1'></embed></object>"}return(ac={outgoing:function(ah,ai,ag){Y.postMessage(aa.channel,ah.toString());if(ag){ag()}},destroy:function(){try{Y.destroyChannel(aa.channel)}catch(ag){}Y=null;if(X){X.parentNode.removeChild(X);X=null}},onDOMReady:function(){ad=aa.remote;o.Fn.set("flash_"+aa.channel+"_init",function(){K(function(){ac.up.callback(true)})});o.Fn.set("flash_"+aa.channel+"_onMessage",af);aa.swf=B(aa.swf);var ah=z(aa.swf);var ag=function(){o.stack.FlashTransport[ah].init=true;Y=o.stack.FlashTransport[ah].swf;Y.createChannel(aa.channel,aa.secret,j(aa.remote),aa.isHost);if(aa.isHost){if(h&&aa.swfNoThrottle){T(aa.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"})}T(aa.props,{src:P(aa.remote,{xdm_e:j(p.href),xdm_c:aa.channel,xdm_p:6,xdm_s:aa.secret}),name:U+aa.channel+"_provider"});X=A(aa)}};if(o.stack.FlashTransport[ah]&&o.stack.FlashTransport[ah].init){ag()}else{if(!o.stack.FlashTransport[ah]){o.stack.FlashTransport[ah]={queue:[ag]};Z(ah)}else{o.stack.FlashTransport[ah].queue.push(ag)}}},init:function(){G(ac.onDOMReady,ac)}})};o.stack.PostMessageTransport=function(aa){var ac,ad,Y,Z;function X(ae){if(ae.origin){return j(ae.origin)}if(ae.uri){return j(ae.uri)}if(ae.domain){return p.protocol+"//"+ae.domain}throw"Unable to retrieve the origin of the event"}function ab(af){var ae=X(af);if(ae==Z&&af.data.substring(0,aa.channel.length+1)==aa.channel+" "){ac.up.incoming(af.data.substring(aa.channel.length+1),ae)}}return(ac={outgoing:function(af,ag,ae){Y.postMessage(aa.channel+" "+af,ag||Z);if(ae){ae()}},destroy:function(){x(N,"message",ab);if(ad){Y=null;ad.parentNode.removeChild(ad);ad=null}},onDOMReady:function(){Z=j(aa.remote);if(aa.isHost){var ae=function(af){if(af.data==aa.channel+"-ready"){Y=("postMessage" in ad.contentWindow)?ad.contentWindow:ad.contentWindow.document;x(N,"message",ae);v(N,"message",ab);K(function(){ac.up.callback(true)},0)}};v(N,"message",ae);T(aa.props,{src:P(aa.remote,{xdm_e:j(p.href),xdm_c:aa.channel,xdm_p:1}),name:U+aa.channel+"_provider"});ad=A(aa)}else{v(N,"message",ab);Y=("postMessage" in N.parent)?N.parent:N.parent.document;Y.postMessage(aa.channel+"-ready",Z);K(function(){ac.up.callback(true)},0)}},init:function(){G(ac.onDOMReady,ac)}})};o.stack.FrameElementTransport=function(Y){var Z,ab,aa,X;return(Z={outgoing:function(ad,ae,ac){aa.call(this,ad);if(ac){ac()}},destroy:function(){if(ab){ab.parentNode.removeChild(ab);ab=null}},onDOMReady:function(){X=j(Y.remote);if(Y.isHost){T(Y.props,{src:P(Y.remote,{xdm_e:j(p.href),xdm_c:Y.channel,xdm_p:5}),name:U+Y.channel+"_provider"});ab=A(Y);ab.fn=function(ac){delete ab.fn;aa=ac;K(function(){Z.up.callback(true)},0);return function(ad){Z.up.incoming(ad,X)}}}else{if(d.referrer&&j(d.referrer)!=S.xdm_e){N.top.location=S.xdm_e}aa=N.frameElement.fn(function(ac){Z.up.incoming(ac,X)});Z.up.callback(true)}},init:function(){G(Z.onDOMReady,Z)}})};o.stack.NameTransport=function(ab){var ac;var ae,ai,aa,ag,ah,Y,X;function af(al){var ak=ab.remoteHelper+(ae?"#_3":"#_2")+ab.channel;ai.contentWindow.sendMessage(al,ak)}function ad(){if(ae){if(++ag===2||!ae){ac.up.callback(true)}}else{af("ready");ac.up.callback(true)}}function aj(ak){ac.up.incoming(ak,Y)}function Z(){if(ah){K(function(){ah(true)},0)}}return(ac={outgoing:function(al,am,ak){ah=ak;af(al)},destroy:function(){ai.parentNode.removeChild(ai);ai=null;if(ae){aa.parentNode.removeChild(aa);aa=null}},onDOMReady:function(){ae=ab.isHost;ag=0;Y=j(ab.remote);ab.local=B(ab.local);if(ae){o.Fn.set(ab.channel,function(al){if(ae&&al==="ready"){o.Fn.set(ab.channel,aj);ad()}});X=P(ab.remote,{xdm_e:ab.local,xdm_c:ab.channel,xdm_p:2});T(ab.props,{src:X+"#"+ab.channel,name:U+ab.channel+"_provider"});aa=A(ab)}else{ab.remoteHelper=ab.remote;o.Fn.set(ab.channel,aj)}var ak=function(){var al=ai||this;x(al,"load",ak);o.Fn.set(ab.channel+"_load",Z);(function am(){if(typeof al.contentWindow.sendMessage=="function"){ad()}else{K(am,50)}}())};ai=A({props:{src:ab.local+"#_4"+ab.channel},onLoad:ak})},init:function(){G(ac.onDOMReady,ac)}})};o.stack.HashTransport=function(Z){var ac;var ah=this,af,aa,X,ad,am,ab,al;var ag,Y;function ak(ao){if(!al){return}var an=Z.remote+"#"+(am++)+"_"+ao;((af||!ag)?al.contentWindow:al).location=an}function ae(an){ad=an;ac.up.incoming(ad.substring(ad.indexOf("_")+1),Y)}function aj(){if(!ab){return}var an=ab.location.href,ap="",ao=an.indexOf("#");if(ao!=-1){ap=an.substring(ao)}if(ap&&ap!=ad){ae(ap)}}function ai(){aa=setInterval(aj,X)}return(ac={outgoing:function(an,ao){ak(an)},destroy:function(){N.clearInterval(aa);if(af||!ag){al.parentNode.removeChild(al)}al=null},onDOMReady:function(){af=Z.isHost;X=Z.interval;ad="#"+Z.channel;am=0;ag=Z.useParent;Y=j(Z.remote);if(af){T(Z.props,{src:Z.remote,name:U+Z.channel+"_provider"});if(ag){Z.onLoad=function(){ab=N;ai();ac.up.callback(true)}}else{var ap=0,an=Z.delay/50;(function ao(){if(++ap>an){throw new Error("Unable to reference listenerwindow")}try{ab=al.contentWindow.frames[U+Z.channel+"_consumer"]}catch(aq){}if(ab){ai();ac.up.callback(true)}else{K(ao,50)}}())}al=A(Z)}else{ab=N;ai();if(ag){al=parent;ac.up.callback(true)}else{T(Z,{props:{src:Z.remote+"#"+Z.channel+new Date(),name:U+Z.channel+"_consumer"},onLoad:function(){ac.up.callback(true)}});al=A(Z)}}},init:function(){G(ac.onDOMReady,ac)}})};o.stack.ReliableBehavior=function(Y){var aa,ac;var ab=0,X=0,Z="";return(aa={incoming:function(af,ad){var ae=af.indexOf("_"),ag=af.substring(0,ae).split(",");af=af.substring(ae+1);if(ag[0]==ab){Z="";if(ac){ac(true)}}if(af.length>0){aa.down.outgoing(ag[1]+","+ab+"_"+Z,ad);if(X!=ag[1]){X=ag[1];aa.up.incoming(af,ad)}}},outgoing:function(af,ad,ae){Z=af;ac=ae;aa.down.outgoing(X+","+(++ab)+"_"+af,ad)}})};o.stack.QueueBehavior=function(Z){var ac,ad=[],ag=true,aa="",af,X=0,Y=false,ab=false;function ae(){if(Z.remove&&ad.length===0){w(ac);return}if(ag||ad.length===0||af){return}ag=true;var ah=ad.shift();ac.down.outgoing(ah.data,ah.origin,function(ai){ag=false;if(ah.callback){K(function(){ah.callback(ai)},0)}ae()})}return(ac={init:function(){if(t(Z)){Z={}}if(Z.maxLength){X=Z.maxLength;ab=true}if(Z.lazy){Y=true}else{ac.down.init()}},callback:function(ai){ag=false;var ah=ac.up;ae();ah.callback(ai)},incoming:function(ak,ai){if(ab){var aj=ak.indexOf("_"),ah=parseInt(ak.substring(0,aj),10);aa+=ak.substring(aj+1);if(ah===0){if(Z.encode){aa=k(aa)}ac.up.incoming(aa,ai);aa=""}}else{ac.up.incoming(ak,ai)}},outgoing:function(al,ai,ak){if(Z.encode){al=H(al)}var ah=[],aj;if(ab){while(al.length!==0){aj=al.substring(0,X);al=al.substring(aj.length);ah.push(aj)}while((aj=ah.shift())){ad.push({data:ah.length+"_"+aj,origin:ai,callback:ah.length===0?ak:null})}}else{ad.push({data:al,origin:ai,callback:ak})}if(Y){ac.down.init()}else{ae()}},destroy:function(){af=true;ac.down.destroy()}})};o.stack.VerifyBehavior=function(ab){var ac,aa,Y,Z=false;function X(){aa=Math.random().toString(16).substring(2);ac.down.outgoing(aa)}return(ac={incoming:function(af,ad){var ae=af.indexOf("_");if(ae===-1){if(af===aa){ac.up.callback(true)}else{if(!Y){Y=af;if(!ab.initiate){X()}ac.down.outgoing(af)}}}else{if(af.substring(0,ae)===Y){ac.up.incoming(af.substring(ae+1),ad)}}},outgoing:function(af,ad,ae){ac.down.outgoing(aa+"_"+af,ad,ae)},callback:function(ad){if(ab.initiate){X()}}})};o.stack.RpcBehavior=function(ad,Y){var aa,af=Y.serializer||O();var ae=0,ac={};function X(ag){ag.jsonrpc="2.0";aa.down.outgoing(af.stringify(ag))}function ab(ag,ai){var ah=Array.prototype.slice;return function(){var aj=arguments.length,al,ak={method:ai};if(aj>0&&typeof arguments[aj-1]==="function"){if(aj>1&&typeof arguments[aj-2]==="function"){al={success:arguments[aj-2],error:arguments[aj-1]};ak.params=ah.call(arguments,0,aj-2)}else{al={success:arguments[aj-1]};ak.params=ah.call(arguments,0,aj-1)}ac[""+(++ae)]=al;ak.id=ae}else{ak.params=ah.call(arguments,0)}if(ag.namedParams&&ak.params.length===1){ak.params=ak.params[0]}X(ak)}}function Z(an,am,ai,al){if(!ai){if(am){X({id:am,error:{code:-32601,message:"Procedure not found."}})}return}var ak,ah;if(am){ak=function(ao){ak=q;X({id:am,result:ao})};ah=function(ao,ap){ah=q;var aq={id:am,error:{code:-32099,message:ao}};if(ap){aq.error.data=ap}X(aq)}}else{ak=ah=q}if(!r(al)){al=[al]}try{var ag=ai.method.apply(ai.scope,al.concat([ak,ah]));if(!t(ag)){ak(ag)}}catch(aj){ah(aj.message)}}return(aa={incoming:function(ah,ag){var ai=af.parse(ah);if(ai.method){if(Y.handle){Y.handle(ai,X)}else{Z(ai.method,ai.id,Y.local[ai.method],ai.params)}}else{var aj=ac[ai.id];if(ai.error){if(aj.error){aj.error(ai.error)}}else{if(aj.success){aj.success(ai.result)}}delete ac[ai.id]}},init:function(){if(Y.remote){for(var ag in Y.remote){if(Y.remote.hasOwnProperty(ag)){ad[ag]=ab(Y.remote[ag],ag)}}}aa.down.init()},destroy:function(){for(var ag in Y.remote){if(Y.remote.hasOwnProperty(ag)&&ad.hasOwnProperty(ag)){delete ad[ag]}}aa.down.destroy()}})};b.easyXDM=o})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);if(typeof TurnToMods=="undefined"){TurnToMods={};(function(){var h={};var e={};TurnToMods.mods=h;TurnToMods.define=function(m,a,c){if(h[m]){return}if(a.length>0){var b=[];var n=0;function d(l,k){var q=-1;for(var j=0;j<a.length;j++){if(l==a[j]){q=j;break}}b[q]=k;if(++n>=a.length){g(m,c,b)}}for(var i=0;i<a.length;i++){f(a[i],d)}}else{g(m,c)}};TurnToMods.load=function(a){if(h[a]){return}TurnTojQuery.ajax({url:"//"+TurnTo.S.staticHost+"/tra4_3/"+(TurnTo.S.devMode?"src/modules/":"modules/")+a+".js",dataType:"script",cache:true})};function f(b,a){if(h[b]){a(b,h[b])}else{if(e[b]){e[b].push(a)}else{e[b]=[a]}}}function g(d,b,a){if(a){h[d]=b.apply(null,a)}else{h[d]=b()}if(e[d]){for(var c=0;c<e[d].length;c++){e[d][c](d,h[d])}delete e[d]}}})()};TurnToMods.define("browserUtil",[],function(){var u=TurnToBoot.getTurnToConfig();var m=navigator.userAgent.toLowerCase(),v=o("windows"),w=!v&&o("iphone"),s=o("ipod"),t=o("ipad"),q=w||s||t,r=o("gsa")&&q;function o(a){return m.indexOf(a)!==-1}function x(){if(u.forceMobile){return true}var a=navigator.userAgent;if(a&&a.match(/iPad/i)!=null){return false}if(screen.width<=736){return true}else{if(screen.width<=1280&&Math.abs(window.orientation)==90){return true}else{if(screen.width==1080&&screen.height==1920&&window.orientation==0){return true}else{if(screen.width==1920&&screen.height==1080&&Math.abs(window.orientation)==90){return true}}}}return false}function p(a){var b=null;var d=document.cookie;var c=d.indexOf(a+"=");if(c>=0){c+=a.length+1;var e=d.indexOf(";",c);if(e==-1){e=d.length}b=d.substring(c,e)}return b}function n(a,c,d){var e=a+"=";if(typeof c!="undefined"){e+=c+"; path=/";if(typeof d!="undefined"){if(d!=-1){var b=new Date();b.setTime(b.getTime()+d*1000);e+="; Expires="+b.toUTCString()}}}else{e+="; path=/; Expires="+new Date(0).toUTCString()}document.cookie=e}return{getCookie:p,setCookie:n,isIOS:q,isIPhone:w,isWindows:v,isGSA:r,isMobileDevice:x}});TurnToMods.define("msg",[],function(){var x=TurnToBoot.getTurnToConfig();x.locale=x.locale||"en_US";x.pluralRule=t();var i=[];for(var v=0;v<10;v++){i[v]=new RegExp("\\{"+v+"\\}")}function C(b,d){d=d||[];var a=TurnToMessageProps[b];if(!a){return"<?"+b+"?>"}for(var c=0;c<d.length;c++){a=a.replace(i[c],d[c])}return a}function z(a){console.log("getPlural"+a);console.log("S.pluralRule:"+x.pluralRule);switch(x.pluralRule){case 0:return q();case 1:return r(a);case 2:return s(a);case 3:return u(a);case 6:return w(a);case 7:return y(a);case 8:return A(a);case 9:return B(a);case 10:return D(a);default:return q()}if(x.locale.indexOf("en")===0||x.locale.indexOf("de")===0){return a===1?"one":"other"}else{if(x.locale.indexOf("fr")===0){return a===1||a===0?"one":"other"}}return"other"}function q(){return"other"}function r(a){return a===1?"one":"other"}function s(a){if(a===0||a===1){return"one"}return"other"}function u(b){var c=b%10;var a=b%100;if(c==1&&a!=11){return"one"}if(c==0||(11<=a<=19)){return"other"}return"few"}function w(b){var c=b%10;var a=b%100;if(c==1&&a!=11){return"one"}if(c==0||(11<=a<=19)){return"other"}return"few"}function y(b){var c=b%10;var a=b%100;if(c===1&&a!==11){return"one"}if((c===2&&a!==12)||(c===3&&a!==13)||(c===4&&a!==14)){return"few"}return"many"}function A(b){var a=b%10;if(a===1){return"one"}if(a===2||a===3||a===4){return"few"}return"other"}function B(b){var c=b%10;var a=b%100;if(b===1){return"one"}if((c===2&&a!==12)||(c===3&&a!==13)||(c===4&&a!==14)){return"few"}return"many"}function D(b){var a=b%100;if(a==1){return"one"}if(a==2){return"many"}if(a==3||a==4){return"few"}return"other"}function t(){var a=x.locale.substring(0,2);console.log("getPluralRule: "+a);switch(a){case"ja":case"ko":case"th":case"tr":case"zh":case"in":return 0;case"bg":case"ca":case"da":case"de":case"el":case"en":case"es":case"et":case"fi":case"it":case"hu":case"nl":case"pt":case"sv":if(x.locale=="pt_BR"){return 2}return 1;case"fr":return 2;case"lv":return 3;case"lt":return 6;case"hr":case"ro":case"ru":return 7;case"cs":case"sk":return 8;case"pl":return 9;case"sl":return 10;default:return 1}}return{msg:C,getPlural:z}});TurnToMods.define("util",[],function(){function e(a){return a.charAt(0).toUpperCase()+a.substring(1)}function f(a){return a.search(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/im)!=-1}function h(a){return a.search(/1?\W*([2-9][0-8][0-9])\W*([2-9][0-9]{2})\W*([0-9]{4})(\se?x?t?(\d*))?/)!=-1}function g(a,d){if(!a){return a}var b=d.split(".");var c=a[b[0]];if(!c||b.length===1){return c}b.shift();return g(c,b.join("."))}return{containsEmail:f,containsPhoneNumber:h,capitalize:e,safeGet:g}});TurnTo.init=function(){TurnToTrack.disableGlobal();checkFirebug();TurnTo.partnerProtocol=document.location.protocol;TurnTo.xhrIntervals=[];var S=TurnToBoot.getTurnToConfig();TurnTo.S=S;S.traTopOffset=S.traTopOffset||"6";S.setupType=S.setupType||"overlay";S.reviewsSetupType=S.reviewsSetupType||"overlay";var clientEvents=null;if(S.eventHandlers){clientEvents={};clientEvents.teaserClick=typeof(S.eventHandlers.teaserClick)==="function"?function(){yieldToUI(S.eventHandlers.teaserClick)}:null;clientEvents.instantClick=typeof(S.eventHandlers.instantClick)==="function"?function(){yieldToUI(S.eventHandlers.instantClick)}:null;clientEvents.questionSubmit=typeof(S.eventHandlers.questionSubmit)==="function"?function(evt){yieldToUI(S.eventHandlers.questionSubmit,evt)}:null;clientEvents.answerSubmit=typeof(S.eventHandlers.answerSubmit)==="function"?function(evt){yieldToUI(S.eventHandlers.answerSubmit,evt)}:null;clientEvents.reviewSubmit=typeof(S.eventHandlers.reviewSubmit)==="function"?function(evt){yieldToUI(S.eventHandlers.reviewSubmit,evt)}:null;clientEvents.chatterSubmit=typeof(S.eventHandlers.chatterSubmit)==="function"?function(evt){yieldToUI(S.eventHandlers.chatterSubmit,evt)}:null;clientEvents.questionTeaserRender=typeof(S.eventHandlers.questionTeaserRender)==="function"?function(){yieldToUI(S.eventHandlers.questionTeaserRender)}:null;clientEvents.reviewsTeaserRender=typeof(S.eventHandlers.reviewsTeaserRender)==="function"?function(){yieldToUI(S.eventHandlers.reviewsTeaserRender)}:null}var msg=TurnToMods.mods.msg.msg;TurnTo.msg=msg;var getPlural=TurnToMods.mods.msg.getPlural;TurnTo.getPlural=getPlural;S.questionHeader=S.questionHeader||"Get answers from owners, experts and our FAQs";S.ppcHeader=S.ppcHeader||msg("tra.pp.header.helpShoppers");S.pswHeader=S.pswHeader||"please help make our store a friendly place to shop.  When your friends are looking for advice, can we allow them to see you have shopped here?";S.pswHeaderInfoBox=S.pswHeaderInfoBox||"When your friends shop here, if they upload a friends list that includes you (for example, from Facebook), they&#39ll be able to see that you shop here, too, and what you bought. That way, if they have questions about us or our products, they&#39ll know you are someone they can turn to for trusted advice.";S.askStaffQuestFor=S.askStaffQuestFor||"My question is about:";S.questionDefaultText=S.questionDefaultText||(S.setupType=="overlay"?"Type in your question. We'll look for answers.":msg("tra.qa.askArea.haveQuestion"));S.questionDefaultTextMobileAndNarrow=S.questionDefaultTextMobileAndNarrow||msg("tra.qa.askArea.haveQuestion.mobile");S.customerQaLabel=S.customerQaLabel||msg("tra.soloQ.customerQaLabel");S.inputTeaserHeader=S.inputTeaserHeader||msg("tra.qaTeaser.header.inputTeaser");S.inputTeaserSubHeader=S.inputTeaserSubHeader||"";S.iTeaserFunc=S.iTeaserFunc||defaultItemTeaserDisplay;S.itemInputTeaserFunc=S.itemInputTeaserFunc||defaultItemInputTeaserFunc;S.reviewsTeaserFunc=S.reviewsTeaserFunc||defaultReviewsItemTeaserFunc;S.log2TxtAreaFunc=S.log2TxtAreaFunc||function(){};S.loadRteaserAfterChatter=S.loadRteaserAfterChatter||false;S.viewEmbedUgcFromEmailFunc=S.viewEmbedUgcFromEmailFunc||null;S.customChatterFunc=S.customChatterFunc||null;S.siteType=S.siteType||1;S.regOnly=S.regOnly||false;S.fbOpen=S.fbOpen||false;S.useFlashXHR=S.useFlashXHR||(typeof TurnToUseFlashXhr!="undefined");S.showGteaser=S.showGteaser||false;S.useFirstPartyCookies=S.useFlashXHR;S.eventPartnerData=S.eventPartnerData||"";S.pointEvents=S.pointEvents||false;if(S.pointEvents&&typeof S.pointEvents.allowAnonymous=="undefined"){S.pointEvents.allowAnonymous=true}TurnTo.friendsUrl="/myConnections";TurnTo.registerUrl=getUrl("/trackin/trajn?siteKey="+S.siteKey,true);if(!S.ttClientUrl){S.ttClientUrl=TurnTo.partnerProtocol+"//"+document.location.host+"/tra/tt_client.html"}else{S.ttClientUrl=TurnTo.partnerProtocol+"//"+document.location.host+S.ttClientUrl}S.updateCookieName=S.updateCookieName||"TTupd";S.authCookieName=S.authCookieName||"TTauth";S.sessionCookieName=S.sessionCookieName||"TTsess";S.thirdBlockedCookieName=S.thirdBlockedCookieName||"TT3bl";S.fbconnectCookieName="TTfbc";S.dialogPosition=S.dialogPosition||["center",100];S.popupOptions=S.popupOptions||"width=760,height=400,location=yes";S.popupName=S.popupName||"TTlogin";S.matchesHeight=S.matchesHeight||450;S.useSSL=(typeof S.useSSL=="undefined")||S.useSSL;S.noProfiles=S.noProfiles||false;S.qPaginateInitial=S.paginationQuestionsShownInitially||10;if(TurnTo.matchData.site.questionsPageSize&&(S.qPaginateInitial>TurnTo.matchData.site.questionsPageSize)){S.qPaginateInitial=TurnTo.matchData.site.questionsPageSize}S.qPaginateExpand=S.paginationQuestionsShownOnExpand||20;if(TurnTo.matchData.site.questionsPageSize&&(S.qPaginateExpand>TurnTo.matchData.site.questionsPageSize)){S.qPaginateExpand=TurnTo.matchData.site.questionsPageSize}S.qPaginateSimilarQCnt=S.paginationInitSimilarQsShown||2;if(TurnTo.matchData.site.relatedQuestionsPageSize&&(S.qPaginateSimilarQCnt>TurnTo.matchData.site.relatedQuestionsPageSize)){S.qPaginateSimilarQCnt=TurnTo.matchData.site.relatedQuestionsPageSize}S.qPaginateSimilarExpand=S.paginationSimilarQsShownOnExpand||10;if(TurnTo.matchData.site.relatedQuestionsPageSize&&(S.qPaginateSimilarExpand>TurnTo.matchData.site.relatedQuestionsPageSize)){S.qPaginateSimilarExpand=TurnTo.matchData.site.relatedQuestionsPageSize}S.rPaginateInitial=S.paginationReviewsShownInitially||10;if(TurnTo.matchData.site.reviewsPageSize&&(S.rPaginateInitial>TurnTo.matchData.site.reviewsPageSize)){S.rPaginateInitial=TurnTo.matchData.site.reviewsPageSize}S.rPaginateExpand=S.paginationReviewsShownOnExpand||20;if(TurnTo.matchData.site.reviewsPageSize&&(S.rPaginateExpand>TurnTo.matchData.site.reviewsPageSize)){S.rPaginateExpand=TurnTo.matchData.site.reviewsPageSize}S.rrPaginateInitial=S.paginationRelatedReviewsShownInitially||10;if(TurnTo.matchData.site.relatedReviewsPageSize&&(S.rrPaginateInitial>TurnTo.matchData.site.relatedReviewsPageSize)){S.rrPaginateInitial=TurnTo.matchData.site.relatedReviewsPageSize}S.rrPaginateExpand=S.paginationRelatedReviewsShownOnExpand||10;if(TurnTo.matchData.site.relatedReviewsPageSize&&(S.rrPaginateExpand>TurnTo.matchData.site.relatedReviewsPageSize)){S.rrPaginateExpand=TurnTo.matchData.site.relatedReviewsPageSize}S.rReviewsTruncateLineLength=S.reviewsTruncateLineLength||4;S.sendExternalMetricsEnabled=TurnTo.matchData.site.sendExternalMetricsEnabled;if(S.sendExternalMetricsEnabled){S.turntoMixpanelToken=TurnTo.matchData.site.turntoMixpanelToken;S.turntoMixpanelLibname=TurnTo.matchData.site.turntoMixpanelLibname}S.traSkipTurntodoneInLocation=TurnTo.matchData.site.traSkipTurntodoneInLocation;S.instantAnswers=true;S.iaExpandCnt=S.instantAnswersPagination||5;S.paginateCommentCapture=(S.paginateCommentCapture&&S.embedCommentCapture)||false;S.recentComments=S.recentComments||false;if(S.recentComments){S.recentComments.whatsThisTooltipText=S.recentComments.whatsThisTooltipText||msg("tra.chatter.whatsThisToolTip");S.recentComments.frequency=S.recentComments.frequency||"low";S.recentComments.timeWindowInHours=S.recentComments.timeWindowInHours||48;S.recentComments.commentMinLength=S.recentComments.commentMinLength||-1;S.recentComments.limit=S.recentComments.limit||100;S.recentComments.header=S.recentComments.header||msg("tra.chatter.header.recentComments")}S.fullComments=S.fullComments||false;if(S.fullComments){S.fullComments.headerText=S.fullComments.headerText||msg("tra.chatter.header.fullComments");S.fullComments.layoutMode=S.fullComments.layoutMode||"centered";S.fullComments.limit=S.fullComments.limit||20;S.fullComments.boxWidth=S.fullComments.boxWidth||"215px";S.fullComments.maxCommentsPerBox=S.fullComments.maxCommentsPerBox||5;S.fullComments.maxDaysOld=S.fullComments.maxDaysOld||30}S.teaserClickFunction=S.teaserClickFunction||false;S.instructCopy=S.instructionalCopyEnabled==null?true:S.instructionalCopyEnabled;S.hideBestAnswer=S.hideBestAnswer||false;S.instantAnswerNoResultsMsg=S.instantAnswerNoResultsMsg||msg("tra.instantAnsResults.noResults");S.instantAnswerOpenedMsg=S.instantAnswerOpenedMsg||msg("tra.instantAnsResults.notWhatLookingFor");S.submitQuestionReviewMsg=S.submitQuestionReviewMsg||msg("tra.qa.askArea.message.reviewQuestion");S.answerVoteHelpText=S.answerVoteHelpText||"Vote for the best answer";S.visualContentTermsOfUse=S.visualContentTermsOfUse||msg("tra.shareMedia.termsOfUse");S.visualContentSharePrompt=S.visualContentSharePrompt||msg("tra.shareMedia.prompt");S.visualContentSharePromptForReview=S.visualContentSharePromptForReview||msg("tra.shareMedia.prompt.review");S.visualContentSharePromptForReviewAfterRateItOnMobile=S.visualContentSharePromptForReviewAfterRateItOnMobile||msg("tra.shareMedia.prompt.review.after.rateIt");S.visualContentPlaceholderForCaption=S.visualContentPlaceholderForCaption||msg("tra.shareMedia.placeholder.caption");S.visualContentRateItPromptForRatingWhenPurchaseRequired=S.visualContentRateItPromptForRatingWhenPurchaseRequired||msg("tra.rateIt.prompt.rateIt.purchaseRequired");S.visualContentRateItPromptForRatingWhenPurchaseNotRequired=S.visualContentRateItPromptForRatingWhenPurchaseNotRequired||msg("tra.rateIt.prompt.rateIt.purchaseNotRequired");S.visualContentRateItPromptForRatingAfterShare=S.visualContentRateItPromptForRatingAfterShare||msg("tra.rateIt.prompt.shareAPhoto");S.visualContentCaptionsPrompt=S.visualContentCaptionsPrompt||msg("tra.shareMedia.prompt.addCaption");S.visualContentCaptionsPromptWhenNoneEditable=S.visualContentCaptionsPromptWhenNoneEditable||msg("tra.shareMedia.prompt.reviewSubmission");S.visualContentPlaceholderForRateItOverallImpression=S.visualContentPlaceholderForRateItOverallImpression||msg("tra.rateIt.title.placeholder");S.visualContentRateItPlaceholderForFullReview=S.visualContentRateItPlaceholderForFullReview||msg("tra.rateIt.reviewBody.placeholder",[TurnTo.matchData.site.reviewsMinLength]);S.visualContentRateItPlaceholderForFullReview=S.visualContentRateItPlaceholderForFullReview.replace("{0}",TurnTo.matchData.site.reviewsMinLength);S.visualContentDoMorePromptAfterSubmission=S.visualContentDoMorePromptAfterSubmission||msg("tra.moreFeedback.prompt.shareMore.afterSubmission");S.visualContentDoMorePromptAfterSubmissionWhenNothingMore=S.visualContentDoMorePromptAfterSubmissionWhenNothingMore||msg("tra.moreFeedback.prompt.noShare.afterSubmission");S.visualContentDoMorePromptAfterAlreadyReceivedSubmission=S.visualContentDoMorePromptAfterAlreadyReceivedSubmission||msg("tra.moreFeedback.prompt.shareMore.afterSubmission.alreadyReviewed");S.visualContentDoMorePromptAfterAlreadyReceivedSubmissionWhenNothingMore=S.visualContentDoMorePromptAfterAlreadyReceivedSubmissionWhenNothingMore||msg("tra.wrev.message.alreadyReviewed");S.visualContentDoMorePrompt=S.visualContentDoMorePrompt||msg("tra.moreFeedback.prompt.shareMore");S.visualContentDoMorePromptWhenNothingMore=S.visualContentDoMorePromptWhenNothingMore||msg("tra.moreFeedback.prompt.noShare");S.dynamicEmbeded=S.setupType=="dynamicEmbed";S.dynamicEmbededReviews=S.reviewsSetupType=="dynamicEmbed";S.fromEmbed=S.dynamicEmbeded&&S.dynamicEmbededReviews;if(S.setupType=="overlay"&&S.reviewsSetupType=="overlay"){S.fromEmbed=false}S.reviewsSearchBoxDefaultText=S.reviewsSearchBoxDefaultText||msg("tra.rev.search.reviewsAndQuestions");S.reviewTitleInstruction=S.reviewTitleInstruction||msg("tra.wrev.instruction.reviewTitle");S.reviewBodyInstruction=S.reviewBodyInstruction||msg("tra.wrev.instruction.reviewBody",[TurnTo.matchData.site.reviewsMinLength]);S.reviewBodyInstruction=S.reviewBodyInstruction.replace("{0}",TurnTo.matchData.site.reviewsMinLength);S.whyDidYouChooseMessage=S.whyDidYouChooseMessage||msg("tra.ppe.whyDidYouChoose");S.commentCaptureShowUsername=S.commentCaptureShowUsername||false;S.setTeaserCookieOnView=S.setTeaserCookieOnView||(typeof S.setTeaserCookieOnView=="undefined"&&S.setupType!="overlay");S.skipCssLoad=S.skipCssLoad||false;S.skipContainerWidthCheck=S.skipContainerWidthCheck||false;S.useCustomSerializerForIE=S.useCustomSerializerForIE||false;S.insertRelatedContentOnLoad=S.insertRelatedContentOnLoad||false;S.skipOnload=S.skipOnload||false;S.skipTurnToEmailHookCheck=S.skipTurnToEmailHookCheck||false;S.reloadTurnToUIOnInitialize=S.reloadTurnToUIOnInitialize||false;S.useTextForButtons=S.useTextForButtons||false;janrainCb=null;if(S.registration&&S.registration.useBackplane){window.escSubscription=Backplane.subscribe(function(backplaneMessage){console.debug("Backplane listen event fired! Response:");console.debug(backplaneMessage);if(backplaneMessage.type=="identity/login"){console.debug(backplaneMessage);xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getJanrainProfile"),postData:toJson({messageId:backplaneMessage.messageURL}),contentType:"text/text",load:function(data,ioArgs){console.debug(data);if(data.logoutUser){TurnTo.matchData.user=null;TurnTo.loggedIn=false;displayTeasers()}if(data.user){TurnTo.matchData.user=data.user;TurnTo.matchData.counts=data.counts;TurnTo.loggedIn=true;change2LiTitleBarFromLo();showHiInHeader()}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data)}closePartnerRegOverlay(true);if(S.registration){S.registration.synced=true}if(janrainCb){janrainCb();janrainCb=null}},error:function(data,ioArgs){console.debug(data)}})}})}var ttXDM={easyXDM:easyXDM.noConflict("TurnTo.ttXDM")};TurnTo.ttXDM=ttXDM;var ttXhr;var cid=(new Date()).getTime();TurnTo.baseEventUrl=getUrl("/webEvent/s.gif?siteKey="+S.siteKey+"&cid="+cid);TurnTo.eventTeaserShown=0;TurnTo.eventTraShownNotLoggedIn=10;TurnTo.eventTraShownLoggedIn=11;TurnTo.eventFriendsOpen=12;TurnTo.eventFOFsOpen=13;TurnTo.eventZipsOpen=14;TurnTo.eventQaItemteaserClick=124;TurnTo.eventQaQSubmit=125;TurnTo.eventQaQPost=126;TurnTo.eventQaAPost=127;TurnTo.eventItemShared=128;TurnTo.eventQaAnswerWidgetOpen=129;TurnTo.matchTypeFriend=1;TurnTo.matchTypeFoaf=2;TurnTo.matchTypeZip=3;TurnTo.facebookTargetId=12;TurnTo.twitterTargetId=13;TurnTo.ppLastFocusIndex=-1;TurnTo.regSourceUnknown=0;TurnTo.regSourceTra=1;TurnTo.regSourceEmbedded=2;TurnTo.regSourceOrderConfPage=3;TurnTo.regSourcePswPte=4;TurnTo.regSourcePswForwardInvite=5;TurnTo.regSourceAskQuestion=6;TurnTo.regSourceAskAnswer=7;TurnTo.regSourceProfile=10;TurnTo.regSourceAskAnswerReply=11;TurnTo.regSourceWriteReview=12;TurnTo.currentRegSource=null;TurnTo.regSourceToAction={};TurnTo.regSourceToAction[TurnTo.regSourceAskQuestion]="question";TurnTo.regSourceToAction[TurnTo.regSourceAskAnswer]="answer";TurnTo.regSourceToAction[TurnTo.regSourceAskAnswerReply]="reply";TurnTo.regSourceToAction[TurnTo.regSourceProfile]="profile";TurnTo.regSourceToAction[TurnTo.regSourceWriteReview]="review";TurnTo.staff=0;TurnTo.siteCustomerService=1;TurnTo.siteModerator=2;TurnTo.siteManager=3;TurnTo.getUrl=getUrl;TurnTo.getStaticUrl=getStaticUrl;TurnTo.iframeProxyUrl=getUrl("/tra2/xip_server.html");TurnTo.staticIframeProxyUrl=getStaticUrl("/tra2/xip_server.html");TurnTo.secureIframeProxyUrl=(S.useSSL?TurnTo.iframeProxyUrl.replace(/http:/,"https:"):TurnTo.iframeProxyUrl);TurnTo.stylesheetUrl=getStaticUrl((S.devMode)?"/traServer4_3/tradevcss/"+S.siteKey+"/tra/"+S.locale:"/tra4_3/tra-"+S.locale+".css");TurnTo.traJq=traJq;TurnTo.traJqC=traJqC;TurnTo.onload=onload;TurnTo.setCookieIframe=null;TurnTo.setCookie=setCookie;TurnTo.sendTheFeed=false;TurnTo.registerFbConnectUser=registerFbConnectUser;TurnTo.inputFocus=inputFocus;TurnTo.inputLoseFocus=inputLoseFocus;TurnTo.getDateString=getDateString;TurnTo.fbButtonSrc=getStaticUrl("/tra4/images/use-facebook.png");TurnTo.fbButtonSrc2=getStaticUrl("/tra4/images/use-facebook.png");TurnTo.getItems4User=getItems4User;TurnTo.findUserRaveTarget=findUserRaveTarget;TurnTo.getProductImage=getProductImage;TurnTo.getUserPhoto=getUserPhoto;TurnTo.getFacebookUserPhoto=getFacebookUserPhoto;TurnTo.connectWithTwitter=connectWithTwitter;TurnTo.makePrimaryIdent=makePrimaryIdent;TurnTo.removeIdent=removeIdent;TurnTo.resendEmailConfirmation=resendEmailConfirmation;TurnTo.inputUserImageForUserSetting=inputUserImageForUserSetting;TurnTo.startPostPurchaseFlow=startPostPurchaseFlow;TurnTo.showInlineAnswerInput=showInlineAnswerInput;TurnTo.hideInlineAnswerInput=hideInlineAnswerInput;TurnTo.insertItemTeaser=insertItemTeaser;TurnTo.insertItemTeaserForSku=insertItemTeaserForSku;TurnTo.insertItemTeasersForMultiSkus=insertItemTeasersForMultiSkus;TurnTo.TT2questionTextFocus=TT2questionTextFocus;TurnTo.TT2reviewTextFocus=TT2reviewTextFocus;TurnTo.TT2questionTextLoseFocus=TT2questionTextLoseFocus;TurnTo.isSiteManager=isSiteManager;TurnTo.isSiteModerator=isSiteModerator;TurnTo.setup=setup;TurnTo.unsupport=unsupport;TurnTo.getUnconfirmedMsg=getUnconfirmedMsg;TurnTo.ilv=ilv;TurnTo.ila=ila;TurnTo.ilt=ilt;TurnTo.ils=ils;TurnTo.ilr=ilr;TurnTo.ilf=ilf;TurnTo.displayDoMore=displayDoMore;TurnTo.showProfile=showProfile;TurnTo.displayProfile=displayProfile;TurnTo.displayReviewerProfile=displayReviewerProfile;TurnTo.showAllAnswers=showAllAnswers;TurnTo.hideAllAnswers=hideAllAnswers;TurnTo.hideAnswers=hideAnswers;TurnTo.skipQ=skipQ;TurnTo.localAuthenticationComplete=localAuthenticationComplete;TurnTo.itemTeaserClick=itemTeaserClick;TurnTo.itemReviewTeaserClick=itemReviewTeaserClick;TurnTo.fwItemClicked=fwItemClicked;TurnTo.pbItemClicked=pbItemClicked;TurnTo.pbItemShown=pbItemShown;TurnTo.clearSearchResultsMiqa=clearSearchResultsMiqa;TurnTo.toggleSearchClearMiqa=toggleSearchClearMiqa;TurnTo.sort=sort;TurnTo.sortReviews=sortReviews;TurnTo.writeReview=writeReview;TurnTo.chooseReviewRatingHover=chooseReviewRatingHover;TurnTo.chooseReviewRatingClick=chooseReviewRatingClick;TurnTo.chooseReviewRatingMouseout=chooseReviewRatingMouseout;TurnTo.chooseReviewRatingAda=chooseReviewRatingAda;TurnTo.chooseReviewRatingAdaFocus=chooseReviewRatingAdaFocus;TurnTo.chooseReviewRatingAdaBlur=chooseReviewRatingAdaBlur;TurnTo.chooseCustomDimensionHover=chooseCustomDimensionHover;TurnTo.chooseCustomDimensionClick=chooseCustomDimensionClick;TurnTo.chooseCustomDimensionMouseout=chooseCustomDimensionMouseout;TurnTo.chooseCustomDimensionAda=chooseCustomDimensionAda;TurnTo.chooseCustomDimensionAdaFocus=chooseCustomDimensionAdaFocus;TurnTo.chooseCustomDimensionAdaBlur=chooseCustomDimensionAdaBlur;TurnTo.clearReviewsSearchResults=clearReviewsSearchResults;TurnTo.toggleReviewsSearchClear=toggleReviewsSearchClear;TurnTo.flagReview=flagReview;TurnTo.insertRecentComments=insertRecentComments;TurnTo.logout=logOut;TurnTo.myQA=myQA;TurnTo.mySettings=mySettings;TurnTo.multiItemSearch=multiItemSearch;TurnTo.miqaScrollR=miqaScrollR;TurnTo.miqaScrollL=miqaScrollL;TurnTo.showQuestion=function(qid,showAnswerInput){showSoloQuestionViewWidget({qid:qid,showAnswerInput:showAnswerInput},"ugcfeed")};TurnTo.showInputBox=showInputBox;TurnTo.shopperProfileCountryChange=shopperProfileCountryChange;TurnTo.insertReview=insertReview;TurnTo.mobileScrollTop=mobileScrollTop=function(jQueryElmnt){var top=jQueryElmnt?jQueryElmnt.offset().top-100:0;window.scrollTo(0,top)};TurnTo.mobileRegData={};TurnTo.diagnostics={};TEASER_TYPE_GLOBAL="g";TEASER_TYPE_ASK="a";TEASER_TYPE_REVIEW="r";TEASER_COOKIE_NAME="TURNTO_TEASER_COOKIE";TEASER_SHOWN_COOKIE_NAME="TURNTO_TEASER_SHOWN";LOGGED_IN_COOKIE_NAME="TURNTO_LOGGEDIN";LOGGED_IN_TOKEN_COOKIE_NAME="TURNTO_TOKEN";ACTIVITY_COOKIE_NAME="TURNTO_ACTIVITY";ROLLOVER_TOOLTIP_COOKIE_NAME="TURNTO_ROLLOVER_TOOLTIP";QUESTION_ASKED_COOKIE_NAME="TURNTO_QASK";QUESTION_EMAIL_COOKIE_NAME="TURNTO_QEML";ANSWER_EMAIL_COOKIE_NAME="TURNTO_AEML";MODERATOR_COOKIE_NAME="TURNTO_MODERATOR";NOSYNC_COOKIE_NAME="TURNTO_NOSYNC";FEEDWCLICK_COOKIE_NAME="TURNTO_FEEDWCLICK";PBSHOWN_COOKIE_NAME="TURNTO_PBSHOWN";PBCLICK_COOKIE_NAME="TURNTO_PBCLICK";QASKIRCLICK_COOKIE_NAME="TURNTO_QAIRCL";ANSWERSUBMIT_COOKIE_NAME="TURNTO_ANSWR";SYNDICATION_TYPE_COMMERCE=0;SYNDICATION_TYPE_CONTENT=1;WRITE_REV_EVERYONE=0;WRITE_REV_ONLY_USERS=1;WRITE_REV_ONLY_PURCHASERS=2;WRITE_REV_MAX_TITLE_LENGTH=1000;TurnTo.traDataLoaded=false;TurnTo.fteaserCount=0;TurnTo.doIteaser=false;TurnTo.mobileHideReviewGuidelines=function(){TurnTojQuery("#TTmobileWriteRevGuideLines").hide()};TurnTo.isPlaceHolderSupported=function(){var i=document.createElement("input");return"placeholder" in i};var traWindow;var traSubWindow;var regWindow;var flashCheck;var importSrc;var toolTipQ;var totalLiMessages=0;var IEversion=0;var IE7or8=false;var instantTeaserClicked=false;var turntoflow,turntomobileflow;var onMobile=false,inRail=false;var turntoflowItemContextUrl;var messageProps={};var whichWidget="f";var preLoadedSite=(TurnTo.matchData&&TurnTo.matchData.site);if(TurnTojQuery.browser.msie){S.useSetup=false}TurnTo.params=getParameters();if((TurnTo.params.length>0&&window.location.href.indexOf("#turntodone")==-1)&&(TurnTo.params.length>0&&TurnTo.params.turntoflow)){turntoflow=TurnTo.params.turntoflow}if((TurnTo.params.length>0&&window.location.href.indexOf("#turntodone")==-1)&&(TurnTo.params.length>0&&TurnTo.params.TurnToMobileFlow)){turntomobileflow=TurnTo.params.TurnToMobileFlow}function traJq(str){return TurnTojQuery(str,TurnTo.jQcontext)}function traJqC(str){return TurnTojQuery(str,TurnTo.jQcontext2)}function traJqR(str){return TurnTojQuery(str,TurnTo.jQcontext3)}function setup(){if(!S.useSetup){return}if(turntoflow){instantTeaSpinScreen()}onload()}function shopperProfileCountryChange(elem){var sel=traJq(elem).val();if(sel==="US"){traJq("#TTstateCAdisplay").hide();traJq("#TTstateOtherdisplay").hide();traJq("#TTstateUSdisplay").show()}else{if(sel==="CA"){traJq("#TTstateCAdisplay").show();traJq("#TTstateOtherdisplay").hide();traJq("#TTstateUSdisplay").hide()}else{traJq("#TTstateCAdisplay").hide();traJq("#TTstateOtherdisplay").show();traJq("#TTstateUSdisplay").hide()}}}function checkDoIteaser(){TurnTo.doIteaser=(TurnTojQuery(".TurnToItemTeaser")[0]!=undefined)&&(typeof TurnToItemSku!="undefined");if(typeof TurnToMultiSku!="undefined"){TurnTo.doIteaser=true}}function checkDoIIteaser(){TurnTo.doIIteaser=(TurnTojQuery(".TurnToItemInputTeaser")[0]!=undefined)&&(typeof TurnToItemSku!="undefined")}function checkDoRteaser(clazz){var clazzName=clazz||"TurnToReviewsTeaser";TurnTo.doRteaser=(TurnTojQuery("."+clazzName)[0]!=undefined)&&(typeof TurnToItemSku!="undefined");if(typeof TurnToReviewsMultiSku!="undefined"){TurnTo.doRteaser=true}}function checkDoRecentComments(){TurnTo.doRecentComments=S.recentComments&&TurnTojQuery("#TurnToRecentComments")[0]!=undefined||S.customChatterFunc}function checkDoFullComments(){TurnTo.doFullComments=S.fullComments&&TurnTojQuery("#TurnToFullComments")[0]!=undefined}function checkDoQA(){TurnTo.doQA=TurnTojQuery("#TurnToContent")[0]!=undefined}function checkDoReviews(){TurnTo.doReviews=TurnTojQuery("#TurnToReviewsContent")[0]!=undefined}TurnTo.runClientCallbackFunc=runClientCallbackFunc;function runClientCallbackFunc(funcName,evt){try{if(clientEvents&&clientEvents[funcName]!==null){clientEvents[funcName](evt)}}catch(e){}}TurnTo.diagnostics.tmp="";TurnTo.diagnostics.copyButton='<button id="turnto-tra-dev-diag-copy" onclick="TurnTo.diagnostics.copyDevDiagToClipboard();">Copy to Clipboard</button>';TurnTo.diagnostics.revertButton='<button id="turnto-tra-dev-diag-copy" onclick="TurnTo.diagnostics.copyDevDiagToClipboard(true);">Copy text: Ctrl-C (Windows) or Cmd-C (Mac).</button>';TurnTo.diagnostics.showDevDiag=function(){TurnTojQuery(document).ready(function(){var cookies=document.cookie.split(";");var cookieSz=cookies.length;TurnTojQuery(document.body).append(TurnToHTML.diagnostics({siteId:TurnTo.matchData.site.siteId,siteName:TurnTo.matchData.site.siteName,traVersion:TurnTo.traVersion,setupType:S.setupType,miq:((TurnTo.matchData.site.miq&&TurnTo.matchData.site.miq===true)?"Enabled":"Disabled"),reviewsEnabled:((TurnTo.matchData.site.reviewsEnabled&&TurnTo.matchData.site.reviewsEnabled===true)?"Enabled":"Disabled"),sku:TurnToItemSku,url:window.location,userAgent:navigator.userAgent,cdn:S.staticHost,cookies:cookies,cookieSz:cookieSz,config:S,copyButton:TurnTo.diagnostics.copyButton}))})};TurnTo.diagnostics.copyDevDiagToClipboard=function(revert){if(revert===true){TurnTojQuery("#turnto-tra-dev-diag-content").html("");TurnTojQuery("#turnto-tra-dev-diag-content").html(TurnTo.diagnostics.tmp);TurnTojQuery("#turnto-tra-dev-diag-button").html(TurnTo.diagnostics.copyButton)}else{TurnTojQuery(document).ready(function(){var text=TurnTojQuery("#turnto-tra-dev-diag-content").html().replace(/<br\s*\/?>/mg,"\n").replace(/(<span class="ttConfigLabel" (.*?)>|<\/span>|<b>|<\/b>)/mg,"");if(window.clipboardData){window.clipboardData.setData("Text",text);window.alert("TurnTo Diagnostics details copied to clipboard!")}else{TurnTo.diagnostics.tmp=TurnTojQuery("#turnto-tra-dev-diag-content").html();var diagTextArea='<textarea style="width: 100%;height:400px;" id="turnto-tra-dev-diag-select">'+text+"</textarea>";TurnTojQuery("#turnto-tra-dev-diag-content").html(diagTextArea);document.getElementById("turnto-tra-dev-diag-select").select();TurnTojQuery("#turnto-tra-dev-diag-button").html(TurnTo.diagnostics.revertButton)}})}};TurnTo.diagnostics.closeDevDiag=function(){TurnTojQuery("#turnto-tra-dev-diag").remove()};function insertNonIndexedUgc(){if(typeof TurnToNonIndexedUGC!="undefined"){for(var property in TurnToNonIndexedUGC){var questions=new Array();questions.push(TurnToNonIndexedUGC[property]);insertQAR({cont:TurnTojQuery("#"+property),questions:questions,replace:true,insertInputBox:false,showReplyLink:true})}}}var formatName=function(nameObj,uidReq,style){uidReq=uidReq!==false;style=style||"default";if(uidReq&&!nameObj.uid){return""}var nName=nameObj.nName?nameObj.nName:nameObj.nickName;var fName=nameObj.fName?nameObj.fName:nameObj.firstName;var lName=nameObj.lName?nameObj.lName:nameObj.lastName;if((style==="default"||style.indexOf("nick")===0)&&nName){return nName}else{if(style==="full"||style.indexOf("Full")>0){return fName+" "+lName}else{if(style==="nickFirst"){return fName}else{if(style==="nickFirstEmail"){return fName?fName:nameObj.email}}}}return nName?nName:(fName+" "+(lName?" "+lName.substring(0,1):""))};TurnTo.formatName=formatName;TurnTo.genSyndSiteLink=function(ugcType,ugcId,siteId,syndicationSource){return'<a target="_blank" href="'+TurnTo.partnerProtocol+"//"+TurnTo.S.host+"/transLink/13/"+ugcType+"/"+ugcId+"/"+S.locale+"?sid="+siteId+'" title="'+syndicationSource.siteName+'" rel="nofollow">'+syndicationSource.siteName+"</a>"};function getTransLinkUrl(origin,type,id,siteId){return TurnTo.partnerProtocol+"//"+TurnTo.S.host+"/transLink/"+origin+"/"+type+"/"+id+"/"+S.locale+"?sid="+siteId}function insertEmbedTra(callbackFn){if(TurnTo.matchData.site.skipDEifNoSku&&typeof TurnToItemData=="undefined"){return}var url="/sitedata/"+S.siteKey+"/v4_3/"+encodeURIComponent(TurnToItemSku)+"/d/"+S.locale+"/catitemhtml";getText(url,function(data,ioArgs){var ttContentEl=TurnTojQuery("#TurnToContent");ttContentEl.replaceWith(data.text);if(data.text==='<div id="TurnToContent"></div>'){if(S.emptyQAMessage){TurnTojQuery("#TurnToContent").append(S.emptyQAMessage)}}TurnTo.jQcontext2=TurnTojQuery("#TurnToContent");yieldToUI(function(){insertInstructionalCopy();var preQuestionRewConf=getRewardPointsConfig(TurnTo.eventQaQPost);if(preQuestionRewConf.preText){TurnTojQuery("#TT2askRewardMsg").html(preQuestionRewConf.preText).show()}insertNonIndexedUgc();setupProfileLinks();setupProfileLinks(TurnTo.jQcontext2,"commerceBanner",false);setupMultiItemScroll();setupQuestionText();insertInlineAnswerBoxes();yieldToUI(function(){personalizeUgc(function(){insertRelatedQuestions();TurnTojQuery("#TT2questionText").focus(function(){if(S.registration){syncPartnerAndTTuserState(function(statusObj){if(TurnTo.matchData.user){showHiInHeader()}})}else{if(!TurnTo.matchData.user){checkForLIUser(function(){showHiInHeader()})}}TurnTojQuery("#TT2questionText").focus(null)})})});if(S.instantAnswers){TurnTojQuery("#TT2questionText").keyup(function(){instantanswers(traJq(this),{fromQA:true})})}setupTextareaAutoSizing(TurnTojQuery("#TT2questionText",ttContentEl),3);setupQuestionSubmit();TurnTojQuery("#TT4closeQuestionBox").click(function(){resetQuestionArea()});TurnTojQuery("#TT4closeQuestionBox").keydown(function(e){if(isEnterKey(e)){resetQuestionArea()}})});if(callbackFn){callbackFn()}})}function isEnterKey(keyPressEvent){var keycode=(keyPressEvent.keyCode?keyPressEvent.keyCode:keyPressEvent.which);return keycode=="13"}function setupTextareaAutoSizing(jTextArea,maxLines){maxLines=typeof maxLines!=="undefined"?(maxLines<3?3:maxLines):1000;jTextArea=TurnTojQuery(jTextArea.selector);var styleProperties=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","whiteSpace","width","paddingTop","paddingBottom","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","borderRightWidth","borderLeftWidth"];var hiddenDiv=TurnTojQuery("<div id='ttHiddenAskQuestionDiv' style='display: none;white-space: pre-wrap;word-wrap: break-word;'>Testing</div>");var stylesToDuplicate={};TurnTojQuery.each(styleProperties,function(i,styleName){stylesToDuplicate[styleName]=jTextArea.css(styleName)});hiddenDiv.css(stylesToDuplicate);jTextArea.after(hiddenDiv);var singleLineHeight=hiddenDiv.height()+1;var paddingAndBorder=hiddenDiv.outerHeight()-hiddenDiv.height();var maxHeight=(singleLineHeight*maxLines)+paddingAndBorder;var useData=false;if(singleLineHeight==1){jTextArea.data("max-lines",maxLines);useData=true}else{jTextArea.css("height",singleLineHeight+paddingAndBorder)}var askText=jTextArea.val();if(!askText){askText=(onMobile||inRail)?S.questionDefaultTextMobileAndNarrow:S.questionDefaultText;jTextArea.addClass("TTdefaultInput")}jTextArea.val(askText);jTextArea.attr("ttinputlabeltext",askText);jTextArea.bind("keypress keyup change input",function(){maxHeight=!useData?maxHeight:parseInt(jTextArea.data("max-height"));var content=jTextArea.val();content=content.replace(/\n/g,"<br>");hiddenDiv.html(content+'<br class="lbr">');var divHeight=hiddenDiv.outerHeight()+1;if(divHeight>maxHeight){divHeight=maxHeight;jTextArea.css("overflow","auto")}else{jTextArea.css("overflow","hidden")}divHeight=divHeight>maxHeight?maxHeight:divHeight;jTextArea.css("height",divHeight)});jTextArea.trigger("change")}function insertEmbedReviews(){var url="/sitedata/"+S.siteKey+"/v4_3/"+encodeURIComponent(TurnToItemSku)+"/d/"+S.locale+"/catitemreviewshtml";getText(url,function(data,ioArgs){var ttContentEl=TurnTojQuery("#TurnToReviewsContent");ttContentEl.replaceWith(data.text);TurnTo.jQcontext3=TurnTojQuery("#TurnToReviewsContent");yieldToUI(function(){paginateDirectReviews();truncateReviews(ttContentEl);disableVotingForReviewOwner(ttContentEl);checkUseSmallDimensions(ttContentEl);insertModerateLink(ttContentEl,"review");setupShowMediaModal(ttContentEl);if(TurnTo.isPlaceHolderSupported()){TurnTojQuery("#TTreviewSearchTerm").attr("placeholder",TurnTo.S.reviewsSearchBoxDefaultText)}else{TurnTojQuery("#TTreviewSearchTerm").attr("ttinputlabeltext",TurnTo.S.reviewsSearchBoxDefaultText);TurnTojQuery("#TTreviewSearchTerm").attr("value",TurnTo.S.reviewsSearchBoxDefaultText);TurnTojQuery("#TTreviewSearchTerm").attr("onblur","TurnTo.inputLoseFocus(this)");TurnTojQuery("#TTreviewSearchTerm").attr("onfocus","TurnTo.inputFocus(this)");TurnTojQuery("#TTreviewSearchTerm").attr("class","TTdefaultInput")}TurnTojQuery("#TTreviewSearchTerm").keyup(function(){var curVal=TurnTojQuery("#TTreviewSearchTerm").val();var curValLen=curVal?curVal.length:0;if(curValLen===0){TurnTo.clearReviewsSearchResults()}else{TurnTojQuery("#TTreviewsWrapper").hide();TurnTo.clearReviewsSearchResults(true);instantanswers(traJq(this),{fromReviews:true})}});TurnTojQuery("#TTwriteReviewBtn").keydown(function(e){if(isEnterKey(e)){writeReview()}});insertRelatedReviews();insertJsonLDMetadata()})})}function checkUseSmallDimensions(){if(TurnTojQuery("#TurnToReviewsContent").width()<=920){traJqR(".TTreview").each(function(){traJqR(this).find(".TTreviewDimsRange").removeClass("TTreviewDimsRange").addClass("TTreviewSmallDimsRange");traJqR(this).find(".TTreviewDims").removeClass("TTreviewDims").addClass("TTreviewSmallDims");traJqR(this).find(".TT4reviewRange").each(function(){traJqR(this).removeClass("TT4reviewRange").addClass("TT4reviewRangeSmall")});traJqR(this).find(".TT4reviewDimRangeLabel").removeClass("TT4reviewDimRangeLabel").addClass("TT4reviewDimRangeLabelSmall");traJqR(this).find(".TTcustomImg").each(function(){var jThis=traJqR(this);var rating=jThis.attr("ttrating");jThis.removeClass().addClass("TTcustomImg TTcustomSmall-"+rating+"-0")})})}}var questionsLoadedState={isLoading:false};var relatedQuestionsLoadedState={isLoading:false};function paginateQuestions(onlyDirect){var qContainer=traJqC("#TT3itemQuestCont");var relQsContainer=traJqC("#TT3relatedQuestionsWrp");var additionalRelQsShown=0,allQs=qContainer.find(".TT3questWrp"),directQsShown,relQsRemaining;if(onlyDirect){var remainingDirectQs=allQs.slice(S.qPaginateInitial);remainingDirectQs.hide();directQsShown=allQs.length-remainingDirectQs.length}else{var allRelQs=relQsContainer.find(".TT3questWrp");relQsRemaining=allRelQs.slice(S.qPaginateSimilarQCnt);relQsRemaining.hide();var relQsShown=allRelQs.length-relQsRemaining.length;var remainingDirectQs=allQs.slice(S.qPaginateInitial-relQsShown);remainingDirectQs.hide();directQsShown=allQs.length-remainingDirectQs.length;if((relQsShown+directQsShown<S.qPaginateInitial)&&relQsRemaining.length>0){additionalRelQsShown=S.qPaginateInitial-(relQsShown+directQsShown);relQsRemaining.slice(0,additionalRelQsShown).show();relQsShown+=additionalRelQsShown}}var totalDirectQs=TurnTojQuery("#TTQuestionsAndAnswers").data("qcnt");totalDirectQs+=userHiddenQuestions.length;totalDirectQs+=TurnTojQuery("#TT3quest-SYSGEN").length>0?1:0;var showMoreContainer=qContainer.find("#TT3qShowMore");var directQsPagingObj=new PaginationObj(qContainer,totalDirectQs,S.qPaginateInitial,S.qPaginateExpand,TurnTo.matchData.site.questionsPageSize,showMoreContainer,"tra.qa.showMoreQuestions.");var directHiddenQs=allQs.length-directQsShown;setupQuestionsShowMore(directQsPagingObj,directQsShown,directHiddenQs,questionsLoadedState);if(!onlyDirect){var totalRelQs=relQsContainer.find("#TT3relatedQuestions").data("rq-count");var showMoreRelQContainer=relQsContainer.find("#TT3rqShowMore");var relQsPagingObj=new PaginationObj(relQsContainer,totalRelQs,S.qPaginateInitial,S.qPaginateSimilarExpand,TurnTo.matchData.site.relatedQuestionsPageSize,showMoreRelQContainer,"tra.qa.showMoreRelatedQuestions.");relQsPagingObj.isRelated=true;var relHiddenQs=relQsRemaining.length-additionalRelQsShown;setupQuestionsShowMore(relQsPagingObj,relQsShown,relHiddenQs,relatedQuestionsLoadedState)}traJqC(".TT3questWrp.TT3questBorder").filter(":visible").last().removeClass("TT3questBorder")}function setupQuestionsShowMore(pagingObj,numQsShown,numHiddenQs,loadedState){var showMoreContainer=pagingObj.showMoreContainer,expandNum=pagingObj.expand;if(pagingObj.total>numQsShown){showMoreContainer.find("a").unbind("click.ttShowMoreQ").bind("click.ttShowMoreQ",function(){showMoreContainer.hide();showMoreContainer.next(".TTspinner").show();callWhenLoaded(expandQuestions,[pagingObj],loadedState,20)});var qsLeft=pagingObj.total-numQsShown;if(numHiddenQs<expandNum&&qsLeft>numHiddenQs){setTimeout(function(){insertPaginatedQuestions(2,pagingObj.isRelated)},2000)}var showMoreNum=qsLeft>expandNum?expandNum:qsLeft;showMoreContainer.find(".TT3ShowMoreText").html(msg(pagingObj.showMoreMsgKey+getPlural(showMoreNum),[showMoreNum]));showMoreContainer.show()}else{showMoreContainer.hide()}}function expandQuestions(pagingObj){var allQuestions=pagingObj.container.find(".TT3questWrp");var hiddenQuestions=allQuestions.not(":visible");var hiddenCnt=0;hiddenQuestions.each(function(index){if(index<pagingObj.expand){traJqC(this).show()}else{hiddenCnt++}});if(hiddenCnt<pagingObj.expand&&pagingObj.total>allQuestions.length){var loadedQuestionsCnt=allQuestions.length;if(!pagingObj.isRelated){loadedQuestionsCnt-=userHiddenQuestions.length;loadedQuestionsCnt-=TurnTojQuery("#TT3quest-SYSGEN").length>0?1:0}var pagesLoaded=loadedQuestionsCnt/pagingObj.pageSize;if(pagesLoaded===parseInt(pagesLoaded,10)){insertPaginatedQuestions(++pagesLoaded,pagingObj.isRelated);hiddenCnt=pagingObj.total-allQuestions.length+hiddenCnt}}var showMoreContainer=pagingObj.showMoreContainer;if(hiddenCnt>0){showMoreContainer.show();var showMoreQsNum=hiddenCnt>pagingObj.expand?pagingObj.expand:hiddenCnt;showMoreContainer.find(".TT3ShowMoreText").html(msg(pagingObj.showMoreMsgKey+getPlural(showMoreQsNum),[showMoreQsNum]));showMoreContainer.show()}else{showMoreContainer.hide()}showMoreContainer.next(".TTspinner").hide()}function hideAnswers(elem,qid){if(qid){var sys=(qid=="SYSGEN");var cont=traJqC(elem).parents("#TT3quest-"+qid);cont.find(".TT3showText").show();cont.find(".TT3hideText").hide();if(sys){var comments=cont.find("#TT4commentColumns");if(onMobile||inRail){cont.find("#TT4commentsLeft .TT3commentCntr").filter(".TTrespMobileDisp").each(function(index){if(index>1){traJq(this).attr("style","display:none !important")}})}else{cont.find("#TT4commentsLeft .TT3commentCntr").filter(".TTrespDesktopDisp").each(function(index){if(index>1){traJq(this).hide()}});cont.find("#TT4commentsRight .TT3commentCntr").each(function(index){if(index>1){traJq(this).hide()}})}var linkLine=cont.find(".TT3linkLine");cont.find(".TT3itemBox").append(comments.remove());cont.find(".TT3itemBox").append(linkLine.remove());setupProfileLinks(cont,null,false)}else{var answersSelector="#TT3IAContainer-"+qid+" .TT4ansAndReplies";if(cont.parents("#TT3soloQuestion").length>0){answersSelector=".TT4ansAndReplies"}var answers=TurnTojQuery(answersSelector,cont);var bestAnswerBlock=TurnTojQuery("#TT4bestAnswerBlock-"+qid,cont);var bestAnswer=TurnTojQuery("[sqvbestanswer=true]",cont);var shownAnswer=TurnTojQuery("[shownanswer=true]",cont);var shownAnswerIsBestAnswer=!shownAnswer.length?false:bestAnswer.attr("id")==shownAnswer.attr("id");hideBySlidingUp(TurnTojQuery("#TT3IAContainer-"+qid,cont));showByExpanding(bestAnswerBlock);var anchor=cont.find("#TT3expand-"+qid+" .TT3showText").find("a");var anchorMsgKey;if(onMobile||inRail){anchorMsgKey="tra.qa.question.linkLine.readAnswer.mobile."+getPlural(answers.length)}else{if(anchor.parents("#TT3UPContent").length==0){anchorMsgKey="tra.qa.question.linkLine.readAnswer."+getPlural(answers.length)}else{anchorMsgKey="tra.qa.question.linkLine.readMoreAnswer."+getPlural(answers.length)}}var anchorMsg=msg(anchorMsgKey,[answers.length]);anchor.html(anchorMsg).attr("title",anchorMsg);cont.find(".TT4voteHelp").hide();if(bestAnswer.length&&shownAnswerIsBestAnswer){bestAnswerBlock.append(bestAnswer.parent().detach())}if(shownAnswer.length&&!shownAnswerIsBestAnswer){var ansAndReply=shownAnswer.parent().detach();var shownAnswerBlock=TurnTojQuery("#TT4shownAnswerBlock-"+qid,cont);shownAnswerBlock.append(ansAndReply).show();ansAndReply.show();TurnTojQuery("#TT3IAContainer-"+qid).prepend(bestAnswer.parent().detach())}TurnTojQuery("#TT3answerVoteCall-"+qid,cont).hide()}}}function hideAllAnswers(){var questions=TurnTojQuery(".TT3questWrp");questions.each(function(){var jThis=traJqC(this);var id=jThis.attr("id").split("-")[1];hideAnswers(jThis.children().first(),id)})}function setupInitialAnswersStateForSQV(cont,hideAll){var questions=TurnTojQuery(".TT3questWrp",cont);var moreAnswers=0;if(questions.length>0||hideAll){questions.each(function(index){var jThis=traJqC(this);var id=jThis.attr("id").split("-")[1];var expDiv=jThis.find("#TT3expand-"+id);var answers=jThis.find("#TT3IAContainer-"+id+" .TT4ansAndReplies");if(answers.length>0&&hideAll){answers.each(function(index){traJqC(this).hide()})}expDiv.attr("expanded","");var showExpand=(answers.length>0);var hideLink=(answers.length==0);if(showExpand){expDiv.show();var showText=expDiv.find(".TT3showText");var hideText=expDiv.find(".TT3hideText");showText.toggle(showExpand);if(hideAll){hideText.hide()}else{hideText.toggle(!showExpand)}if(hideLink){showText.hide()}}else{expDiv.hide()}})}}function setupInitialAnswersState(cont,overrideExpandFlag,hideAll){var questions=TurnTojQuery(".TT3questWrp",cont);if(questions.length>0||hideAll||S.inProfile){if(S.bestAnswerText){TurnTojQuery(".TTbestAnswer",cont).html(S.bestAnswerText)}questions.each(function(index){var moreAnswers=0;var jThis=traJqC(this);var id=jThis.attr("id").split("-")[1];var sys=(id=="SYSGEN");var expDiv=jThis.find("#TT3expand-"+id);var answers;if(onMobile||inRail){answers=jThis.find(sys?".TT3commentCntr":"#TT3IAContainer-"+id+" .TT4ansAndReplies");if(sys){answers=answers.filter(".TTrespMobileDisp")}}else{answers=jThis.find(sys?".TT3commentCntr":"#TT3IAContainer-"+id+" .TT4ansAndReplies");if(sys){answers=answers.filter(".TTrespDesktopDisp")}}var showExpand=false;var hideLink=false;if(jThis.parents("#TT3UPAnsSec").length==0){if(!expDiv.attr("expanded")||expDiv.is(":visible")||overrideExpandFlag){expDiv.attr("expanded","");if(sys){showExpand=true;hideLink=onMobile||inRail?answers.length<=2:answers.length<=4}else{showExpand=(answers.length>1);hideLink=(answers.length==1&&!S.hideBestAnswer);if(answers.length>1||hideAll){answers.each(function(index){if(index>0||S.hideBestAnswer||hideAll){traJqC(this).hide()}})}}}else{if(questions.length==1){if(hideAll&&answers.length>0){showExpand=true}}}}else{answers.each(function(){var aThis=traJqC(this);if(aThis.find(".TT3youHolder").attr("tt3-uid")!=traJq("#TT3UPuid").val()){moreAnswers++;aThis.hide();showExpand=true}});if(!showExpand&&moreAnswers>0){showAllAnswers(jThis.find(".TT3showText a"),id)}if(answers.length==1){expDiv.hide()}if(moreAnswers>0){var anchor=expDiv.find(".TT3showText").find("a");var anchorMsgKey;if(onMobile||inRail){anchorMsgKey="tra.qa.question.linkLine.readMoreAnswer.mobile."+getPlural(moreAnswers)}else{anchorMsgKey="tra.qa.question.linkLine.readMoreAnswer."+getPlural(moreAnswers)}var anchorMsg=msg(anchorMsgKey,[moreAnswers]);anchor.html(anchorMsg).attr("title",anchorMsg)}return}if(answers.length>1){expDiv.show();var showText=expDiv.find(".TT3showText");var hideText=expDiv.find(".TT3hideText");var anchor=showText.find("a");if(sys){moreAnswers=onMobile||inRail?answers.length-2:answers.length-4}else{moreAnswers=answers.length}var anchorMsgKey;if(onMobile||inRail){anchorMsgKey="tra.qa.question.linkLine.readAnswer.mobile."+getPlural(moreAnswers)}else{if(moreAnswers>1){moreAnswers=answers.length}anchorMsgKey="tra.qa.question.linkLine.readAnswer."+getPlural(moreAnswers)}var anchorMsg=msg(anchorMsgKey,[moreAnswers]);anchor.html(anchorMsg).attr("title",anchorMsg);showText.toggle(showExpand);if(hideAll){hideText.hide()}else{hideText.toggle(!showExpand)}if(hideLink&&sys){showText.hide()}else{if(hideLink){showText.hide()}}}else{expDiv.hide()}})}}function showAllAnswers(elem,qid){if(qid){var sys=qid=="SYSGEN";var jElem=traJqC(elem);var expDiv=jElem.hasClass("TT3expand")?jElem:jElem.parents(".TT3expand");var qCont=expDiv.parents("#TT3quest-"+qid);var profile=expDiv.parents("#TT3UPContent");var answers;if(profile.length>0){if(sys){answers=qCont.find(" .TT3commentCntr")}else{answers=profile.find("#TT3IAContainer-"+qid+" .TT4ansAndReplies")}}else{answers=qCont.find((sys?" .TT3commentCntr":" #TT3IAContainer-"+qid+" .TT4ansAndReplies"))}if(onMobile||inRail){if(sys){answers=answers.filter(".TTrespMobileDisp")}}else{if(sys){answers=answers.filter(".TTrespDesktopDisp")}}if(sys){traJqC("#TT4commentsExpanded").append(traJqC("#TT4commentColumns").remove());answers.show();setupProfileLinks(traJqC("#TT4commentsExpanded"),null,false);expDiv.attr("expanded","true");expDiv.find(".TT3hideText").show();expDiv.find(".TT3showText").hide()}else{if(answers.length>0){var bestAnswer=qCont.find("#TT4bestAnswerBlock-"+qid+" .TT4ansAndReplies");if(qCont.parents("#TT3soloQuestion").length>0){answers.parent().prepend(bestAnswer.detach())}answers.show();bestAnswer.show();var shownAnswer=TurnTojQuery("[shownanswer=true]",qCont);var bestAnswerId=bestAnswer.find("[sqvbestanswer=true]").attr("id");var shownAnswerIsBestAnswer=!shownAnswer.length?false:bestAnswerId==shownAnswer.attr("id");if(shownAnswer.length&&!shownAnswerIsBestAnswer){var answerId=shownAnswer.attr("id").split("-")[1];var shownAnswerHiddenField=qCont.find("#TT2qid4answer-"+answerId);shownAnswerHiddenField.after(shownAnswer.parent().detach()).show()}expDiv.attr("expanded","true");qCont.find(".TT3showText").hide();qCont.find(".TT3hideText").show();qCont.find("#TT4VoteHelpText").text(S.answerVoteHelpText);qCont.find(".TT4answVoteCall").show();TurnTojQuery("#TT3answerVoteCall-"+qid,qCont).show();showByExpanding(answers.parent(),function(){setupMultiItemScroll(answers.parent())});if(profile.length==0){hideBySlidingUp(TurnTojQuery("#TT4bestAnswerBlock-"+qid))}}}}else{traJqC(".TT3questWrp").each(function(){var cont=traJqC(this);var expDiv=cont.find(".TT3expand");var id=cont.attr("id").split("-")[1];showAllAnswers(expDiv,id)})}}function myQA(fromMobile){if(onMobile&&!fromMobile){regWindow=window.open(TurnTo.matchData.site.mobileTraPageUrl+(TurnTo.matchData.site.mobileTraPageUrl.indexOf("?")>-1?"&":"?")+"turntosku="+TurnToItemSku+"&ttmlp=true&TurnToMobileFlow=mobileMyQA&curl="+encodeURIComponent(document.URL),"_blank");return}if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){S.registration.synced=false;if(ensurePartnerRegUser(TurnTo.regSourceProfile,function(){showProfile(null,fromMobile)})==1){displayProfile(TurnTo.matchData.user.id)}}else{if(TurnTo.matchData.user){displayProfile(TurnTo.matchData.user.id)}else{showProfile(null,fromMobile)}}}function mySettings(){if(!isWidgetOpen()){toggleMainWindow("none")}displayUserSetting()}var userQuestions=null;var userHiddenQuestions=[];function personalizeUgc(cb){var uid=getCookie(LOGGED_IN_COOKIE_NAME);var hasActivity=(typeof TurnToItemSku=="undefined")?false:hasActivity4Sku(TurnToItemSku);if(!uid&&!hasActivity){cb();return}if(hasActivity){var data={};data.sku=TurnToItemSku;xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getUgc4User"),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){if(data.user){if(data.user.id!=uid){localLogout();setLocalLoginCookie(data);setModeratorCookie(data)}TurnTo.matchData.user=data.user;userQuestions=data.questions;showHiInHeader();insertPersonalizedUgc(data.questions,uid);showHiInHeader()}else{if(data.logoutUser){localLogout()}}cb()},error:function(data,ioArgs){console.debug(data)}})}else{insertYouBadge(TurnTo.jQcontext2,uid);insertModerateLink(TurnTo.jQcontext2,"answer");disableVotingForOwner(TurnTo.jQcontext2,uid);traJqC(".TT3questWrp").each(function(i){var el=TurnTojQuery(this);if(el.attr("tt3-uid")==uid){TurnTojQuery(".TT3sendThanks",el).each(function(st){var stel=TurnTojQuery(this);if(stel.attr("tt3-uid")!=uid){stel.show()}})}});cb()}}function insertPersonalizedUgc(questions,uid){var userHiddenQsAdded=userHiddenQuestions.length>0;var exQs={};traJqC(".TT3questWrp").each(function(i){exQs[TurnTojQuery(this).attr("id").split("-")[1]]=true});for(var i=0;i<questions.length;i++){var currQ=questions[i];if(exQs[currQ.id]){insertQAR({cont:traJqC("#TT3quest-"+currQ.id),questions:[currQ],replace:true})}else{if(currQ.isHidden){userHiddenQuestions.push(currQ)}}}if(!userHiddenQsAdded){insertQAR({cont:traJqC("#TT3itemQuestCont"),questions:userHiddenQuestions})}insertYouBadge(TurnTo.jQcontext2,uid);insertModerateLink(TurnTo.jQcontext2,"answer");disableVotingForOwner(TurnTo.jQcontext2,uid)}var relatedUgcIds={questions:[],answers:[]};var relatedQsAdded=false;function insertRelatedQuestions(page){if(!TurnToItemSku){return}var loadingFirstPage=!page||page==1;if((relatedQsAdded&&loadingFirstPage)||relatedQuestionsLoadedState.isLoading){return}relatedQsAdded=true;relatedQuestionsLoadedState.isLoading=true;var data={};data.sku=TurnToItemSku;staticXhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:"/sitedata/"+S.siteKey+"/v4_2/"+encodeURIComponent(TurnToItemSku)+"/r/"+S.locale+"/relatedquestions"+(page?"/"+page:""),load:function(data,ioArgs){if(!data.relatedQuestions.length){setupInitialAnswersState(TurnTojQuery("#TT3itemQuestCont"),true,true);if(loadingFirstPage){paginateQuestions()}relatedQuestionsLoadedState.isLoading=false;return}else{traJqC("#TTextNQA").html(msg("tra.qa.noQuestions.similarQuestions"))}for(var i=0;i<data.relatedQuestions.length;i++){var rQuestion=data.relatedQuestions[i];relatedUgcIds.questions.push("q-"+rQuestion.id);for(var j=0;j<rQuestion.answers.length;j++){relatedUgcIds.answers.push("a-"+rQuestion.answers[j].id)}}var relatedQs=traJqC("#TT3relatedQuestions");if(data.count){relatedQs.data("rq-count",data.count)}var insertProps={cont:relatedQs,hide:!loadingFirstPage,showAbout:true,showImg:true,insertInputBox:true,hideDefaultImg:true};if(loadingFirstPage){insertProps.questions=data.relatedQuestions;insertQAR(insertProps)}else{insertProps.append=true;for(var i=0;i<data.relatedQuestions.length;i++){insertProps.questions=[data.relatedQuestions[i]];insertQAR(insertProps)}}insertModerateLink(relatedQs,"answer");insertYouBadge(relatedQs);disableVotingForOwner(relatedQs);yieldToUI(function(){setupMultiItemScroll(relatedQs);setupInitialAnswersState(TurnTojQuery("#TT3itemQuestCont"),true,true);setupInitialAnswersState(relatedQs,true,true);if(loadingFirstPage){paginateQuestions()}});traJqC("#TT3relatedQuestionsWrp .TT3questWrp").last().removeClass("TT3questBorder");traJqC("#TT3relatedQuestionsWrp").show();relatedQuestionsLoadedState.isLoading=false},error:function(data,ioArgs){setupInitialAnswersState(TurnTojQuery("#TT3itemQuestCont"),true,true);if(loadingFirstPage){paginateQuestions()}relatedQuestionsLoadedState.isLoading=false}})}var relatedReviewsAdded=false;function insertRelatedReviews(page){if(!TurnToItemSku){return}var loadingFirstPage=!page||page==1;if((relatedReviewsAdded&&loadingFirstPage)||relatedReviewsLoadedState.isLoading){return}relatedReviewsAdded=true;relatedReviewsLoadedState.isLoading=true;var data={};data.sku=TurnToItemSku;staticXhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:"/sitedata/"+S.siteKey+"/v4_2/"+encodeURIComponent(TurnToItemSku)+"/r/"+S.locale+"/relatedreviews"+(page?"/"+page:""),load:function(data,ioArgs){if(!data.relatedReviews.length){relatedReviewsLoadedState.isLoading=false;return}var relatedReviewsCont=TurnTojQuery("#TT4relatedReviews");if(data.count){relatedReviewsCont.data("rr-count",data.count)}for(var i=0;i<data.relatedReviews.length;i++){data.relatedReviews[i].hide=!loadingFirstPage;insertReview(relatedReviewsCont,data.relatedReviews[i],{},data.shopperProfile)}var ttReviewCount=TurnTojQuery("#ttReviewCount").val();if(ttReviewCount==0){TurnTojQuery(".TTreviewSummary").show()}yieldToUI(function(){disableVotingForReviewOwner(relatedReviewsCont);insertModerateLink(relatedReviewsCont,"review");relatedReviewsCont.parent().show();truncateReviews(relatedReviewsCont);if(loadingFirstPage){paginateRelatedReviews()}});relatedReviewsLoadedState.isLoading=false},error:function(data,ioArgs){relatedReviewsLoadedState.isLoading=false}})}function insertYouBadge(elmnt,uid){if(!uid){uid=getCookie(LOGGED_IN_COOKIE_NAME)}if(!uid){return}TurnTojQuery(".TT3youHolder",elmnt).each(function(i){var el=TurnTojQuery(this);var children=el.children();if(el.attr("tt3-uid")==uid&&children.length==0){el.html(TurnToHTML.youBadge({}))}})}function insertModerateLink(elmnt,type){var muid=getCookie(MODERATOR_COOKIE_NAME);if(!muid){return}var moderateLabel=msg("tra.common.linkLine.moderate");if(type==="answer"){TurnTojQuery("#TTbrowseQAWrapper .TT3linkLine",elmnt).each(function(i){var el=TurnTojQuery(this);if(el.find(".TT3Moderate").length==0){var id=el.parents(".TT3questWrp").attr("id").split("-")[1];var moderateLink=' <li class="TTmoderateAnswer"><a class="TT3Moderate" target="_blank" href="'+TurnTo.partnerProtocol+"//"+S.host+"/moderation/qsolo?id="+id+'" rel="nofollow">'+moderateLabel+"</a></li>";var helpful=el.find(".TTflagAnswer");helpful.after(moderateLink)}});TurnTojQuery(".TT3questCntr :not('.TT3ansCntr') .TT3linkLine",elmnt).each(function(i){var el=TurnTojQuery(this);if(el.find(".TT3Moderate").length==0){var id=el.parents(".TT3questWrp").attr("id").split("-")[1];var moderateLink=' <li class="TTmoderateAnswer"><a class="TT3Moderate" target="_blank" href="'+TurnTo.partnerProtocol+"//"+S.host+"/moderation/qsolo?id="+id+'" rel="nofollow">'+moderateLabel+"</a></li>";var helpful=el.find(".TT3askedBy");if(helpful.length!=0){helpful.after(moderateLink)}else{el.append(moderateLink)}}})}else{if(type==="review"){var cont=TurnTojQuery(elmnt.selector);TurnTojQuery(".TTreview .TTrevLinkLine",cont).each(function(i){var el=TurnTojQuery(this);if(el.find(".TT3Moderate").length==0){var id=el.parents(".TTreview").attr("reviewId");var moderateLink=' <li><a class="TT3Moderate" target="_blank" href="'+TurnTo.partnerProtocol+"//"+S.host+"/reviews/rsolo?id="+id+"&siteId="+TurnTo.matchData.site.siteId+'" rel="nofollow">'+moderateLabel+"</a></li> ";el.append(moderateLink)}})}}}function disableVotingForOwner(elmnt,uid,fromProfile,newQuestion){if(!uid){uid=getCookie(LOGGED_IN_COOKIE_NAME)}if(!uid&&!newQuestion){return}TurnTojQuery(".TT3helpful",elmnt).each(function(i){var el=TurnTojQuery(this);var title=msg("tra.qa.question.linkLine.haveThisQuestionToo.cantVote.hover");if(el.attr("tt3-uid")==uid){if(fromProfile){el.remove()}else{var link=el.find("a");link.replaceWith("<span>"+link.html()+"</span>").attr("title",title);el.attr("title",title).addClass("TT4disabledVote")}}});TurnTojQuery(".TT4answerVote",elmnt).each(function(i){var el=TurnTojQuery(this);var title=msg("tra.qa.answer.cantVote.hover");if(el.attr("tt3-uid")==uid){el.attr("title",title).addClass("TT4disableVote")[0].onclick=null}});TurnTojQuery(".TT4addAnswer",elmnt).each(function(i){var el=TurnTojQuery(this);var title=msg("tra.qa.question.linkLine.addAnswer.cantAnswer.hover");if(el.attr("tt3-uid")==uid||newQuestion){if(fromProfile){el.parent().remove()}else{el.replaceWith('<span class="TT4disabledVote" title="'+title+'">'+el.html()+"</span>")}}})}function disableVotingForReviewOwner(elmnt,uid){if(!uid){uid=getCookie(LOGGED_IN_COOKIE_NAME)}if(!uid){return}var cont=TurnTojQuery(elmnt.selector);TurnTojQuery(".TThelpful",cont).each(function(i){var el=TurnTojQuery(this);var title=msg("tra.rev.linkLine.helpful.cantVote.hover");if(el.attr("tt-uid")==uid){el.find("a").each(function(){traJqC(this).attr("title",title).css("cursor","inherit")[0].onclick=null});el.attr("title",title)}})}function setupShowMediaModal(ugcCont){ugcCont=TurnTojQuery(ugcCont.selector);if(TurnToMods.mods.browserUtil.isIOS){ugcCont.find('.TTmediaBlock img[class^="TTorientation-"]').removeClass(function(index,css){if(css.indexOf("TTorientation-")>-1){var orientation=parseInt(css.split("-")[1]);if(TurnToMods.mods.imageUtil.isRotated(orientation)){var theImg=TurnTojQuery(this);var w=theImg.css("width");var h=theImg.css("height");theImg.css("width",h);theImg.css("height",w)}return css}return""})}ugcCont.undelegate("click.ttMediaModal keydown.ttMediaModal").delegate(".TTmediaBlock","click.ttMediaModal keydown.ttMediaModal",function(e){if(e.type=="keydown"&&!isEnterKey(e)){return}var mediaBlock=TurnTojQuery(this),mediaId=mediaBlock.data("media-id"),mediaCont=mediaBlock.closest(".TTmediaForUgc"),ugcId=mediaCont.data("ugc-id"),ugcType=mediaCont.data("ugc-type"),isModerator=getCookie(MODERATOR_COOKIE_NAME);var getMediaForModal=function(){var modalMediaDeferred=TurnTojQuery.Deferred();xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:TurnTo.xhrUri("/traServer4/getMediaContentForUgc")+"&ugcId="+ugcId+"&ugcType="+ugcType,load:function(data,ioArgs){modalMediaDeferred.resolve(data.mc,false)},error:function(data,ioArgs){modalMediaDeferred.reject()}});return modalMediaDeferred.promise()};TurnToMods.mods.mediaModal.display({getMediaPromise:getMediaForModal,mediaId:mediaId,isModerator:isModerator,siteId:TurnTo.matchData.site.siteId,siteName:TurnTo.matchData.site.siteName,appId:TurnTo.matchData.site.fbAppId})})}function displayMediaModalForIds(mediaIds){var isModerator=getCookie(MODERATOR_COOKIE_NAME);var getMediaForModal=function(){var modalMediaDeferred=TurnTojQuery.Deferred();xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:TurnTo.xhrUri("/traServer4/getMediaContentByIds")+"&mediaIds="+mediaIds,load:function(data,ioArgs){modalMediaDeferred.resolve(data.mc,false)},error:function(data,ioArgs){modalMediaDeferred.reject()}});return modalMediaDeferred.promise()};TurnToMods.mods.mediaModal.display({getMediaPromise:getMediaForModal,mediaId:mediaIds[0],isModerator:isModerator,siteId:TurnTo.matchData.site.siteId,siteName:TurnTo.matchData.site.siteName,appId:TurnTo.matchData.site.fbAppId})}function insertItemTeaserForSku(sku,clazz,callback){insertItemTeaserDone=false;var url="/sitedata/"+S.siteKey+"/v4_3/"+sku+"/d/itemjson";TurnTo.error=null;staticXhr("GET",{url:xhrUri(url),load:function(data,ioArgs){window.TurnToItemSku=sku;TurnToItemData=new Object();TurnToItemData.counts=data.counts;TurnToItemData.sku=sku;insertItemTeaser(clazz);if(callback){callback()}},error:function(data,ioArgs){if(callback){callback()}}})}function insertReviewsTeaserForSku(sku,clazz,callback){insertReviewTeaserDone=false;var url="/sitedata/"+S.siteKey+"/v4_3/"+sku+"/d/itemjson";TurnTo.error=null;staticXhr("GET",{url:xhrUri(url),load:function(data,ioArgs){window.TurnToItemSku=sku;TurnToItemData=new Object();TurnToItemData.counts=data.counts;TurnToItemData.sku=sku;insertReviewsTeaser(clazz);if(callback){callback()}},error:function(data,ioArgs){console.log("could not load reviews teaser for SKU "+sku+" - Status: "+data.status+" Error: "+data.error);if(callback){callback()}}})}var turntoflowItemSku=null;function insertItemTeasersForMultiSkus(skulist,indx){if(typeof indx=="undefined"){TurnTo.isMultiItemPage=true;indx=0;turntoflowItemSku=(turntoflow&&TurnToItemSku)?TurnToItemSku:null}window.TurnToItemSku=null;if(indx==skulist.length){if(turntoflowItemSku){TurnToItemSku=turntoflowItemSku}runClientCallbackFunc("questionTeaserRender");return}var itm=skulist[indx];var index2=indx+1;insertItemTeaserForSku(itm.sku,itm.teaserClass,function(){insertItemTeasersForMultiSkus(skulist,index2)})}function insertReviewTeasersForMultiSkus(skulist,indx){if(typeof indx=="undefined"){TurnTo.isMultiItemPage=true;indx=0}if(indx==skulist.length){runClientCallbackFunc("reviewsTeaserRender");return}var itm=skulist[indx];var index2=indx+1;insertReviewsTeaserForSku(itm.sku,itm.teaserClass,function(){insertReviewTeasersForMultiSkus(skulist,index2)})}var insertItemTeaserDone=false;function insertItemTeaser(clazz){if(!insertItemTeaserDone){if(typeof TurnToItemData!="undefined"){TurnTo.doIteaser=true;loadItemTeaser(TurnToItemData,clazz);insertItemTeaserDone=true}else{if(typeof TurnToMultiSku!="undefined"){insertItemTeasersForMultiSkus(TurnToMultiSku)}}}}var insertItemInputTeaserDone=false;function insertItemInputTeaser(clazz){if(!insertItemInputTeaserDone){if(typeof TurnToItemData!="undefined"){TurnTo.doIITeaser=true;loadItemInputTeaser(clazz);insertItemInputTeaserDone=true}}}var insertReviewTeaserDone=false;function insertReviewsTeaser(clazz){if(!insertReviewTeaserDone){if(typeof TurnToItemData!="undefined"){TurnTo.doRTeaser=true;loadReviewsTeaser(clazz);insertReviewTeaserDone=true}else{if(typeof TurnToReviewsMultiSku!="undefined"){insertReviewTeasersForMultiSkus(TurnToReviewsMultiSku)}}}}function displayTeasers(arg1,fromMobile){var inBeforeReady=arg1||false;if(TurnTo.doIteaser){if(inBeforeReady){insertUI(fromMobile);insertItemTeaser()}else{if(!S.useSetup){insertItemTeaser()}}}if(TurnTo.doIIteaser){if(inBeforeReady){insertUI(fromMobile);insertItemInputTeaser()}else{if(!S.useSetup){insertItemInputTeaser()}}}if(TurnTo.doRteaser){if(inBeforeReady){insertUI(fromMobile);insertReviewsTeaser()}else{if(!S.useSetup&&!S.loadRteaserAfterChatter){insertReviewsTeaser()}if(S.loadRteaserAfterChatter){if(typeof TurnToChatter==="undefined"||!TurnToChatter.updatedCCWdgtC){var ccEl=TurnTojQuery("#TurnToChatterContent");if(ccEl.length>0){if(document.addEventListener){ccEl[0].addEventListener("ccWdgtC.updated",function(){insertReviewsTeaser()})}}var attempts=0;var intervalId=setInterval(function(){attempts++;if(attempts>4){clearInterval(intervalId);return}try{var rTeas=TurnTojQuery(".TurnToReviewsTeaser").first();if(TurnToChatter.updatedCCWdgtC&&TurnTojQuery.trim(rTeas.text())===""){insertReviewsTeaser();clearInterval(intervalId)}}catch(e){}},400)}else{insertReviewsTeaser()}}}}}TurnTo.displayTeasers=function(teaserClasses){var iTeaserClass=null;var iiTeaserClass=null;var rTeaserClass=null;if(teaserClasses){var iTeaserClass=teaserClasses.itemTeaserClass;var iiTeaserClass=teaserClasses.itemInputTeaserClass;var rTeaserClass=teaserClasses.reviewTeaserClass}checkDoIteaser();checkDoIIteaser();checkDoRteaser();if(TurnTo.doIteaser){if(typeof TurnToItemData!="undefined"){loadItemTeaser(TurnToItemData,iTeaserClass)}}if(TurnTo.doIIteaser){if(typeof TurnToItemData!="undefined"){TurnTo.doIITeaser=true;loadItemInputTeaser(iiTeaserClass)}}if(TurnTo.doRteaser){if(typeof TurnToItemData!="undefined"){TurnTo.doRTeaser=true;loadReviewsTeaser(rTeaserClass)}}};function insertHead(){if(!S.skipCssLoad){var headID=document.getElementsByTagName("head")[0];var cssNode=document.createElement("link");cssNode.type="text/css";cssNode.rel="stylesheet";cssNode.href=TurnTo.stylesheetUrl;cssNode.media="screen";headID.appendChild(cssNode)}}var insertUiComplete=false;function insertUI(fromMobile){if(insertUiComplete){return}if(hasSpinScreen){TurnTojQuery("#TTturntospinner").replaceWith(TurnToHTML.mainscreen)}else{if(S.useSetup){TurnTojQuery("#TurnToSetup").append("<div id='TTturntoTra'></div>")}else{var traDiv=document.createElement("div");traDiv.id="TTturntoTra";document.body.appendChild(traDiv)}TurnTojQuery("#TTturntoTra").replaceWith(TurnToHTML.mainscreen)}insertUiParts(fromMobile);if(!onMobile){resize()}traWindow=TurnTojQuery("#TTtraWindow")[0];traSubWindow=TurnTojQuery("#TTtraSubWindow")[0];traWindow.overlay=TurnTojQuery("#TTtraBackOverlay")[0].style;traSubWindow.overlay=TurnTojQuery("#TTtraInsideOverlay")[0].style;if(!fromMobile){var clsr=TurnTojQuery("#TTtraWindowClose")[0];if(clsr){clsr.onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false}}TurnTojQuery("#TTSubWindowClose")[0].onclick=function(e){toggleSubWindow("none");if(!isWidgetOpen()&&!S.inProfile){toggleMainWindow("block")}TurnTojQuery("#TTmainContent").css("height","auto")}}if(fromMobile){TurnTojQuery("#TTtraWindow").append(TurnToHTML.responsiveMainscreen)}TurnTo.jQcontext=TurnTojQuery("#TTtraWindow");TurnTo.jQcontext2=S.setupType=="overlay"?TurnTo.jQcontext:TurnTojQuery("#TurnToContent");TurnTo.jQcontext3=S.setupType=="overlay"||S.setupType=="mobileTT"?TurnTo.jQcontext:TurnTojQuery("#TurnToReviewsContent");toolTipQ=TurnTojQuery("#TTtoolTip");toolTipQ[0].onmouseout=function(e){toolTipQ[0].style.display="none"};if(TurnTojQuery.support.boxModel&&!onMobile){TurnTojQuery("#TTtraWindow").css("position","fixed")}else{TurnTojQuery("#TTtraWindow").css("position","absolute")}insertUiComplete=true}function insertUiParts(fromMobile){if(TurnTo.loggedIn){if(!fromMobile){insertScreen("#TTtraUserStateMain",TurnToHTML.TTtraLoggedInMain)}var clsr=TurnTojQuery("#TTtraWindowClose")[0];if(clsr){clsr.onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false}}}else{if(!fromMobile){insertScreen("#TTtraUserStateMain",TurnToHTML.TTtraLoggedOutMain)}var clsr=TurnTojQuery("#TTtraWindowClose")[0];if(clsr){clsr.onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false}}}if(S.removeTurnToLogo){traJq("#TTtraFooterLogo").hide()}}TurnTo.openPopupWindow=function openPopupWindow(url,title){window.open(url,title,"height=550,width=650,status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1")};function insertFullComments(){if(TurnTo.doFullComments){var config=S.fullComments?S.fullComments:{};config.offset=0;var container=TurnTojQuery("#TurnToFullComments");container.append('<div id="TT3fullChatterHeader">'+config.headerText+"</div>");container.append('<div id="TT3fullChatterCont"></div>');container.append('<div id="TT3fetchMore" style="display:none;"><img id="TTloginSpinner" style="border:none;display:inline;vertical-align:middle;padding-right:5px" height="26" src="'+TurnTo.getStaticUrl("/tra3/images/traspin.gif")+'" alt="'+msg("tra.commom.alt.loading")+'"/><span>'+msg("tra.chatter.message.loadingMore")+"</span></div>");var chatterBox=container.find("#TT3fullChatterCont");chatterBox.width(config.width);chatterBox.height(config.height);chatterBox.css("position","relative");getMoreCommentBlocks()}}function testScrollForChatter(){var elem=TurnTojQuery("#TT3fetchMore").show().css("visibility","hidden");var docViewTop=TurnTojQuery(window).scrollTop();var h=TurnTojQuery(window).height();var docViewBottom=docViewTop+h;var elemTop=elem.offset().top;var elemBottom=elemTop+elem.height();if(elemTop-h<=docViewBottom){TurnTojQuery(window).unbind("scroll.turntoChatterScroll");elem.show();getMoreCommentBlocks()}}function getMoreCommentBlocks(){var config=S.fullComments?S.fullComments:{};var spacing=S.fullComments.spacing?parseInt(S.fullComments.spacing):10;staticXhr("GET",{url:xhrUri("/sitedata/fullcomments/"+S.siteKey+"/v4_3/"+S.locale+"/"+config.offset+"/"+config.limit+"/"+config.maxDaysOld+(config.category?("/"+config.category):"")),load:function(data,ioArgs){TurnTo.pbItemShown();var container=TurnTojQuery("#TurnToFullComments");var chatterBox=container.find("#TT3fullChatterCont");config.offset=data.offset;for(var i=0;i<data.catItemComments.length;i++){var comment=traJq(TurnToHTML.commentBlock({comments:data.catItemComments[i],profilesEnabled:!S.noProfiles}));if(config.boxWidth){comment.width(config.boxWidth)}chatterBox.append(comment);TurnTojQuery(".TT3chatterFullBox").last().mouseover(function(){var shareButtonContainer=TurnTojQuery(this).find(".TT3shareBtns");var shareIframeIncluded=shareButtonContainer.attr("shareiframeincluded");if(shareIframeIncluded!="true"){shareButtonContainer.attr("shareiframeincluded","true");var catItemTitle=shareButtonContainer.attr("catitemtitle");var catItemImageId=shareButtonContainer.attr("catitemimageid");var siteId=shareButtonContainer.attr("siteid");var siteCatalogItemId=shareButtonContainer.attr("sitecatalogitemid");var shareButtonsHtml=traJq(TurnToHTML.commentBlockShareButtons({catItemTitle:catItemTitle,catItemImageId:catItemImageId,siteId:siteId,siteCatalogItemId:siteCatalogItemId}));shareButtonContainer.append(shareButtonsHtml)}shareButtonContainer.css("display","block")});TurnTojQuery(".TT3chatterFullBox").last().mouseleave(function(){var shareButtonContainer=TurnTojQuery(this).find(".TT3shareBtns");shareButtonContainer.css("display","none")});if(i==0&&!config.columnHeights){var columns=config.columns=Math.floor(chatterBox.width()/(comment.outerWidth()+spacing));config.columnHeights=new Array(columns);for(var j=0;j<columns;j++){config.columnHeights[j]=0}if(config.layoutMode=="centered"){config.leftSpacing=(chatterBox.width()-(((columns-1)*spacing)+(columns*comment.outerWidth())))/2;config.hSpacing=spacing}else{config.leftSpacing=0;config.hSpacing=(chatterBox.width()-(columns*comment.outerWidth()))/(columns-1)}config.curColumn=0}var curColumn=config.curColumn%config.columns;comment.css("top",config.columnHeights[curColumn]+spacing);if(curColumn==0){comment.css("left",config.leftSpacing)}else{comment.css("left",config.leftSpacing+(curColumn*config.hSpacing)+(curColumn*comment.outerWidth()))}var commentHeight=comment.outerHeight();if(comment.find(".TT3commentImg").height()==0){config.columnHeights[curColumn]+=commentHeight+spacing+parseInt(config.boxWidth)}else{config.columnHeights[curColumn]+=commentHeight+spacing}config.curColumn++}setupProfileLinks(container,"TT3fullChatterAskedBy",true);var max=0;for(var j=0;j<config.columns;j++){if(config.columnHeights[j]>max){max=config.columnHeights[j]}}chatterBox.height(max);container.height(max+TurnTojQuery("#TT3fullChatterHeader").outerHeight()+20);TurnTojQuery("#TT3fetchMore").hide();if(data.moreComments){TurnTojQuery(window).bind("scroll.turntoChatterScroll",testScrollForChatter)}},error:function(data,ioArgs){}})}function insertRecentComments(){if(TurnTo.doRecentComments){var recentCommentsConfig=S.recentComments?S.recentComments:{};staticXhr("GET",{url:xhrUri("/sitedata/recentcomments/"+S.siteKey+"/v4_3/"+S.locale+"/0/"+recentCommentsConfig.limit+"/"+recentCommentsConfig.frequency+"/"+recentCommentsConfig.timeWindowInHours+"/"+recentCommentsConfig.commentMinLength+(recentCommentsConfig.category?("/"+recentCommentsConfig.category):"")),load:function(data,ioArgs){if(S.customChatterFunc){for(var i=0;i<data.comments.length;i++){data.comments[i].catItem.imageUrl=TurnTo.getProductImage(data.comments[i].catItem.imageId,"SS")}S.customChatterFunc(data);return}var container=TurnTojQuery("#TurnToRecentComments").html(TurnToHTML.recentCommentsBlock({width:(recentCommentsConfig.width?recentCommentsConfig.width:null),height:(recentCommentsConfig.height?recentCommentsConfig.height:null)}));var chatter=container.find("#TT3chatter");var header=container.find("#TT3chatterHeader");var footer=container.find("#TT3chatterFooter");var totalHeight=container.height();var content=container.find("#TT3chatterCont").height(container.outerHeight()-header.height()-footer.outerHeight(true));chatter.attr("pages",1);chatter.attr("curpage",0);insertComments(data.comments,chatter,content.height());chatter.attr("minId",data.minId);setupProfileLinks(container,null,true);container.find("#TT3whatsThis").click(function(){var dialog=container.find("#TT3whatsThisDialog");if(dialog.is(":visible")){dialog.hide()}else{dialog.css("margin-top",traJq(this).height()+12).show()}});if(data.comments.length<recentCommentsConfig.limit){chatter.attr("morecomments",false)}container.find("#TT3whatsThisDialog").click(function(){traJq(this).hide()});var animateFunc;if(recentCommentsConfig.animationType=="none"){container.find("#TT3chatterBox").mouseover(function(){var curPage=parseInt(chatter.attr("curpage"));if(curPage+1<parseInt(chatter.attr("pages"))){container.find("#TT3nextBtn").show()}if(curPage>0){container.find("#TT3prevBtn").show()}});container.find("#TT3chatterBox").mouseout(function(){container.find("#TT3nextBtn").hide();container.find("#TT3prevBtn").hide()});container.find("#TT3nextBtn").click(function(){var curPage=parseInt(chatter.attr("curpage"))+1;var pages=parseInt(chatter.attr("pages"));if(curPage<=pages){chatter.attr("curpage",curPage);chatter.css("top",content.height()*-curPage);if(curPage+1>=pages){if(chatter.attr("morecomments")!="false"){getMoreComments()}else{traJq(this).hide()}}}});container.find("#TT3prevBtn").click(function(){var curPage=parseInt(chatter.attr("curpage"))-1;if(curPage>0){chatter.attr("curpage",curPage);chatter.css("top",content.height()*-curPage)}else{chatter.attr("curpage",curPage);chatter.css("top",0);traJq(this).hide()}})}else{if(recentCommentsConfig.animationType=="zoomUp"){animateFunc=function(){if(parseInt(chatter.attr("curpage"))+1>=parseInt(chatter.attr("pages"))){chatter.attr("curpage",-1);chatter.css("top",content.height())}zoomUp(chatter,content.height(),function(){var curPage=parseInt(chatter.attr("curpage"))+1;chatter.attr("curpage",curPage);var pages=parseInt(chatter.attr("pages"));if(curPage+2>=pages){if(chatter.attr("morecomments")!="false"){getMoreComments()}else{traJq(this).hide()}}})}}else{animateFunc=function(){scrollUp(function(){var pages=parseInt(chatter.attr("pages"));var pageHeight=content.height();var curPage=Math.floor(Math.abs(parseInt(chatter.css("top")))/pageHeight);if(curPage+2>=pages){var lastFetchPage=chatter.attr("lastfetchpage");lastFetchPage=lastFetchPage?parseInt(lastFetchPage):-1;if(chatter.attr("morecomments")!="false"&&lastFetchPage!=curPage){getMoreComments();chatter.attr("lastfetchpage",curPage)}}})}}}if(animateFunc){var timeOut=setInterval(animateFunc,recentCommentsConfig.animationFreqInMs);content.mouseover(function(){clearInterval(timeOut)});content.mouseout(function(){timeOut=setInterval(animateFunc,recentCommentsConfig.animationFreqInMs)})}},error:function(data,ioArgs){console.log("recent comments json XHR - Status: "+data.status+" Error: "+data.error)}})}}function getMoreComments(){var chatter=TurnTojQuery("#TT3chatter");var startId=chatter.attr("minId");var recentCommentsConfig=S.recentComments?S.recentComments:{};staticXhr("GET",{url:xhrUri("/sitedata/recentcomments/"+S.siteKey+"/v4/"+startId+"/"+recentCommentsConfig.limit+"/"+recentCommentsConfig.frequency+"/"+recentCommentsConfig.timeWindowInHours+"/"+recentCommentsConfig.commentMinLength+(recentCommentsConfig.category?("/"+recentCommentsConfig.category):"")),load:function(data,ioArgs){var container=TurnTojQuery("#TurnToRecentComments");var chatter=container.find("#TT3chatter");var content=container.find("#TT3chatterCont");insertComments(data.comments,chatter,content.height());chatter.attr("minId",data.minId);if(data.comments.length<recentCommentsConfig.limit){chatter.attr("morecomments",false)}else{chatter.attr("morecomments",true)}},error:function(data,ioArgs){TurnTojQuery("#TT3chatter").attr("morecomments",false)}})}function insertComments(comments,chatter,pageHeight){var page;var curPageHeight=0;var totalPages=parseInt(chatter.attr("pages"));var lastPage=chatter.children(".TT3chatterPage").last();lastPage.children(".TT3chatterComment").each(function(){curPageHeight+=traJq(this).outerHeight()});if(lastPage.length>0){page=lastPage}else{page=traJq('<div class="TT3chatterPage"></div>');page.height(pageHeight);chatter.append(page)}for(var i=0;i<comments.length;i++){var comment=traJq(TurnToHTML.recentComment({comment:comments[i],profilesEnabled:!S.noProfiles}));page.append(comment);curPageHeight+=comment.outerHeight(true);if(S.recentComments.animationType!="crawlUp"&&curPageHeight>=page.height()){page=traJq('<div class="TT3chatterPage"></div>');page.height(pageHeight);totalPages++;chatter.append(page);comment.remove();page.append(comment);curPageHeight=comment.outerHeight(true)}}chatter.attr("pages",totalPages)}function scrollUp(onStepFn){var chatter=TurnTojQuery("#TT3chatter");var newTop=parseInt(chatter.css("top"))-2;if(Math.abs(newTop)>TurnTojQuery("#TT3chatter").height()){newTop=0}chatter.css("top",newTop);if(onStepFn){onStepFn()}}function zoomUp(elem,amount,onFinish){if(amount>0){var newTop=parseInt(elem.css("top"))-Math.min(amount,10);elem.css("top",newTop);setTimeout(function(){zoomUp(elem,amount-Math.min(amount,10),onFinish)},50)}else{if(onFinish){onFinish()}}}function unsupport(){if(navigator.userAgent.indexOf("AOL")>=0||navigator.userAgent.indexOf("googleweblight")>=0){return true}if(TurnTojQuery.browser.msie&&TurnTojQuery.browser.version.indexOf(".")&&TurnTojQuery.browser.version.substr(0,TurnTojQuery.browser.version.indexOf("."))<7){return true}if(S.useFlashXHR){if(FlashDetect.major<9){return true}else{if(FlashDetect.major==9&&FlashDetect.minor==0&&FlashDetect.revision<124){return true}}}return false}function checkDoResponsive(){if(S.skipContainerWidthCheck){return}if(!onMobile){var embeddedReviewsDivWidth=traJqR("#TurnToReviewsContent").width();var embeddedQADivWidth=traJq("#TurnToContent").width();var isRevVisible=traJqR("#TurnToReviewsContent").is(":visible");var isQAVisible=traJqR("#TurnToContent").is(":visible");if((isRevVisible&&embeddedReviewsDivWidth!=null&&embeddedReviewsDivWidth>0&&embeddedReviewsDivWidth<=479)||(isQAVisible&&embeddedQADivWidth!=null&&embeddedQADivWidth>0&&embeddedQADivWidth<=479)){var headId=document.getElementsByTagName("head")[0];var cssNode=document.createElement("link");cssNode.type="text/css";cssNode.rel="stylesheet";cssNode.href=getStaticUrl((S.devMode)?"/traServer4_3/tradevcss/"+S.siteKey+"/tra-narrow/"+S.locale:"/tra4_3/tra-narrow-"+S.locale+".css");cssNode.media="screen";headId.appendChild(cssNode);inRail=true}else{if((isRevVisible&&(embeddedReviewsDivWidth!=null)&&embeddedReviewsDivWidth>479&&embeddedReviewsDivWidth<=736)||(isQAVisible&&embeddedQADivWidth!=null&&embeddedQADivWidth>479&&embeddedQADivWidth<=736)){var headId=document.getElementsByTagName("head")[0];var cssNode=document.createElement("link");cssNode.type="text/css";cssNode.rel="stylesheet";cssNode.href=getStaticUrl((S.devMode)?"/traServer4_3/tradevcss/"+S.siteKey+"/tra-wide/"+S.locale:"/tra4_3/tra-wide-"+S.locale+".css");cssNode.media="screen";headId.appendChild(cssNode);inRail=true}else{return}}}}function onload(){IEversion=TurnTojQuery.browser.version.substr(0,1);IE7or8=IEversion==7||IEversion==8;if(TurnTojQuery.browser.msie){TurnTo.quirksMode=document.compatMode!="CSS1Compat"}onMobile=isMobileDevice();checkDoIteaser();checkDoIIteaser();checkDoRteaser();checkDoRecentComments();checkDoFullComments();checkDoQA();checkDoReviews();if(S.useFlashXHR){if(FlashDetect.major<9){return}else{if(FlashDetect.major==9&&FlashDetect.minor==0&&FlashDetect.revision<124){return}else{finishOnload()}}}else{finishOnload()}}function finishOnload(){insertHead();checkDoResponsive();checkThirdPartyCookies();var visitorParts=TurnToTrack.visitTeaserShown(S.useStaticTeaser||(preLoadedSite&&!getCookie(LOGGED_IN_COOKIE_NAME)));setCookie(TEASER_SHOWN_COOKIE_NAME,new Date().getTime(),2592000);if(S.setupType=="mobileTT"){TurnTojQuery("body").addClass("TTmobileLandingPageBody")}if(turntoflow&&preLoadedSite&&!onMobile){insertUI();traHookCheck()}else{if(preLoadedSite&&onMobile&&turntoflow){insertUI(true);traHookCheck()}else{if(turntomobileflow){insertUI(true);traMobileHookCheck()}}}if(preLoadedSite){setTimeout(function(){displayTeasers(null,turntomobileflow?true:false);insertRecentComments();insertFullComments();if(!turntoflow&&!turntomobileflow){insertUI()}insertQA(insertReviews);if(S.onloadFn){S.onloadFn()}if(S.setupType=="mobileTT"){TurnTojQuery("#TTtraWindow").css("position","relative");var ttDiv=TurnTojQuery("#TTtraWindow");var clientDiv=TurnTojQuery("#mobileTT-content");if(clientDiv.length){clientDiv.append(ttDiv)}}},0)}checkUnloadReg()}TurnTo.initialize=function(){if(S.fullComments){S.fullComments.columnHeights=null}insertUiComplete=false;TurnTo.jQcontext=undefined;TurnTo.jQcontext2=undefined;TurnTo.jQcontext3=undefined;var hasDRFired=document.attachEvent?document.readyState==="complete":document.readyState!=="loading";if(hasDRFired){TurnTo.onload()}else{TurnTojQuery(document).ready(TurnTo.onload)}};function insertQA(callbackFn){if(TurnTo.doQA){if(S.dynamicEmbeded){insertEmbedTra(callbackFn)}else{if(S.setupType!="overlay"){if(TurnTojQuery("#TurnToContent").is(":empty")){if(S.emptyQAMessage){TurnTojQuery("#TurnToContent").append(S.emptyQAMessage)}}insertInstructionalCopy();insertNonIndexedUgc();setupQuestionSubmit();if(S.instantAnswers){TurnTojQuery("#TT2questionText").keyup(function(){instantanswers(traJq(this),{fromQA:true})})}setupProfileLinks();insertInlineAnswerBoxes();setupMultiItemScroll();personalizeUgc(function(){setupInitialAnswersState(null,true);TurnTojQuery("#TT2questionText").focus(function(){if(S.registration){syncPartnerAndTTuserState(function(statusObj){if(TurnTo.matchData.user){showHiInHeader()}})}else{if(!TurnTo.matchData.user){checkForLIUser(function(){showHiInHeader()})}}TurnTojQuery("#TT2questionText").focus(null)});if(S.insertRelatedContentOnLoad){insertRelatedQuestions()}else{paginateQuestions()}});checkUseSmallDimensions();yieldToUI(function(){setupTextareaAutoSizing(TurnTojQuery("#TT2questionText",TurnTojQuery("#TurnToContent")),3);TurnTojQuery("#TT4closeQuestionBox").click(function(){resetQuestionArea()});TurnTojQuery("#TT4closeQuestionBox").keydown(function(e){if(isEnterKey(e)){resetQuestionArea()}})});if(callbackFn){callbackFn()}}}}else{if(callbackFn){callbackFn()}}}function insertReviews(){if(TurnTo.doReviews){if(S.dynamicEmbededReviews){insertEmbedReviews()}else{if(S.reviewsSetupType=="staticEmbed"){var ttContentEl=TurnTojQuery("#TurnToReviewsContent");TurnTo.jQcontext3=ttContentEl;if(TurnTo.isPlaceHolderSupported()){TurnTojQuery("#TTreviewSearchTerm").attr("placeholder",TurnTo.S.reviewsSearchBoxDefaultText)}else{TurnTojQuery("#TTreviewSearchTerm").attr("ttinputlabeltext",TurnTo.S.reviewsSearchBoxDefaultText);TurnTojQuery("#TTreviewSearchTerm").attr("value",TurnTo.S.reviewsSearchBoxDefaultText);TurnTojQuery("#TTreviewSearchTerm").attr("onblur","TurnTo.inputLoseFocus(this)");TurnTojQuery("#TTreviewSearchTerm").attr("onfocus","TurnTo.inputFocus(this)");TurnTojQuery("#TTreviewSearchTerm").attr("class","TTdefaultInput")}TurnTojQuery("#TTreviewSearchTerm").keyup(function(){var curVal=TurnTojQuery("#TTreviewSearchTerm").val();var curValLen=curVal?curVal.length:0;if(curValLen===0){TurnTo.clearReviewsSearchResults()}else{TurnTojQuery("#TTreviewsWrapper").hide();TurnTo.clearReviewsSearchResults(true);instantanswers(traJq(this),{fromReviews:true})}});TurnTojQuery("#TTwriteReviewBtn").keydown(function(e){if(isEnterKey(e)){writeReview()}});paginateDirectReviews();truncateReviews(ttContentEl);disableVotingForReviewOwner(ttContentEl);checkUseSmallDimensions();setupShowMediaModal(ttContentEl);if(S.insertRelatedContentOnLoad){insertRelatedReviews()}insertJsonLDMetadata()}}}}TurnTo.reset=function(cmd){var isMultiSkuPage=(typeof TurnToMultiSku!="undefined")||(typeof TurnToReviewsMultiSku!="undefined");if(cmd===undefined){cmd={}}if(!(cmd.sku)&&!isMultiSkuPage){return}TurnToItemSku=cmd.sku;insertItemTeaserDone=false;insertReviewTeaserDone=false;relatedQsAdded=false;relatedReviewsAdded=false;if(isMultiSkuPage){TurnToItemData=undefined;if(typeof TurnToMultiSku!="undefined"){insertItemTeaser()}if(typeof TurnToReviewsMultiSku!="undefined"){insertReviewsTeaser()}return}staticXhr("GET",{url:xhrUri("/sitedata/"+S.siteKey+"/v4_3/"+TurnToItemSku+"/d/itemjson"),load:function(data,ioArgs){TurnToItemData=new Object();TurnToItemData.counts=data.counts;TurnToItemData.sku=cmd.sku;TurnTo.displayTeasers();if(S.setupType=="staticEmbed"){S.setupType="dynamicEmbed";S.dynamicEmbeded=true}if(S.reviewsSetupType=="staticEmbed"){S.reviewsSetupType="dynamicEmbed";S.dynamicEmbededReviews=true}insertQA();insertReviews()},error:function(data,ioArgs){}})};function insertInstructionalCopy(){var qTextHlpCnt=TurnTojQuery("#TT4questionTextHelp");if(S.questionStartTypingText&&qTextHlpCnt.length>0){TurnTojQuery("#TT4questionTextHelp")[0].previousSibling.nodeValue=S.questionStartTypingText+" "}updateCommonInstructionInvalidTextIfCustomization(TurnTojQuery("#TTaskAreaBtnLine_instr"));if(!S.instructCopy){TurnTojQuery("#TT4questionTextHelp").hide()}else{var closeFn=function(){TurnTojQuery("#TT4questionTextHelpCnt").hide()};TurnTojQuery("#TT4questionTextHelpCloser").click(closeFn).keydown(closeFn,checkEnterKeyHandleCallback);TurnTojQuery("#TT4questionTextHelp").show().click(function(){if(S.instructionalCopyContent){TurnTojQuery("#TT4questionTextHelpContent").html(S.instructionalCopyContent);TurnTojQuery("#TT4questionTextHelpCnt").show()}else{var hasSuggested=(typeof TurnToSuggestedQuestions!="undefined"&&TurnToSuggestedQuestions);TurnTojQuery("#TT4questionTextHelpContent").html(TurnToHTML.informationOverlayDefault({hasSuggested:hasSuggested}));TurnTojQuery("#TT4questionTextHelpCnt").show();if(hasSuggested){TurnTojQuery("#TTviewSuggested").click(function(){TurnTojQuery("#TT4instantAnswersQ").hide();TurnTojQuery("#TTmiqBubble").hide();toggleSubWindow("none");var container=TurnTojQuery("#TTsuggestedQs");container.empty();for(var i=0;i<TurnToSuggestedQuestions.length;i++){container.append(TurnToHTML.suggestedQuestion({text:TurnToSuggestedQuestions[i]})).show()}container.find(".TTsqRight a").click(function(){var text=TurnTojQuery(this).html();TurnTojQuery("#TT2questionText").focus().val(text).removeClass("TTdefaultInput").keyup()})})}}})}}function showHiInHeader(){TurnTojQuery.each(["#TThiMsg","#TTrevHiMsg"],function(index,hiId){if(TurnTo.matchData.user&&TurnTojQuery(hiId).is(":empty")){var displayName=formatName(TurnTo.matchData.user,false,"nickFirst");TurnTojQuery(hiId).html(TurnToHTML.hiHeaderMsg({displayName:displayName})+" | ");updateLogoutLinks(logOut)}})}var miqaCatItems4Ans={};function insertInlineAnswerBoxes(cont){var itemsBoxes=cont?cont.find(".TT3itemBox"):traJqC(".TT3itemBox");itemsBoxes.each(function(){var itemBox=traJqC(this);var qid=itemBox.attr("ttqid");if(qid){itemBox.parent().next().after(TurnToHTML.inlineAnswerInputBox({qid:qid,aid:null,defaultText:msg("tra.qa.answer.instruction.enterAnswer"),rid:null,show:false,replyInput:false,related:false,replyToUid:null}));addTextToButtons();setupInlineAnswer(traJqC("#TT3quest-"+qid),qid);setupQuestionText(traJqC("#TT3quest-"+qid))}else{setupQuestionText(traJqC("#TT3quest-SYSGEN"))}})}function showInputBox(elem,qid,aid,rid){var qarid=qid+(aid?(aid+(rid?rid:"")):"");var parentQ=traJqC(elem).parents(".TT3questWrp");var box=parentQ.find("#TT2answersBlock-"+qarid);if(box.is(":visible")){box.hide()}else{box.show();parentQ.find("#TT2inlineAnswer-"+qarid).focus()}}var traMobileHookCheckDone=false;function traMobileHookCheck(){if(traMobileHookCheckDone){return}if(!turntomobileflow){return}var addDone=false;if(turntomobileflow=="mobileMyQA"){myQA(true)}else{if(turntomobileflow=="mobileProfile"){displayProfile(TurnTo.params.uid,TurnTo.params.fromChatter,true,TurnTo.params.rid)}else{if(turntomobileflow=="mobileWriteReview"){writeReview({turntosku:TurnTo.params.turntosku},true)}else{if(turntomobileflow=="doMore"){displayDoMore(null,true)}else{if(turntomobileflow=="readReview"){itemReviewTeaserClick({fromMobile:true})}else{if(turntomobileflow=="writeReview"){itemReviewTeaserClick({fromMobile:true,writeReview:true})}else{if(turntomobileflow=="readComments"){toggleMainWindow("none");showQuestionWidget({iteaserClick:true,sku:TurnToItemSku,fromInputTeaser:false,text:""})}else{if(turntomobileflow=="fromInputTeaser"){toggleMainWindow("none");showQuestionWidget({iteaserClick:true,sku:TurnToItemSku,fromInputTeaser:TurnTo.params.fromInputTeaser=="true",text:(typeof TurnTo.params.text!="undefined"?unescape(TurnTo.params.text):"")})}}}}}}}}if(addDone&&!S.traSkipTurntodoneInLocation){window.location=window.location+"#turntodone"}traMobileHookCheckDone=true}var traHookCheckDone=false;function traHookCheck(){if(traHookCheckDone){return}if(!turntoflow){return}if(S.skipTurnToEmailHookCheck){return}var xauthToken=TurnTo.params.turntoxauthtoken;if(xauthToken){setCookie(LOGGED_IN_TOKEN_COOKIE_NAME,xauthToken,31536000)}var addDone=false;if((TurnTo.params.turntoflow=="fmatch"||TurnTo.params.turntoflow=="ppemail")&&TurnTo.params.turntoeml){TurnTo.pteFlowStarted=true;getItems4Pte(TurnTo.params.turntoeml,TurnTo.params.turntotri,TurnTo.params.turntoiuid,function(){displayManagePastPurchases()});addDone=true}else{if((TurnTo.params.turntoflow=="answer"||TurnTo.params.turntoflow=="irrelevantq")&&TurnTo.params.turntoqid&&TurnTo.params.turntosuid){if(TurnTo.params.turntoflow=="answer"&&getCookie("TURNTO_VISITOR_COOKIE")==null){toggleMainWindow("none");showMainMessage(msg("tra.systemMessage.notAcceptingCookies"),msg("tra.systemMessage.button.ok"),"",toggleMainWindow);return}if(TurnTo.params.turntoqid&&TurnTo.params.turntosuid){TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;if(TurnTo.params.turntoqid.indexOf(".")>0){TurnTo.params.turntoqid=TurnTo.params.turntoqid.replace(/[.]/g,"=")}if(TurnTo.params.turntosuid.indexOf(".")>0){TurnTo.params.turntosuid=TurnTo.params.turntosuid.replace(/[.]/g,"=")}var rebelMailCallback=function(){if(TurnTo.params.turntoFromRebelmail){var cmdObj={};cmdObj.fromRebelMail=TurnTo.params.turntoFromRebelmail;cmdObj.turntoflow=TurnTo.params.turntoflow;cmdObj.turntoqid=TurnTo.params.turntoqid;if(TurnTo.params.ttAnswer!=undefined){cmdObj.ttAnswer=decodeURIComponent(TurnTo.params.ttAnswer);traJq("#TT2answerText").val(cmdObj.ttAnswer).removeClass("TTdefaultInput")}TurnToTrack.track("TTanswerWindow",cmdObj);traJq("#TT2answerBtn").click()}};if(TurnTo.params.turntoflow=="answer"&&S.registration&&S.registration.localLogoutFunction){showAnswerWidget(TurnTo.params.turntoqid,TurnTo.params.turntosuid,TurnTo.params.sourceId,TurnTo.params.iqrlId,function(answerer){S.registration.localGetUserInfoFunction(function(statusObj){if(!statusObj.user_auth_token){return}if(statusObj.email!=answerer.email){S.registration.localLogoutFunction(function(){})}});rebelMailCallback()})}else{showAnswerWidget(TurnTo.params.turntoqid,TurnTo.params.turntosuid,TurnTo.params.sourceId,TurnTo.params.iqrlId,rebelMailCallback)}}setCookie(QUESTION_EMAIL_COOKIE_NAME,new Date().getTime(),2592000);addDone=true}else{if((TurnTo.params.turntoflow=="answerview"||TurnTo.params.turntoflow=="replyview")&&TurnTo.params.turntocatitmid){if(isWidgetOpen()){toggleMainWindow("none");TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;if(TurnTo.params.turntoqid||TurnTo.params.turntoaid){showSoloQuestionViewWidget({qid:TurnTo.params.turntoqid,aid:TurnTo.params.turntoaid},TurnTo.params.turntoflow)}}else{if(S.viewEmbedUgcFromEmailFunc){S.viewEmbedUgcFromEmailFunc()}else{if(TurnTo.params.turntoqid&&TurnTo.params.turntouid){var tcmdObj={qid:TurnTo.params.turntoqid,aid:TurnTo.params.turntoaid};if(TurnTo.params.turntoflow=="replyview"){tcmdObj.uid=TurnTo.params.turntouid}showSoloQuestionViewWidget(tcmdObj,TurnTo.params.turntoflow)}}}setCookie(ANSWER_EMAIL_COOKIE_NAME,new Date().getTime(),2592000);addDone=true}else{if(TurnTo.params.turntoflow=="answerreply"&&TurnTo.params.turntorid&&TurnTo.params.turntoaid&&TurnTo.params.turntouid){showSoloQuestionViewWidget({rid:TurnTo.params.turntorid,aid:TurnTo.params.turntoaid,uid:TurnTo.params.turntouid},TurnTo.params.turntoflow);addDone=true}else{if(TurnTo.params.turntoflow=="review"){if(TurnTo.params.newReg=="y"){displayMessageInSubWindow(msg("tra.reg.message.emailConfirmed")+" "+msg("tra.wrev.message.reviewSubmitted"),{header:msg("tra.reg.header.emailConfirmation"),closeButton:true,mobileCloseBtnFn:redirectToMobilePdp})}else{if(TurnTo.params.reconf=="y"){if(TurnTo.params.ttalreadyreviewed=="y"){displayMessageInSubWindow('<span class="TT4revReceived">'+msg("tra.wrev.message.alreadyReviewed")+"</span>",{closeButton:true,header:msg("tra.wrev.header.alreadyReviewed"),mobileCloseBtnFn:redirectToMobilePdp})}else{displayMessageInSubWindow(msg("tra.reg.message.emailConfirmed"),{header:msg("tra.reg.header.emailConfirmation"),closeButton:true,mobileCloseBtnFn:redirectToMobilePdp})}}else{TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;var cmdObj={turntosku:TurnTo.params.turntosku};if(TurnTo.params.turntoCosId){cmdObj.cosId=TurnTo.params.turntoCosId;cmdObj.turntocossuid=TurnTo.params.turntocossuid;cmdObj.cosTransId=TurnTo.params.turntoCosTransId}else{cmdObj.turntosuid=TurnTo.params.turntosuid;cmdObj.transId=TurnTo.params.transId}cmdObj.fromRse=true;if(TurnTo.params.turntoRseFollowUpNum){cmdObj.rseFollowUpNum=TurnTo.params.turntoRseFollowUpNum}if(TurnTo.params.turntoIncentiveType){cmdObj.incentiveType=TurnTo.params.turntoIncentiveType}setCookie(NOSYNC_COOKIE_NAME,new Date().getTime());if(TurnTo.params.reviewStartAction){cmdObj.shareFor="review";cmdObj.mediaType="photo";cmdObj.startAction=TurnTo.params.reviewStartAction;cmdObj.fromRebelMail=TurnTo.params.turntoFromRebelmail;cmdObj.fromRebelMailFallback=TurnTo.params.turntoRebelmailFallback}if(TurnTo.params.reviewStartAction=="shareAPhoto"&&onMobile){displayShareMedia(cmdObj,onMobile)}else{cmdObj.starSelected=TurnTo.params.starSelected||0;if(cmdObj.starSelected<0||cmdObj.starSelected>5){cmdObj.starSelected=0}writeReview(cmdObj,onMobile)}}}addDone=true}else{if(TurnTo.params.turntoflow=="rebelmail"){setCookie(NOSYNC_COOKIE_NAME,new Date().getTime());TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;var cmdObj={fromRse:true,fromRebelMail:true,shareFor:"review",mediaType:"photo",startAction:"rateIt"};if(TurnTo.params.turntotoAlreadyReviewed=="1"){cmdObj.error="Already Reviewed";TurnToTrack.track("TTwriteReviewScreen",cmdObj);displayMessageInSubWindow('<span class="TT4revReceived">'+msg("tra.wrev.message.alreadyReviewed")+"</span>",{closeButton:onMobile?window.opener:true,header:msg("tra.wrev.header.alreadyReviewed"),mobileCloseBtnFn:redirectToMobilePdp})}else{if(TurnTo.params.turntoReviewHasErrors||TurnTo.params.turntoShowGuidelines){cmdObj.turntosku=TurnTo.params.turntosku;if(TurnTo.params.turntoCosId){cmdObj.cosId=TurnTo.params.turntoCosId;cmdObj.turntocossuid=TurnTo.params.turntocossuid;cmdObj.cosTransId=TurnTo.params.turntoCosTransId}else{cmdObj.turntosuid=TurnTo.params.turntosuid;cmdObj.transId=TurnTo.params.transId}if(TurnTo.params.turntoRseFollowUpNum){cmdObj.rseFollowUpNum=TurnTo.params.turntoRseFollowUpNum}if(TurnTo.params.turntoReviewFieldValues){cmdObj.rebelmailFormFields=JSON.parse(decodeURIComponent(TurnTo.params.turntoReviewFieldValues))}if(TurnTo.params.turntoShowGuidelines=="1"){cmdObj.showGuidelines=true}writeReview(cmdObj,onMobile)}else{if(TurnTo.params.turntoReviewId){cmdObj.rmFormSubmitted=true;TurnToTrack.startAction=cmdObj.startAction;TurnToTrack.track("TTmoreFeedback",cmdObj);saveReviewFingerprint(0);if(isVcEnabledForReviews()&&onMobile){cmdObj.reviewId=TurnTo.params.turntoReviewId;cmdObj.catItem=JSON.parse(decodeURIComponent(TurnTo.params.turntoCatItem));displayShareMedia(cmdObj,false)}else{displayDoMore({afterSubmission:true},onMobile)}}}}addDone=true}else{if(TurnTo.params.newReg=="y"){if((TurnTo.params.turntoflow=="question"||TurnTo.params.turntoflow=="answer"||TurnTo.params.turntoflow=="myqa")&&TurnTo.params.turntoflowid){var mmm;if(TurnTo.params.turntoflowConfDupe=="y"){mmm=msg("tra.reg.message.alreadyConfirmed")}else{mmm=msg("tra.reg.message.emailConfirmed");if(TurnTo.params.turntoflow=="question"){mmm+=(" "+msg("tra.qa.askArea.message.receiveAnswers"))}else{if(TurnTo.params.turntoflow=="answer"){mmm+=(" "+msg("tra.qa.answer.message.answerSubmitted"))}}}displayMessageInSubWindow(mmm,{header:msg("tra.reg.header.emailConfirmation"),closeButton:true});hideMLPCloser()}addDone=true}else{if(TurnTo.params.turntoflow=="sitevisitsadmin"){toggleMainWindow("none");showSiteVisitAdminControl();addDone=true}else{if(TurnTo.params.turntoflow=="sitevisitsadminsilent"){TurnToTrack.blockSiteVisitTracking();window.location=decodeURIComponent(TurnTo.params.turntonexturl)}else{if(TurnTo.params.turntoflow=="thankanswer"&&TurnTo.params.turntoaid&&TurnTo.params.turntouid){TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;showSoloQuestionViewWidget({qid:TurnTo.params.turntoqid,uid:TurnTo.params.turntouid,aid:TurnTo.params.turntoaid},TurnTo.params.turntoflow);setCookie(NOSYNC_COOKIE_NAME,new Date().getTime(),2592000);setCookie(ANSWER_EMAIL_COOKIE_NAME,new Date().getTime(),2592000);addDone=true}else{if(TurnTo.params.turntoflow=="thanka"&&TurnTo.params.turntoaid&&TurnTo.params.turntouid){TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;showSoloQuestionViewWidget({qid:TurnTo.params.turntoqid,uid:TurnTo.params.turntouid,aid:TurnTo.params.turntoaid},TurnTo.params.turntoflow);setCookie(ANSWER_EMAIL_COOKIE_NAME,new Date().getTime(),2592000);addDone=true}else{if(TurnTo.params.turntoflow=="econf"){displayMessageInSubWindow(msg("tra.reg.message.confirmedByCustomerSystem")+(!S.registration?" "+msg("tra.reg.message.idependentOfAccount"):""),{header:msg("tra.reg.header.emailConfirmation"),closeButton:true});addDone=true}else{if(TurnTo.params.turntoflow=="activity"){setActivityCookie(TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku);if(TurnTo.params.reviews=="true"&&TurnTo.params.ttalreadyreviewed=="y"){displayMessageInSubWindow('<span class="TT4revReceived">'+msg("tra.wrev.message.alreadyReviewed")+"</span>",{closeButton:true,header:msg("tra.wrev.header.alreadyReviewed"),mobileCloseBtnFn:redirectToMobilePdp})}else{displayMessageInSubWindow(msg("tra.reg.message.emailConfirmed"),{header:msg("tra.reg.header.emailConfirmation"),closeButton:true,mobileCloseBtnFn:redirectToMobilePdp})}addDone=true}else{if(TurnTo.params.turntoflow=="optout"){if(TurnTo.params.turntoEmailType=="reviewSolicitation"||TurnTo.params.turntoEmailType=="rseFollowUp"){displayMessageInSubWindow(msg("tra.reg.message.reviewsOptout"),{header:msg("tra.reg.header.optOut"),closeButton:onMobile?window.opener:true})}else{displayMessageInSubWindow(msg("tra.reg.message.questionOptOut"),{header:msg("tra.reg.header.optOut"),closeButton:onMobile?window.opener:true})}addDone=true}else{if(TurnTo.params.turntoflow=="mediaModal"){var mediaId=TurnTo.params.ttMediaId;displayMediaModalForIds([mediaId]);addDone=true}}}}}}}}}}}}}}}if(addDone&&!S.traSkipTurntodoneInLocation){window.location=window.location+"#turntodone"}traHookCheckDone=true}function redirectToMobilePdp(){var type=TurnTo.params.turntoflowid?"ci":(TurnTo.params.transId?"i":"sk");var id=TurnTo.params.turntoflowid?TurnTo.params.turntoflowid:(TurnTo.params.transId?TurnTo.params.transId:TurnTo.params.turntosku);window.location=getTransLinkUrl(4,type,id,TurnTo.matchData.site.siteId)}function turntoflowIsReviewOrRebelmail(){return TurnTo.params.turntoflow=="review"||TurnTo.params.turntoflow=="rebelmail"}function saveReviewFingerprint(count){if(!TurnTo.matchData.site.deviceFingerprintOn){return}if(count==0){TurnToMods.load("fingerprint")}var interval=1000;window.setTimeout(function(){if(TurnTo.deviceFingerprint){var data={reviewId:TurnTo.params.turntoReviewId,deviceFingerprint:TurnTo.deviceFingerprint};TurnTo.params.turntoReviewId;xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/saveReviewFingerprint"),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){}})}else{if(count<3){saveReviewFingerprint(count+1)}}},interval)}function showSiteVisitAdminControl(){insertScreen("#TTtraLayout",TurnToHTML.siteVisitsAdmin,{blocking:TurnToTrack.isSiteVisitTrackingBlock(),siteDisplayName:TurnTo.matchData.site.siteName});TurnTojQuery(".TT2sectionHeader").hide();traJq("#TT2footerFeedback").hide();traJq("#TT2block").click(function(){TurnToTrack.blockSiteVisitTracking();showSiteVisitAdminControl()});traJq("#TT2clear").click(function(){TurnToTrack.unblockSiteVisitTracking();showSiteVisitAdminControl()});traJq("#TT2close").click(function(){toggleMainWindow()})}var closedFromSpinScreen=false;var hasSpinScreen=false;function instantTeaSpinScreen(){if(S.useSetup){TurnTojQuery("#TurnToSetup").append("<div id='TTturntospinner' style='display:none'></div>")}else{TurnTojQuery("body").prepend("<div id='TTturntospinner' style='display:none'></div>")}TurnTojQuery("#TTturntospinner").html(TurnToHTML.spinscreen);TurnTojQuery("#TTtraWindow").css({top:TurnTojQuery(document).scrollTop()+20+"px",left:((TurnTojQuery(window).width()/2)-350)+"px"});TurnTojQuery("#TTspinnerClose").click(function(e){closedFromSpinScreen=true;TurnTojQuery("#TTturntospinner").hide()});TurnTojQuery("#TTturntospinner").show();hasSpinScreen=true}function dismissMessage(id){dismissQuestionWidgetMessage(id);if(traJq("#TTLImessageArea")&&traJq("#TTLImessageArea").length>0){if(traJq(id)&&traJq(id).length>0){traJq(id).hide();totalLiMessages--;checkLiMessages()}}}function dismissFbNewUserMess(){dismissMessage("#TTnewfbusermessage");TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/dismissnewfbuser")+"&cid="+cid,load:function(data,ioArgs){console.log("dismissed new fb user")},error:function(data,ioArgs){var message="dismiss new fb user XHR - Status: "+data.status+" Error: "+data.error}})}function checkLiMessages(){if(totalLiMessages<0){totalLiMessages=0}(totalLiMessages==0)?traJq("#TTLImessageArea").hide():traJq("#TTLImessageArea").show()}function addLIMessage(params){totalLiMessages++;checkLiMessages();traJq("#TTLImessageArea").append(TurnToHTML[params.screen]({params:params}))}function dismissLoggedInItemMessage(params){traJq("#TT2loggedInItemMessageArea"+params.suid).hide();traJq("#TT2loggedInItemMessageArea"+params.suid).html("");traJq("#TT2clearBoth"+params.suid).remove()}var numQuestionWidgetMsg=0;function addQuestionWidgetMessage(params){var msgArea=traJq("#TT2questionWidgetMessageArea");msgArea.append(TurnToHTML[params.screen]({params:params}));if(numQuestionWidgetMsg==0){msgArea.show()}numQuestionWidgetMsg++}function dismissQuestionWidgetMessage(id){var msgArea=traJq("#TT2questionWidgetMessageArea");if(msgArea&&msgArea.length>0){if(traJq(id)&&traJq(id).length>0){traJq(id).hide();numQuestionWidgetMsg--}if(numQuestionWidgetMsg==0){msgArea.hide()}}}function displayMessageInSubWindow(htmlMsg,cmd,textMsg){var sscreen=TurnTojQuery("#TTSubScreen");if(onMobile){sscreen=TurnTojQuery("#TurnToMobileSubWindow")}if(sscreen.length==0){}else{if(!cmd){cmd={}}var subwinHtml="";if(cmd.header){subwinHtml+='<div class="TT8 TT2bold">'+cmd.header+"</div>"}subwinHtml+='<div id="TT3subwinMsg" '+(cmd.header?'class="TTpadGenSubWin"':"")+">"+htmlMsg+"</div>";if(cmd.closeButton&&(onMobile?window.opener:true)||(cmd.closeButton&&cmd.mobileCloseBtnFn)){subwinHtml+='<div id="TT2closeGroup" class="TTpad20"><div id="TTgenSubWinClose" class="TTcloseBtn" role="button" tabindex="0" aria-label="'+msg("tra.common.label.close")+'"></div></div>'}var swJq=sscreen.html(subwinHtml);addTextToButtons();var closeAction=function(){if(onMobile){if(cmd.mobileCloseBtnFn){cmd.mobileCloseBtnFn()}else{closeMobileOverlay()}}else{toggleSubWindow("none")}};TurnTojQuery("#TTgenSubWinClose",swJq).click(closeAction).keydown(function(e){if(isEnterKey(e)){closeAction.call(this,e)}});if(!onMobile){showSubWin();resizeSubWindow("TT3subwinMsg")}else{toggleMainWindow("none")}}}function displayGenericErrorMessageInSubWindow(){displayMessageInSubWindow(msg("tra.systemMessage.genericError"))}function setLoggedInItemMessage(params){traJq("#TT2loggedInItemMessageArea"+params.suid).show();traJq("#TT2loggedInItemMessageArea"+params.suid).before("<div id='TT2clearBoth"+params.suid+"' class='TT2clearBoth'></div>");traJq("#TT2loggedInItemMessageArea"+params.suid).html("<a style='float:right' id='TT2dismissLoggedInItemMessage"+params.suid+"' href='javascript:void(0)' rel='nofollow'><img src='"+getStaticUrl("/tra3/images/subCloseButton.png")+"' border='0' style='padding-left:2px'/></a>");traJq("#TT2loggedInItemMessageArea"+params.suid).append(TurnToHTML[params.screen]({params:params}));traJq("#TT2dismissLoggedInItemMessage"+params.suid)[0].suid=params.suid;traJq("#TT2dismissLoggedInItemMessage"+params.suid)[0].onclick=function(e){dismissLoggedInItemMessage({suid:this.suid})}}function toggleTopLinks(settingsActive,profileActive,isOtherUser){isOtherUser=isOtherUser||false;var linkHtml=function(id,text){return'<a id="'+id+'" class="TTexternalLink" href="javascript:void(0)" rel="nofollow">'+text+"</a>"};var spanHtml=function(id,text){return'<span style="font-weight:bold" id="'+id+'">'+text+"</span>"};if(TurnTo.matchData.site.syndicationSiteType==SYNDICATION_TYPE_COMMERCE){traJq("#TT2myAskLinkSeparator").hide();var sLink=traJq("#TT3settingsLink").show();sLink.replaceWith(settingsActive?spanHtml(sLink.attr("id"),sLink.html()):linkHtml(sLink.attr("id"),sLink.html()));sLink=traJq("#TT3settingsLink");if(!settingsActive){sLink.click(function(){if(TurnTo.matchData.user){displayUserSetting()}else{showProfile()}})}var prLink=traJq("#TT3myProfileLink").show();prLink.replaceWith(profileActive&&!isOtherUser?spanHtml(prLink.attr("id"),prLink.html()):linkHtml(prLink.attr("id"),prLink.html()));prLink=traJq("#TT3myProfileLink");if(!profileActive||(profileActive&&isOtherUser)){prLink.click(function(){if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){S.registration.synced=false;if(ensurePartnerRegUser(TurnTo.regSourceProfile,function(){showProfile(null,S.setupType=="mobileTT")})==1){displayProfile(TurnTo.matchData.user.id,false,S.setupType=="mobileTT")}}else{if(TurnTo.matchData.user){displayProfile(TurnTo.matchData.user.id,false,S.setupType=="mobileTT")}else{showProfile(null,S.setupType=="mobileTT")}}})}}else{traJq("#TT3toplinks").hide()}if(S.registration&&S.registration.localRegistrationUrl){traJq("#TT3settingsLink").hide().prev().hide()}}function displayUserSetting(callbackF){TurnTo.photoEditorShow=false;getUserSetting(callbackF?callbackF:function(){var useProfileDiv=traJq("#TT3profile").is(":visible");var useDoMoreDiv=traJq("#TTmoreFeedback").is(":visible");var screen=useProfileDiv?"#TT3profile":(useDoMoreDiv?"#TTmoreFeedback":(onMobile?"#TurnToMobileContent":"#TTtraLayout"));insertScreen(screen,TurnToHTML.userSetting,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl,onMobile:onMobile});insertScreen("#contactInfo",TurnToHTML.userSettingEmailAddresses,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl});if(TurnTo.matchData.user.setting.profileAttrs&&TurnTo.matchData.user.setting.profileAttrs.length>0){insertScreen("#TT4profileDims",TurnToHTML.userSettingsProfileDims,{profileDims:TurnTo.matchData.user.setting.profileAttrs,profileDimsSelected:TurnTo.matchData.user.setting.userSelections})}if(onMobile){TurnTojQuery("#TTmobileHeader").hide();insertScreenHeader()}toggleTopLinks(true,false);setupUserSettingAction()})}function getUserSetting(callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getUserSetting")+"&cid="+cid,load:function(data,ioArgs){TurnTo.matchData.user.setting=data;TurnTo.matchData.site.profileAttrs=data.profileAttrs;if(callbackF){callbackF()}},error:function(data,ioArgs){var message="getUserSetting XHR - Status: "+data.status+" Error: "+data.error}})}function checkEnterKeyHandleCallback(event){if(isEnterKey(event)&&event.data&&typeof event.data=="function"){event.data.call(this,event)}}function setupUserSettingAction(){traJq("#pwd_change").click(showUserSettingPwdChange);traJq("#pwd_nochange").click(hideUserSettingPwdChange);traJq("#showPhotoEditorLink1").click(showPhotoEditor);traJq("#showPhotoEditorLink2").click(showPhotoEditor);traJq("#closePhotoButton").click(closePhotoEditor).keydown(closePhotoEditor,checkEnterKeyHandleCallback);traJq("#TT3updateButton").click(updateUserSetting);traJq("#savePhotoButton").click(saveUserPhoto).keydown(saveUserPhoto,checkEnterKeyHandleCallback);traJq("#TT2userSettingFbConnect").click(function(){connectWithFacebook(null,{link:true,connectButton:this,onConnectClose:function(){displayUserSetting()}})});traJq("input[name='userImgSelection']").click(function(){var imageType=this.value;if(imageType=="facebook"){traJq("#tmpUserImg").show();traJq("#tmpUserImg")[0].src="";traJq("#tmpUserImg")[0].src=getFacebookUserPhoto()}else{traJq("#tmpUserImg")[0].src="";if(TurnTo.matchData.user.hasPhoto&&TurnTo.matchData.user.pid.indexOf("fb")>0){traJq("#tmpUserImg").hide()}else{traJq("#tmpUserImg").show();traJq("#tmpUserImg")[0].src=getUserPhoto(TurnTo.matchData.user.id,TurnTo.matchData.user.pid)}}})}function updateUserSetting(){TurnTo.error=null;traJq("#TT3updateButton").hide();traJq("#TT3updateLoading").show();var p={};var profileForm=traJq("#TT3profileForm");profileForm.find("input").each(function(i){if(this.type=="checkbox"&&this.checked){p[this.name.replace("TT3","")]=TurnTojQuery.trim(this.value)}else{if(this.type!="checkbox"){p[this.name.replace("TT3","")]=TurnTojQuery.trim(this.value)}}});var ageRangeSelect=profileForm.find("#TT3ageRange");p.ageRange=ageRangeSelect.val();var countrySelect=profileForm.find("#TT3country");p.country=countrySelect.val();if(p.country==="US"){p.state=profileForm.find("#TT3stateUS").val()}else{if(p.country==="CA"){p.state=profileForm.find("#TT3stateCA").val()}else{p.state=profileForm.find("#TT3state").val()}}var localeSelect=profileForm.find("#TTlocaleSelect");p.locale=localeSelect.length>0?localeSelect.val():null;if(TurnTo.matchData.site.profileAttrs){for(var cpd=0;cpd<TurnTo.matchData.site.profileAttrs.length;cpd++){var profileDim=TurnTo.matchData.site.profileAttrs[cpd];var profileAttr=traJq("#TTprofileDim-"+profileDim.id);var type=TurnTo.matchData.site.profileAttrs[cpd].type;var value=profileAttr.val();if(type==0){if(value!=""&&value!=null){p["profileDims["+cpd+"].dimDefType"]=0;p["profileDims["+cpd+"].dimDefId"]=profileDim.id;p["profileDims["+cpd+"].dimValueId"]=value}}else{if(value!=""&&value!=null){p["profileDims["+cpd+"].dimDefType"]=1;p["profileDims["+cpd+"].dimDefId"]=profileDim.id;p["profileDims["+cpd+"].dimValueId"]=profileDim.values[0].id;p["profileDims["+cpd+"].dimFreeformText"]=value}}}}if(TurnTo.photoEditorShow){var imgTypeSelected=traJq("input[name='userImgSelection']:checked").val();if(imgTypeSelected!="facebook"&&TurnTo.userSettingUploadId){p.uploadId=TurnTo.userSettingUploadId;p.imgTypeSelected=imgTypeSelected;TurnTo.userSettingUploadId=null}if(imgTypeSelected=="facebook"){p.imgTypeSelected=imgTypeSelected}}xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/updateUserSetting")+"&cid="+cid,postData:TurnTojQuery.param(p),contentType:"application/x-www-form-urlencoded",load:function(data,ioArgs){TurnTo.matchData.user=data.user;TurnTo.matchData.user.pid=data.pid;TurnTo.matchData.user.uIdents=data.uIdents;updateTitleBar();if(!S.inProfile){toggleSubWindow("none");traJq("#TT3updateButton").show();traJq("#TT3updateLoading").hide()}else{traJq("#TT3updateButton").show();traJq("#TT3updateLoading").hide()}hideUserSettingPwdChange();if(S.inProfile){displayUserSetting()}},error:function(data,ioArgs){var message="";var errorText="";traJq("#userSettingSuccess").hide();var userSettingErrors=traJq("#TT4userSettingErrors").empty().show();if(data.errors){for(var i=0;i<data.errors.length;i++){errorText+=data.errors[i]+"</br>"}}else{if(data.error){message="makePrimaryIdent XHR - Status: "+data.status+" Error: "+data.error;errorText=data.error+"</br>"}}userSettingErrors.append(errorText);traJq("#TT3updateButton").show();traJq("#TT3updateLoading").hide()}})}function updateTitleBar(){var displayName=formatName(TurnTo.matchData.user,false,"nickFirst");traJqC("#TThiMsg").html(TurnToHTML.hiHeaderMsg({displayName:displayName})+" | ");traJqR("#TTrevHiMsg").html(TurnToHTML.hiHeaderMsg({displayName:displayName})+" | ");TurnTojQuery(".TTfirstName").html(displayName)}function inputUserImageForUserSetting(inputEl,callback){if(inputEl.value==""){return}TurnTo.userSettingUploadId=(new Date()).getTime();traJq("#TT3profileForm").append('<iframe id="'+TurnTo.userSettingUploadId+'" name="'+TurnTo.userSettingUploadId+'" style="display:none"/>');traJq("#TT3profileForm").attr("target",TurnTo.userSettingUploadId);traJq("#TT3profileForm").attr("action",getUrl("/traServer4/uploadTmpUserImage"));traJq("#TT3profileForm").attr("enctype","multipart/form-data");traJq("#TT3profileForm").attr("encoding","multipart/form-data");traJq("#TT3profileForm").append('<input type="hidden" id="uploadId" name="uploadId" value="'+TurnTo.userSettingUploadId+'"/>');traJq("#TT3profileForm").submit();traJq("#TT3profileForm").removeAttr("action");traJq("#TT3profileForm").removeAttr("enctype");traJq("#TT3profileForm").removeAttr("target");traJq("#tmpUserImg").hide();var oldUserImg=traJq("#tmpUserImg").attr("src");traJq("#tmpUserImgLoading").show();traJq("#tmpUserImg").load(function(){clearTimeout(TurnTo.userSettingCheckImgClear);clearInterval(TurnTo.userSettingCheckImgInterval);traJq("#tmpUserImgLoading").hide();traJq("#tmpUserImg").show();traJq("#uploadId").remove();traJq("#TT2customUserImgRadio").show();traJq("input[name='userImgSelection'][value=custom]").attr("checked","checked");TurnTojQuery("#"+TurnTo.userSettingUploadId).remove()});TurnTo.userSettingCheckImgInterval=setInterval(function(){traJq("#tmpUserImg").attr("src",getUrl("/traServer4/displayTmpUserImage?uploadId="+TurnTo.userSettingUploadId+"&t="+(new Date()).getTime()))},3000);TurnTo.userSettingCheckImgClear=setTimeout(function(){clearInterval(TurnTo.userSettingCheckImgInterval);traJq("#tmpUserImgLoading").hide();traJq("#tmpUserImg").attr("src",oldUserImg);traJq("#tmpUserImg").show();traJq("#uploadId").remove();traJq("#TT2customUserImgRadio").show();TurnTojQuery("#"+TurnTo.userSettingUploadId).remove();TurnTo.userSettingUploadId=null},180000)}function saveUserPhoto(){var imgTypeSelected=traJq("input[name='userImgSelection']:checked").val();if(imgTypeSelected=="facebook"||TurnTo.userSettingUploadId){traJq("#userImg").hide();traJq("#userImgLoading").show();traJq("#userImg").load(function(){traJq("#userImg").show();traJq("#userImgLoading").hide();traJq("#TT2userImgFile").val("");updateTitleBar();if(imgTypeSelected=="facebook"){traJq("#tmpUserImg").hide();traJq("#TT2customUserImgRadio").show()}else{traJq("#tmpUserImg").show()}traJq("#showPhotoEditorLink1").show()});TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/saveUserImage")+"&cid="+cid+"&uploadId="+TurnTo.userSettingUploadId+"&imgTypeSelected="+imgTypeSelected,load:function(data,ioArgs){if(data.pid&&data.pid!="0"){TurnTo.matchData.user.pid=data.pid;TurnTo.matchData.user.hasPhoto=true}traJq("#showPhotoEditorLink2").html("&nbsp;Change Photo");traJq("#showPhotoEditorLink1").show();traJq("#userImg").attr("src",getUserPhoto(TurnTo.matchData.user.id,TurnTo.matchData.user.pid));TurnTo.userSettingUploadId=null},error:function(data,ioArgs){var message="saveUserPhoto XHR - Status: "+data.status+" Error: "+data.error;TurnTo.userSettingUploadId=null}})}closePhotoEditor()}function showPhotoEditor(){TurnTo.photoEditorShow=true;traJq("#showPhotoEditorLink1").hide();traJq("#editPhoto").show();traJq("#editPhotoButtons").show();if(TurnTo.matchData.user.hasPhoto){traJq("#tmpUserImg").show();if(TurnTo.matchData.user.pid.indexOf("fb")>0){traJq("#tmpUserImg")[0].src=getFacebookUserPhoto();traJq("input[name='userImgSelection']")[1].checked=true}else{traJq("#tmpUserImg")[0].src=getUserPhoto(TurnTo.matchData.user.id,TurnTo.matchData.user.pid);traJq("input[name='userImgSelection']")[0].checked=true}}}function closePhotoEditor(){TurnTo.photoEditorShow=false;if(TurnTo.matchData.user.hasPhoto){traJq("#showPhotoEditorLink1").show()}traJq("#editPhoto").hide();traJq("#editPhotoButtons").hide()}function makePrimaryIdent(id,callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/makeIdentifierPrimary/"+id)+"&cid="+cid,load:function(data,ioArgs){if(callbackF){callbackF()}else{getUserSetting(function(){insertScreen("#contactInfo",TurnToHTML.userSettingEmailAddresses,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl})})}},error:function(data,ioArgs){var message="makePrimaryIdent XHR - Status: "+data.status+" Error: "+data.error}})}function removeIdent(id,callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/deleteIdentifier/"+id)+"&cid="+cid,load:function(data,ioArgs){if(callbackF){callbackF()}else{getUserSetting(function(){insertScreen("#contactInfo",TurnToHTML.userSettingEmailAddresses,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl})})}},error:function(data,ioArgs){var message="removeIdent XHR - Status: "+data.status+" Error: "+data.error}})}function disconnectTwitter(){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/disconnectTwitter")+"&cid="+cid,load:function(data,ioArgs){traJq("#twitterConnected").css({display:"none"});traJq("#twitterNotConnected").css({display:"inline"});TurnTo.matchData.user.setting.twitterIdentifier=null},error:function(data,ioArgs){var message="disconnectTwitter XHR - Status: "+data.status+" Error: "+data.error}})}function disconnectFacebook(){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/disconnectFacebook")+"&cid="+cid,load:function(data,ioArgs){traJq("#facebookConnected").css({display:"none"});traJq("#facebookNotConnected").css({display:"inline"});TurnTo.matchData.user.setting.twitterIdentifier=null},error:function(data,ioArgs){var message="disconnectFacebook XHR - Status: "+data.status+" Error: "+data.error}})}function showUserSettingPwdChange(){traJq("#pwd_change").hide();traJq("#pwd_nochange").show();traJq("#TT3currpasswd").show();traJq("#TT3pwd_1").show();traJq("#TT3pwd_2").show();traJq("#TT3editingPasswd").val(true)}function hideUserSettingPwdChange(){traJq("#pwd_change").show();traJq("#pwd_nochange").hide();traJq("#TT3currpasswd").hide();traJq("#TT3pwd_1").hide();traJq("#TT3pwd_2").hide();traJq("#TT3editingPasswd").val(false)}function findUserRaveTarget(targetId){if(TurnTo.matchData.user&&TurnTo.matchData.user.raveTargets){for(var i=0;i<TurnTo.matchData.user.raveTargets.length;i++){if(TurnTo.matchData.user.raveTargets[i].id==targetId){return i}}}return -1}function setupCommentCapture(){if(!S.embedCommentCapture){toggleMainWindow()}var container="";if(S.inProfile){container=TurnTojQuery(isWidgetOpen()?"#TT3profile":"#TTtraLayout")}else{if(S.embedCommentCapture){container=TurnTojQuery("#TTcommentCapture")}else{TurnTojQuery("#TTtraLayout").html('<div id="TTcommentCapture"></div>');container=TurnTojQuery("#TTcommentCapture");container.css({width:"100%","padding-bottom":"10px"});if(!isWidgetOpen()){toggleMainWindow("none")}}}var user=TurnTo.matchData.user?TurnTo.matchData.user:(TurnTo.matchData.siteUser?TurnTo.matchData.siteUser:TurnTo.turnToFeed);var firstName=user.firstName?TurnTojQuery.trim(user.firstName):"";var lastName=user.lastName?TurnTojQuery.trim(user.lastName):"";var items=TurnTo.matchData.items4Conf?TurnTo.matchData.items4Conf:TurnTo.matchData.user.items;var newItems=[];var pastItems=[];if(!S.embedCommentCapture){for(var i=0;i<items.length;i++){items[i].newOrder?newItems.push(items[i]):pastItems.push(items[i])}}var connectedTwitter=findUserRaveTarget(TurnTo.twitterTargetId)>-1;container.html(TurnToHTML.commentCapture({items:items,newItems:newItems,pastItems:pastItems,firstName:firstName,lastName:lastName,getStaticUrl:getStaticUrl,connectedTwitter:connectedTwitter}));var commentFields=container.find(".TTccComment");commentFields.focus(function(){captureCommentFocus(this)});setupCharLimit(commentFields,".TTCommentCaptureContent",".TT2charLimitCount",".TTbigSubmitBtn",500);container.find(".TTccTW").click(function(e){var tw=TurnTojQuery(this);tw.toggleClass("TTtwitterShare");tw.toggleClass("TTtwitterNoShare");if(tw.hasClass("TTtwitterShare")&&findUserRaveTarget(TurnTo.twitterTargetId)<0){connectWithTwitter(e,{})}});container.find(".TTccFB").click(function(e){var fb=TurnTojQuery(this);fb.toggleClass("TTfacebookShare");fb.toggleClass("TTfacebookNoShare");if(fb.hasClass("TTfacebookShare")){connectWithFacebookToPostComments(e,function(){fb.removeClass("TTfacebookShare");fb.addClass("TTfacebookNoShare")})}});container.find(".TTbigSubmitBtn").click(function(e){e.preventDefault();var submitBtn=TurnTojQuery(this);var commentBlock=submitBtn.closest(".TTcommentCaptureBlock");var commentField=commentBlock.find("textarea");var comment=commentField.val();if(TurnTojQuery.trim(comment).length>0){submitBtn.hide();commentBlock.find(".TT2submitImgLoading").show();if(TurnTo.matchData.user){saveComment4UserItem(commentBlock,comment,saveCommentCaptureComplete)}else{registerAndLogin(function(){saveComment4UserItem(commentBlock,comment,saveCommentCaptureComplete);setLocalLoginCookie();setModeratorCookie()})}}else{commentBlock.find(".TT4SysMsgBody").html(msg("tra.ppe.error.blankComment")).show()}});if(S.paginateCommentCapture){container.find(".TTccNext").click(function(e){e.preventDefault();var commentBlocks=container.find(".TTcommentCaptureBlock");var curItemNumCont=container.find(".TTccCurItemNum");var curItemNum=parseInt(curItemNumCont.text());var nextNum=curItemNum+1;if(nextNum>commentBlocks.length){nextNum=1}curItemNumCont.text(nextNum);commentBlocks.hide();commentBlocks.eq(nextNum-1).show()})}if(!S.embedCommentCapture){container.find(".TTcloseBtn").bind("click",function(){if(checkUnsavedComments()){toggleMainWindow()}})}addTextToButtons()}function connectWithFacebookToPostComments(e,deniedCb){if(TurnTo.matchData.user&&!TurnTo.matchData.user.fbPostToWallGranted){connectWithFacebook(e,{post:true,photo:true,link:true,keepSubwindow:true,noMatchesShow:true,onConnectClose:function(){getFbPostToWallGranted(function(){if(!TurnTo.matchData.user.fbPostToWallGranted&&deniedCb){deniedCb()}})}})}else{if(!TurnTo.matchData.user){var items4Conf=TurnTo.matchData.items4Conf;TurnTo.fbwin=openConnectWindow(getUrl("/traServer4/showLoadingPage",false));registerAndLogin(function(){connectWithFacebook(e,{post:true,photo:true,link:true,keepSubwindow:true,noMatchesShow:true,onConnectClose:function(){getFbPostToWallGranted(function(){if(!TurnTo.matchData.user.fbPostToWallGranted&&deniedCb){deniedCb()}});TurnTo.matchData.items4Conf=items4Conf}});setLocalLoginCookie();setModeratorCookie()})}}}function captureCommentFocus(commentField){var commentField=commentField instanceof TurnTojQuery?commentField:TurnTojQuery(commentField);if(commentField.attr("expanded")){return}commentField.attr("expanded",true);var contentContainer=commentField.closest(".TTCommentCaptureContent");contentContainer.find(".TTccSavedCommentArea").hide();showByExpanding(contentContainer.find(".TTccPrompt"));showByExpanding(contentContainer.find(".TTccBottom"));if(!commentField.val()||commentField.val().trim().length==0){commentField.attr("placeholder",msg("tra.ppe.placeholder.comment"))}if(!commentField.is("visible")){commentField.show();contentContainer.find(".TTbigSubmitBtn").show()}commentField.animate({height:100},400,function(){if(onMobile){var itemImage=contentContainer.next(".TTccItemImage");var imageBottom=itemImage.offset().top+itemImage.outerHeight();var cfTop=commentField.offset().top-getBoxValue(commentField,"padding-top")-getBoxValue(commentField,"border-top-width");var cfCont=commentField.parent();if((cfTop-imageBottom)<10){var cfContMarginTop=getBoxValue(cfCont,"margin-top");cfCont.animate({"margin-top":Math.round(10-(cfTop-imageBottom)+cfContMarginTop)},300)}cfCont.animate({marginRight:10},200)}})}function getBoxValue(elem,propName){elem=elem instanceof TurnTojQuery?elem:TurnTojQuery(elem);var val=elem.css(propName).replace("px","");if(val){return parseInt(val)}return 0}function saveCommentCaptureComplete(commentBlock,data){commentBlock.data("icId",data.commentId);commentBlock.find(".TT2submitImgLoading").hide();commentBlock.find(".TT4SysMsgBody").empty().hide();hideBySlidingUp(commentBlock.find(".TTccPrompt"));hideBySlidingUp(commentBlock.find(".TTccBottom"));var commentField=commentBlock.find(".TTccComment");hideBySlidingUp(commentField);if(commentField.attr("expanded")){commentField.removeAttr("expanded")}var commenterName=commentBlock.closest("#TTcommentCapture").find("input[name=TTccGreetName]").val();var datePurchased=commentBlock.find("input[name=TTccPurchasedDate]").val();var orderCount=parseInt(commentBlock.find("input[name=TTccNumOfOrders]").val());var commentArea=commentBlock.find(".TTccSavedCommentArea");commentArea.html(TurnToHTML.commentCaptureSaved({itemId:data.id,commentText:stripString(commentField.val()),commenterName:commenterName,datePurchased:datePurchased,orderCount:orderCount}));commentBlock.find("#TTccEditLink-"+data.id).click(function(){captureCommentFocus(commentField);commentField.focus()});commentBlock.find("#TTccDeleteLink-"+data.id).click(function(){deleteComment4UserItem(data.id,data.commentId,commentBlock,deleteCommentCaptureComplete)});showByExpanding(commentArea,function(){commentArea.find("#TTccEditLink-"+data.id).focus()})}function deleteCommentCaptureComplete(commentBlock,data){var savedCommentArea=commentBlock.find(".TTccSavedCommentArea");hideBySlidingUp(savedCommentArea,function(){savedCommentArea.empty()});commentBlock.find(".TT2charLimitCount").html("500");var ta=commentBlock.find(".TTccComment").css("height","").val("");ta.parent().css("margin-top","");ta.parent().css("margin-right","");showByExpanding(ta)}function setupCharLimit(jFields,parentSelector,countSelector,saveSelector,maxChars){jFields.bind("input propertychange",function(e){var parentCont=TurnTojQuery(this).closest(parentSelector);var countCont=parentCont.find(countSelector);if(this.value.length>maxChars){countCont.css("color","red");parentCont.find(saveSelector).hide()}else{countCont.css("color","");parentCont.find(saveSelector).show()}countCont.html(maxChars-this.value.length)})}function getIndexByStiId(stiId){var stiIds=traJq("input[name=TT2stiIds]");for(var i=0;i<stiIds.length;i++){if(stiIds[i].value==stiId){return i}}return -1}function saveComment4UserItem(commentBlock,comment,callbackF){var postToFacebook=commentBlock.find(".TTccFB").hasClass("TTfacebookShare");var postToTwitter=commentBlock.find(".TTccTW").hasClass("TTtwitterShare");var stiId=commentBlock.find("input[name=TT2stiIds]").val();var idx=getIndexByStiId(stiId);var siteId=commentBlock.data("sid");var icId=commentBlock.data("icId");comment=stripString(comment);var errorCont=TurnTojQuery(".TT4SysMsgBody",commentBlock);errorCont.empty().hide();if(TurnToMods.mods.util.containsEmail(comment)){errorCont.html(msg("tra.addComment.error.dontIncludeEmail")).show();TurnTojQuery(".TT2submitImgLoading",commentBlock).hide();TurnTojQuery(".TTbigSubmitBtn",commentBlock).show();return}TurnTo.error=null;var uriParams="&sid="+siteId+"&cid="+cid+"&postToFacebook="+postToFacebook+"&postToTwitter="+postToTwitter;if(icId){uriParams+=("&icId="+icId)}var data={raveComment:comment};xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/updateComment4UserItem/"+stiId)+uriParams,postData:toJson(data),load:function(data,ioArgs){if(callbackF){callbackF(commentBlock,data)}if(postToFacebook||postToTwitter){logRewardPoints(TurnTo.eventItemShared)}runClientCallbackFunc("chatterSubmit",{id:data.commentId,sku:data.sku,productTitle:data.productTitle})},error:function(data,ioArgs){errorCont.html(data.error).show();TurnTojQuery(".TT2submitImgLoading",commentBlock).hide();TurnTojQuery(".TTbigSubmitBtn",commentBlock).show()}})}function deleteComment4UserItem(stiId,icId,commentBlock,callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/updateComment4UserItem/"+stiId)+"&icId="+icId+"&cid="+cid+"&rave=false",load:function(data,ioArgs){if(callbackF){callbackF(commentBlock,data)}},error:function(data,ioArgs){var message="deleteComment4UserItem XHR - Status: "+data.status+" Error: "+data.error}})}function checkUnsavedComments(){var commentFields=traJq("#TTcommentCaptureContainer .TTccComment");var hasUnsaved=false;commentFields.each(function(i){var field=traJq(this);if(field.attr("expanded")&&field.val().trim().length>0){hasUnsaved=true}});if(hasUnsaved){if(confirm(msg("tra.pp.message.willNotSaveUnlessSubmit"))){return true}return false}else{return true}}function updateSharing(share,callbackF){TurnTo.error=null;if(share){TurnTo.newSharePastPurchases=true}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/updateSharing/")+"&cid="+cid+"&sharing="+share+(TurnTo.matchData.siteUser?"&suid="+TurnTo.matchData.siteUser.id:""),load:function(data,ioArgs){if(callbackF){callbackF(data)}},error:function(data,ioArgs){var message="updateSharing XHR - Status: "+data.status+" Error: "+data.error}})}function connectWithTwitter(e,options){var svisitParams=TurnToTrack.makeVisitorPartsQS(TurnToTrack.getVisitorParts());var ttTwitterUrl=getUrl("/twitterOauth/auth?return_controller=traServer4&return_action=oauthComplete&error_controller=traServer4&error_action=oauthComplete&consumer=twitter&siteKey="+S.siteKey+svisitParams);if(TurnTo.twitterConnectPopupInterval){clearInterval(TurnTo.twitterConnectPopupInterval)}TurnTo.twitterwin=window.open(ttTwitterUrl,"ConnectWithTwitter","height=550,width=650,status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1");if(TurnTo.twitterwin){TurnTo.twitterConnectPopupInterval=setInterval(function(){twitterConnectPopupIntervalFn(options)},500)}stopDefault(e)}function twitterConnectPopupIntervalFn(options){if(TurnTo.twitterwin.closed){clearInterval(TurnTo.twitterConnectPopupInterval);if(options.onConnectClose){options.onConnectClose()}else{getUserRaveTargets(refreshPastPurchaseTwitterConnect)}}}function getUserRaveTargets(callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getUserRaveTargets/")+"&cid="+cid,load:function(data,ioArgs){TurnTo.matchData.user.raveTargets=data.raveTargets;if(callbackF){callbackF(data)}},error:function(data,ioArgs){var message="getUserRaveTargets XHR - Status: "+data.status+" Error: "+data.error}})}function refreshPastPurchaseTwitterConnect(data){var twitterBoxes=traJq("input[name=TT2twitterBox]");var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;for(var i=0;i<twitterBoxes.length;i++){if(findUserRaveTarget(TurnTo.twitterTargetId)>-1){twitterBoxes[i].checked=true}else{twitterBoxes[i].checked=false}}}function refreshPastPurchaseFbConnect(data){var facebookBoxes=traJq("input[name=TT2facebookBox]");var foundFbTarget=findUserRaveTarget(TurnTo.facebookTargetId)>-1;for(var i=0;i<facebookBoxes.length;i++){if(foundFbTarget){facebookBoxes[i].checked=true}else{facebookBoxes[i].checked=false}}}function defaultItemTeaserDisplay(data){var preText=S.iteaserPreamble||'<div class="TTiteaserPreamble">'+msg("tra.qaTeaser.header.getAnswers")+"</div>";var text=S.iteaserText||msg("tra.qaTeaser.askQuestion");var iteaserhtml='<div id="TT2ILTbox">'+preText+'<div id="TT2ILTbutton-holder"><a class="TT2ILTbutton TurntoItemTeaserClick" href="javascript:void(0)" rel="nofollow">'+text+"</a></div>";iteaserhtml+='<div id="TT2ILTcount-line">';if(data.counts.q>0||data.counts.a>0){iteaserhtml+='<p><a class="TurnToIteaSee" href="javascript:void(0)" rel="nofollow">';if(data.counts.q>0){iteaserhtml+=msg("tra.qaTeaser.link.seeQuestions."+getPlural(data.counts.q),[data.counts.q]);if(data.counts.a>0){iteaserhtml+=" | "}}if(data.counts.a>0){iteaserhtml+=msg("tra.qaTeaser.link.seeAnswers."+getPlural(data.counts.a),[data.counts.a])}iteaserhtml+="</a></p>"}iteaserhtml+="</div></div>";return iteaserhtml}function loadItemTeaser(data,clazz){if(!TurnTo.doIteaser){return}var clazzNam=clazz||"TurnToItemTeaser";var iteaserhtml=S.iTeaserFunc(data);var iteasers=TurnTojQuery("."+clazzNam);iteasers.html(iteaserhtml);var teaserClickAskFunc=TurnTo.isMultiItemPage?function(){TurnToItemSku=data.sku;TurnTo.itemTeaserClick({fromInputTeaser:false})}:function(){TurnTo.itemTeaserClick({fromInputTeaser:false})};var teaserClickSeeFunc=TurnTo.isMultiItemPage?function(){TurnToItemSku=data.sku;TurnTo.itemTeaserClick({fromInputTeaser:false})}:function(){TurnTo.itemTeaserClick({fromInputTeaser:false})};TurnTojQuery("."+clazzNam+" .TurntoItemTeaserClick").click(teaserClickAskFunc);TurnTojQuery("."+clazzNam+" .TurnToIteaSee").click(teaserClickSeeFunc);if(!TurnTo.isMultiItemPage){runClientCallbackFunc("questionTeaserRender")}}function loadItemInputTeaser(clazz){if(!TurnTo.doIITeaser){return}S.itemInputTeaserFunc(clazz,TurnToItemData)}function defaultItemInputTeaserFunc(clazz,data){var clazzNam=clazz||"TurnToItemInputTeaser";var iteasers=TurnTojQuery("."+clazzNam);iteasers.html(TurnToHTML.inputTeaser({}));TurnTojQuery(".TTinputTeaserNext").click(function(){TurnTo.itemTeaserClick({fromInputTeaser:true,text:TurnTojQuery("#TTinputTeaserQ").val()})});TurnTojQuery("#TTinputTeaserQ").keypress(function(e){if(e.which==13){TurnTo.itemTeaserClick({fromInputTeaser:true,text:TurnTojQuery("#TTinputTeaserQ").val()});stopDefault(e)}});var clearHandler=function(){if(TurnTojQuery.browser.msie&&TurnTojQuery.browser.version.indexOf(".")&&TurnTojQuery.browser.version.substr(0,TurnTojQuery.browser.version.indexOf("."))==10){TurnTojQuery("#TTinputTeaserClear").hide();return}if(TurnTojQuery("#TTinputTeaserQ").val().length==0){TurnTojQuery("#TTinputTeaserClear").css("visibility","hidden")}else{TurnTojQuery("#TTinputTeaserClear").css("visibility","visible")}};TurnTojQuery("#TTinputTeaserQ").keyup(clearHandler).blur(clearHandler);TurnTojQuery(".TTteaSearchLink").click(function(){TurnTo.itemTeaserClick({fromInputTeaser:false})})}function loadReviewsTeaser(clazz){if(!TurnTo.doRTeaser){return}S.reviewsTeaserFunc(clazz,TurnToItemData);if(!TurnTo.isMultiItemPage){runClientCallbackFunc("reviewsTeaserRender")}}function defaultReviewsItemTeaserFunc(clazz,data){var clazzNam=clazz||"TurnToReviewsTeaser";var iteasers=TurnTojQuery("."+clazzNam);var rating=Math.round((TurnToItemData.counts.ar+0.25)*100)/100;rating=rating.toString();var decimal=parseInt(rating.substring(2,3));rating=rating.substring(0,1)+"-"+(decimal>=5?"5":"0");var chatterContentInPage=TurnTojQuery("#TurnToChatterContent").length>0;var qaOverlayConfigured=TurnTo.S.setupType==="overlay";var haveComments=TurnTo.S.loadRteaserAfterChatter?TurnToItemData.counts.ccWdgtC>0:TurnToItemData.counts.c>0;var showCommentsLink=haveComments&&(chatterContentInPage||qaOverlayConfigured);iteasers.html(TurnToHTML.reviewTeaser({rating:rating,showCommentsLink:showCommentsLink,loadRteaserAfterChatter:TurnTo.S.loadRteaserAfterChatter}));var teaserSku=TurnToItemData.sku;iteasers.find(".TTreadReviews").click(function(){TurnTo.itemReviewTeaserClick({sku:teaserSku})});iteasers.find(".TTwriteReview").click(function(){TurnTo.itemReviewTeaserClick({writeReview:true,sku:teaserSku})});if(showCommentsLink){if(chatterContentInPage){iteasers.find(".TTreadComments").click(function(e){TurnTojQuery("html, body").animate({scrollTop:TurnTojQuery("#TurnToChatterContent").offset().top})})}else{if(TurnTo.S.setupType==="overlay"){iteasers.find(".TTreadComments").click(function(){TurnTo.itemTeaserClick({sku:teaserSku,fromInputTeaser:false,readComments:true})})}}}}function fwItemClicked(){TurnToTrack.visitFWItemClick();setCookie(FEEDWCLICK_COOKIE_NAME,new Date().getTime(),2592000)}function pbItemClicked(){TurnToTrack.visitPBItemClick();setCookie(PBCLICK_COOKIE_NAME,new Date().getTime(),2592000)}function pbItemShown(){TurnToTrack.visitPBShown();setCookie(PBSHOWN_COOKIE_NAME,new Date().getTime(),2592000)}function itemTeaserClick(cmd){setTeaserCookie(TEASER_TYPE_ASK);if(S.setupType=="overlay"&&!onMobile){toggleMainWindow("none");showQuestionWidget({iteaserClick:true,sku:TurnToItemSku,fromInputTeaser:cmd.fromInputTeaser,text:cmd.text})}else{if(!onMobile){if(cmd.fromInputTeaser){var inputTeaserText=cmd.text;TurnTojQuery("#TT2questionText").val(inputTeaserText).removeClass("TTdefaultInput").focus();instantAnswerSearch(TurnTojQuery("#TT2questionText"),{fromQA:true})}else{}}else{var mobileFlow=cmd.readComments?"readComments":"fromInputTeaser";window.open(TurnTo.matchData.site.mobileTraPageUrl+(TurnTo.matchData.site.mobileTraPageUrl.indexOf("?")>-1?"&":"?")+"turntosku="+TurnToItemSku+(typeof cmd.text!="undefined"?"&text="+cmd.text:"")+"&fromInputTeaser="+cmd.fromInputTeaser+"&TurnToMobileFlow="+mobileFlow+"&curl="+encodeURIComponent(document.URL),"_blank")}}runClientCallbackFunc("teaserClick")}function itemReviewTeaserClick(cmd){if(cmd&&cmd.sku){TurnToItemSku=cmd.sku}setTeaserCookie(TEASER_TYPE_REVIEW);if(cmd&&cmd.fromMobile&&cmd.writeReview){toggleMainWindow();writeReview(null,true)}else{if((S.reviewsSetupType=="overlay"&&!onMobile)||(cmd&&cmd.fromMobile)){toggleMainWindow("none");showReviewWidget({iteaserClick:true,sku:TurnToItemSku,writeReview:cmd?cmd.writeReview:false,fromMobile:cmd?cmd.fromMobile:false})}else{var mobileFlow="readReview";if(cmd&&cmd.writeReview){mobileFlow="writeReview"}window.open(TurnTo.matchData.site.mobileTraPageUrl+(TurnTo.matchData.site.mobileTraPageUrl.indexOf("?")>-1?"&":"?")+"turntosku="+TurnToItemSku+"&TurnToMobileFlow="+mobileFlow+"&curl="+encodeURIComponent(document.URL),"_blank")}}runClientCallbackFunc("teaserClick")}function questionAskedOrInstantResultClick(){TurnToTrack.visitQAskedIRClicked();setCookie(QASKIRCLICK_COOKIE_NAME,new Date().getTime(),2592000)}function answerSubmittedSV(){TurnToTrack.visitAnswerSubmitted();setCookie(ANSWERSUBMIT_COOKIE_NAME,new Date().getTime(),2592000)}if(S.setTeaserCookieOnView){TurnTojQuery(window).bind("scroll.turntoWidgetScroll",testScrollForEmbedInView)}function testScrollForEmbedInView(){var ttContent=TurnTojQuery("#TurnToContent");if(ttContent.is(":visible")&&isEmbedWidScrolledIntoView(ttContent)){setTeaserCookie(TEASER_TYPE_ASK);TurnTojQuery(window).unbind("scroll.turntoWidgetScroll");if(!S.insertRelatedContentOnLoad&&S.reviewsSetupType=="staticEmbed"){insertRelatedQuestions()}}}if(TurnTo.matchData.site&&TurnTo.matchData.site.reviewsEnabled&&S.reviewsSetupType!="overlay"){TurnTojQuery(window).bind("scroll.turntoReviewsScroll",testScrollForEmbedReviewsInView)}function testScrollForEmbedReviewsInView(){if(!insertUiComplete){return}var ttRevContent=TurnTojQuery("#TurnToReviewsContent");if(ttRevContent.is(":visible")&&isEmbedWidScrolledIntoView(ttRevContent)){TurnTojQuery(window).unbind("scroll.turntoReviewsScroll");setTeaserCookie(TEASER_TYPE_REVIEW);if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){}else{checkForLIUser()}if(!S.insertRelatedContentOnLoad&&S.reviewsSetupType=="staticEmbed"){insertRelatedReviews()}}}function isEmbedWidScrolledIntoView(elem){if(elem.length==0){return false}var docViewTop=TurnTojQuery(window).scrollTop();var h=TurnTojQuery(window).height();var docViewBottom=docViewTop+h;var elemTop=TurnTojQuery(elem).offset().top;var elemBottom=elemTop+TurnTojQuery(elem).height();var twentyPercentTop=(elemTop*0.2);if(docViewTop>=(elemTop-twentyPercentTop)){return true}else{return((elemBottom>=docViewTop)&&(elemTop<=docViewBottom)&&(elemBottom<=docViewBottom)&&(elemTop>=docViewTop))}}function setTeaserCookie(type){setCookie(TEASER_COOKIE_NAME,type+","+new Date().getTime(),2592000);if(typeof(TurnToTrack)!="undefined"){TurnToTrack.visitTeaserClick(type)}}function getTraInitData(loadFunc,options){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getTraInitData"),load:function(data,ioArgs){TurnTo.traDataLoaded=true;if(data.logoutUser){localLogout()}setLocalLoginCookie(data);setModeratorCookie(data);loadFunc(data,ioArgs)},error:function(data,ioArgs){displayGenericErrorMessageInSubWindow()}})}function getItems4User(callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getItems4User")+"&cid="+cid,load:function(data,ioArgs){TurnTo.matchData.user.items=data.items;if(typeof TurnTo.matchData.counts=="undefined"){TurnTo.matchData.counts={}}if(data.items!=null){TurnTo.matchData.user.counts.userItems=data.items.length}TurnTo.matchData.user.siteSharing=data.siteSharing;TurnTo.matchData.user.raveTargets=data.raveTargets;TurnTo.matchData.allTargets=data.allTargets;callbackF()},error:function(data,ioArgs){var message="getItems4User XHR - Status: "+data.status+" Error: "+data.error}})}function setUserState(data,ioArgs){var s=TurnTo.matchData.site;TurnTo.matchData=data;TurnTo.matchData.site=s;importSrc=TurnTo.matchData.importSrc;if(data.status==1){return false}TurnTo.loggedIn=(data.user!=null);setLocalLoginCookie(data);setModeratorCookie(data);return true}function hasErrors(){if(TurnTo.error){TurnTojQuery(".TTerror").each(function(i){this.innerHTML=TurnTo.error});return true}return false}function checkThirdPartyCookies(){if(S.useFirstPartyCookies){setThirdBlocked(true);return}var cName=S.thirdBlockedCookieName;var cVal=getCookie(cName);if(cVal==null){setCookie(S.thirdBlockedCookieName,false);cVal=false}if(cVal){setThirdBlocked(cVal=="true");return}}function checkFirebug(){var haveCon=(typeof window.console!="undefined");var haveFB=(haveCon&&("dirxml" in window.console));if(!haveFB){var names=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];window.console={};for(var i=0;i<names.length;++i){window.console[names[i]]=function(){}}}}function setThirdBlocked(blocked){TurnTo.thirdBlocked=blocked;if(TurnTo.setCookieIframe){setCookie(S.thirdBlockedCookieName,""+blocked);var p=TurnTo.setCookieIframe.parentNode;if(p){p.removeChild(TurnTo.setCookieIframe)}TurnTo.setCookieIframe=null}}function getUrl(uri,httpOnly){var proto=(httpOnly)?"http:":TurnTo.partnerProtocol;return proto+"//"+S.host+uri}function getStaticUrl(uri){return TurnTo.partnerProtocol+"//"+S.staticHost+uri}function getSessionUrl(uri,query,httpOnly){if(httpOnly==null){httpOnly=true}var post="";var sid=getCookie(S.sessionCookieName);if(sid){uri="/syncSession"+uri;post+="?js="+sid}var url=getUrl(uri,httpOnly);url+=post;if(query){url+=(sid?"&":"?")+query}return url}TurnTo.xhrUri=xhrUri;function xhrUri(uri,siteKeyOverride){var xu=uri;var sid=getCookie(S.sessionCookieName);if(sid){xu+=";jsessionid="+sid}xu+="?siteKey="+(siteKeyOverride?siteKeyOverride:S.siteKey)+"&lang="+S.locale+"&uniq="+(new Date().getTime());return xu}function toggleDisplay(elem,displayStyle){var elemQ=TurnTojQuery(elem);if(typeof displayStyle=="undefined"){displayStyle="block"}if(elem.style.display==displayStyle){elemQ.hide(200,checkScroll);displayStyle="none"}else{elemQ.show(200,checkScroll);displayStyle="block"}return displayStyle}function checkScroll(){var postCss={"overflow-y":TurnTo.matchesBox.matchesList.scrollHeight>S.matchesHeight?"scroll":"hidden"};if(TurnTojQuery.browser.msie){postCss.height=Math.min(S.matchesHeight,TurnTo.matchesBox.matchesList.scrollHeight)+"px"}else{postCss["max-height"]=S.matchesHeight+"px"}TurnTo.matchesBox.matchesListQ.css(postCss)}var webEventCount=0;function logWebEvent(event,params){if(!params){params=""}if(TurnTo.matchData!=null){if(TurnTo.matchData.user&&TurnTo.matchData.user.id){params+="&uid="+TurnTo.matchData.user.id}var webevnt=document.createElement("img");webevnt.width="1";webevnt.width="1";webevnt.border="0";webevnt.className="TTWebEvent";var c=webEventCount++;webevnt.id="TTWebEvent"+c;document.body.appendChild(webevnt);var webEventCallElem=TurnTojQuery("#TTWebEvent"+c);webEventCallElem[0].src=TurnTo.baseEventUrl+"&e="+event+(params?params:"")}}function logWebEvent2(event,params){if(typeof(TurnToTrack)!="undefined"&&TurnToTrack.isSiteVisitTrackingBlock()){return}if(!params){params=""}if(TurnTo.matchData&&TurnTo.matchData.user&&TurnTo.matchData.user.id){params+="&uid="+TurnTo.matchData.user.id}var c=webEventCount++;params+="&uniq="+c;TurnTojQuery("body").append('<img width="1" border="0" class="TTWebEvent" id="TTWebEvent'+c+'" src="'+TurnTo.baseEventUrl+"&e="+event+params+'">')}function logTraEvent(event,params){params+="&et=tra&url="+document.URL+"&pd="+S.eventPartnerData;logWebEvent(event,params)}var rewardPointsEventMap={};rewardPointsEventMap[TurnTo.eventQaQPost]="askedQuestion";rewardPointsEventMap[TurnTo.eventQaAPost]="answeredQuestion";rewardPointsEventMap[TurnTo.eventItemShared]="sharedItem";var rewardEventCount=0;function logRewardPoints(event){if(!TurnTo.matchData.user&&!S.pointEvents.allowAnonymous){return}var rpConf=getRewardPointsConfig(event);var lpurl=rpConf.url?rpConf.url:null;var lpfn=rpConf.fn?rpConf.fn:null;if(lpfn&&typeof lpfn==="function"){try{lpfn()}catch(e){console.error("Error invoking lpfn: "+e)}}if(lpurl){var c=rewardEventCount++;if(lpurl.indexOf("?")>-1){lpurl+="&"}else{lpurl+="?"}lpurl+="cid="+cid+rewardEventCount;TurnTojQuery("body").append('<img width="1" border="0" class="TTWebEvent" id="TTRewardEvent'+c+'" src="'+lpurl+'">')}}function getRewardPointsConfig(event){if(!S.pointEvents){return{}}var cnfev=S.pointEvents[rewardPointsEventMap[event]];return cnfev?cnfev:{}}function showRealLogin(e){TurnTo.jq("#TTcheckFormDiv")[0].style.display="none";TurnTo.jq("#TTloginScreen")[0].style.display="block";TurnTo.jq(TurnTo.loginUsername).focus();stopDefault(e);return false}TurnTo.insertScreen=insertScreen;function insertScreen(id,html,obj){var q=traJq(id);if(q==null){}q[0].innerHTML=obj?html(obj):html;addTextToButtons();return q}function showQuestionWidget(cmd,callback){whichWidget="ask";traJq("#TT3overlayHeader").hide();var elId="#TTtraLayout";if(onMobile){elId="#TurnToMobileContent"}S.fromEmbed=false;insertScreen(elId,'<div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div>');var feedback=TurnTojQuery("#TT2footerFeedback");feedback.show();feedback.attr("href","mailto:feedback@turnto.com?subject=Feedback on QandA widget on "+encodeURIComponent(TurnTo.matchData.site.siteName)+"&body=%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A---------------------------------------------------------------%0ASubmitted from: "+encodeURIComponent(document.location));insertScreen(elId,TurnToHTML.questionWidget,new function(){var url="/sitedata/"+S.siteKey+"/v4_3/"+encodeURIComponent(TurnToItemSku)+"/d/"+S.locale+"/catitemhtml";getText(url,function(data,ioArgs){TurnTojQuery("#TT3ugcContent4item").html(data.text);if(data.text==='<div id="TurnToContent"></div>'){if(S.emptyQAMessage){TurnTojQuery("#TurnToContent").append(S.emptyQAMessage)}}TurnTo.jQcontext2=TurnTojQuery("#TurnToContent");yieldToUI(function(){if(S.registration){syncPartnerAndTTuserState(function(statusObj){if(TurnTo.matchData.user){showHiInHeader()}})}else{checkForLIUser()}insertInstructionalCopy();if(cmd.fromInputTeaser){var inputTeaserText=cmd.text;TurnTojQuery("#TT2questionText").val(inputTeaserText).removeClass("TTdefaultInput").focus();instantAnswerSearch(TurnTojQuery("#TT2questionText"),{fromQA:true})}if(S.inWidget){TurnTojQuery("#TT3overlayHeader").hide()}if(S.instantAnswers){TurnTojQuery("#TT2questionText").keyup(function(){instantanswers(traJq(this),{fromQA:true})})}setupTextareaAutoSizing(TurnTojQuery("#TT2questionText"),3);setupQuestionSubmit();TurnTojQuery("#TT4closeQuestionBox").click(function(){resetQuestionArea()});TurnTojQuery("#TT4closeQuestionBox").keydown(function(e){if(isEnterKey(e)){resetQuestionArea()}});toggleTopLinks(false,false);insertNonIndexedUgc();insertInlineAnswerBoxes();yieldToUI(function(){setupProfileLinks();setupProfileLinks(TurnTo.jQcontext2,"commerceBanner",false);setupMultiItemScroll();personalizeUgc(function(){insertRelatedQuestions()})})})})})}function showReviewWidget(cmd,callback){traJqC("#TT4writeReview").remove();traJqC("#TT3overlayHeader").remove();var elId="#TTtraLayout";if(onMobile){elId="#TurnToMobileContent"}S.fromEmbed=false;insertScreen(elId,'<div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div>').show();insertScreen(elId,TurnToHTML.reviewWidget,new function(){var url="/sitedata/"+S.siteKey+"/v4_3/"+encodeURIComponent(TurnToItemSku)+"/d/"+S.locale+"/catitemreviewshtml";getText(url,function(data,ioArgs){var ttReviewsEl=TurnTojQuery("#TT3reviewContent4item");ttReviewsEl.html(data.text);yieldToUI(function(){checkUseSmallDimensions();checkForLIUser();toggleTopLinks(false,false);paginateDirectReviews();truncateReviews(ttReviewsEl);disableVotingForReviewOwner(ttReviewsEl);insertModerateLink(ttReviewsEl,"review");setupShowMediaModal(ttReviewsEl);if(TurnTo.isPlaceHolderSupported()){TurnTojQuery("#TTreviewSearchTerm").attr("placeholder",TurnTo.S.reviewsSearchBoxDefaultText)}else{TurnTojQuery("#TTreviewSearchTerm").attr("ttinputlabeltext",TurnTo.S.reviewsSearchBoxDefaultText);TurnTojQuery("#TTreviewSearchTerm").attr("value",TurnTo.S.reviewsSearchBoxDefaultText);TurnTojQuery("#TTreviewSearchTerm").attr("onblur","TurnTo.inputLoseFocus(this)");TurnTojQuery("#TTreviewSearchTerm").attr("onfocus","TurnTo.inputFocus(this)");TurnTojQuery("#TTreviewSearchTerm").attr("class","TTdefaultInput")}TurnTojQuery("#TTreviewSearchTerm").keyup(function(){var curVal=TurnTojQuery("#TTreviewSearchTerm").val();var curValLen=curVal?curVal.length:0;if(curValLen===0){TurnTo.clearReviewsSearchResults()}else{TurnTojQuery("#TTreviewsWrapper").hide();TurnTo.clearReviewsSearchResults(true);instantanswers(traJq(this),{fromReviews:true})}});TurnTojQuery("#TTwriteReviewBtn").keydown(function(e){if(isEnterKey(e)){writeReview()}});if(cmd&&cmd.writeReview){writeReview(null,cmd.fromMobile)}insertRelatedReviews()})})})}function yieldToUI(fnct,args){setTimeout(function(){fnct(args)},0)}var ugcFeedSku=null;function showSoloQuestionViewWidget(cmd,turntoflow){if(turntoflow!="ugcfeed"){dropLocalLoginCookie();dropModeratorCookie()}getQuestionData(cmd,function(data,ioArgs){if(data.question.removed){showQuestionRemovedMsg();if(!isWidgetOpen()){toggleMainWindow("none")}return}if(turntoflow=="ugcfeed"){ugcFeedSku=window.TurnToItemSku;window.TurnToItemSku=data.catItem.sku}setActivityCookie(window.TurnToItemSku);toggleMainWindow("none");traJq("#TT-spinner").hide();traJq(".TT2sectionHeader").hide();var statusMsg=null;if(turntoflow=="thanka"){statusMsg=msg("tra.soloQ.message.thanka",[formatName(data.question,false),formatName(data.answer,false,"nickFirstEmail")])}else{if(turntoflow=="answerview"){statusMsg=msg("tra.soloQ.message.answerview")}else{if(turntoflow=="thankanswer"){statusMsg=msg("tra.soloQ.message.thankanswer",[formatName(data.question,false),formatName(data.answer,false,"nickFirstEmail")])}else{if(turntoflow=="answerreply"){statusMsg=msg("tra.soloQ.message.answerreply",[formatName(data.answer,false,"nickFirstEmail"),formatName(data.reply,false,"nickFirstEmail")])}else{if(turntoflow=="replyview"){statusMsg=msg("tra.soloQ.message.replyview",[(data.user.firstName?" "+data.user.firstName:"")])}}}}}var elId="#TTtraLayout";if(onMobile){elId="#TurnToMobileContent"}if(turntoflow=="domore"){var soloQCont='<div id="TTdoMoreSoloQView"></div>';if(onMobile){TurnTojQuery(elId).append(soloQCont)}else{TurnTojQuery(elId).after(soloQCont)}elId="#TTdoMoreSoloQView"}var params={question:data.question,catItem:data.catItem,showHeader:false,showBackBtn:false,hideClose:false,hideSeeAll:!S.teaserClickFunction,statusMsg:statusMsg,postfix:""};insertScreen(elId,TurnToHTML.soloQuestionViewWidget,params);TurnTojQuery(elId).show();var questions=new Array();questions.push(data.question);var container=TurnTojQuery("#TT3soloQuestion");var qarParams={cont:container,questions:questions,showAbout:true,showImg:true,append:true,insertInputBox:true,showReplyLink:true};insertQAR(qarParams);insertYouBadge(container);insertModerateLink(container,"answer");disableVotingForOwner(container);var isShowAllAnswersView=(turntoflow=="answerview"||turntoflow=="replyview");var isShowSingleAnswerView=(turntoflow=="thanka"||turntoflow=="thankanswer"||turntoflow=="answerreply"||turntoflow=="domore");if(!isShowAllAnswersView){setupInitialAnswersStateForSQV(container,true);setupShownAnswer(data.question.id,data.answer.id)}else{setupInitialAnswersStateForSQV(container,false)}if(turntoflow=="domore"){container.find(".TT3answersBlock").show()}if(data.question.answers.length>1&&!isShowSingleAnswerView){var showLink=container.find("#TT3expand-"+data.question.id+" .TT3showText a");showAllAnswers(showLink,data.question.id)}container.find(".TT3questWrp").removeClass("TT3questBorder");if(turntoflow=="thankanswer"){ilr(data.question.id,data.answer.id,null,TurnTojQuery("#TT3soloQuestion  #TT3replyLink"+data.answer.id),function(){container.find("#TT2inlineAnswer-"+data.question.id+"-"+data.answer.id).focus()})}else{if(turntoflow=="answerreply"){container.find("#TT3IRContainer-"+data.question.id+"-"+data.answer.id+"-"+data.reply.id).show().parents(".TT3IRContainer").show();ilr(data.question.id,data.answer.id,data.reply.id,container.find("#TT3replyLink"+data.answer.id+"-"+data.reply.id),function(){container.find("#TT2inlineAnswer-"+data.question.id+"-"+data.answer.id+"-"+data.reply.id).focus()})}}if(cmd.showAnswerInput){container.find(".TT4addAnswer").click()}if(ugcFeedSku&&!onMobile){TurnTojQuery("#TTtraWindowClose")[0].onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;if(ugcFeedSku){window.TurnToItemSku=ugcFeedSku;ugcFeedSku=null}}}if(turntoflow){turntoflowItemContextUrl=data.catItem?data.catItem.url:null}var mlpCloseFunc=getMobileLandingPageTTflowCloser();var closeFunc;if(mlpCloseFunc){closeFunc=mlpCloseFunc}else{if(turntoflow=="domore"){if(onMobile){closeFunc=function(){TurnTojQuery(elId).remove();traJq("#TTmoreFeedback").show()}}else{var oldCloseWinFunc=TurnTojQuery("#TTtraWindowClose")[0].onclick;closeFunc=function(){TurnTojQuery(elId).remove();traJq("#TTmoreFeedback").show();TurnTojQuery("#TTtraWindowClose")[0].onclick=oldCloseWinFunc};TurnTojQuery("#TTtraWindowClose")[0].onclick=closeFunc}}else{closeFunc=function(){if(!onMobile){toggleMainWindow()}else{closeMobileOverlay()}}}}traJq("#TT2ppCloseBtn").click(closeFunc);if(S.teaserClickFunction){TurnTojQuery("#TT3soloSeeAll").click(function(){closeFunc()})}addTextToButtons()})}function getMobileLandingPageTTflowCloser(){if(S.setupType!="mobileTT"||!turntoflowItemContextUrl||!TurnTo.params.turntoflow){return null}return function(){window.location=turntoflowItemContextUrl}}function hideMLPCloser(){if(S.setupType=="mobileTT"){TurnTojQuery("#TTgenSubWinClose").hide()}}function showInlineSoloArticleViewWidget(cmd,cb){getArticleData(cmd,function(data,ioArgs){var header=null;var postfix=cmd.fromQA?"Q":"R";TurnTojQuery("#TT4inlineSqv"+postfix).remove();TurnTojQuery("#TT4inlineSqv"+postfix).remove();var container;if(cmd.fromQA){TurnTojQuery("#TT4askQResultsLine").hide();TurnTojQuery("#TT3askBtnBlock .TT4askQ").append('<div class="TTsqvBorder"><div class="TTsqvBack"></div><div class="TTsqvForward"></div><div class="TT4QiaHintCenter TTrespDesktopDisp">'+S.instantAnswerOpenedMsg+'</div><div class="TTclear"></div></div>');container=TurnTojQuery("#TT3askBtnBlock .TT4askQ");container.append('<div id="TT4inlineSqv'+postfix+'" style="display: none;"></div>');addTextToButtons()}else{container=TurnTojQuery("#TT4instantAnswers"+postfix).after('<div id="TT4inlineSqv'+postfix+'" style="display: none;"></div>').hide().parent()}var wasShowMoreVisible=container.find("#TT3iaShowMore"+postfix).is(":visible");container.find("#TT4iaResults"+postfix).parent().hide();container.find("#TT3iaShowMore"+postfix).hide();var inlineSqvEl=TurnTojQuery("#TT4inlineSqv"+postfix);insertScreen(inlineSqvEl,TurnToHTML.soloArticleViewWidget,{titleHtml:data.article.titleHtml,bodyHtml:data.article.bodyHtml,postfix:postfix});if(cmd.fromReviews){traJqR("#TT3soloQuestionView"+postfix).prepend('<div class="TTsqvBorder"><div class="TTsqvBack"></div><div class="TTclear"></div></div>')}container.find(".TTsqvBack").click(function(){TurnTojQuery("#TT4inlineSqv"+postfix).hide();TurnTojQuery("#TT4askQResultsLine").show();expandAndFadeIn(container.find("#TT4iaResults"+postfix).parent());if(wasShowMoreVisible){container.find("#TT3iaShowMore"+postfix).show()}if(cmd.fromQA){container.find(".TT4askQ").show();traJq(this).parent().remove()}else{traJqR("#TT4instantAnswers"+postfix).show()}});if(cmd.fromQA){container.find(".TTsqvForward").click(function(){TurnTojQuery("#TT4inlineSqv"+postfix).hide();TurnTojQuery("#TT3askBtnBlock .TT4askQ").hide();TurnTojQuery("#TT2questionText").attr("nosearch",true);expandAndFadeIn(TurnTojQuery("#TTaskExpand"));TurnTojQuery("#TT2questionText").focus();traJq(this).parent().remove();container.find(".TT4QhintCenter").html(S.submitQuestionReviewMsg)})}expandAndFadeIn(inlineSqvEl);if(cb){cb()}})}function showInlineSoloQuestionViewWidget(cmd,cb){getQuestionData(cmd,function(data,ioArgs){var header=null;var postfix=cmd.fromQA?"Q":"R";TurnTojQuery("#TT4inlineSqv"+postfix).remove();var container;if(cmd.fromQA){TurnTojQuery("#TT4askQResultsLine").hide();TurnTojQuery("#TT3askBtnBlock .TT4askQ").append('<div class="TTsqvBorder"><div class="TTsqvBack"></div><div class="TTsqvForward"></div><div class="TT4QiaHintCenter TTrespDesktopDisp">'+S.instantAnswerOpenedMsg+'</div><div class="TTclear"></div></div>');container=TurnTojQuery("#TT3askBtnBlock .TT4askQ");container.append('<div id="TT4inlineSqv'+postfix+'" style="display: none;"></div>')}else{container=TurnTojQuery("#TT4instantAnswersR").after('<div id="TT4inlineSqv'+postfix+'" style="display: none;"></div>').hide().parent()}var wasShowMoreVisible=container.find("#TT3iaShowMore"+postfix).is(":visible");container.find("#TT4iaResults"+postfix).parent().hide();container.find("#TT3iaShowMore"+postfix).hide();var inlineSqvEl=TurnTojQuery("#TT4inlineSqv"+postfix);insertScreen(inlineSqvEl,TurnToHTML.soloQuestionViewWidget,{header:header,question:data.question,catItem:data.catItem,showHeader:false,showBackBtn:cmd.fromReviews?true:false,statusMsg:null,hideClose:true,hideSeeAll:true,postfix:postfix});container.find(".TTsqvBack").click(function(){TurnTojQuery("#TT4inlineSqv"+postfix).hide();TurnTojQuery("#TT4askQResultsLine").show();expandAndFadeIn(container.find("#TT4iaResults"+postfix).parent());if(wasShowMoreVisible){container.find("#TT3iaShowMore"+postfix).show()}if(cmd.fromQA){container.find(".TT4askQ").show();traJq(this).parent().remove()}else{traJqR("#TT4instantAnswers"+postfix).show()}});if(cmd.fromQA){container.find(".TTsqvForward").click(function(){TurnTojQuery("#TT4inlineSqv"+postfix).hide();TurnTojQuery("#TT3askBtnBlock .TT4askQ").hide();TurnTojQuery("#TT2questionText").attr("nosearch",true);expandAndFadeIn(TurnTojQuery("#TTaskExpand"));TurnTojQuery("#TT2questionText").focus();traJq(this).parent().remove();container.find(".TT4QhintCenter").html(S.submitQuestionReviewMsg)})}var questions=new Array();questions.push(data.question);var soloQ=TurnTojQuery("#TT3soloQuestion"+postfix);insertQAR({cont:soloQ,questions:questions,showAbout:true,showImg:true,append:true,insertInputBox:true,showReplyLink:true,hideDefaultImg:true});insertYouBadge(soloQ);insertModerateLink(soloQ,"answer");disableVotingForOwner(soloQ);setupInitialAnswersState(soloQ);if(data.question.answers.length>1){var showLink=soloQ.find("#TT3expand-"+data.question.id+" .TT3showText a");showAllAnswers(showLink,data.question.id)}soloQ.find(".TT3questWrp").removeClass("TT3questBorder");var closeFunc=function(){};expandAndFadeIn(inlineSqvEl);setupMultiItemScroll(inlineSqvEl);traJq("#TT2ppCloseBtn"+postfix).click(closeFunc);if(cb){cb()}})}function showInlineSoloReviewViewWidget(cmd,cb){getReviewData(cmd,function(data,ioArgs){var header=null;var postfix=cmd.fromQA?"Q":"R";TurnTojQuery("#TT4inlineSqv"+postfix).remove();var container;if(cmd.fromQA){TurnTojQuery("#TT4askQResultsLine").hide();TurnTojQuery("#TT3askBtnBlock .TT4askQ").append('<div class="TTsqvBorder"><div class="TTsqvBack"></div><div class="TTsqvForward"></div><div class="TT4QiaHintCenter TTrespDesktopDisp">'+S.instantAnswerOpenedMsg+'</div><div class="TTclear"></div></div>');container=TurnTojQuery("#TT3askBtnBlock .TT4askQ");container.append('<div id="TT4inlineSqv'+postfix+'" style="display: none;"></div>')}else{container=TurnTojQuery("#TT4instantAnswers"+postfix).after('<div id="TT4inlineSqv'+postfix+'" style="display: none;"></div>').hide().parent()}var wasShowMoreVisible=container.find("#TT3iaShowMore"+postfix).is(":visible");container.find("#TT4iaResults"+postfix).parent().hide();container.find("#TT3iaShowMore"+postfix).hide();var inlineSqvEl=TurnTojQuery("#TT4inlineSqv"+postfix);insertScreen(inlineSqvEl,'<div id="TT3soloReviewView'+postfix+'"></div>');if(cmd.fromReviews){traJqR("#TT3soloReviewViewR").append('<div class="TTsqvBorder"><div class="TTsqvBack"></div><div class="TTclear"></div></div>')}container.find(".TTsqvBack").click(function(){TurnTojQuery("#TT4inlineSqv"+postfix).hide();TurnTojQuery("#TT4askQResultsLine").show();expandAndFadeIn(container.find("#TT4iaResults"+postfix).parent());if(wasShowMoreVisible){container.find("#TT3iaShowMore"+postfix).show()}if(cmd.fromQA){container.find(".TT4askQ").show();traJq(this).parent().remove()}else{traJqR("#TT4instantAnswers"+postfix).show()}});if(cmd.fromQA){container.find(".TTsqvForward").click(function(){TurnTojQuery("#TT4inlineSqv"+postfix).hide();TurnTojQuery("#TT3askBtnBlock .TT4askQ").hide();TurnTojQuery("#TT2questionText").attr("nosearch",true);expandAndFadeIn(TurnTojQuery("#TTaskExpand"));TurnTojQuery("#TT2questionText").focus();traJq(this).parent().remove();container.find(".TT4QhintCenter").html(S.submitQuestionReviewMsg)})}insertReview(TurnTojQuery("#TT3soloReviewView"+postfix),data.review,{hideCtrls:TurnTo.matchData.site.instAnsFromIngestedReviews,ctrlsBelowReview:true},data.shopperProfile);var closeFunc=function(){};expandAndFadeIn(inlineSqvEl);traJq("#TT2ppCloseBtn"+postfix).click(closeFunc);if(cb){cb()}})}function getArticleData(cmd,callbackF){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getArticleData")+"&said="+cmd.said+(cmd.logClick?"&logClick=true"+(qaSessionId?"&qaSessionId="+qaSessionId:""):"")+("&svid="+TurnToTrack.getSiteVisitId()),load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.loggedIn=true;setLocalLoginCookie(data);setModeratorCookie(data);showHiInHeader()}if(callbackF){callbackF(data,ioArgs)}},error:function(data,ioArgs){traJq("#error").html(data.error)}})}function getQuestionData(cmd,callbackF){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getQuestionData")+((cmd.qid?"&qid="+cmd.qid:"")+(cmd.uid?"&uid="+cmd.uid:"")+(cmd.aid?"&aid="+cmd.aid:"")+(cmd.rid?"&rid="+cmd.rid:"")+(cmd.logClick?"&logClick=true"+(qaSessionId?"&qaSessionId="+qaSessionId:""):"")+("&svid="+TurnToTrack.getSiteVisitId())),load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.loggedIn=true;setLocalLoginCookie(data);setModeratorCookie(data);showHiInHeader()}TurnToCatItemType=data.catItem.itemType;if(callbackF){callbackF(data,ioArgs)}},error:function(data,ioArgs){traJq("#error").html(data.error);var message="getQuestionData XHR - Status: "+data.status+" Error: "+data.error}})}function getReviewData(cmd,callbackF){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getReviewData")+((cmd.irid?"&irid="+cmd.irid:"")+(cmd.uid?"&uid="+cmd.uid:"")+(cmd.logClick?"&logClick=true"+(qaSessionId?"&qaSessionId="+qaSessionId:""):"")+("&svid="+TurnToTrack.getSiteVisitId())),load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.loggedIn=true;setLocalLoginCookie(data);setModeratorCookie(data);showHiInHeader()}if(callbackF){callbackF(data,ioArgs)}}})}function submitAnswerReplyEnsurePartnerReg(qid,aid,rid,callbackF,cont){S.registration.synced=false;ensurePartnerRegUser(TurnTo.regSourceAskAnswerReply,function(){submitAnswerReply(qid,aid,rid,callbackF,cont)})}function submitAnswerReply(qid,aid,rid,callbackF,cont,isExistingLoUser,uident){var idPostfix=qid+(aid?"-"+aid:"")+(rid?"-"+rid:"");var inputElJQ=TurnTojQuery("#TT2inlineAnswer-"+idPostfix);var text=stripString(inputElJQ.val());if(!text||text==inputElJQ.attr("ttInputLabelText")){return}if(!TurnTo.matchData.user&&!isExistingLoUser){showGenericRegFlow({header:msg("tra.qa.reply.reg.header"),regSource:TurnTo.regSourceAskAnswerReply,showNickname:true,instructionalText:msg("tra.qa.reply.instruction.connectOrProvide"),showSkip:false,showCancel:true,reconfirmCallback:function(){submitAnswerReply(qid,aid,rid,callbackF,cont,true,TurnTo.matchData.uident)}},function(data,ioArgs){submitAnswerReply(qid,aid,rid,callbackF,cont,isExistingLoUser,uident)});return}if(!S.inWidget){toggleSubWindow("none")}if(S.setupType=="mobileTT"){TurnTojQuery("#TurnToMobileContent").show()}var qaid=qid+"-"+aid+(rid?"-"+rid:"");var replyText=stripString(TurnTojQuery("#TT2inlineAnswer-"+qaid,cont).val());var replyToUid=TurnTojQuery("#TT2replyToUid-"+qaid,cont).val();if(!replyText){return}if(TurnToMods.mods.util.containsEmail(replyText)){TurnTojQuery("#TT2error-"+qaid,cont).html(msg("tra.qa.reply.error.dontIncludeEmail")).show();return}if(TurnToMods.mods.util.containsPhoneNumber(replyText)){TurnTojQuery("#TT2error-"+qaid,cont).html(msg("tra.qa.reply.error.dontIncludePhone")).show();return}if(TurnTojQuery("#TT2inlineAnswer-"+qaid,cont).attr("class")=="TTdefaultInput"){return}TurnTojQuery("#TT2imgLoading-"+qaid,cont).show();TurnTojQuery("#TT2answerBtn-"+qaid,cont).hide();var data={};data.reply=replyText;data.aid=aid;data.rid=rid;data.replyToUid=replyToUid;data.notify=TurnTojQuery("#TT2answerNotify-"+qaid,cont).attr("checked");data.uident=uident?uident:null;xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/replyAnswer"),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){if(window.TurnToItemSku){setActivityCookie(TurnToItemSku)}if(callbackF){callbackF(data,ioArgs)}else{TurnTojQuery("#TT2imgLoading-"+qaid,cont).hide();TurnTojQuery("#TT2answerBtn-"+qaid,cont).show();TurnTojQuery("#TT2answersBlock-"+qaid,cont).remove();TurnTojQuery("#TT3replyLink"+qaid,cont).replaceWith("<span>"+msg("tra.qa.answer.linkLine.reply")+"</span>");insertReply(qid,aid,rid,data.reply,true,cont);traJqC("#TT3IRContainer-"+qid+"-"+aid+" .TT3rplyCntr").last().removeClass("TT3replyBorder");insertYouBadge(traJqC("#TT3reply-"+data.reply.id));insertModerateLink(traJqC("#TT3reply-"+data.reply.id),"answer")}},error:function(data,ioArgs){TurnTojQuery("#TT2imgLoading-"+qaid,cont).hide();TurnTojQuery("#TT2answerBtn-"+qaid,cont).show();TurnTojQuery("#TT2error-"+qaid,cont).html(data.error);var message="subimtAnswerReply XHR - Status: "+data.status+" Error: "+data.error}})}function insertReply(qid,aid,parentRid,data,isNew,cont,hideReply){var qaid=qid+"-"+aid+(parentRid?"-"+parentRid:"");var confirmMsg=msg("tra.qa.reply.message.replySubmitted");if(!TurnTo.matchData.user&&TurnTo.matchData.isExistingLoUser){confirmMsg=getExistingLoUserMsg(null)}else{if(TurnTo.matchData.user&&TurnTo.matchData.user.isPreUser){confirmMsg=msg("tra.qa.reply.message.replyNotSubmitted")+" "+TurnTo.getUnconfirmedMsg(TurnTo.matchData.user)}}var replier={uid:data.uid,pid:data.pid,fName:data.fName,lName:data.lName,nName:data.nName,isStaff:data.isStaff,expertLabel:data.expertLabel};TurnTojQuery("#TT3IRContainer-"+qaid,cont).prepend(TurnToHTML.replyBlock({confirmMsg:confirmMsg,qid:qid,aid:aid,rid:data.id,showReplyLink:false,reply:data.text,replier:replier,replyDate:data.dateCreated,siteId:data.siteId,siteName:data.siteName,syndicationSource:data.syndicationSource,depth:data.depth?data.depth:0,hideReply:hideReply,replyCnt:(data.replys?data.replys.length:0)}));setupResendConfirm(cont);if(isNew){var msgBlock=TurnTojQuery("#TT3replySubmitted-"+data.id,cont);if(!data.uid){msgBlock.find("b").html(msg("tra.qa.reply.message.replySubmitted")+" "+msg("tra.systemMessage.checkInboxToConfirm"))}msgBlock.show();TurnTojQuery("#TT3dismissReplied-"+data.id,cont).click(function(){TurnTojQuery("#TT3replySubmitted-"+data.id,cont).remove()});var qEl=traJqC("#TT3answer-"+aid+" .TT3ansCntr .TT3itemBox2");if(!qEl.hasClass("TT3replyBorder")){qEl.addClass("TT3replyBorder")}if(parentRid){var parEl=traJqC("#TT3reply-"+parentRid);if(!parEl.hasClass("TT3replyBorder")){parEl.addClass("TT3replyBorder")}}}setupProfileLinks(TurnTojQuery("#TT3reply-"+data.id,cont))}function setupResendConfirm(cont){var resendLink=cont?cont.find(".TT3resendConfirm"):TurnTojQuery(".TT3resendConfirm");resendLink.click(function(){for(var i=0;i<TurnTo.matchData.user.uIdents.length;i++){if(TurnTo.matchData.user.uIdents[i].type==1&&!TurnTo.matchData.user.uIdents[i].confirmed){var email=TurnTo.matchData.user.uIdents[i].ident;var msgCb;if(!S.inProfile&&S.setupType!=="overlay"){msgCb=function(){resendLink.closest(".TT4SysMsgBody").append('<p class="TT4confirmResent">'+msg("tra.reg.message.confirmationResent",[email])+"</p>")}}resendEmailConfirmation(email,msgCb)}}})}function isSiteManager(userSiteRoles){if(userSiteRoles==null){return false}for(var i=0;i<userSiteRoles.length;i++){if(userSiteRoles[i]==TurnTo.siteManager){return true}}return false}function isSiteModerator(userSiteRoles){if(userSiteRoles==null){return false}for(var i=0;i<userSiteRoles.length;i++){if(userSiteRoles[i]==TurnTo.siteModerator){return true}}return false}function showInlineAnswerInput(el,expand){if(el){var inputElJQ=traJqC(el);if(inputElJQ.hasClass("TTdefaultInput")){setSelectionRange(el,0,0)}el.onkeydown=function(){if(traJqC(this).hasClass("TTdefaultInput")){traJqC(this).removeClass("TTdefaultInput").val("").html("");setSelectionRange(el,0,0)}};el.onclick=function(){if(traJqC(this).hasClass("TTdefaultInput")){setSelectionRange(el,0,0)}};if(expand){inputElJQ.attr("rows","3");inputElJQ.parent().find(".TT4answerBtns").show()}}}function setSelectionRange(input,start,end){if(input.setSelectionRange){input.focus();input.setSelectionRange(start,end)}else{if(input.createTextRange){var range=input.createTextRange();range.collapse(true);range.moveEnd("character",end);range.moveStart("character",start);range.select()}}}function hideInlineAnswerInput(inputElJQ){var id=inputElJQ.attr("id");if(id){var qid=id.substring(id.lastIndexOf("-")+1);inputElJQ.height("25px");inputElJQ.attr("rows","1");inputElJQ.val(inputElJQ.attr("ttinputlabeltext"));inputElJQ.addClass("TTdefaultInput");inputElJQ[0].ttInputClicked=null;var parent=inputElJQ.parent();parent.find("#TT2answerBtns-"+qid).hide();parent.find("#TT2answersBlock-"+qid).height("26px");parent.find("#TT2answersBlock-"+qid).css("padding","");parent.find("#TT2error-"+qid).empty().hide()}}function showGenericRegFlow(cmd,cb){if(S.registration){return}TurnTojQuery("#TTmainContent").height((TurnTojQuery(window).height()-100)+"px");var targetId="#TTSubScreen";if(onMobile){TurnTojQuery("#TurnToMobileContent").hide();targetId="#TurnToMobileRegistration";if(S.setupType!="mobileTT"){TurnTojQuery("#TTtraWindow").css("overflow","visible");if(TurnTojQuery(targetId).length===0){targetId="#TTinnerReg";var regContHtml='<div id="TurnToMobileRegistration" style="width:100%;height:100%;position:fixed;-webkit-backface-visibility: hidden;top:0;left:0;background-color:white"><div id="TTinnerReg" style="height:100%;position:relative;overflow:scroll;"></div></div>';TurnTojQuery("#TTtraWindow").append(regContHtml)}}}var customClientMsg=msg("tra.reg.message.additionalCustom");customClientMsg=customClientMsg==""||customClientMsg.indexOf("<?tra")>-1?null:customClientMsg;insertScreen(targetId,TurnToHTML.registrationScreen,{header:cmd.header,regSource:cmd.regSource,showNickname:cmd.showNickname,instructionalText:cmd.instructionalText,showSkip:cmd.showSkip,showCancel:cmd.showCancel,customClientMsg:customClientMsg}).show();if(!onMobile){showSubWin()}else{if(S.setupType!="mobileTT"){TurnTojQuery("#TTtraUserStateMain").hide();TurnTojQuery("#TTtraWindow").show()}else{toggleMainWindow("none")}}var subSpinnerDes=msg("tra.reg.message.pleaseWait");var facebookFn=function(e){if(!setCheckDoubleClick(TurnTojQuery(this))){return}connectWithFacebook(e,{onConnectClose:function(e){if(onMobile){traJq("#TurnToMobileRegistration").empty()}if(TurnTo.loggedIn){if(cb){cb()}toggleSubWindow("none");if(onMobile&&cmd.fromReviews){TurnTojQuery("#TurnToMobileContent").show()}change2LiTitleBarFromLo()}else{showGenericRegFlow(cmd,cb)}},photo:true,noMatchesShow:true,regSource:TurnTo.regSourceProfile,keepSubwindow:true,subSpinnerDes:subSpinnerDes,showSubSpinner:true,connectButton:this})};traJq("#TTfacebookDelAuth").click(facebookFn).keydown(facebookFn,checkEnterKeyHandleCallback);var delAuthFn=function(){if(!setCheckDoubleClick(TurnTojQuery(this))){return}var domain=traJq(this).attr("domain").replace(/^\s+|\s+$/g,"");TurnTo.delAuthWin=delAuthImport(domain,TurnTo.regSourceProfile);if(TurnTo.delAuthPopupInterval){clearInterval(TurnTo.delAuthPopupInterval)}TurnTo.delAuthPopupInterval=setInterval(function(){if(TurnTo.delAuthWin.closed){insertScreen("#TTSubScreen",TurnToHTML.subSpinScreen,{description:subSpinnerDes});clearInterval(TurnTo.delAuthPopupInterval);getTraInitDataAuthImport(function(data,ioArgs){if(onMobile){traJq("#TurnToMobileRegistration").empty()}if(data.user){if(!setUserState(data,ioArgs)){return}toggleSubWindow("none");if(onMobile&&cmd.fromReviews){TurnTojQuery("#TurnToMobileContent").show()}if(cb){cb()}change2LiTitleBarFromLo()}else{showGenericRegFlow(cmd,cb)}},true)}},750)};traJq(".TTdelAuth").click(delAuthFn).keydown(delAuthFn,checkEnterKeyHandleCallback);var submitFn=function(e){doSubmitRegForm2(e,function(data,ioArgs){traJq("#TurnToMobileRegistration").hide();if(!setUserState(data,ioArgs)){return}toggleSubWindow("none");if(cb&&TurnTo.matchData.user){cb()}setLocalLoginCookie(data);setModeratorCookie(data);if(TurnTo.matchData.user){TurnToTrack.newUserRegistration(TurnTo.matchData.user.id)}if(!TurnTo.matchData.user&&(TurnTo.matchData.existingLoUserEmail||data.isExistingLoUser)&&cmd.reconfirmCallback){cmd.reconfirmCallback(data)}else{var confirmMsg=msg("tra.reg.instruction.checkInboxToConfirm");if(isWidgetOpen()&&!onMobile){showSubWin();insertScreen("#TTSubScreen",'<span style="font-size:14px;">'+confirmMsg+"</span>")}else{if(!onMobile||cmd.fromProfile){toggleMainWindow("none");showMainMessage(confirmMsg,msg("tra.reg.button.ok"),"",(onMobile?closeMobileOverlay:toggleMainWindow));if(onMobile){traJq(".TTregCancel").hide()}TurnTojQuery("#TTmainContent").css({height:"180px"})}else{if(onMobile){TurnTojQuery("#TurnToMobileContent").show()}}}}},{qid:cmd.qid,sqid:cmd.sqid,fromProfile:cmd.fromProfile,fromReviews:cmd.fromReviews,useToken:cmd.useToken})};traJq("#TTregSubmit").click(submitFn).keydown(submitFn,checkEnterKeyHandleCallback);traJq(".TTregCancel").click(function(){if(onMobile){if(cmd.fromProfile){closeMobileOverlay()}else{TurnTojQuery("#TurnToMobileRegistration").hide();if(S.setupType=="mobileTT"){TurnTojQuery("#TurnToMobileContent").show()}else{if(onMobile&&S.setupType!="mobileTT"){TurnTojQuery("#TTtraWindow").hide().css("overflow","hidden")}}}}else{TurnTojQuery("#TTmainContent").css("height","auto");hideSubWin()}})}function setCheckDoubleClick(elmnt,doClear){if(doClear){elmnt.removeProp("disabledX");return true}if(elmnt.prop("disabledX")){return false}elmnt.prop("disabledX",true);return true}function ensurePartnerRegUser(regSource,callbackFn){if(S.registration.synced&&!TurnTo.matchData.user){return 0}if(!S.registration.synced){syncPartnerAndTTuserState(function(statusObj){if(statusObj.user_auth_token&&TurnTo.matchData.user){callbackFn()}else{showPartnerRegFlow(regSource,callbackFn)}});return 0}closePartnerRegOverlay(false);return 1}function showPartnerReg4AnonymousQuestion(cmd){showPartnerRegFlow(TurnTo.regSourceAskQuestion,function(){updateQuestionOwner(cmd,function(){var addOnMsg=msg("tra.qa.askArea.message.receiveAnswers");if(TurnTo.matchData.site.daysToSendAnswers){addOnMsg=msg("tra.qa.askArea.message.receiveAnswersForDays."+getPlural(TurnTo.matchData.site.daysToSendAnswers),[TurnTo.matchData.site.daysToSendAnswers])}else{if(TurnTo.matchData.site.maxAnswerEmails){addOnMsg=msg("tra.qa.askArea.message.receiveNumAnswers."+getPlural(TurnTo.matchData.site.maxAnswerEmails),[TurnTo.matchData.site.maxAnswerEmails])}}TurnTojQuery("#TT3newQMsgTxt").html(msg("tra.qa.askArea.message.questionSubmittied")+" "+addOnMsg);TurnTojQuery("#TT3newQMsg").show()})})}function closePartnerRegOverlay(manualClose){if(manualClose){S.registration.synced=false}if(onMobile){if(TurnToMods.mods.browserUtil.isIPhone){TurnTojQuery("body").css("position","");TurnTojQuery("body").scrollTop(localStorage.cachedScrollPos)}else{TurnTojQuery("body").css("overflow","")}if(S.setupType=="mobileTT"){TurnTojQuery(traWindow).show()}if(manualClose&&TurnTo.currentRegSource==TurnTo.regSourceProfile){window.close()}}else{if(!isWidgetOpen()){traWindow.overlay.display="none"}}TurnTojQuery("#TTpartnerRegWindow").remove()}function showPartnerRegFlow(regSource,onLocalAuthCompleteFn){if(onLocalAuthCompleteFn){S.registration.onLocalAuthCompleteFn=onLocalAuthCompleteFn}traWindow.overlay.display="block";TurnTo.currentRegSource=regSource;var regUrl=S.registration.localRegistrationUrl;var regAction=TurnTo.regSourceToAction[regSource];if(regAction){regUrl=regUrl+(regUrl.indexOf("?")>-1?"&":"?")+"turntoRegAction="+regAction}TurnTojQuery("#TTtraWindow").after('<div id="TTpartnerRegWindow" aria-labelledby="ui-dialog-title-TTsigninWrapper" role="dialog" tabindex="-1"></div>');var ttpRegWind=TurnTojQuery("#TTpartnerRegWindow");ttpRegWind.html(TurnToHTML.partnerRegOverlay({pregUrl:regUrl}));if(!onMobile){ttpRegWind.css({top:TurnTojQuery(document).scrollTop()+20+"px",left:((TurnTojQuery(window).width()/2)-(ttpRegWind.width()/2))+"px"})}else{ttpRegWind.css({top:"0",left:"0",position:"fixed",width:"100%",height:"100%",border:"none"});ttpRegWind.attr("scrolling","no");if(TurnToMods.mods.browserUtil.isIPhone){TurnTojQuery("body").css("position","fixed");ttpRegWind.find("#TT3partnerRegCont").css({"-webkit-overflow-scrolling":"touch","overflow-y":"scroll"});ttpRegWind.find("#TTpartnerRegFrame").css({width:1,"min-width":"100%"}).attr("scrolling","no");localStorage.cachedScrollPos=TurnTojQuery(document).scrollTop()}else{TurnTojQuery("body").css("overflow","hidden")}}TurnTojQuery(window).unbind("message.ttpReg").bind("message.ttpReg",localAuthenticationCompleteMessage);ttpRegWind.show();TurnTojQuery("#TTpartnerRegWindowClose").click(function(){closePartnerRegOverlay(true)})}var localAuthenticationCompleteMessage=function(e){var oe=e.originalEvent;if(extractBaseDomain(oe.origin)!==extractBaseDomain(window.location.host)){return}if(oe.data=="ttPartnerAuthComplete"){TurnTojQuery(window).unbind("message.ttpReg");TurnTo.doLocalAuthenticationComplete()}};function extractBaseDomain(url){if(url.indexOf("//")>-1){url=url.split("/")[2]}else{url=url.split("/")[0]}url=url.split("?")[0];url=url.split(":")[0];var domainParts=url.split(".");var numOfParts=domainParts.length;if(numOfParts>2){url=domainParts[numOfParts-2]+"."+domainParts[numOfParts-1]}return url}function localAuthenticationComplete(){if(parent){parent.postMessage("ttPartnerAuthComplete","*")}else{TurnTo.doLocalAuthenticationComplete()}}TurnTo.doLocalAuthenticationComplete=function(){if(S.registration&&S.registration.useBackplane){janrainCb=function(){if(S.registration.onLocalAuthCompleteFn){S.registration.onLocalAuthCompleteFn()}else{S.registration.onLocalAuthCompleteFn=null}};Backplane.expectMessages("identity/login")}else{syncPartnerAndTTuserState(function(statusObj){if(statusObj.user_auth_token&&S.registration.onLocalAuthCompleteFn){S.registration.onLocalAuthCompleteFn()}closePartnerRegOverlay(false);if(onMobile&&!statusObj.user_auth_token&&TurnTo.currentRegSource==TurnTo.regSourceProfile){window.close()}S.registration.onLocalAuthCompleteFn=null;TurnTo.currentRegSource=null})}};function syncPartnerAndTTuserState(onSyncFn){if((!S.registration||!S.registration.localGetLoginStatusFunction)&&!S.registration.useBackplane){return}if(S.registration&&S.registration.syncInProgress){return}if(S.registration.useBackplane){onSyncFn({});return}if(getCookie(NOSYNC_COOKIE_NAME)){onSyncFn({});return}S.registration.syncInProgress=true;S.registration.localGetLoginStatusFunction(function(statusObj){if(!statusObj.user_auth_token){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/logout"),handleAs:"json",ssl:true,load:function(data,ioArgs){localLogout();S.registration.synced=true;onSyncFn(statusObj);S.registration.syncInProgress=false},error:function(data,ioArgs){S.registration.syncInProgress=false}});return}var ttSyncCall=function(statusObj,signature){statusObj.flow=="question";statusObj.sku=TurnToItemSku;xhr("POST",{postData:toJson(statusObj),contentType:"text/text",url:xhrUri("/traServer4/syncPartnerAuthUserState")+(signature?("&sig="+encodeURIComponent(signature)):""),load:function(data,ioArgs){if(data.logoutUser){TurnTo.matchData.user=null;TurnTo.loggedIn=false;displayTeasers()}if(data.user){TurnTo.matchData.user=data.user;TurnTo.matchData.counts=data.counts;TurnTo.loggedIn=true;change2LiTitleBarFromLo()}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data)}S.registration.synced=true;if(onSyncFn){onSyncFn(statusObj)}S.registration.syncInProgress=false},error:function(data,ioArgs){traJq("#error").html(data.error);traJq("#TTregSubmitLoading").hide();S.registration.syncInProgress=false}})};xhr("POST",{postData:toJson(statusObj),contentType:"text/text",url:xhrUri("/traServer4/verifyPartnerAuthUserSyncState"),load:function(data,ioArgs){if(data.synced){S.registration.synced=true;if(data.user){TurnTo.matchData.user=data.user;showHiInHeader()}if(onSyncFn){onSyncFn(statusObj)}S.registration.syncInProgress=false}else{if(S.registration.localGetUserInfoFunction){S.registration.localGetUserInfoFunction(ttSyncCall)}else{statusObj.get_user_info_from_server=true;ttSyncCall(statusObj)}}},error:function(data,ioArgs){traJq("#error").html(data.error);traJq("#TTregSubmitLoading").hide();S.registration.syncInProgress=false}})})}function ssoSyncStateNoUserCreate(onSyncFn){if((!S.registration||!S.registration.localGetLoginStatusFunction)&&!S.registration.useBackplane){return}if(S.registration&&S.registration.syncInProgress){return}if(S.registration.useBackplane){onSyncFn({});return}if(getCookie(NOSYNC_COOKIE_NAME)){onSyncFn({});return}S.registration.syncInProgress=true;S.registration.localGetLoginStatusFunction(function(statusObj){if(!statusObj.user_auth_token){ssoLogout(onSyncFn);return}xhr("POST",{postData:toJson(statusObj),contentType:"text/text",url:xhrUri("/traServer4/verifyPartnerAuthUserSyncState"),load:function(data,ioArgs){S.registration.syncInProgress=false;if(data.synced){S.registration.synced=true;if(data.user){TurnTo.matchData.user=data.user;showHiInHeader()}if(onSyncFn){onSyncFn()}return}if(data.isLiUser){ssoLogout(onSyncFn);return}onSyncFn()},error:function(data,ioArgs){S.registration.syncInProgress=false}})})}function ssoLogout(callbackFn){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/logout"),handleAs:"json",ssl:true,load:function(data,ioArgs){localLogout();S.registration.synced=true;if(typeof callbackFn!="undefined"){callbackFn()}S.registration.syncInProgress=false},error:function(data,ioArgs){S.registration.syncInProgress=false}})}function updateQuestionOwner(cmd,callback){if(!TurnTo.matchData.user&&TurnTo.matchData.existingLoUserEmail){TurnTojQuery("#TT3newQMsgTxt").html(getExistingLoUserMsg(TurnTo.matchData.existingLoUserEmail)).show()}else{var p={};if(cmd.sqid){p.sqid=cmd.sqid}else{p.qid=cmd.qid}xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/updateQuestionOwner"),postData:toJson(p),contentType:"text/text",load:function(data,ioArgs){if(data.uid){if(TurnTo.matchData.user.isPreUser&&!S.registration){var newQMsgTxt=TurnTojQuery("#TT3newQMsgTxt");newQMsgTxt.html(getUnconfirmedMsg(TurnTo.matchData.user)).show();setupResendConfirm(newQMsgTxt)}else{var addOnMsg=msg("tra.qa.askArea.message.receiveAnswers");if(TurnTo.matchData.site.daysToSendAnswers){addOnMsg=msg("tra.qa.askArea.message.receiveAnswersForDays."+getPlural(TurnTo.matchData.site.daysToSendAnswers),[TurnTo.matchData.site.daysToSendAnswers])}else{if(TurnTo.matchData.site.maxAnswerEmails){addOnMsg=msg("tra.qa.askArea.message.receiveNumAnswers."+getPlural(TurnTo.matchData.site.maxAnswerEmails),[TurnTo.matchData.site.maxAnswerEmails])}}traJqC("#TT3newQMsgTxt").html(msg("tra.qa.askArea.message.questionSubmittied")+" "+addOnMsg)}TurnTojQuery("#TT3newQMsg").show();var qid;if(cmd.sqid){qid=cmd.sqid+"sq"}else{qid=cmd.qid}traJqC("#TT3quest-"+qid+" .TT3askedByAnon").replaceWith('<span class="TT3askedBy"><a href="javascript:void(0)" tt3-uid="'+data.uid+'" rel="nofollow">'+(data.nName?data.nName:(data.fName+" "+data.lName))+'</a><span class="TT3youHolder" tt3-uid="'+data.uid+'"></span></span>');traJqC("#TT3quest-"+qid+" .TT3helpful").attr("tt3-uid",data.uid);insertYouBadge();insertModerateLink("","answer");disableVotingForOwner();if(!S.pointEvents.allowAnonymous){logRewardPoints(TurnTo.eventQaQPost)}setActivityCookie(TurnToItemSku);if(cmd.sqid&&data.qid){runClientCallbackFunc("questionSubmit",{id:data.qid})}if(callback){callback(data)}}}})}}function loginOnAnonymousQuestion(qid,data,ioArgs){if(!setUserState(data,ioArgs)){return}toggleSubWindow("none");change2LiTitleBarFromLo();insertYouBadge(TurnTo.jQcontext2);insertModerateLink(TurnTo.jQcontext2,"answer");disableVotingForOwner(TurnTo.jQcontext2)}function loginOnSubmitAnswer(cmd){var qid=cmd.qid;var cont=cmd.cont;if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitInlineAnswerEnsurePartnerReg(qid,cont)}else{submitInlineAnswer(qid,cont,cmd.isExistingLoUser,cmd.uident)}}function change2LiTitleBarFromLo(){traJq("#TTtraDialogTitleBar2").attr("id","TTtraDialogTitleBar");traJq("#TTtraDialogTitleBar").html('<a id="TTtraWindowClose" aria-label="Close" title="Close" href="javascript:void(0)" role="button" unselectable="on" rel="nofollow"></a>');if(!onMobile){traJq("#TTtraWindowClose")[0].onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;if(ugcFeedSku){window.TurnToItemSku=ugcFeedSku;ugcFeedSku=null}}}traJq("#TTmainContent").css("padding-top","0px");showHiInHeader()}function updateLogoutLinks(logoutFn,innerHTML){var logoutLinks=TurnTojQuery(".TTlogoutLink");logoutLinks.each(function(i){this.href="javascript:void(0)";this.onclick=function(){if(onMobile&&window.opener&&window.opener.TurnTo){if(window.opener.opener&&window.opener.opener.TurnTo){window.opener.opener.TurnTo.logout(true);window.opener.TurnTo.logout(true);var usm=TurnTojQuery("#TTtraUserStateMain",window.opener.document);if(usm.length>0){usm.hide()}}else{window.opener.TurnTo.logout(true)}}else{logoutFn()}if(S.registration&&S.registration.localLogoutFunction){S.registration.localLogoutFunction(function(statusObj){})}else{if(S.registration&&S.registration.useBackplane){Backplane.resetCookieChannel()}}if(onMobile&&window.opener&&window.opener.TurnTo){closeMobileOverlay()}};if(innerHTML){this.innerHTML=innerHTML}})}function submitItemQuestion(dupFlag){TurnTojQuery("#TT2staffQuesLabel").css("color","");var rawQuestion=TurnTojQuery.trim(TurnTojQuery("#TT2questionText").val());var question=stripString(rawQuestion);if(TurnToMods.mods.util.containsEmail(question)){TurnTojQuery("#TT3error").html(msg("tra.qa.askArea.error.dontIncludeEmail")).show();TurnTojQuery("#TTmiqBubble").css("top","285px");return}else{if(!containsQuestionMark(question)){TurnTojQuery("#TT3error").html(msg("tra.qa.askArea.error.isThisAQuestion")).show();TurnTojQuery("#TTmiqBubble").css("top","285px");return}}if(TurnTojQuery("#TT2questionText").attr("class")=="TTdefaultInput"||question.length==0){TurnTojQuery("#TT3error").html(msg("tra.qa.askArea.error.question.blank")).show();TurnTojQuery("#TTmiqBubble").css("top","285px");return}if(TurnToMods.mods.util.containsPhoneNumber(question)){TurnTojQuery("#TT3error").html(msg("tra.qa.askArea.error.dontIncludePhone")).show();TurnTojQuery("#TTmiqBubble").css("top","285px");TurnTojQuery("#TT2staffQuesLabel").css("color","red");return}var iid=TurnTojQuery("#TT2iid").val();var catItmId=TurnTojQuery("#TT2catItmId").val();TurnTojQuery("#TT3error").empty().hide();TurnTojQuery("#TTmiqBubble").css("top","250px");var miqaCatItemIds=[];var miqaCatItemStartIndx=0;if(TurnToCatItemType==2){if(miqaCatItems.length>0){catItmId=miqaCatItems[0].id;miqaCatItemStartIndx=1}else{if(catItmId==""){TurnTojQuery("#TT3error").html("Please select at least one item.").show();return}}}for(var i=miqaCatItemStartIndx;i<miqaCatItems.length;i++){miqaCatItemIds.push(miqaCatItems[i].id)}TurnTojQuery("#TT2questionSubImgLoading").show();TurnTojQuery("#TT2askOwnersBtn").hide();TurnTojQuery("#TT2questionText").attr("disabled",true);TurnTojQuery("#TT4questionTextWrap").css("background-color","#ECECEC");var data={};data.question=question;data.iid=iid;data.catItmId=catItmId;data.svid=TurnToTrack.getSiteVisitId();data.dupFlag=dupFlag!=null?dupFlag:false;data.questType=(TurnTojQuery('[name="TT2questTypeOpt"]').length==0)?0:(TurnTojQuery("#TT2questCust").is(":checked")?1:2);data.multiItems=miqaCatItemIds;xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/askQuestion4Item"),postData:toJson(data),contentType:"text/text",load:function(data,ioargs){if(data.possibleDup){TurnTojQuery("#TTmiqBubble").hide();TurnTojQuery("input[name=TT2questTypeOpt]").attr("disabled","disabled");TurnTojQuery("#TT2askRewardMsg").hide();TurnTojQuery("#TT2questionSubmitted").hide();TurnTojQuery("#TT3error").html(TurnToHTML.recentlySubmittedQuestionMsg({prevQuestion:data.prevQuestion})).css("background-color","#fcf7d7").css("padding","10px").show();addTextToButtons();TurnTojQuery("#TTmiqBubble").css("top","340px");TurnTojQuery("#TT2questionSubImgLoading").hide();TurnTojQuery("#TT2acceptDup").bind("click",function(){TurnTojQuery("#TT2acceptDup").remove();TurnTojQuery("#TT2cancelDup").remove();TurnTojQuery("#TT3error").empty().hide();TurnTojQuery("#TTmiqBubble").css("top","250px");TurnTojQuery("input[name=TT2questTypeOpt]").removeAttr("disabled");submitItemQuestion(true)});TurnTojQuery("#TT2cancelDup").bind("click",function(){TurnTojQuery("#TT2acceptDup").remove();TurnTojQuery("#TT2cancelDup").remove();TurnTojQuery("#TT3error").empty().hide();TurnTojQuery("#TTmiqBubble").css("top","250px");TurnTojQuery("#TT2questionSubImgLoading").hide();TurnTojQuery("#TT2askOwnersBtn").show();TurnTojQuery("#TT2questionText").val("").removeAttr("disabled");TurnTojQuery("#TT4questionTextWrap").css("background-color","#FFFFFF");var postQuestionRewConf=getRewardPointsConfig(TurnTo.eventQaQPost);if(postQuestionRewConf.postText){TurnTojQuery("#TT2askRewardMsg").html(postQuestionRewConf.preText).show();TurnTojQuery("#TT3error").empty().hide();TurnTojQuery("#TTmiqBubble").css("top","250px")}TurnTojQuery("input[name=TT2questTypeOpt]").removeAttr("disabled")});return}TurnTojQuery("#TT2questionSubImgLoading").hide();TurnTojQuery("#TT2askOwnersBtn").show();var qTextElem=TurnTojQuery("#TT2questionText").val(S.questionDefaultText).removeAttr("disabled").addClass("TTdefaultInput");if(TurnToMods.mods.browserUtil.isIPhone){qTextElem.blur()}TurnTojQuery("#TT4questionTextWrap").css("background-color","#FFFFFF");TurnTojQuery("#TT3askBtnBlock").show();TurnTojQuery("#TT4instantAnswersQ").hide();TurnTojQuery("#TTmiqInline").empty();TurnTojQuery("#TTmiqBubble").hide();var asker={isYou:true};var pRegOpen=false;if(TurnTo.matchData.user){asker.uid=TurnTo.matchData.user.id;asker.pid=TurnTo.matchData.user.pid;asker.fName=TurnTo.matchData.user.firstName;asker.lName=TurnTo.matchData.user.lastName[0];asker.nName=TurnTo.matchData.user.nickName}else{asker.uid=null;asker.pid=null;asker.fName=null;asker.lName=null;asker.nName=null;if(S.registration&&S.registration.localRegistrationUrl&&!S.registration.useBackplane){S.registration.localGetLoginStatusFunction(function(statusObj){if(!statusObj.user_auth_token){showPartnerReg4AnonymousQuestion({qid:data.qid,sqid:data.sqid,questionText:rawQuestion,catImgId:TurnTojQuery("#TT3imgId").val(),questionSubmitted:true,catImgProcessed:TurnTojQuery("#TT3imgPros").val()})}});pRegOpen=true}else{if(S.registration&&S.registration.localRegistrationUrl&&S.registration.useBackplane){showPartnerReg4AnonymousQuestion({qid:data.qid,sqid:data.sqid});pRegOpen=true}else{var cmd={qid:data.qid,sqid:data.sqid,regSource:TurnTo.regSourceAskQuestion,header:msg("tra.reg.header.haveAnswersEmailed"),showNickname:true,showSkip:!data.hideAnon,showCancel:(onMobile&&data.hideAnon)};if(data.hideAnon){cmd.instructionalText=msg("tra.reg.header.instruction.toCompleteQuestionSubmission")}else{cmd.instructionalText=msg("tra.reg.header.instruction.anonToHaveAnswersEmailed")}cmd.reconfirmCallback=function(){TurnTojQuery("#TT3newQMsgTxt").html(getExistingLoUserMsg(TurnTo.matchData.existingLoUserEmail)).show().parent().show();if(S.setupType=="mobileTT"){TurnTojQuery("#TurnToMobileContent").show()}};showGenericRegFlow(cmd,function(){updateQuestionOwner(cmd)})}}}miqaCatItems=[];qaSessionId=null;var questionBlock=TurnTojQuery("#TT3IQContainer");if(data.catItem.catItemId==TurnToCatItemId){var qid;if(data.sqid){qid=data.sqid+"sq"}else{qid=data.qid}questionBlock.after(TurnToHTML.questionAnswerBlock({asker:asker,questionText:replaceTrimLineBreaks(data.questionText),rawQuestionText:data.questionText,qid:qid,isStaff:data.isStaff,expertLabel:data.expertLabel,upVotes:data.upVotes,downVotes:data.downVotes,dateCreated:data.dateCreated,showImg:false,catItem:data.catItem,showSkip:false,showAbout:false,syndicationSource:null,aCnt:data.aCnt,dateInMs:data.dateInMs,qNickName:null,shopperName:data.shopperName,miqCatItems:data.miqCatItems,isNew:true,smallInputBox:false,answerVoteHelpText:S.answerVoteHelpText,hide:false}));var qCont=TurnTojQuery("#TT3quest-"+qid);setupInlineAnswer(qCont,qid);setupProfileLinks(qCont);setupQuestionText(qCont);setupMultiItemScroll(qCont);disableVotingForOwner(qCont,null,false,true)}TurnTojQuery("#TT2showQuestionBox").show();TurnTojQuery("#TT3miqaAttachedItems").children().each(function(idx,elem){if(idx>0){TurnTojQuery(elem).remove()}});var newMsg;if(TurnTo.matchData.user&&TurnTo.matchData.user.isPreUser&&!S.registration){newMsg=getUnconfirmedMsg(TurnTo.matchData.user)}else{if(TurnTo.matchData.user){newMsg=msg("tra.qa.askArea.message.questionSubmittied");var addOnMsg=msg("tra.qa.askArea.message.receiveAnswers");if(TurnTo.matchData.site.daysToSendAnswers){addOnMsg=msg("tra.qa.askArea.message.receiveAnswersForDays."+getPlural(TurnTo.matchData.site.daysToSendAnswers),[TurnTo.matchData.site.daysToSendAnswers])}else{if(TurnTo.matchData.site.maxAnswerEmails){addOnMsg=msg("tra.qa.askArea.message.receiveNumAnswers."+getPlural(TurnTo.matchData.site.maxAnswerEmails),[TurnTo.matchData.site.maxAnswerEmails])}}newMsg+=" "+addOnMsg}else{if(!data.hideAnon){if(data.catItem.catItemId!=TurnToCatItemId){newMsg=msg("tra.qa.askArea.message.questionSubmittied")}else{newMsg=msg("tra.qa.askArea.message.questionSubmittied")+" "+msg("tra.qa.askArea.message.checkBack")}}}}if(newMsg){TurnTojQuery("#TT3newQMsgTxt").html(newMsg);TurnTojQuery("#TT3newQMsg").show()}TurnTojQuery("#TT3resendConfirm").click(function(){resendEmailConfirmation(TurnTo.matchData.user.uIdents[0].ident)});TurnTojQuery("#TT3dismissQ").click(function(){TurnTojQuery("#TT3newQMsg").hide()});var postQuestionRewConf=getRewardPointsConfig(TurnTo.eventQaQPost);if(postQuestionRewConf.postText){TurnTojQuery("#TT2askRewardMsg").html(postQuestionRewConf.postText).show()}resetQuestionArea();setCookie(QUESTION_ASKED_COOKIE_NAME,new Date().getTime(),2592000);if(TurnTo.matchData.user){setActivityCookie(TurnToItemSku)}logWebEvent2(TurnTo.eventQaQPost,(typeof(TurnToTrack)!="undefined")?"&svid="+TurnToTrack.getSiteVisitId():null);questionAskedOrInstantResultClick();logRewardPoints(TurnTo.eventQaQPost);if(data.qid){runClientCallbackFunc("questionSubmit",{id:data.qid})}},error:function(data,ioargs){TurnTojQuery("#TT2questionSubImgLoading").hide();TurnTojQuery("#TT2askOwnersBtn").show();TurnTojQuery("#TT2questionText").removeAttr("disabled");TurnTojQuery("#TT4questionTextWrap").css("background-color","#FFFFFF");var message="submitItemQuestion XHR - Status: "+data.status+" Error: "+data.error;if(data.error){TurnTojQuery("#TT3error").html("<img src='"+getStaticUrl("/tra3/images/blueexclaimmark.png")+"' style='vertical-align:middle'/>"+data.error);TurnTojQuery("#TTmiqBubble").css("top","285px")}}});TurnTojQuery("#TT2anwerCharCount").html("")}function getUnconfirmedMsg(user){return msg("tra.systemMessage.unconfirmedEmail",[user.uIdents[0].ident])}function getExistingLoUserMsg(email){if(email){return msg("tra.systemMessage.loConfirmEmail",[email])}return msg("tra.systemMessage.loConfirmWithoutEmail")}function getTwitterPublishPerm(cmd){if(traJq("#TT2twitterBox").is(":checked")){var wasNotUser=!TurnTo.matchData.user;traJq("#TT2twitterBox").attr("disabled",true);if(wasNotUser){connectWithTwitter(null,{onConnectClose:function(){checkForLIUser(function(data,ioargs){TurnTo.traDataLoaded=false;if(!setUserState(data,ioargs)){return}if(TurnTo.matchData.user){traJq("#TT2twitterBox").removeAttr("disabled");getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){traJq("input[name=TT2twitterBox]").attr("checked",false)}cmd.callback()});if(TurnTo.matchData.user&&traJq("#TTtraDialogTitleBar").length>0){change2LiTitleBarFromLo()}}},function(data,ioargs){if(data.twitterConnected){TurnTo.matchData.twitterConnected=true;traJq("#TT2twitterBox").removeAttr("disabled");cmd.callback()}else{traJq("#TT2twitterBox").removeAttr("disabled");traJq("input[name=TT2twitterBox]").attr("checked",false);cmd.callback()}})}})}else{if(findUserRaveTarget(TurnTo.twitterTargetId)==-1){connectWithTwitter(null,{onConnectClose:function(){traJq("#TT2twitterBox").removeAttr("disabled");getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){traJq("input[name=TT2twitterBox]").attr("checked",false)}cmd.callback()})}})}else{traJq("#TT2twitterBox").removeAttr("disabled");cmd.callback()}}if(window.event){window.event.returnValue=true}}}function getFacebookPublishPerm(cmd){if(traJq("#TT2facebookBox").attr("checked")){traJq("#TT2facebookBox").attr("disabled",true);if(!TurnTo.matchData.user||!TurnTo.matchData.user.fbPostToWallGranted){connectWithFacebook(null,{regSource:cmd.regSource,post:true,photo:true,link:(TurnTo.matchData.user?true:false),noMatchesShow:true,keepSubwindow:true,onConnectClose:function(){traJq("#TT2facebookBox").removeAttr("disabled");if(TurnTo.matchData.user){getFbPostToWallGranted(function(){if(!TurnTo.matchData.user.fbPostToWallGranted){traJq("input[name=TT2facebookBox]").attr("checked",false)}cmd.callback()});if(TurnTo.matchData.user&&traJq("#TTtraDialogTitleBar").length>0){change2LiTitleBarFromLo()}}else{traJq("input[name=TT2facebookBox]").attr("checked",false);cmd.callback();s}}})}else{traJq("#TT2facebookBox").removeAttr("disabled");cmd.callback()}if(window.event){window.event.returnValue=true}}}function showAnswerWidget(qid,suid,sourceId,iqrlId,callbackFn){dropLocalLoginCookie();dropModeratorCookie();traJq(".TT2sectionHeader").hide();xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getQuestion")+"&qid="+qid+"&suid="+suid,load:function(data,ioArgs){if(data.catItem){TurnToCatItemType=data.catItem.itemType;turntoflowItemContextUrl=data.catItem.itemUrl}toggleMainWindow("none");TurnTo.answerData=data;traJq("#TT-spinner").hide();traJq(".TT2sectionHeader").hide();if(data.logoutUser){TurnTo.matchData.user=null;TurnTo.loggedIn=false}if(data.user){TurnTo.matchData.user=data.user;TurnTo.loggedIn=true;showHiInHeader()}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data)}if(traJq("#TTtraDialogTitleBar2")&&traJq("#TTtraDialogTitleBar2").length>0){traJq("#TTtraDialogTitleBar2").attr("id","TTtraDialogTitleBar");traJq("#TTtraDialogTitleBar").css("height","32px")}else{}if(data.question.status==0){showQuestionRemovedMsg();return}var item=data.catItem;var elId="TTtraLayout";if(onMobile){elId="TurnToMobileContent"}if(TurnTo.params.turntoflow=="irrelevantq"){insertScreen("#"+elId,TurnToHTML.irrelevantWidget,{item:data.catItem,question:data.question,asker:data.asker,answerer:data.answerer,sourceId:sourceId,iqrlId:iqrlId});traJq("#TT2ppCloseBtn").click(function(){toggleMainWindow()});traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer4/logClickEvent","siteKey="+S.siteKey+"&v="+TurnTo.version+"&lang="+S.locale+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId});return}else{insertScreen("#"+elId,TurnToHTML.answerWidget,{item:data.catItem,question:data.question,asker:data.asker,answerer:data.answerer,sourceId:sourceId,iqrlId:iqrlId,rewardConfig:getRewardPointsConfig(TurnTo.eventQaAPost),miqCatItems:data.miqCatItems})}updateCommonInstructionInvalidTextIfCustomization(traJq("#TT2answerBtns div.TT4answerInstructions"));if((!TurnTo.matchData.user||TurnTo.matchData.user.hasDefaultPassword)&&!S.registration){traJq("#TT3answerPwdBox").show()}traJq("#TT2footerFeedback").hide();traJq("#TTtraFooterLogo").hide();traJq("#TT2answerBtn").click(function(){submitAnswer();setCookie(NOSYNC_COOKIE_NAME,new Date().getTime())});traJq("#TT2answerText")[0].onkeyup=function(e){var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){traJq(".TT2charLimitCount")[0].style.color="black";traJq("#TT2answerBtn").show()}else{traJq(".TT2charLimitCount")[0].style.color="red";traJq("#TT2answerBtn").hide()}traJq("#TT2anwerCharCount").html(msg("tra.qa.answer.charactersLeft",[charLeft]))}else{traJq("#TT2anwerCharCount").html("");traJq("#TT2answerBtn").show()}};var cont=traJq("#TT2answerWidget");var miqaAddFn=function(){if(!miqaCatItems4Ans[data.question.id]){miqaCatItems4Ans[data.question.id]=[]}var parent=traJq(this).parents(".TT4ansMiqaAnsBtns");var isOpen=parent.find(".TTmiqaBubble").is(":visible");if(isOpen){parent.find(".TTmiqaBubble").remove()}else{showMultiItemPicker({resultsDiv:cont.find("#TT3miqaAnswer"),list:miqaCatItems4Ans[data.question.id],mode:"a",id:data.question.id})}};traJq(".TT3answerMiqa").click(miqaAddFn).keydown(miqaAddFn,checkEnterKeyHandleCallback);traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer4/logClickEvent","siteKey="+S.siteKey+"&lang="+S.locale+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId});logWebEvent2(TurnTo.eventQaAnswerWidgetOpen,"&fof="+iqrlId);if(callbackFn){callbackFn(data.answerer)}},error:function(data,ioArgs){var message="getQuestion XHR - Status: "+data.status+" Error: "+data.error}})}function showQuestionRemovedMsg(){showMainMessage(msg("tra.systemMessage.questionRemoved"),msg("tra.systemMessage.button.ok"),"",toggleMainWindow)}function showMainMessage(message,bttn1Label,bttn2Label,bttn1Callback,bttn2Callback){var elId="#TTtraLayout";if(onMobile){elId="#TurnToMobileSubWindow"}insertScreen(elId,TurnToHTML.mainMessage,{message:message,bttn1Label:bttn1Label,bttn2Label:bttn2Label});TurnTojQuery(".TT2sectionHeader").hide();traJq("#TT2footerFeedback").hide();if(bttn1Callback){traJq("#TT2bttn1").click(function(){bttn1Callback()})}else{traJq("#TT2bttn1").hide()}if(bttn2Callback){traJq("#TT2bttn2").click(function(){bttn2Callback()})}else{traJq("#TT2bttn2").hide()}}function submitAnswer(){var answer=stripString(traJq("#TT2answerText").val());if(!answer||answer==traJq("#TT2answerText").attr("ttInputLabelText")){return}var errCont=traJq("#TT2error").empty().hide();var valFail=false;if(TurnToMods.mods.util.containsEmail(answer)){errCont.append(msg("tra.qa.answer.error.dontIncludeEmail"));valFail=true}if(TurnToMods.mods.util.containsPhoneNumber(answer)){errCont.append(msg("tra.qa.answer.error.dontIncludePhone"));valFail=true}if(valFail){errCont.show();return}traJq("#TT2imgLoading").show();traJq("#TT2answerBtn").hide();if(traJq("#TT2answerText").attr("class")=="TTdefaultInput"){traJq("#TT2imgLoading").hide();traJq("#TT2answerBtn").show();return}var miqaCatItems=[];if(miqaCatItems4Ans[TurnTo.answerData.question.id]){for(var i=0;i<miqaCatItems4Ans[TurnTo.answerData.question.id].length;i++){miqaCatItems.push(miqaCatItems4Ans[TurnTo.answerData.question.id][i].id)}}var data={};data.answer=answer;data.qid=TurnTo.answerData.question.id;data.sourceId=traJq("#answSourceId").val();data.iqrlId=traJq("#iqrlId").val();data.multiItems=miqaCatItems;var doSubmitFn=function(){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/answerQuestion4Item"),postData:toJson(data),contentType:"text/text",load:function(answerData,ioArgs){showAnswerRegFlow(answerData);TurnTojQuery("#TT3miqaAnswer-"+TurnTo.answerData.question.id).empty().hide();if(miqaCatItems4Ans[TurnTo.answerData.question.id]){miqaCatItems4Ans[TurnTo.answerData.question.id].splice()}logRewardPoints(TurnTo.eventQaAPost);setActivityCookie(TurnToItemSku);personalizeUgc(function(){setupInitialAnswersState(null,false);insertAnswerSubmittedMessage(answerData.aid,TurnTo.matchData.user.isPreUser)});answerSubmittedSV();runClientCallbackFunc("answerSubmit",{id:answerData.aid})},error:function(data,ioArgs){traJq("#TT2imgLoading").hide();traJq("#TT2answerBtn").show();if(data.errorCode==401){traJq("#TT2error").html(msg("tra.systemMessage.notAcceptingCookies")).show()}else{traJq("#TT2error").html(data.error).show()}}})};if(TurnTo.matchData.user){doSubmitFn()}else{registerAndLogin(doSubmitFn)}}function submitInlineAnswerEnsurePartnerReg(qid,cont){S.registration.synced=false;if(ensurePartnerRegUser(TurnTo.regSourceAskAnswer,function(){submitInlineAnswer(qid,cont)})==0){return}}function submitInlineAnswer(qid,cont,isExistingLoUser,uident){var inputElJQ=TurnTojQuery("#TT2inlineAnswer-"+qid,cont);var answerText=stripString(inputElJQ.val());if(!answerText||answerText==inputElJQ.attr("ttInputLabelText")){return}if(!TurnTo.matchData.user&&!isExistingLoUser){checkForLIUser(function(){submitInlineAnswer(qid,cont,isExistingLoUser,uident);return},function(){var regCmdObj={header:msg("tra.qa.answer.reg.header"),regSource:TurnTo.regSourceAskAnswer,showNickname:true,instructionalText:msg("tra.qa.answer.instruction.connectOrProvide"),showSkip:false,showCancel:true,reconfirmCallback:function(){loginOnSubmitAnswer({qid:qid,cont:cont,isExistingLoUser:true,uident:TurnTo.matchData.uident})}};var regSuccessCb=function(){loginOnSubmitAnswer({qid:qid,cont:cont,isExistingLoUser:isExistingLoUser,uident:uident})};showGenericRegFlow(regCmdObj,regSuccessCb)});return}if(!S.inWidget){toggleSubWindow("none")}if(S.setupType=="mobileTT"){TurnTojQuery("#TurnToMobileContent").show()}if(TurnToMods.mods.util.containsEmail(answerText)){TurnTojQuery("#TT2error-"+qid,cont).html(msg("tra.qa.answer.error.dontIncludeEmail")).show();return}if(TurnToMods.mods.util.containsPhoneNumber(answerText)){TurnTojQuery("#TT2error-"+qid,cont).html(msg("tra.qa.answer.error.dontIncludePhone")).show();return}var miqaCatItems=[];if(miqaCatItems4Ans[qid]){for(var i=0;i<miqaCatItems4Ans[qid].length;i++){miqaCatItems.push(miqaCatItems4Ans[qid][i].id)}}TurnTojQuery("#TT2imgLoading-"+qid,cont).show();var answerBtn=TurnTojQuery("#TT2answerBtn-"+qid,cont).hide();var data={};data.answer=answerText;data.qid=qid;data.notify=TurnTojQuery("#TT2answerNotify-"+qid,cont).attr("checked");data.sourceId="2";data.uident=uident?uident:null;data.multiItems=miqaCatItems;xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/answerQuestion4Item"),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){if(window.TurnToItemSku){setActivityCookie(TurnToItemSku)}answerBtn.show();TurnTojQuery("#TT3miqaAnswer-"+qid).empty().hide();if(miqaCatItems4Ans[qid]){delete (miqaCatItems4Ans[qid])}insertAnswer(qid,data,true,cont);cont.attr("answers",parseInt(cont.attr("answers"))+1);showInputBox(cont.find(".TT4addAnswer")[0],qid);answerSubmittedSV();runClientCallbackFunc("answerSubmit",{id:data.aid})},error:function(data,ioArgs){TurnTojQuery("#TT2imgLoading-"+qid,cont).hide();TurnTojQuery("#TT2answerBtn-"+qid,cont).show();TurnTojQuery("#TT2error-"+qid,cont).html(data.error);var message="submitInlineAnswer XHR - Status: "+data.status+" Error: "+data.error}});TurnTojQuery("#TT2anwerCharCount-"+qid,cont).html("")}function insertAnswer(qid,data,isNew,cont,hideReply,isMultiItemQuestion,isBestAnswer,isSqv){if(isNew){TurnTojQuery("#TT2imgLoading-"+qid,cont).hide();TurnTojQuery("#TT2answerBtn-"+qid,cont).show();TurnTojQuery("#TT2inlineAnswer-"+qid,cont).val("");TurnTojQuery("#TT2error-"+qid,cont).html("");inputLoseFocus(TurnTojQuery("#TT2inlineAnswer-"+qid,cont)[0])}var answerer={uid:data.uid,pid:data.pid,fName:data.fName?data.fName:(isNew&&TurnTo.matchData.user?TurnTo.matchData.user.firstName:msg("tra.common.anonUser")),lName:data.lName?data.lName:(isNew&&TurnTo.matchData.user?TurnTo.matchData.user.lastName:null),nName:data.nName?data.nName:(TurnTo.matchData.user&&isNew?(TurnTo.matchData.user.nickName?TurnTo.matchData.user.nickName:null):null),isStaff:data.isStaff,expertLabel:data.expertLabel};if(isBestAnswer){TurnTojQuery("#TT4bestAnswerBlock-"+qid,cont).prepend(TurnToHTML.answerBlock({answerer:answerer,answerText:replaceTrimLineBreaks(data.text),rawAnswerText:data.text,aid:data.aid,cid:data.cid?data.cid:null,upVotes:data.upVotes,downVotes:data.downVotes,thanked:data.thanked,askerId:data.askerId,qid:qid,quid:data.quid,dateCreated:data.dateCreated,replys:[],replyCnt:(data.replys?data.replys.length:0),hasReplys:(data.replys&&data.replys.length>0),showReply:true,siteId:data.siteId,siteName:data.siteName,syndicationSource:data.syndicationSource,syndicationAnswerSource:data.syndicationAnswerSource,hideReply:hideReply,isMultiItemQuestion:isMultiItemQuestion,miqaCatItems:data.miqaCatItems,bestAnswer:S.hideBestAnswer?null:true,isNew:isNew,purchaseDate:data.purchaseDate,isSqv:isSqv}))}else{TurnTojQuery("#TT3IAContainer-"+qid,cont).prepend(TurnToHTML.answerBlock({answerer:answerer,answerText:replaceTrimLineBreaks(data.text),rawAnswerText:data.text,aid:data.aid,cid:data.cid?data.cid:null,upVotes:data.upVotes,downVotes:data.downVotes,thanked:data.thanked,askerId:data.askerId,qid:qid,quid:data.quid,dateCreated:data.dateCreated,replys:[],replyCnt:(data.replys?data.replys.length:0),hasReplys:(data.replys&&data.replys.length>0),showReply:true,siteId:data.siteId,siteName:data.siteName,syndicationSource:data.syndicationSource,syndicationAnswerSource:data.syndicationAnswerSource,hideReply:hideReply,isMultiItemQuestion:isMultiItemQuestion,miqaCatItems:data.miqaCatItems,bestAnswer:S.hideBestAnswer?null:data.bestAnswer,isNew:isNew,purchaseDate:data.purchaseDate}))}var answerBlock=TurnTojQuery("#TT3answer-"+data.aid,cont);setupProfileLinks(answerBlock);setupMultiItemScroll(answerBlock);if(isNew){TurnTojQuery("#TT3IAContainer-"+qid).show();insertAnswerSubmittedMessage(data.aid,TurnTo.matchData.user?TurnTo.matchData.user.isPreUser:false,TurnTojQuery("#TTmoreFeedback").length==0&&data.amqFlag,TurnTo.matchData.user?false:true);insertYouBadge(answerBlock);insertModerateLink(answerBlock,"answer");disableVotingForOwner(answerBlock)}if(TurnTo.matchData.user&&TurnTo.matchData.user.id!=data.uid){TurnTojQuery(".TT3thumbsLeft",cont).show()}return answerBlock}function insertAnswerSubmittedMessage(aid,isPreUser,amqFlag,isExistingLoUser){var answerEl=TurnTojQuery("#TT3answer-"+aid+" .TT3ansCntr");var emailAddress="";if(isPreUser){for(var i=0;i<TurnTo.matchData.user.uIdents.length;i++){if(TurnTo.matchData.user.uIdents[i].type==1&&!TurnTo.matchData.user.uIdents[i].confirmed){emailAddress=TurnTo.matchData.user.uIdents[i].ident;break}}}var onMlp=S.setupType=="mobileTT";var mdl={aid:aid};if(isPreUser){mdl.messageTxt=msg("tra.qa.answer.message.answerNotSubmitted")+" "+getUnconfirmedMsg(TurnTo.matchData.user)}else{if(isExistingLoUser){mdl.messageTxt="<span>"+msg("tra.qa.answer.message.answerSubmitted")+" "+msg("tra.systemMessage.checkInboxToConfirm")+"</span>"}else{mdl.messageTxt="<span>"+msg("tra.qa.answer.message.answerSubmitted")+" "+(amqFlag?'(<a href="javascript:void(0)" onclick="TurnTo.displayDoMore(null, '+onMlp+')" rel="nofollow">'+msg("tra.qa.answer.message.clickForMoreToAnswer")+"</a>)":"")+"</span>"}}answerEl.prepend(TurnToHTML.answerSubmittedConfMessage(mdl));TurnTojQuery("#TT3answerSubmitted-"+aid,answerEl).show();TurnTojQuery("#TT3dismissSubmitted-"+aid,answerEl).click(function(){TurnTojQuery("#TT3answerSubmitted-"+aid,answerEl).remove()});setupResendConfirm()}function setupProfileLinks(cont,clazz,fromChatter){TurnTojQuery("."+(clazz?clazz:"TT3askedBy")+" a",cont).each(function(){var link=traJqC(this);if(S.noProfiles){link.replaceWith("<span>"+link.html()+"</span>")}else{var uid=link.attr("tt3-uid");if(uid){link.click(function(){displayProfile(uid,fromChatter);if(fromChatter){TurnTo.fwItemClicked()}})}}})}function showAnswerRegFlow(answerData){traJq("#TT2answerPanel").hide();traJq("#TT2answerSubmittedPanelTxt").html(traJq("#TT2answerText").val());traJq("#TT2answerSubmittedPanel").show();traJq("#TT2answerRegFlow").show();var postAnswerRewConf=getRewardPointsConfig(TurnTo.eventQaAPost);if(postAnswerRewConf.postText){traJq("#TT2answerRewardMsg").html(postAnswerRewConf.postText+(answerData.couponText?"<br>":"")).show()}if(answerData.couponText){traJq("#TT2answerRewardMsg").append(answerData.couponText).show()}traJq(".TT2doneSub").show()[0].onclick=function(){if(answerData.amqFlag){displayDoMore(null,onMobile)}else{if(S.inWidget){showQuestionWidget4AnswerFlow(answerData)}else{if(!onMobile){toggleMainWindow()}else{closeMobileOverlay()}}}}}function submitReg4Answer(answerData,callbackF){var p={};traJq(".TT2doneSub").hide();traJq("#TTregSubmitLoading").show();p.passwd=traJq("#TTpassword")[0].value;p.repasswd=traJq("#TTrePassword")[0].value;if(TurnTo.lastUploadedImageId){p.uploadId=TurnTo.lastUploadedImageId}var enteredPwd=p.passwd.length>0||p.repasswd.length>0;var enteredPhoto=p.uploadId;if(!enteredPwd&&!enteredPhoto){showQuestionWidget4AnswerFlow(answerData);return}else{if(!enteredPwd&&enteredPhoto){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/saveUserImage")+"&cid="+cid+"&uploadId="+TurnTo.lastUploadedImageId,load:function(data,ioArgs){if(data.pid&&data.pid!="0"){TurnTo.matchData.user.hasPhoto=true;TurnTo.matchData.user.pid=data.pid}showQuestionWidget4AnswerFlow(answerData)},error:function(data,ioArgs){var message="saveUserImage XHR - Status: "+data.status+" Error: "+data.error;TurnTo.lastUploadedImageId=null}})}else{if(enteredPwd){if(enteredPhoto){p.imgTypeSelected="custom"}p.editingPasswd=true;p.firstName=TurnTo.matchData.user.firstName;p.lastName=TurnTo.matchData.user.lastName;p.id=TurnTo.matchData.user.id;xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/updateUserSetting")+"&cid="+cid,content:p,load:function(data,ioArgs){if(data.pid&&data.pid!="0"){TurnTo.matchData.user.hasPhoto=true;TurnTo.matchData.user.pid=data.pid}if(callbackF){callbackF()}},error:function(data,ioArgs){traJq("#TTregSubmitLoading").hide();traJq(".TT2doneSub").show();traJq("#TTregSubmit").show();traJq("#TTregSkip").show();displayErrorsInSubscreen(data.errors)}})}}}}function TT2questionTextFocus(el){if(el){var elJQ=traJqC(el);if(elJQ.hasClass("TTdefaultInput")){setSelectionRange(el,0,0);elJQ.removeClass("TTdefaultInput").val("").html("")}if(elJQ.data("max-lines")&&!elJQ.data("max-height")){var hiddenDiv=elJQ.next("#ttHiddenAskQuestionDiv");var singleLineHeight=hiddenDiv.height()+1;var paddingAndBorder=hiddenDiv.outerHeight()-hiddenDiv.height();var maxLines=parseInt(elJQ.data("max-lines"));var maxHeight=(singleLineHeight*maxLines)+paddingAndBorder;elJQ.data("max-height",maxHeight)}traJqC("#TTbrowseQAWrapper").hide();traJqC("#TT4closeQuestionBox").show()}}function TT2questionTextLoseFocus(el){traJqC("#TTbrowseQAWrapper").show();traJqC("#TT4closeQuestionBox").hide()}function TT2reviewTextFocus(el){if(el){var elJQ=traJqC(el);if(elJQ.hasClass("TTdefaultInput")){setSelectionRange(el,0,0)}el.onkeydown=function(){if(elJQ.hasClass("TTdefaultInput")){elJQ.removeClass("TTdefaultInput").val("").html("");setSelectionRange(el,0,0)}};el.onclick=function(){if(elJQ.hasClass("TTdefaultInput")){setSelectionRange(el,0,0)}}}}function showQuestionWidget4AnswerFlow(answerData){change2LiTitleBarFromLo();var feedback=TurnTojQuery("#TT2footerFeedback");feedback.show();feedback.attr("href","mailto:feedback@turnto.com?subject=Feedback on QandA widget on "+encodeURIComponent(TurnTo.matchData.site.siteName)+"&body=%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A---------------------------------------------------------------%0ASubmitted from: "+encodeURIComponent(document.location));numQuestionWidgetMsg=0;traJq("#TT2questionWidgetMessageArea").html("");showQuestionWidget({catItmId:TurnTo.answerData.catItem.id},function(data,ioArgs){insertScreen("#TTtraLayout",TurnToHTML.questionWidget,{match:{},comments:data.comments,questions:data.questions,item:data.catItem,relatedQuestions:data.relatedQuestions,rewardConfig:getRewardPointsConfig(TurnTo.eventQaQPost)});traJq(".TT2answerReply").click(function(){this.style.color="#777777";var qaid=this.id.substring(this.id.indexOf("-"));traJq("#TT2answersBlock"+qaid).show();traJq("#TT2answerBtns"+qaid).show()});traJq("#TT2dismissSubmitted").click(function(){traJq("#TT2questionSubmitted").hide()});traJq("#TT2dismissNotConfirmed").click(function(){traJq("#TT2questionSubmittedNotConfirmed").hide()});traJq("#TT2resendConfirmation").click(function(){for(var i=0;i<TurnTo.matchData.user.uIdents.length;i++){if(TurnTo.matchData.user.uIdents[i].type==1&&!TurnTo.matchData.user.uIdents[i].confirmed){resendEmailConfirmation(TurnTo.matchData.user.uIdents[i].ident)}}});traJq("#TT2askQuestionTips").click(function(){traJq("#TT2askQuestionExamples").toggle();traJq("#TT2askQuestionTipsExpandImg").toggle();traJq("#TT2askQuestionTipsShrinkImg").toggle()});traJq("#TT2showQuestionBoxLink").click(function(){traJq("#TT2showQuestionBox").hide();traJq("#TT2questionSection").show();traJq("#TT2whatShouldAsk").show()});setupQuestionSubmit();if(!TurnTo.matchData.user.hasPhoto){if(TurnTo.answerData&&TurnTo.answerData.answerer&&TurnTo.answerData.answerer.fbMatched){}else{traJq("#TT2AddUserPhoto").click(function(){displayUserSetting(function(){insertScreen("#TTSubScreen",TurnToHTML.userSetting,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl,onMobile:onMobile});toggleSubWindow("block");insertScreen("#contactInfo",TurnToHTML.userSettingEmailAddresses,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl});var traHeight=TurnTojQuery("#TTmainContent").height();traJq("#TT2userSetting").css({maxHeight:traHeight-50+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2userSetting").css({height:"auto"})}setupUserSettingAction();showPhotoEditor()})})}}var name=TurnTo.answerData.answerer.fName?TurnTo.answerData.answerer.fName:TurnTo.answerData.answerer.email;traJq("#TT2askWigetHeader").html('<span style="margin-left:10px"></span>'+name+", thanks for helping "+TurnTo.answerData.asker.fName+" "+(TurnTo.answerData.asker.lName!=null?TurnTo.answerData.asker.lName:"")+" with <a id='TT2itemLink-title-"+data.catItem.id+"' class='TT2itemLink' href='javascript:void(0)' style='font-size:18px;font-weight:bold;color:#314C9B' rel='nofollow'>"+data.catItem.title+"</a>");traJq("#TT2questionSection").hide();traJq("#TT2showQuestionBox").show();traJq("#TT2facebookBox").click(function(e){if(this.checked){this.disabled=true;if(!TurnTo.matchData.user.fbPostToWallGranted){connectWithFacebook(null,{post:true,photo:true,link:true,noMatchesShow:true,onConnectClose:function(){traJq("#TT2facebookBox").removeAttr("disabled");if(TurnTo.matchData.user){getFbPostToWallGranted(function(){if(!TurnTo.matchData.user.fbPostToWallGranted){traJq("input[name=TT2facebookBox]").attr("checked",false)}else{traJq("input[name=TT2facebookBox]").attr("checked",true)}});if(TurnTo.matchData.user&&traJq("#TTtraDialogTitleBar").length>0){change2LiTitleBarFromLo()}}else{traJq("input[name=TT2facebookBox]").attr("checked",false)}}})}else{traJq("#TT2facebookBox").removeAttr("disabled")}if(window.event){window.event.returnValue=true}}});traJq("#TT2twitterBox").click(function(e){if(this.checked){if(!TurnTo.matchData.user){return}this.disabled=true;if(findUserRaveTarget(TurnTo.twitterTargetId)==-1){if(!TurnTo.matchData.user.raveTargets){getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){connectWithTwitter(null,{onConnectClose:function(){traJq("#TT2twitterBox").removeAttr("disabled");getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){traJq("input[name=TT2twitterBox]").attr("checked",false)}else{traJq("input[name=TT2twitterBox]").attr("checked",true)}})}})}else{traJq("input[name=TT2twitterBox]").attr("checked",true);traJq("#TT2twitterBox").removeAttr("disabled")}})}else{connectWithTwitter(null,{onConnectClose:function(){traJq("#TT2twitterBox").removeAttr("disabled");getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){traJq("input[name=TT2twitterBox]").attr("checked",false)}else{traJq("input[name=TT2twitterBox]").attr("checked",true)}})}})}}else{traJq("#TT2twitterBox").removeAttr("disabled")}if(window.event){window.event.returnValue=true}}});traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer4/logClickEvent","siteKey="+S.siteKey+"&lang="+S.locale+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId});traJq("textarea[name^=TT2inlineAnswer-]").keyup(function(){var qaid=this.id.substring(this.id.indexOf("-"));var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){traJq("#TT2anwerCharCount"+qaid)[0].style.color="black";traJq("#TT2answerBtn"+qaid).show()}else{traJq("#TT2anwerCharCount"+qaid)[0].style.color="red";traJq("#TT2answerBtn"+qaid).hide()}traJq("#TT2anwerCharCount"+qaid).html(charLeft+" characters left")}else{traJq("#TT2anwerCharCount"+qaid).html("");traJq("#TT2answerBtn"+qaid).show()}});traJq(".TT2cancelBtn").click(function(){var qaid=this.id.substring(this.id.indexOf("-"));var reply=qaid.indexOf("-")!=qaid.lastIndexOf("-");traJq("#TT2inlineAnswer"+qaid).val("");inputLoseFocus(traJq("#TT2inlineAnswer"+qaid)[0],hideInlineAnswerInput);traJq("#TT2answerReply"+qaid).css("color","#314C9B");if(reply){traJq("#TT2answersBlock"+qaid).hide();traJq("#TT2answerBtns"+qaid).hide()}traJq("#TT2error"+qaid).html("");traJq("#TT2anwerCharCount-"+qaid).html("");traJq("#TT2answersBlock-"+qaid).hide()});traJq(".TT2answerBtn").click(function(){var qaid=this.id.substring(this.id.indexOf("-")+1);var ids=qaid.split("-");var qid=ids[0];if(ids.length>1){var aid=ids[1];var rid=ids[2];if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitAnswerReplyEnsurePartnerReg(qid,aid,rid)}else{submitAnswerReply(qid,aid,rid)}}else{if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitInlineAnswerEnsurePartnerReg(qid)}else{submitInlineAnswer(qid)}}});var postAnswerRewConf=getRewardPointsConfig(TurnTo.eventQaAPost);if(postAnswerRewConf.postText){traJq("#TT2askRewardMsg").html(postAnswerRewConf.postText).show()}})}function resetQuestionArea(){TurnTojQuery("#TT2askOwnersBtn").show();TurnTojQuery("#TT2questionText").val("").attr("nosearch",null);TurnTojQuery("#TTaskExpand").hide();inputLoseFocus(TurnTojQuery("#TT2questionText")[0],TT2questionTextLoseFocus);TurnTojQuery("#TT2questionText").change();TurnTojQuery("#TT3askBtnBlock").show();TurnTojQuery("#TT4instantAnswersQ").hide();TurnTojQuery("#TTmiqInline").empty();TurnTojQuery("#TT4inlineSqvQ").hide();TurnTojQuery("#TTmiqBubble").hide();TurnTojQuery("#TTsuggestedQs").empty().hide();TurnTojQuery("#TT2questionCharCount").empty().hide();TurnTojQuery("#TT2questionSection .TT4askQ").empty().hide();TurnTojQuery("#TTaskArea .TT4startTyping").show();TurnTojQuery(TurnToCatItemType==2?"#TT4questionTypeSwitcher_category":"#TT4questionTypeSwitcher_item").click();if(S.instructCopy){TurnTojQuery("#TTinstructCopy").hide();var whatBox=TurnTojQuery("#TTaskWhatBox");whatBox.height(TurnTojQuery("#TT2questionSection").outerHeight()-(whatBox.innerHeight()-whatBox.height())).show()}TurnTojQuery("#TT3miqaAttachedItems").children().each(function(idx,elem){if(idx>0){TurnTojQuery(elem).remove()}});TurnTojQuery("#TT3error").empty().hide();TurnTojQuery("#TTmiqBubble").css("top","250px");miqaCatItems=[];qaSessionId=null}function setupQuestionSubmit(){TurnTojQuery("#TT2askOwnersBtn").click(function(){logEventAndSubmitQuestion()});TurnTojQuery("#TT2askOwnersBtn").keydown(function(e){if(isEnterKey(e)){logEventAndSubmitQuestion()}});var resetQFn=function(){resetQuestionArea()};TurnTojQuery("#TT3questCancelBtn").click(resetQFn).keydown(resetQFn,checkEnterKeyHandleCallback);if(TurnTojQuery("#TT2questionText").length>0){TurnTojQuery("#TT2questionText")[0].onkeyup=function(e){var charLeft=2000-this.value.length;if(charLeft<=200){var warnEl=TurnTojQuery("#TT2questionCharCount");if(charLeft>=0){TurnTojQuery("#TT2askOwnersBtn").show()}else{TurnTojQuery("#TT2askOwnersBtn").hide()}TurnTojQuery("#TT2questionCharCount").html(msg("tra.qa.askArea.charactersLeft",[charLeft])).show()}else{TurnTojQuery("#TT2questionCharCount").empty().hide();TurnTojQuery("#TT2askOwnersBtn").show()}}}TurnTojQuery("#TT3loLink").click(function(){logOut(true);if(S.registration&&S.registration.localLogoutFunction){S.registration.localLogoutFunction(function(statusObj){})}else{if(S.registration&&S.registration.useBackplane){Backplane.resetCookieChannel()}}resetQuestionArea()});traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer4/logClickEvent","siteKey="+S.siteKey+"&v="+TurnTo.version+"&lang="+S.locale+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId});TurnTojQuery(".TT3useThisQ").click(function(){var text=TurnTojQuery(this).prev().html();TurnTojQuery("#TT2questionText").focus().val(text)});var addItemsFn=function(){var isOpen=TurnTojQuery("#TTmiqBubble").is(":visible");if(isOpen){TurnTojQuery("#TTmiqBubble").hide();TurnTojQuery("#TTaskAreaBtnLine").show()}else{showMultiItemPicker({resultsDiv:TurnTojQuery("#TT3miqaAttachedItems"),list:miqaCatItems,mode:"q",id:"q"})}};traJqC("#TT3miq").click(addItemsFn).keydown(addItemsFn,checkEnterKeyHandleCallback);traJqC("#TT4questionTypeSwitcher_item").change(function(elmnt){traJqC("#TT4qTypeSwitcherWrp1").show();traJqC("#TT4qTypeSwitchCategory").hide()[0].selectedIndex=0;showMiqaControls();TurnTojQuery("#TT2catItmId").val(TurnToCatItemType==2?"":TurnToCatItemId)});traJqC("#TT4questionTypeSwitcher_category").change(function(elmnt){hideMiqaControls();TurnTojQuery("#TTmiqBubble").hide();var catDD=traJqC("#TT4qTypeSwitchCategory").show();TurnTojQuery("#TT2catItmId").val(catDD.val())});traJqC("#TT4qTypeSwitchCategory").change(function(eventData){TurnTojQuery("#TT2catItmId").val(TurnTojQuery(this).val())})}function logEventAndSubmitQuestion(){var qText=TurnTojQuery.trim(TurnTojQuery("#TT2questionText").val());if(qText.length>0&&qText!=TurnTojQuery("#TT2questionText").attr("ttinputlabeltext")){logWebEvent2(TurnTo.eventQaQSubmit,(typeof(TurnToTrack)!="undefined")?"&svid="+TurnToTrack.getSiteVisitId():null)}submitItemQuestion()}function showMiqaControls(){traJqC("#TTmiqArea").show()}function hideMiqaControls(){miqaCatItems=[];TurnTojQuery("#TT3miqaAttachedItems").children().each(function(idx,elem){if(idx>0){TurnTojQuery(elem).remove()}});traJqC("#TTmiqArea").hide()}function showMultiItemPicker(cmd){var id=cmd.mode=="q"?0:cmd.id;var overlayOpen=TurnTojQuery("#TTtraLayout").is(":visible");var elId="#TTtraLayout";if(cmd.mode=="q"){elId=TurnTojQuery("#TTmiqInline");TurnTojQuery("#TTmiqBubble").show();TurnTojQuery("#TTaskAreaBtnLine").hide();if(overlayOpen&&TurnTojQuery("#TTscrollArea").height()-TurnTojQuery("#TTscrollArea").scrollTop()<elId.offset().top+elId.outerHeight()){if(TurnTojQuery("#TTpadding").length==0){TurnTojQuery("#TurnToContent").append('<div id="TTpadding" style="height:200px"></div>')}}if(overlayOpen&&TurnTojQuery("#TTscrollArea").height()-TurnTojQuery("#TTscrollArea").scrollTop()<elId.offset().top+elId.outerHeight()){TurnTojQuery("#TTscrollArea").animate({scrollTop:TurnTojQuery("#TT4miqAbout").position().top})}else{if(TurnTojQuery(window).height()-TurnTojQuery(window).scrollTop()<elId.offset().top+elId.outerHeight()){TurnTojQuery("html, body").animate({scrollTop:TurnTojQuery("#TTaskArea").offset().top})}}}else{if(cmd.mode=="a"){var parentDiv=cmd.resultsDiv.parents(".TT4ansMiqaAnsBtns");parentDiv.append(TurnToHTML.miqaPickerBubble({}));elId=parentDiv.find(".TTmiqaInline");elId.css("height","190px");parentDiv.find(".TT3miqaRsltsRow2").hide();if(overlayOpen){var scrollArea=TurnTojQuery("#TTscrollArea");var miqaBubble=parentDiv.find(".TTmiqaBubble");var scrollAreaBottom=scrollArea.offset().top+scrollArea.outerHeight();var bubbleBottom=miqaBubble.offset().top+miqaBubble.outerHeight();if(bubbleBottom>scrollAreaBottom){scrollArea.animate({scrollTop:(scrollArea.scrollTop()+(bubbleBottom-scrollAreaBottom))})}}else{TurnTojQuery("html, body").animate({scrollTop:parentDiv.parents(".TT3answersBlock").offset().top})}}else{if(overlayOpen){elId="#TTSubScreen"}else{TurnTojQuery("#TT3overlayHeader").hide()}}}S.inMiqPicker=true;insertScreen(elId,TurnToHTML.itemPicker({stateId:id}));var ip=TurnTojQuery(elId).find(".TTitemPicker");var searchFn=function(){clearSearchResultsMiqa(ip);multiItemSearch(ip,cmd)};ip.find(".TT3searchBtn").click(searchFn).keypress(searchFn,checkEnterKeyHandleCallback);var toggleFn=function(e){toggleSearchClearMiqa(ip);if(e){var code=e.which;if(code==13){e.preventDefault();searchFn()}}};var searchField=ip.find(".TT3SearchTermMiqa");searchField.keyup(toggleFn).blur(toggleFn);ip.find(".TT3clearSearchMiqa").click(function(){searchField.val("");clearSearchResultsMiqa(ip)});if(!overlayOpen&&!onMobile){scrollDivTop("TTmainContent")}TurnTojQuery(".TT3removeAttachedItem").die("click");var clickMiqaFn=function(){var id=TurnTojQuery(this).attr("catitemid");var pos=null;for(var i=0;i<cmd.list.length;i++){if(cmd.list[i].id==id){pos=i;break}}cmd.list.splice(pos,1);TurnTojQuery(this).parent().remove();if(cmd.list.length<4){TurnTojQuery(".TT3scrollR").hide()}if(cmd.mode=="a"){if(cmd.resultsDiv.children().length==0){cmd.resultsDiv.parent().find(".TTanswerMiqaHelp").show();cmd.resultsDiv.hide()}}else{var addBtn=TurnTojQuery("#TT3miq");if(addBtn.position().top==0){addBtn.css("margin-top","-15px")}var ic=TurnTojQuery("#TTinstructCopy");ic.css("height",TurnTojQuery("#TT2questionSection").innerHeight()-(ic.innerHeight()-ic.height())+"px")}if(cmd.mode=="q"){TurnTojQuery(".TT3miqaItem.TT3itemAdded").filter("[catitemid="+id+"]").each(function(){traJq(this).find(".TT3added").hide().find(".TT3add").show()})}else{if(cmd.mode=="a"){var parentDiv=cmd.resultsDiv.parents(".TT4ansMiqaAnsBtns");var addBtn=parentDiv.find(".TT3answerMiqa");if((addBtn.offset().left+addBtn.outerWidth()+52)>parentDiv.find(".TT3answerBtn").offset().left&&addBtn.position().top==0){parentDiv.find(".TT3answerBtn").parent().css("margin-top","50px")}if((addBtn.offset().left+addBtn.outerWidth()+52)<=parentDiv.find(".TT2cancelBtn").offset().left&&addBtn.position().top==0){parentDiv.find(".TT2cancelBtn").parent().css("margin-top","0");parentDiv.find(".TT3answerBtn").parent().css("margin-top","0")}parentDiv.find(".TT3miqaItem.TT3itemAdded").filter("[catitemid="+id+"]").each(function(){traJq(this).find(".TT3added").hide().find(".TT3add").show()})}}};TurnTojQuery(".TT3removeAttachedItem").live("click",clickMiqaFn);var closePickerFn=function(){ip.parents("#TTmiqBubble").hide();ip.parents(".TTmiqaBubble").remove();ip.remove();if(cmd.mode="q"){TurnTojQuery("#TTaskAreaBtnLine").show()}};ip.find(".TTitemPickerClose").click(closePickerFn).keypress(closePickerFn,checkEnterKeyHandleCallback)}var miqaCatItems=[];function multiItemSearch(itemPickerDiv,cmd){var searchBtn=itemPickerDiv.find(".TT3searchBtn").hide();var loadingSpinner=itemPickerDiv.find(".TT2imgLoading").show();var excludedCatItemIds=[];var siteKey="";for(var i=0;i<cmd.list.length;i++){excludedCatItemIds.push(cmd.list[i].id)}if(cmd.mode=="q"&&typeof TurnToCatItemId!="undefined"){excludedCatItemIds.push(TurnToCatItemId)}else{if(cmd.mode=="a"){siteKey=itemPickerDiv.closest("#TT3quest-"+cmd.id).data("site-key")}}var postObj={searchTerm:itemPickerDiv.find(".TT3SearchTermMiqa").val(),excludeCatItemIds:excludedCatItemIds};xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),postData:toJson(postObj),contentType:"text/text",url:xhrUri("/traServer4/itemSearch4Miqa",siteKey),load:function(data,ioArgs){var miqaRsltsRow1=itemPickerDiv.find(".TT3miqaRsltsRow1");miqaRsltsRow1.empty().show();if(cmd.mode=="q"){var miqaRsltsRow2=itemPickerDiv.find(".TT3miqaRsltsRow2");miqaRsltsRow2.empty().show()}var searchMsg=msg("tra.qa.miqa.message.searchReturned."+getPlural(data.totalFound),[data.totalFound]);var maxShown=100;if(data.totalFound>maxShown){searchMsg+=" "+msg("tra.qa.miqa.message.searchShown",[maxShown])}itemPickerDiv.find(".TT3miqaRsltsCnt").html(searchMsg).show();for(var i=0;i<data.items.length;i++){var item=data.items[i];if(i%2==0||cmd.mode=="a"){miqaRsltsRow1.append(TurnToHTML.miqaItem({item:item,checkboxId:"TTadaItemPicker-"+item.id+cmd.mode+i}))}else{miqaRsltsRow2.append(TurnToHTML.miqaItem({item:item,checkboxId:"TTadaItemPicker-"+item.id+cmd.mode+i}))}}if(data.items.length>0){setupMultiItemScroll(itemPickerDiv,true,cmd.mode=="q")}itemPickerDiv.find(".TT3miqaItem").hover(function(){if(!traJq(this).hasClass("TT3itemAdded")){traJq(this).children(".TT3add").show();traJq(this).removeClass("TT3itemAdded")}},function(){traJq(this).children(".TT3add").hide()});itemPickerDiv.find(".TTadaItemPicker").focus(function(){var hoverElem=traJq(this).parent().parent();hoverElem.find("img").css("border-bottom","2px solid #025DA7");if(!hoverElem.hasClass("TT3itemAdded")){hoverElem.children(".TT3add").show();hoverElem.removeClass("TT3itemAdded")}}).blur(function(){var hoverElem=traJq(this).parent().parent();hoverElem.children(".TT3add").hide();hoverElem.find("img").css("border-bottom","none")}).keyup(function(event){var keycode=(event.keyCode?event.keyCode:event.which);if(keycode!=32){return}var jThis=traJq(this);if(!jThis.is(":checked")){miqaItemClicked(jThis.parent().parent(),cmd)}else{if(cmd.mode=="a"){var removeElem=jThis.parents(".TT4ansMiqaAnsBtns").first().find('.TT3removeAttachedItem[catitemid="'+jThis.attr("catitemid")+'"');removeElem.click()}else{var removeElem=traJqC("#TTaskExpand").find('.TT3removeAttachedItem[catitemid="'+jThis.attr("catitemid")+'"');removeElem.click()}}});itemPickerDiv.find(".TT3miqaItem").click(function(){miqaItemClicked(this,cmd)});loadingSpinner.hide();searchBtn.show()},error:function(error,ioArgs){displayGenericErrorMessageInSubWindow();loadingSpinner.hide();searchBtn.show()}})}function miqaItemClicked(elem,cmd){if((cmd.mode=="q"&&cmd.list.length>=9)||(cmd.mode=="a"&&cmd.list.length>=10)){return}var jThis=TurnTojQuery(elem);var catItemId=jThis.attr("catitemid");var title=jThis.attr("title");var imgId=jThis.attr("catimgid");jThis.addClass("TT3itemAdded").unbind("click").unbind("keypress");jThis.find(".TT3added").show();jThis.find(".TT3add").hide();if(cmd.mode=="q"){var addBtn=TurnTojQuery("#TT3miq");var items=TurnTojQuery("#TT3miqaAttachedItems");items.append(TurnToHTML.miqaAttachedItem({catItemId:catItemId,title:title,imgId:imgId,hideRemove:false}));if((addBtn.position().left+addBtn.outerWidth())<75){addBtn.css({"margin-top":"4px"})}else{items.find(".TT3miqaAttachedItem").last().css("margin-top",addBtn.css("margin-top"))}var ic=TurnTojQuery("#TTinstructCopy");ic.css("height",TurnTojQuery("#TT2questionSection").innerHeight()-(ic.innerHeight()-ic.height())+"px");cmd.resultsDiv.siblings(".TTquestionMiqaHelp").hide()}else{var parentDiv=cmd.resultsDiv.parents(".TT4ansMiqaAnsBtns");var addBtn=parentDiv.find(".TT3answerMiqa");if((addBtn.offset().left+addBtn.outerWidth()+52)>parentDiv.find(".TT2cancelBtn").offset().left){parentDiv.find(".TT2cancelBtn").parent().css("margin-top","14px");parentDiv.find(".TT3answerBtn").parent().css("margin-top","50px")}if((addBtn.offset().left+addBtn.outerWidth()+52)>parentDiv.find(".TT3answerBtn").offset().left){parentDiv.find(".TT3answerBtn").parent().css("margin-top","14px")}cmd.resultsDiv.append(TurnToHTML.miqaAttachedItem({catItemId:catItemId,title:title,imgId:imgId,hideRemove:false})).show();if((addBtn.position().left+addBtn.outerWidth())<75){if(cmd.mode=="q"){addBtn.css({"margin-top":"4px"})}else{addBtn.css({"margin-top":"0"})}}else{cmd.resultsDiv.last().css("margin-top",addBtn.css("margin-top"))}var callout=parentDiv.find(".TTmiqaCallout");callout.css("left",(addBtn.position().left)+2+"px");parentDiv.find(".TTmiqaBubble").css("top",(addBtn.position().top+addBtn.height()+callout.height()+5)+"px");parentDiv.find(".TTanswerMiqaHelp").hide()}cmd.list.push({id:catItemId,title:title,imgId:imgId})}function miqaScrollR(elem){var miqaItemBox=traJq(elem).next();var children=miqaItemBox.children();children.filter(":visible").first().attr("data-scroll-left","true").hide();children.filter('[data-scroll-right="true"]').first().removeAttr("data-scroll-right").show();children.filter(":visible").css("margin-left",10);children.filter(":visible").first().css("margin-left",0);traJq(elem).prev().show();if(children.filter('[data-scroll-right="true"]').length<=0){traJq(elem).hide()}}function miqaScrollL(elem){var miqaItemBox=traJq(elem).next().next();var children=miqaItemBox.children();children.filter(":visible").last().attr("data-scroll-right","true").hide();children.filter('[data-scroll-left="true"]').last().removeAttr("data-scroll-left").show();children.filter(":visible").css("margin-left",10);children.filter(":visible").first().css("margin-left",0);if(children.filter('[data-scroll-left="true"]').length<=0){traJq(elem).hide()}traJq(elem).next().show()}function toggleSearchClearMiqa(itemPickerDiv){if(itemPickerDiv.find(".TT3SearchTermMiqa").val().length==0){itemPickerDiv.find(".TT3clearSearchMiqa").css("visibility","hidden")}else{itemPickerDiv.find(".TT3clearSearchMiqa").css("visibility","visible")}}function clearSearchResultsMiqa(itemPickerDiv){toggleSearchClearMiqa(itemPickerDiv);itemPickerDiv.find(".TT3miqaRsltsCnt").hide();itemPickerDiv.find(".TT3miqaRslts").empty();itemPickerDiv.find(".TT4miqaScrollRContainer").css("visibility","hidden");itemPickerDiv.find(".TT4miqaScrollLContainer").css("visibility","hidden")}function getQuestBoxData(cmd,callbackF,errorF){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),postData:toJson(cmd),contentType:"text/text",url:xhrUri("/traServer4/getQuestBoxData"),load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.matchData.counts=data.counts;TurnTo.loggedIn=true;change2LiTitleBarFromLo();showHiInHeader()}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data)}TurnTo.matchData.catItem=data.catItem;if(callbackF){callbackF(data,ioArgs)}},error:function(error,ioArgs){displayGenericErrorMessageInSubWindow();errorF()}})}function checkForLIUser(loggedInCb,loggedOutCb){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/checkForLIUser"),postData:toJson({}),contentType:"text/text",load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.matchData.counts=data.counts;TurnTo.loggedIn=true;change2LiTitleBarFromLo();showHiInHeader();TurnToTrack.identify()}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data);if(data.logoutUser){localLogout()}}if(TurnTo.matchData.user&&loggedInCb){loggedInCb(data,ioArgs)}else{if(loggedOutCb){loggedOutCb(data,ioArgs)}}},error:function(data,ioArgs){displayGenericErrorMessageInSubWindow()}})}function sort(elem){var sortField=traJqC(elem);sortField.attr("disabled","disabled");var sortOrder=sortField.val();var questionCont=traJqC("#TT3itemQuestCont");var directQsCont=questionCont.find("#TTQuestionsAndAnswers");var totalQCount=directQsCont.data("qcnt");var loadedCount=directQsCont.find(".TT3questWrp").length;if(totalQCount>loadedCount){return insertPaginatedDirectQuestions(1,sortOrder)}var comparator=getQuestionComparator(sortOrder);var questions=traJqC("#TT3itemQuestCont .TT3questWrp");questions.hide();var sorted=mergeSort(TurnTojQuery.makeArray(questions),comparator);for(var i=0;i<sorted.length;i++){var quest=traJqC(sorted[i]);quest.show();quest.appendTo(directQsCont)}setupInitialAnswersState(questionCont,true,true);paginateQuestions(true);sortField.removeAttr("disabled")}function getQuestionComparator(sortOrder){if(sortOrder=="fewestAns"){return(function(left,right){var leftAnswers=parseInt(traJqC(left).attr("answers"));var rightAnswers=parseInt(traJqC(right).attr("answers"));var leftDate=parseInt(traJqC(left).attr("date"));var rightDate=parseInt(traJqC(right).attr("date"));var rslt=compareInts(leftAnswers,rightAnswers);return(rslt==0?compareInts(leftDate,rightDate):rslt)})}else{if(sortOrder=="mostRecent"){return(function(left,right){var leftVal=parseInt(traJqC(left).attr("date"));var rightVal=parseInt(traJqC(right).attr("date"));if(traJqC(left).attr("checkout")!=null){return -1}else{if(traJqC(right).attr("checkout")!=null){return 1}}return compareInts(rightVal,leftVal)})}else{if(sortOrder=="oldest"){return(function(left,right){var leftVal=parseInt(traJqC(left).attr("date"));var rightVal=parseInt(traJqC(right).attr("date"));return compareInts(leftVal,rightVal)})}else{if(sortOrder=="mostAns"){return(function(left,right){var leftAnswers=parseInt(traJqC(left).attr("answers"));var rightAnswers=parseInt(traJqC(right).attr("answers"));var leftDate=parseInt(traJqC(left).attr("date"));var rightDate=parseInt(traJqC(right).attr("date"));var rslt=compareInts(rightAnswers,leftAnswers);return(rslt==0?compareInts(leftDate,rightDate):rslt)})}else{return(function(left,right){var leftVotes=parseInt(traJqC(left).attr("upVotes"))-parseInt(traJqC(left).attr("downVotes"));var rightVotes=parseInt(traJqC(right).attr("upVotes"))-parseInt(traJqC(right).attr("downVotes"));var leftAnswers=parseInt(traJqC(left).attr("answers"));var rightAnswers=parseInt(traJqC(right).attr("answers"));var leftDate=parseInt(traJqC(left).attr("date"));var rightDate=parseInt(traJqC(right).attr("date"));if(traJqC(left).attr("checkout")!=null){return -1}else{if(traJqC(right).attr("checkout")!=null){return 1}}var rslt=compareInts(rightVotes,leftVotes);rslt=(rslt==0?compareInts(rightAnswers,leftAnswers):rslt);return(rslt==0?compareInts(rightDate,leftDate):rslt)})}}}}}function insertPaginatedQuestions(page,forRelatedQuestions){if(forRelatedQuestions){insertRelatedQuestions(page)}else{var sortBy=traJqC("#TT3sortBox").val();insertPaginatedDirectQuestions(page,sortBy)}}function insertPaginatedDirectQuestions(page,sortBy){var qaCont=TurnTojQuery("#TTQuestionsAndAnswers");var lastPageSort=qaCont.data("page")+qaCont.data("sortby");if(questionsLoadedState.isLoading||((page+sortBy)==lastPageSort)){return}questionsLoadedState.isLoading=true;var url="/sitedata/"+S.siteKey+"/v4_2/"+encodeURIComponent(TurnToItemSku)+"/d/"+S.locale+"/catitemhtml/"+page+"/"+sortBy;getText(url,function(data,ioArgs){var lastQ=null;if(page==1){qaCont.html(data.text)}else{lastQ=qaCont.find(".TT3questWrp").last();qaCont.append(data.text)}addTextToButtons();qaCont.data("page",page);qaCont.data("sortby",sortBy);yieldToUI(function(){var newQsCont=lastQ?lastQ.nextAll(".TT3questWrp"):qaCont;var uid=getCookie(LOGGED_IN_COOKIE_NAME);if(uid&&userQuestions){insertPersonalizedUgc(userQuestions,uid);if(lastQ){newQsCont=newQsCont.filter(function(){var newQId=this.id.split("-")[1];for(var i=0;i<userQuestions.length;i++){if(newQId==userQuestions[i].id){return false}}return true})}}insertInlineAnswerBoxes(newQsCont);setupProfileLinks(newQsCont);insertModerateLink(newQsCont,"answer");disableVotingForOwner(newQsCont,uid);setupInitialAnswersState(qaCont,true,true);if(page==1){paginateQuestions(true);traJqC("#TT3sortBox").prop("disabled",false)}});questionsLoadedState.isLoading=false},function(data,ioArgs){questionsLoadedState.isLoading=false})}function clearReviewsSearchResults(skipInput){traJqR("#TTrevSearchRslts").empty().hide();if(!skipInput||skipInput===false){traJqR("#TT4instantAnswersR").hide();traJqR("#TTreviewsWrapper").show();traJqR("#TTreviewSearchTerm").val("")}traJqR("#TT4inlineSqvR").hide()}function toggleReviewsSearchClear(){if(TurnTojQuery.browser.msie&&TurnTojQuery.browser.version.indexOf(".")&&TurnTojQuery.browser.version.substr(0,TurnTojQuery.browser.version.indexOf("."))==10){traJqR("#TTclearRevSearch").hide();return}if(traJqR("#TTreviewSearchTerm").val().length==0){traJqR("#TTclearRevSearch").css("visibility","hidden");clearReviewsSearchResults()}else{traJqR("#TTclearRevSearch").css("visibility","visible")}}function insertReview(container,review,preferences,shopperProfile,containerEl){if(containerEl){container=traJqR(containerEl)}var useSmallImgs=false;var qa=container.parents("#TurnToContent");if(qa.length>0&&qa.width()<=920){useSmallImgs=true}else{var rev=container.parents("#TurnToReviewsContent");if(rev.length>0&&rev.width()<=920){useSmallImgs=true}var ttReviewCount=rev.find("#ttReviewCount").val();if(ttReviewCount==0){rev.find(".TTreviewSummary").hide()}}var html=TurnToHTML.reviewBlock({id:review.id,title:review.title,text:review.text,incentivized:review.incentivized,dateCreated:review.dateCreated,dateCreatedInMillis:review.dateCreatedInMillis,upVotes:review.upVotes,downVotes:review.downVotes,rating:review.rating,user:review.user,customDimensionValues:review.customDimensionValues,useSmallImgs:useSmallImgs,purchaseDate:review.purchaseDate,preferences:preferences?preferences:{},customProfileDimensionValues:review.customProfileDimensionValues,syndicationData:review.syndicationData,shopperProfile:shopperProfile,itemReviewResponses:review.itemReviewResponses,mediaContent:review.mediaContent,catItem:review.catItem,hide:review.hide});if(preferences&&preferences.prepend){container.prepend(html)}else{container.append(html)}}function writeReview(cmdObj,fromMobile){cmdObj=cmdObj||{};if(S.customWriteReviewFunction&&!cmdObj.skipCustomWriteReviewFunction){S.customWriteReviewFunction();return}if(onMobile&&!fromMobile){window.open(TurnTo.matchData.site.mobileTraPageUrl+(TurnTo.matchData.site.mobileTraPageUrl.indexOf("?")>-1?"&":"?")+"turntosku="+TurnToItemSku+"&TurnToMobileFlow=mobileWriteReview&ttmlp=true&starSelected="+cmdObj.starSelected+"&curl="+encodeURIComponent(document.URL),"_blank");return}var displayCb=displayWriteReview;if(onMobile){cmdObj.shareFor="review";cmdObj.startAction=cmdObj.startAction||"rateIt";cmdObj.starSelected=cmdObj.starSelected||0;displayCb=displayRateIt}if(turntoflowIsReviewOrRebelmail()&&(cmdObj.turntosuid||cmdObj.turntocossuid)){writeReviewInitData(displayCb,cmdObj);return}cmdObj.fromInline=true;if(cmdObj.fromDoMore){cmdObj.fromInline=false}if(TurnTo.matchData.site.acceptedReviewsType==WRITE_REV_ONLY_PURCHASERS){if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){S.registration.synced=false;ensurePartnerRegUser(TurnTo.regSourceWriteReview,function(){writeReviewInitData(displayCb,cmdObj)})}else{checkForLIUser(function(){if(TurnTo.matchData.user.isPreUser&&!S.registration){displayGenericReviewsMessage(msg("tra.wrev.reg.instruction.mustConfirmToWrite"),function(){TurnTojQuery("#TT3resendConfirm").click(function(){resendEmailConfirmation(TurnTo.matchData.user.uIdents[0].ident,function(){displayGenericReviewsMessage(msg("tra.reg.message.confirmationResent",[TurnTo.matchData.user.uIdents[0].ident]))})})})}else{writeReviewInitData(displayCb,cmdObj)}},function(){showGenericRegFlow({header:msg("tra.reg.header.findProfile"),regSource:TurnTo.regSourceWriteReview,showNickname:true,instructionalText:msg("tra.wrev.reg.instruction.reviewsForPurchasersOnly"),showSkip:false,showCancel:false,fromReviews:true,reconfirmCallback:function(){displayGenericReviewsMessage(getExistingLoUserMsg(TurnTo.matchData.existingLoUserEmail))}},function(){if(TurnTo.matchData.user.isPreUser&&!S.registration){displayGenericReviewsMessage(getUnconfirmedMsg(TurnTo.matchData.user),function(){TurnTojQuery("#TT3resendConfirm").click(function(){resendEmailConfirmation(TurnTo.matchData.user.uIdents[0].ident,function(){displayGenericReviewsMessage(msg("tra.reg.message.confirmationResent",[TurnTo.matchData.user.uIdents[0].ident]))})})})}else{writeReviewInitData(displayCb,cmdObj)}})})}}else{if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){S.registration.synced=false;syncPartnerAndTTuserState(function(){writeReviewInitData(displayCb,cmdObj)})}else{writeReviewInitData(displayCb,cmdObj)}}}function displayGenericReviewsMessage(msgTxt,cbfn,hideMobileCloser){var msgDiv=TurnTojQuery("#TT3newRMsgTxt");if(onMobile){TurnTojQuery("#TurnToMobileSubWindow").html('<div id="TurnToMobGenRevMsg"></div>');msgDiv=TurnTojQuery("#TurnToMobGenRevMsg");TurnTojQuery("#TurnToMobileContent").hide();TurnTojQuery("#TurnToMobileRegistration").hide();if(!hideMobileCloser){var dismissLbl=msg("tra.systemMessage.link.dismiss");msgTxt+='<a id="TT3dismissR" class="TT3tabClose" href="javascript:void(0)" title="'+dismissLbl+'" rel="nofollow"><span style="margin-left: 18px">'+dismissLbl+"</span></a>"}toggleMainWindow("none")}if(msgDiv.length==0){displayMessageInSubWindow(msgTxt,null)}else{msgDiv.html(msgTxt);TurnTojQuery("#TT3dismissR").click(function(){if(onMobile){window.close()}else{TurnTojQuery("#TT3newRMsg").hide()}})}if(cbfn){cbfn()}if(onMobile){msgDiv.show()}else{TurnTojQuery("#TT3newRMsg").show()}}function displayWriteReview(reviewInitData){var elId="TTtraLayout";var traLayout=traJq("#TTtraLayout");traJq("#TT3overlayHeader").hide();var uName=TurnTo.matchData.user?formatName(TurnTo.matchData.user,false,"nickFirst"):(reviewInitData.reviewer?reviewInitData.reviewer.fName:"");traLayout.next("#TT4writeReview").remove();traLayout.find("#TTwriteReviewScreen").remove();var widgetWasOpen=isWidgetOpen();if(widgetWasOpen){traLayout.hide().after('<div id="TT4writeReview"></div>');traJq("#TTmoreFeedback").hide();elId="TT4writeReview"}else{if(!onMobile){traJq("#TTmoreFeedback").remove()}traLayout.show();S.fromEmbed=true}var startActionWasShareAPhoto=reviewInitData.startAction&&reviewInitData.startAction==="shareAPhoto"?true:false;var reviewPrompt=TurnTo.matchData.site.acceptedReviewsType==WRITE_REV_ONLY_PURCHASERS?S.visualContentRateItPromptForRatingWhenPurchaseRequired:S.visualContentRateItPromptForRatingWhenPurchaseNotRequired;if(startActionWasShareAPhoto){reviewPrompt=S.visualContentRateItPromptForRatingAfterShare}insertScreen("#"+elId,TurnToHTML.writeReviewScreen,{initData:reviewInitData,uName:uName,reviewPrompt:reviewPrompt});var writeReviewScreen=traJq("#TTwriteReviewScreen");if(reviewInitData.preSelectedRating>0){var rtgEl=traJq("#TTrevRating");rtgEl.attr("temprating",reviewInitData.preSelectedRating);rtgEl.removeClass().addClass("TTratingBox TTrating-"+reviewInitData.preSelectedRating+"-0");rtgEl.trigger("click")}if(reviewInitData.rebelmailFormFields){populateWriteReviewScreen(reviewInitData.rebelmailFormFields,writeReviewScreen)}var traWinCloser=traJq("#TTtraWindowClose")[0];if(widgetWasOpen){var oldFunc=traJq("#TTtraWindowClose")[0].onclick;traWinCloser.onclick=function(){traWinCloser.onclick=oldFunc;traJq("#TT4writeReview").remove();if(traJq("#TTmoreFeedback").size()==1){traJq("#TTmoreFeedback").show()}else{traLayout.show()}};closeReset=true}if(startActionWasShareAPhoto){displayShareMedia(reviewInitData);traJq("#TTwriteReviewScreen").find(".TTskipLink").show().unbind("click").bind("click",function(){displayDoMore(null,onMobile)})}else{toggleMainWindow("none")}traJq("#TTwriteRevGuideLn").unbind("click keydown").bind("click keydown",function(e){if(e.type=="keydown"&&!isEnterKey(e)){return}var el=TurnTojQuery("#TTSubScreen");if(S.reviewGuidelines){el.html(S.reviewGuidelines)}else{insertScreen(el,TurnToHTML.reviewGuidelines,{})}showSubWin()});traJq(".TTmediaBtn").unbind("click keydown").bind("click keydown",function(e){if(e.type=="keydown"&&!isEnterKey(e)){return}var mediaIdsToPreselect=[];var media=traJq("#TTattachedMedia .TTmediaBlock");if(media.length>0){TurnTojQuery.each(media,function(i,v){mediaIdsToPreselect.push(traJq(v).data("id"))})}var shareObj={shareFor:"review",catItem:reviewInitData.catalogItem,mediaType:traJq(this).data("type"),userId:null,mediaIdsToPreselect:mediaIdsToPreselect,};if(reviewInitData.siblingSiteKey){shareObj.siblingSiteKey=reviewInitData.siblingSiteKey}if(reviewInitData.transId){shareObj.transId=reviewInitData.transId}if(reviewInitData.cosId&&reviewInitData.cosTransId){shareObj.cosId=reviewInitData.cosId;shareObj.cosTransId=reviewInitData.cosTransId}displayShareMedia(shareObj)});traJq("#TTattachedMedia").delegate(".TTmediaRemove","click",function(){traJq(this).parent().remove();updateSelectedCntsDisplayOnWriteReviewScreen()});var submitting=false;var submitBtn=writeReviewScreen.find("#TTsubmitReview");var setSubmitState=function(state){var spinner=writeReviewScreen.find(".TTimgLoading");if(state=="on"){submitting=true;submitBtn.hide();spinner.show()}else{submitting=false;spinner.hide();submitBtn.show()}};submitBtn.unbind("click keydown").bind("click keydown",function(e){if(submitting){return}if(e.type=="keydown"&&!isEnterKey(e)){return}setSubmitState("on");var data={};data.rating=traJq("#TTrevRating").attr("rating");var title=traJq("#TTreviewTitle");data.title=stripString(!title.hasClass("TTdefaultInput")?title.val():"");data.text=stripString(traJq("#TTreviewText").val());data.catItemSku=reviewInitData.catalogItem.sku?reviewInitData.catalogItem.sku:TurnToItemSku;data.customDimensionValues={};data.fromRse=reviewInitData.fromRse;data.fromInline=reviewInitData.fromInline;data.mobile=false;if(TurnTo.deviceFingerprint){data.deviceFingerprint=TurnTo.deviceFingerprint}if(reviewInitData.transId){data.transId=reviewInitData.transId}else{if(reviewInitData.cosTransId){data.cosId=reviewInitData.cosId;data.cosTransId=reviewInitData.cosTransId}}if(reviewInitData.rseFollowUpNum){data.rseFollowUpNum=reviewInitData.rseFollowUpNum}if(reviewInitData.campaign){data.campaign=reviewInitData.campaign}if(reviewInitData.incentiveType){data.incentiveType=reviewInitData.incentiveType}var reviewErrors=[];if(!data.rating){reviewErrors.push(msg("tra.wrev.error.rating.blank"));TurnToTrack.addErrorMetric("TTwriteReviewScreen","ratingBlankError")}if(!data.text||(data.text&&data.text.length<TurnTo.matchData.site.reviewsMinLength)||data.text==traJq("#TTreviewText").attr("ttinputlabeltext")){reviewErrors.push(msg("tra.wrev.error.reviewBody.minLength",[TurnTo.matchData.site.reviewsMinLength]));TurnToTrack.addErrorMetric("TTwriteReviewScreen","reviewMinLenError")}if(data.text&&data.text.length>TurnTo.matchData.site.reviewsMaxLength){reviewErrors.push(msg("tra.wrev.error.reviewBody.maxLength"));TurnToTrack.addErrorMetric("TTwriteReviewScreen","reviewMaxLenError")}if(reviewInitData.reviewTitleMandatory&&!data.title){reviewErrors.push(msg("tra.wrev.error.title.blank"));TurnToTrack.addErrorMetric("TTwriteReviewScreen","titleBlankError")}for(var cdd=0;cdd<TurnTo.writeReviewInitData.dimensionDefinitions.length;cdd++){var dimDef=TurnTo.writeReviewInitData.dimensionDefinitions[cdd];if(dimDef.type==1){var dimDefElmnt=traJq("#TTcustDim-"+dimDef.id);var custRating=dimDefElmnt.attr("rating");if(dimDef.required&&custRating==null){reviewErrors.push(msg("tra.wrev.error.dimRating.blank",[dimDef.label]));TurnToTrack.addErrorMetric("TTwriteReviewScreen","dimRatingError")}else{custRating=parseInt(custRating);for(var v=0;v<dimDef.itemReviewDimensionValueDefinitions.length;v++){if(dimDef.itemReviewDimensionValueDefinitions[v].value==custRating){data.customDimensionValues[dimDef.id]=dimDef.itemReviewDimensionValueDefinitions[v].id;break}}}}else{if(dimDef.type==2||dimDef.type==3){var selectedValId=null;var customElem=traJq("#TTcustDim-"+dimDef.id);if(dimDef.type==2||!customElem.is("select")){customElem.find(".TTcustDim-"+dimDef.id).each(function(idx,chkbox){var chkboxjq=TurnTojQuery(chkbox);if(chkboxjq.prop("checked")){selectedValId=chkboxjq.attr("value")}})}else{selectedValId=traJq("#TTcustDim-"+dimDef.id).val()}if(dimDef.required&&!selectedValId){reviewErrors.push(msg("tra.wrev.error.dimOption.blank",[dimDef.label]));TurnToTrack.addErrorMetric("TTwriteReviewScreen","dimOptError")}else{var parsedId=parseInt(selectedValId);if(!isNaN(parsedId)){data.customDimensionValues[dimDef.id]=parsedId}}}else{if(dimDef.type==4){var selectedValId=[];var customElem=traJq("#TTcustDim-"+dimDef.id);customElem.find(".TTcustDim-"+dimDef.id).each(function(idx,chkbox){var chkboxjq=TurnTojQuery(chkbox);if(chkboxjq.prop("checked")){selectedValId.push(parseInt(chkboxjq.attr("value")))}});if(dimDef.required&&selectedValId.length<1){reviewErrors.push(msg("tra.wrev.error.dimOption.blank",[dimDef.label]));TurnToTrack.addErrorMetric("TTwriteReviewScreen","dimOptError")}else{data.customDimensionValues[dimDef.id]=selectedValId}}}}}data.profileDims=[];for(var cpd=0;cpd<reviewInitData.profileAttrs.length;cpd++){var profileDim=reviewInitData.profileAttrs[cpd];var profileAttr=traJq("#TTprofileDim-"+profileDim.id);var value=profileAttr.val();if(profileDim.required&&profileDim.collectDuringContentSubmit&&(value==""||value==null)){reviewErrors.push(msg("tra.wrev.error.profileDimOption.blank",[profileDim.label]));TurnToTrack.addErrorMetric("TTwriteReviewScreen","profileDimOptError")}else{if(value!=""&&value!=null&&value!=profileAttr.attr("data-oldvalue")&&profileDim.type==0){data.profileDims.push({dimDefId:profileDim.id,dimValueId:value})}else{if(value!=""&&value!=null&&profileDim.type==1){data.profileDims.push({dimDefId:profileDim.id,dimValueId:profileDim.values[0].id,dimFreeformText:stripString(value)})}}}}if(!reviewInitData.shopperProfile.shopperCityStateHidden&&reviewInitData.shopperProfile.cityStateCollectDuringContentSubmit){var city=traJq("#TTcity").val();var country=traJq("#TTreviewCountry").val();var state;if(country==="US"){state=traJq("#TTstateUS").val()}else{if(country==="CA"){state=traJq("#TTstateCA").val()}else{state=traJq("#TTstate").val()}}if(reviewInitData.shopperProfile.cityStateRequired){if(!city||city==""){reviewErrors.push(msg("tra.wrev.error.city.blank"));TurnToTrack.addErrorMetric("TTwriteReviewScreen","cityBlankError")}if(!state||state==""){if(!country||country==""||country=="US"){reviewErrors.push(msg("tra.wrev.error.state.blank"))}else{if(country=="CA"){reviewErrors.push(msg("tra.wrev.error.province.blank"))}else{reviewErrors.push(msg("tra.wrev.error.stateother.blank"))}}TurnToTrack.addErrorMetric("TTwriteReviewScreen","stateBlankError")}if(!country||country==""){reviewErrors.push(msg("tra.wrev.error.city.blank"));TurnToTrack.addErrorMetric("TTwriteReviewScreen","countryBlankError")}}data.city=city;data.state=state;data.country=country}if(!reviewInitData.shopperProfile.shopperAgeRangeHidden&&reviewInitData.shopperProfile.ageRangeCollectDuringContentSubmit){var ageRange=traJq("#TTreviewAge").val();data.ageRange=ageRange;if(reviewInitData.shopperProfile.ageRangeRequired){if(!ageRange||ageRange==""){reviewErrors.push(msg("tra.wrev.error.age.blank"));TurnToTrack.addErrorMetric("TTwriteReviewScreen","ageBlankErrors")}}}if(reviewInitData.showSweepstakesOptIn){var sweepstakesElem=traJq("#TTsweepstakesOptIn");sweepstakesElem.find("#TTsweepstakesOptInChkBox").each(function(idx,chkbox){var sweepstakesChkBox=TurnTojQuery(chkbox);data.sweepstakesOptIn=sweepstakesChkBox.prop("checked")})}if(data.title&&data.title.length>WRITE_REV_MAX_TITLE_LENGTH){reviewErrors.push(msg("tra.wrev.error.title.maxLength",[WRITE_REV_MAX_TITLE_LENGTH]));TurnToTrack.addErrorMetric("TTwriteReviewScreen","titleLengthErrors")}var failFn=function(errors){if(errors&&errors.length>0){var errsCont=traJq("#TTwriteRevErrs");errsCont.empty();for(var i=0;i<errors.length;i++){var errCodeArgs=errors[i].args?errors[i].args:[];var errMsg=errors[i].code?msg(errors[i].code,errCodeArgs):errors[i];errsCont.append("<li>"+errMsg+"</li>")}errsCont.show();traJq("#TTscrollArea").scrollTop(0)}else{displayGenericErrorMessageInSubWindow()}setSubmitState("off")};if(reviewErrors.length>0){failFn(reviewErrors);return}var media=traJq("#TTattachedMedia .TTmediaBlock");if(media.length>0){data.mediaIds=[];TurnTojQuery.each(media,function(i,v){data.mediaIds.push(traJq(v).data("id"))})}var trackingData={fromRse:data.fromRse,fromInline:data.fromInline};if(data.rseFollowUpNum){trackingData.rseFollowUpNum=data.rseFollowUpNum}if(reviewInitData.fromRebelMail){trackingData.fromRebelMail=true;trackingData.fromRebelMailFallback=reviewInitData.fromRebelMailFallback;trackingData.rebelmailFormFields=reviewInitData.rebelmailFormFields}var submitFn=function(){setSubmitState("on");traJq("#TTreviewError").empty().hide();data.existingLoUserId=TurnTo.matchData.existingLoUserId?TurnTo.matchData.existingLoUserId:null;data.correlationId=TurnTo.correlationId?TurnTo.correlationId:null;xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/createReview",reviewInitData.siblingSiteKey),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){TurnTo.correlationId=null;trackingData.alreadyReviewed=data.alreadyReviewed?true:false;if(data.alreadyReviewed){displayDoMore({afterSubmission:trackingData},onMobile);traJq("#TTwriteReviewScreen").remove();traJq("#TTmainContent").css({height:"auto"});trackScreenExited("submit",trackingData);return}displayDoMore({afterSubmission:trackingData},onMobile);trackingData.reviewId=data.review.id;trackingData.vcAttached=data.review.mediaContent.length>0;trackScreenExited("submit",trackingData);traJq("#TTwriteReviewScreen").remove();if(reviewInitData.catalogItem.sku==TurnToItemSku){insertReview(traJqR("#TTreviews"),data.review,{prepend:true,hideCtrls:true},data.shopperProfile)}runClientCallbackFunc("reviewSubmit",{id:data.review.id})},error:function(data,ioArgs){failFn(data.errors)}})};setTimeout(function(){setSubmitState("off")},2000);checkReviewAuthAndSubmit(submitFn,function(){toggleMainWindow();displayMessageInSubWindow(msg("tra.wrev.error.unableToSubmit"),{closeButton:true})})});if(reviewInitData.fromRebelMail&&reviewInitData.rebelmailFormFields){submitBtn.click()}if(reviewInitData.fromRebelMail&&reviewInitData.showGuidelines){traJq("#TTwriteRevGuideLn").click()}function trackScreenExited(exitType,data){TurnToTrack.trackScreenExited("TTwriteReviewScreen",exitType,data);traJq("#TTtraWindowClose").unbind("click.reviewMetrics")}traJq("#TTtraWindowClose").bind("click.reviewMetrics",function(){trackScreenExited("premature")})}function populateWriteReviewScreen(fieldValues,writeReviewScreen){TurnTojQuery.each(fieldValues,function(i,val){if(i=="title"){var titleElem=writeReviewScreen.find("#TTreviewTitle");inputFocus(titleElem[0]);titleElem.val(val);inputLoseFocus(titleElem[0])}else{if(i=="text"){var textElem=writeReviewScreen.find("#TTreviewText");inputFocus(textElem[0]);textElem.val(val);inputLoseFocus(textElem[0])}else{if(i=="rating"){var ratingElem=writeReviewScreen.find("#TTrevRating");setReviewTempRating(ratingElem,val);chooseReviewRatingClick(ratingElem[0])}else{if(i.indexOf("TTcustDim-")>-1){var dimElems=writeReviewScreen.find("."+i);if(dimElems.length==0){dimElems=writeReviewScreen.find("#"+i)}if(dimElems.length==0){return}if(dimElems.size()>1){if(!TurnTojQuery.isArray(val)){val=[val]}for(var x=0;x<val.length;x++){dimElems.filter("[value="+val[x]+"]").prop("checked",true)}}else{if(dimElems.hasClass("TTwriteRevCustomDimBox")){setCustomDimensionTempRating(dimElems,val);chooseCustomDimensionClick(dimElems[0])}else{if(dimElems.prop("tagName").toLowerCase()=="select"){dimElems.find("option[value="+val+"]").prop("selected",true)}}}}else{if(i=="ageRange"){writeReviewScreen.find("#TTreviewAge").val(val)}else{if(i.indexOf("TTprofileDim-")>-1){var profileAttr=writeReviewScreen.find("#"+i);if(profileAttr.length==0){return}profileAttr.val(val)}}}}}}})}function updateSelectedCntsDisplayOnWriteReviewScreen(){var elem=traJq("#TTattachedMedia");var photos=traJq(".TTattachedMediaBlock > .TTmediaBlock[data-type=photo]",elem);var videos=traJq(".TTattachedMediaBlock > .TTmediaBlock[data-type=video]",elem);var photoMsg="tra.shareMedia.photosSelected.counts."+TurnTo.getPlural(photos.length);var videoMsg="tra.shareMedia.videosSelected.counts."+TurnTo.getPlural(videos.length);traJq("#TTwriteRevMediaCnts",elem).html(msg(photoMsg,[photos.length])+msg(videoMsg,[videos.length])).show()}TurnTo.checkReviewAuthAndSubmit=checkReviewAuthAndSubmit;function checkReviewAuthAndSubmit(submitFn,failFn){if(TurnTo.matchData.site.acceptedReviewsType==WRITE_REV_ONLY_USERS){var hasRseData=turntoflowIsReviewOrRebelmail()&&(TurnToMods.mods.util.safeGet(TurnTo,"initShareMedia.eml")||TurnToMods.mods.util.safeGet(TurnTo,"writeReviewInitData.reviewer.eml"));if(hasRseData&&!TurnTo.matchData.user&&!TurnTo.matchData.isExistingLoUser){registerAndLogin(submitFn);return}if(!S.registration){checkForLIUser(function(){if(TurnTo.matchData.user.isPreUser&&!S.registration){if(!onMobile){displayGenericReviewsMessage(msg("tra.wrev.reg.instruction.mustConfirmToWrite"),function(){TurnTojQuery("#TT3resendConfirm").click(function(){resendEmailConfirmation(TurnTo.matchData.user.uIdents[0].ident,function(){displayGenericReviewsMessage(msg("tra.reg.message.confirmationResent",[TurnTo.matchData.user.uIdents[0].ident]))})})},true)}}submitFn()},function(){showGenericRegFlow({header:msg("tra.reg.header.findProfile"),regSource:TurnTo.regSourceWriteReview,showNickname:true,instructionalText:msg("tra.wrev.reg.instruction.lookupProfileConnectOrProvide"),showSkip:false,showCancel:false,fromReviews:true,useToken:true,fromMobile:onMobile,reconfirmCallback:function(data){displayReconfirmPolling(data.cttid,submitFn,function(){if(failFn){failFn()}})}},function(){submitFn()})})}else{if(S.registration){if(!getCookie(NOSYNC_COOKIE_NAME)){S.registration.synced=false;if(ensurePartnerRegUser(TurnTo.regSourceWriteReview,function(){submitFn()})==0){return}}else{submitFn()}}}}else{if(TurnTo.matchData.site.acceptedReviewsType==WRITE_REV_ONLY_PURCHASERS){var hasRseData=turntoflowIsReviewOrRebelmail()&&(TurnToMods.mods.util.safeGet(TurnTo,"initShareMedia.eml")||TurnToMods.mods.util.safeGet(TurnTo,"writeReviewInitData.reviewer.eml"));if(hasRseData&&!TurnTo.matchData.user&&!TurnTo.matchData.isExistingLoUser){registerAndLogin(submitFn);return}submitFn()}}}function displayReconfirmPolling(cttid,cb,failCb){if(cttid==undefined){if(failCb){failCb()}else{displayMessageInSubWindow(msg("tra.common.error.unexpected"),{closeButton:true})}return}var targetId="#TTSubScreen";if(onMobile){TurnTojQuery("#TurnToMobileContent").hide();targetId="#TurnToMobileRegistration"}var email=TurnTo.matchData.existingLoUserEmail;insertScreen(targetId,TurnToHTML.pollingReconfirm,{email:email}).show();var pollCont=TurnTojQuery("#TTpollingConfirm");if(!onMobile){showSubWin(true)}else{addMobileHeader(false,{},targetId);toggleMainWindow("none")}pollCont.find(".TTresendReconfirm").bind("click",function(e){e.preventDefault();var msgCont=pollCont.find("#TTresendRslt");resendReconfirm(cttid,email,function(){msgCont.html(msg("tra.polling.reconfirm.resendSuccess",[email]))},function(){msgCont.html(msg("tra.polling.reconfirm.resendFail"))})});var reconfirmedContinue=function(){cb();if(onMobile){TurnTojQuery(targetId).empty().hide();TurnTojQuery("#TurnToMobileContent").show()}else{hideSubWin()}};var attempts=0;var continueAttempted=false;var pollInterval=setInterval(function(){attempts++;if(attempts>60){clearInterval(pollInterval);pollCont.find("#TTconfirmWaitMsg").html(msg("tra.polling.reconfirm.pollingTimeout")).css("font-weight","bold");pollCont.find(".TTvc-continue").show().bind("click",function(){checkUserReconfirm(cttid,email,reconfirmedContinue,function(){pollCont.find("#TTconfirmWaitMsg").html(msg("tra.polling.reconfirm.secondAttemptFail"));if(!onMobile&&!continueAttempted){pollCont.find("#TTinitialReconfirmMsg").append('<p><a id="TTreportProblem" href="#" rel="nofollow">'+msg("tra.polling.reconfirm.reportAProblem")+"</a>");pollCont.find("#TTreportProblem").bind("click",function(e){e.preventDefault();if(failCb){failCb()}})}continueAttempted=true})});return}checkUserReconfirm(cttid,email,function(){clearInterval(pollInterval);reconfirmedContinue()})},2000)}function checkUserReconfirm(cttid,email,cb,failCb){var url=xhrUri("/traServer4/checkUserReconfirm")+"&cttid="+cttid+"&email="+email;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:url,load:function(data,ioArgs){if(!setUserState(data,ioArgs)){if(failCb){failCb()}return}if(cb&&TurnTo.matchData.user){cb()}else{if(failCb){failCb()}}}})}function resendReconfirm(cttid,email,successCb,failCb){var data={cttid:cttid,email:email,regCatItemSku:TurnToItemSku,mobile:onMobile};xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/resendReconfirm"),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){if(successCb){successCb()}},error:function(data,ioArgs){if(failCb){failCb()}}})}function displayRateIt(reviewInitData){addMobileHeader(reviewInitData.fromRse,reviewInitData.catalogItem);TurnToMods.mods.rateIt.display(reviewInitData);toggleMainWindow("none");var rateItScreen=TurnTojQuery("#TTrateItScreen");var rateItEvents="ttRateIt.complete ttRateIt.cancelled";rateItScreen.unbind(rateItEvents).bind(rateItEvents,function(e,reviewId,alreadyReviewed){rateItScreen.unbind(rateItEvents);rateItScreen.hide();if(e.namespace=="complete"){reviewInitData.reviewId=reviewId}if(reviewInitData.startAction=="rateIt"&&isVcEnabledForReviews()&&!alreadyReviewed){reviewInitData.mediaType=reviewInitData.mediaType||"photo";displayShareMedia(reviewInitData)}else{var afterSubmission=(e.namespace=="complete")?{alreadyReviewed:alreadyReviewed}:null;displayDoMore({afterSubmission:afterSubmission},true)}})}function isVcEnabledForReviews(){var vcSettings=TurnTo.matchData.site.vcSettings;return(vcSettings&&vcSettings.activation&&vcSettings.activation.review)}function writeReviewInitData(cb,cmdObj){cmdObj=cmdObj?cmdObj:{};var data={catItemSku:TurnToItemSku};var fromRse=false;var fromInline=false;var preSelectedRating=0;if(cmdObj.turntosuid){data.turntosuid=cmdObj.turntosuid}if(cmdObj.turntocossuid){data.cosId=cmdObj.cosId;data.turntocossuid=cmdObj.turntocossuid}if(cmdObj.sku){data.catItemSku=cmdObj.sku}if(cmdObj.fromRse){fromRse=true}if(cmdObj.fromInline){fromInline=true}if(cmdObj.starSelected){preSelectedRating=cmdObj.starSelected}if(cmdObj.incentiveType){data.incentiveType=cmdObj.incentiveType}xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/writeReviewInitData",cmdObj.siblingSiteKey),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){if(data.alreadyReviewed){if(onMobile){TurnTojQuery("#TurnToMobileContent").empty().hide()}displayMessageInSubWindow('<span class="TT4revReceived">'+msg("tra.wrev.message.alreadyReviewed")+"</span>",{closeButton:true,header:msg("tra.wrev.header.alreadyReviewed"),mobileCloseBtnFn:redirectToMobilePdp});TurnToTrack.track("TTwriteReviewScreen Not Displayed",{error:"Already Reviewed",fromRebelMail:cmdObj.fromRebelMail})}else{if(data.hasPurchase||TurnTo.matchData.site.acceptedReviewsType!=WRITE_REV_ONLY_PURCHASERS){TurnTo.writeReviewInitData=data;if(data.logoutUser){TurnTo.matchData.user=null;TurnTo.loggedIn=false}data.fromRse=fromRse;data.fromInline=fromInline;data.preSelectedRating=preSelectedRating;if(cmdObj.transId){data.transId=cmdObj.transId}if(cmdObj.rseFollowUpNum){data.rseFollowUpNum=cmdObj.rseFollowUpNum}if(cmdObj.turntosuid){data.turntosuid=cmdObj.turntosuid}if(cmdObj.turntocossuid){data.cosId=cmdObj.cosId;data.turntocossuid=cmdObj.turntocossuid}if(cmdObj.cosTransId){data.cosTransId=cmdObj.cosTransId}if(cmdObj.siblingSiteKey){data.siblingSiteKey=cmdObj.siblingSiteKey}data.fromRebelMail=cmdObj.fromRebelMail;data.showGuidelines=cmdObj.showGuidelines;data.rebelmailFormFields=cmdObj.rebelmailFormFields?cmdObj.rebelmailFormFields:null;data.fromRebelMailFallback=cmdObj.fromRebelMailFallback;if(cmdObj.shareFor){data.shareFor=cmdObj.shareFor;data.mediaType=cmdObj.mediaType;data.startAction=cmdObj.startAction;data.media=cmdObj.media;TurnToTrack.startAction=cmdObj.startAction}data.campaign=cmdObj.campaign;if(cmdObj.incentiveType){data.incentiveType=cmdObj.incentiveType}cb(data);if(data.fromRebelMail){if(onMobile){data.errors=TurnTojQuery("#TTrateIt").data("errorList")}else{data.errors=TurnTojQuery("#TTwriteReviewScreen").data("errorList")}}TurnToTrack.startAction=data.startAction||"rateIt";TurnToTrack.track("TTwriteReviewScreen Displayed",data);if(TurnTo.matchData.site.deviceFingerprintOn){TurnToMods.load("fingerprint")}}else{displayGenericReviewsMessage(msg("tra.wrev.message.noEligibleItemsReviewsForPurchasersOnly"),null);TurnToTrack.track("TTwriteReviewScreen Not Displayed",{error:"No Eligible Items",fromRebelMail:cmdObj.fromRebelMail})}}},error:function(data,ioArgs){displayGenericErrorMessageInSubWindow()}})}function chooseReviewRatingHover(event,elem){var elem=traJqR(elem);var event=TurnTojQuery.event.fix(event);var parentOffset=elem.offset();var relX=event.pageX-parentOffset.left;var ratio=relX/elem.width();var numStars=Math.ceil((ratio*100)/20);setReviewTempRating(elem,numStars)}function setReviewTempRating(elem,numStars){elem.removeClass();elem.addClass("TTratingBox TTrating-"+numStars+"-0");elem.attr("temprating",numStars)}function chooseReviewRatingClick(elem){var elem=traJqR(elem);elem.attr("clicked","true");elem.attr("rating",elem.attr("temprating"))}function chooseReviewRatingMouseout(elem){var elem=traJqR(elem);var rating=elem.attr("rating")?elem.attr("rating"):0;elem.removeClass();elem.addClass("TTratingBox TTrating-"+rating+"-0")}function chooseReviewRatingAda(elem){var ratingElem=traJqR(elem).parent().children("#TTrevRating");ratingElem.removeClass();ratingElem.addClass("TTratingBox TTrating-"+elem.value+"-0");ratingElem.attr("rating",elem.value).attr("temprating",elem.value)}function chooseReviewRatingAdaFocus(elem){var ratingElem=traJqR(elem).parent().children("#TTrevRating");ratingElem.css("border","1px gray dotted")}function chooseReviewRatingAdaBlur(elem){var ratingElem=traJqR(elem).parent().children("#TTrevRating");ratingElem.css("border","none")}function chooseCustomDimensionHover(event,elem){var elem=traJqR(elem);var event=TurnTojQuery.event.fix(event);var parentOffset=elem.offset();var relX=event.pageX-parentOffset.left;var ratio=relX/elem.width();var numStars=Math.ceil((ratio*100)/20);setCustomDimensionTempRating(elem,numStars)}function setCustomDimensionTempRating(elem,numStars){elem.removeClass();elem.addClass("TTwriteRevCustomDimBox TTcustom-"+numStars+"-0");elem.attr("temprating",numStars)}function chooseCustomDimensionClick(elem){var elem=traJqR(elem);elem.attr("clicked","true");elem.attr("rating",elem.attr("temprating"))}function chooseCustomDimensionMouseout(elem){var elem=traJqR(elem);var rating=elem.attr("rating")?elem.attr("rating"):0;elem.removeClass();elem.addClass("TTwriteRevCustomDimBox TTcustom-"+rating+"-0")}function chooseCustomDimensionAda(elem){var custDim=traJqR(elem).parent().children(".TTwriteRevCustomDimBox");custDim.removeClass();custDim.addClass("TTwriteRevCustomDimBox TTcustom-"+elem.value+"-0");custDim.attr("rating",elem.value).attr("temprating",elem.value)}function chooseCustomDimensionAdaFocus(elem){var custDim=traJqR(elem).parent().children(".TTwriteRevCustomDimBox");custDim.css("border","1px gray dotted")}function chooseCustomDimensionAdaBlur(elem){var custDim=traJqR(elem).parent().children(".TTwriteRevCustomDimBox");custDim.css("border","none")}function flagReview(id,elem){var elem=traJqR(elem).hide();xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/flagReview"),postData:toJson({id:id}),contentType:"text/text",load:function(data,ioArgs){elem.replaceWith('<span style="font-weight:bold">'+msg("tra.rev.linkLine.inappropriateThanks")+"</span>")},error:function(data,ioArgs){elem.show();displayGenericErrorMessageInSubWindow()}})}function truncateReviews(container){container=TurnTojQuery(container.selector);var lineHeight;TurnTojQuery(".TTreviewBody",container).not(".tt-expanded-readmore").each(function(){var jThis=traJqR(this);if(!lineHeight){lineHeight=getLineHeightInPx(jThis)}var divHeight=jThis.height();var lines=divHeight/lineHeight;if(lines>S.rReviewsTruncateLineLength){var ratio=S.rReviewsTruncateLineLength/lines;var approxTruncIdx=ratio*jThis.text().length-20;var origText=jThis.html();jThis.html(jThis.text().substring(0,approxTruncIdx)+' <a class="TTreviewReadMore" href="javascript:void(0)" rel="nofollow">'+msg("tra.rev.link.readMore")+"</a>");jThis.find(".TTreviewReadMore").click(function(){jThis.html(origText);jThis.addClass("tt-expanded-readmore")})}})}function getLineHeightInPx(container){container.append("<div id='tt_temp_div' style='position:absolute; visibility:hidden'>Text</div>");var hiddenDiv=TurnTojQuery("#tt_temp_div",container);var temp_height=hiddenDiv.height();hiddenDiv.remove();return temp_height}function PaginationObj(container,total,initial,expand,pageSize,showMoreContainer,showMoreMsgKey){this.container=container;this.total=total;this.initial=initial;this.expand=expand;this.pageSize=pageSize;this.showMoreContainer=showMoreContainer;this.showMoreMsgKey=showMoreMsgKey?showMoreMsgKey:"";this.isRelated=false}var reviewsLoadedState={isLoading:false};function paginateDirectReviews(){var cont=traJqR("#TTreviews");var showMoreContainer=cont.parent().find("#TT3rShowMore");var totalReviews=traJqR("#ttReviewCount").val();var paginationObj=new PaginationObj(cont,totalReviews,S.rPaginateInitial,S.rPaginateExpand,TurnTo.matchData.site.reviewsPageSize,showMoreContainer,"tra.rev.showMoreReviews.");paginateReviews(paginationObj,reviewsLoadedState)}var relatedReviewsLoadedState={isLoading:false};function paginateRelatedReviews(){var cont=traJqR("#TT4relatedReviews");var totalReviews=cont.data("rr-count");var showMoreContainer=cont.parent().find("#TT3rrShowMore");var paginationObj=new PaginationObj(cont,totalReviews,S.rrPaginateInitial,S.rrPaginateExpand,TurnTo.matchData.site.relatedReviewsPageSize,showMoreContainer,"tra.rev.showMoreRelatedReviews.");paginationObj.isRelated=true;paginateReviews(paginationObj,{isLoading:false})}function paginateReviews(paginationObj,loadedStateObj){var showMoreContainer=paginationObj.showMoreContainer;showMoreContainer.hide();var allLoadedReviews=paginationObj.container.find(".TTreview");var allVisibleReviews=allLoadedReviews.filter(":visible");var numOfVisibleReviews=allVisibleReviews.length;if(numOfVisibleReviews>paginationObj.initial){for(var i=paginationObj.initial;i<allVisibleReviews.length;i++){allVisibleReviews.eq(i).hide();numOfVisibleReviews--}}else{if(numOfVisibleReviews<paginationObj.initial&&allLoadedReviews.length>numOfVisibleReviews){for(var i=numOfVisibleReviews;i<paginationObj.initial;i++){allLoadedReviews.eq(i).show();numOfVisibleReviews++}}}if(paginationObj.total>numOfVisibleReviews){showMoreContainer.find("a").unbind("click.ttMoreReviews").bind("click.ttMoreReviews",function(){showMoreContainer.hide();showMoreContainer.next(".TTspinner").show();callWhenLoaded(expandReviews,[paginationObj],loadedStateObj,20,function(){showMoreContainer.next(".TT2imgLoading").hide()})});var numHiddenReviews=allLoadedReviews.length-numOfVisibleReviews;var reviewsLeft=paginationObj.total-numOfVisibleReviews;if(numHiddenReviews<paginationObj.expand&&reviewsLeft>numHiddenReviews){insertPaginatedReviews(2,paginationObj.isRelated)}var showMoreNum=reviewsLeft>paginationObj.expand?paginationObj.expand:reviewsLeft;showMoreContainer.find(".TT3ShowMoreText").html(msg(paginationObj.showMoreMsgKey+getPlural(showMoreNum),[showMoreNum]));showMoreContainer.show()}else{showMoreContainer.hide();showMoreContainer.find("a").unbind("click.ttMoreReviews")}}function callWhenLoaded(f,args,loadedState,maxAttempts,tof,attempts){if(!loadedState.isLoading){f.apply(null,args);return}attempts=attempts?attempts:0;if(attempts>maxAttempts){if(tof){tof()}return}setTimeout(function(){attempts++;callWhenLoaded(f,args,loadedState,maxAttempts,tof,attempts)},500)}function expandReviews(paginationObj){var allLoadedReviews=paginationObj.container.find(".TTreview");var hiddenReviews=allLoadedReviews.filter(":hidden");var hiddenCount=0;hiddenReviews.each(function(index){if(index<paginationObj.expand){TurnTojQuery(this).show()}else{hiddenCount++}});truncateReviews(paginationObj.container);if(hiddenCount<paginationObj.expand&&paginationObj.total>allLoadedReviews.length){var pagesLoaded=allLoadedReviews.length/paginationObj.pageSize;if(pagesLoaded===parseInt(pagesLoaded,10)){insertPaginatedReviews(++pagesLoaded,paginationObj.isRelated);hiddenCount=paginationObj.total-allLoadedReviews.length+hiddenCount}}var showMoreContainer=paginationObj.showMoreContainer;if(hiddenCount>0){var showMoreNum=hiddenCount>paginationObj.expand?paginationObj.expand:hiddenCount;showMoreContainer.find(".TT3ShowMoreText").html(msg(paginationObj.showMoreMsgKey+getPlural(showMoreNum),[showMoreNum]));showMoreContainer.show()}showMoreContainer.next(".TTspinner").hide()}function sortReviews(elem){var sortField=traJqR(elem);sortField.attr("disabled","disabled");var showMore=traJqR("#TT3rShowMore").hide();var sortOrder=sortField.val();var reviewCount=traJqR("#ttReviewCount").val();if(reviewCount>TurnTo.matchData.site.reviewsPageSize){insertPaginatedDirectReviews(1,sortOrder,function(){sortField.removeAttr("disabled")});return}showMore.find("a").unbind("click.ttMoreReviews");var comparator;if(sortOrder=="mostRecent"){comparator=function(left,right){var leftVal=parseInt(traJqR(left).attr("date"));var rightVal=parseInt(traJqR(right).attr("date"));return compareInts(rightVal,leftVal)}}else{if(sortOrder=="lowHigh"){comparator=function(left,right){var leftVal=parseInt(traJqR(left).attr("rating"));var rightVal=parseInt(traJqR(right).attr("rating"));return compareInts(leftVal,rightVal)}}else{if(sortOrder=="highLow"){comparator=function(left,right){var leftVal=parseInt(traJqR(left).attr("rating"));var rightVal=parseInt(traJqR(right).attr("rating"));return compareInts(rightVal,leftVal)}}else{comparator=function(left,right){var leftVotes=parseInt(traJqR(left).attr("upvotes"))-parseInt(traJqR(left).attr("downvotes"));var rightVotes=parseInt(traJqR(right).attr("upvotes"))-parseInt(traJqR(right).attr("downvotes"));var leftRating=parseInt(traJqR(left).attr("rating"));var rightRating=parseInt(traJqR(right).attr("rating"));var rslt=compareInts(rightVotes,leftVotes);return(rslt==0?compareInts(rightRating,leftRating):rslt)}}}}var reviewsCont=traJqR("#TTreviews");var reviews=reviewsCont.find(".TTreview");reviews.detach();var sorted=mergeSort(TurnTojQuery.makeArray(reviews),comparator);for(var i=0;i<sorted.length;i++){var review=traJqR(sorted[i]);i<S.rPaginateInitial?review.show():review.hide();reviewsCont.append(review)}var totalReviewsCount=traJqR("#ttReviewCount").val();if(totalReviewsCount>S.rPaginateInitial){paginateDirectReviews()}sortField.removeAttr("disabled")}function insertPaginatedReviews(page,forRelatedItems){if(forRelatedItems){insertRelatedReviews(page)}else{var sortBy=traJqR("#TTreviewSort").val();insertPaginatedDirectReviews(page,sortBy)}}function insertPaginatedDirectReviews(page,sortBy,cb){var url="/sitedata/"+S.siteKey+"/v4_3/"+encodeURIComponent(TurnToItemSku)+"/d/"+S.locale+"/catitemreviewshtml/"+page+"/"+sortBy;if(reviewsLoadedState.isLoading){return}reviewsLoadedState.isLoading=true;getText(url,function(data,ioArgs){var reviewsCont=TurnTojQuery("#TTreviews");if(page==1){reviewsCont.html(data.text);yieldToUI(function(){paginateDirectReviews();truncateReviews(reviewsCont);checkUseSmallDimensions(reviewsCont)})}else{reviewsCont.append(data.text);yieldToUI(function(){truncateReviews(reviewsCont);checkUseSmallDimensions(reviewsCont);disableVotingForReviewOwner(reviewsCont);insertModerateLink(reviewsCont,"review")})}reviewsLoadedState.isLoading=false;if(cb){cb()}},function(data,ioArgs){reviewsLoadedState.isLoading=false;if(cb){cb()}})}function displayShareMedia(cmdObj,fromMobile){var shareMediaScreen=traJq("#TTshareMediaScreen");if(shareMediaScreen.length==0){if(onMobile){traJq("#TurnToMobileContent").append('<div id="TTshareMediaScreen"></div>')}else{traJq("#TTtraLayout").after('<div id="TTshareMediaScreen"></div>')}shareMediaScreen=traJq("#TTshareMediaScreen")}var smCb=function(){if(cmdObj.shareFor=="review"){var oldWindowCloseFunc=null;if(onMobile){addMobileHeader(cmdObj.fromRse,cmdObj.catItem)}else{if(!onMobile&&cmdObj.startAction!="shareAPhoto"){var traWinCloser=traJq("#TTtraWindowClose")[0];oldWindowCloseFunc=traWinCloser.onclick;traWinCloser.onclick=function(){traWinCloser.onclick=oldWindowCloseFunc;traJq("#TTwriteReviewScreen").show();shareMediaScreen.hide()}}}TurnToTrack.startAction=cmdObj.startAction?cmdObj.startAction:TurnToTrack.startAction;var model={shareFor:"review",reviewId:cmdObj.reviewId,catItem:cmdObj.catItem,mediaType:cmdObj.mediaType,userId:null,onMobile:onMobile?onMobile:false,startAction:cmdObj.startAction,mediaIdsToPreselect:cmdObj.mediaIdsToPreselect||[],};if(cmdObj.siblingSiteKey){model.siblingSiteKey=cmdObj.siblingSiteKey}if(cmdObj.transId){model.transId=cmdObj.transId}if(cmdObj.cosId&&cmdObj.cosTransId){model.cosId=cmdObj.cosId;model.cosTransId=cmdObj.cosTransId}TurnToMods.mods.shareMedia.display(model);traJq("#TTwriteReviewScreen").hide();traJq("#TT4reviewWidget").hide();toggleMainWindow("none");shareMediaScreen.bind("ttMediaSelected.review ttMediaSelectionCancelled.review",function(e,media){shareMediaScreen.unbind("ttMediaSelected.review ttMediaSelectionCancelled.review");if(media){cmdObj.media=media;cmdObj.mediaIds=[];for(var i=0;i<media.length;i++){cmdObj.mediaIds.push(media[i].id)}}if(onMobile){if(cmdObj.startAction=="shareAPhoto"){writeReviewInitData(function(reviewInitData){displayRateIt(reviewInitData);shareMediaScreen.hide()},cmdObj)}else{if(cmdObj.startAction=="rateIt"){if(media&&cmdObj.reviewId){associateMediaToUgc(cmdObj.mediaIds,cmdObj.reviewId,"review",function(){displayDoMore({afterSubmission:true},true);shareMediaScreen.hide()})}else{if(cmdObj.reviewId){displayDoMore({afterSubmission:true},true);shareMediaScreen.hide()}}}}}else{shareMediaScreen.hide();if(e.type=="ttMediaSelected"){traJq("#TTwriteReviewScreen #TTattachedMedia").html(TurnToHTML.mediaBlocksAttached({media:media})).show();updateSelectedCntsDisplayOnWriteReviewScreen();traJq("#TTwriteReviewScreen").show();traJq("#TTwriteReviewScreen .TTmediaBtn").first().focus()}else{if(cmdObj.startAction=="shareAPhoto"){toggleMainWindow()}else{traJq("#TTwriteReviewScreen").show()}}if(oldWindowCloseFunc){traJq("#TTtraWindowClose")[0].onclick=oldWindowCloseFunc}}})}};initShareMedia(cmdObj,smCb)}function initShareMedia(cmdObj,cb){var params="";if(TurnTo.params.turntoflow=="review"&&cmdObj){if(cmdObj.turntosuid){params+=("&turntosuid="+cmdObj.turntosuid)}else{if(cmdObj.turntocossuid){params+=("&cosId="+cmdObj.cosId+"&turntocossuid="+cmdObj.turntocossuid)}}}if(!cmdObj.catItem){if(cmdObj.catalogItem){cmdObj.catItem=cmdObj.catalogItem}else{params+=("&sku="+TurnToItemSku)}}if(!params){cb();return}var url=xhrUri("/traServer4/initShareMedia")+params;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:url,load:function(data,ioArgs){if(data.logoutUser){TurnTo.matchData.user=null;TurnTo.loggedIn=false}if(data.catItem){cmdObj.catItem=data.catItem}if(data.eml){if(!TurnTo.initShareMedia){TurnTo.initShareMedia={}}TurnTo.initShareMedia.eml=data.eml}cb()},error:function(data,ioArgs){cb()}})}function associateMediaToUgc(mediaIds,ugcId,ugcType,cb){var data={mediaIds:mediaIds,ugcId:ugcId,ugcType:ugcType};xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:TurnTo.xhrUri("/traServer4/associateMediaToUgc"),postData:TurnTo.toJson(data),load:function(resp,ioArgs){cb()},error:function(resp,ioArgs){cb()}})}function addMobileHeader(fromEmail,catItem,altContId){var mobileCont=altContId?TurnTojQuery(altContId):TurnTojQuery("#TurnToMobileContent");var mobileHeader=mobileCont.find("#TTmobileHeader");var originalTop=TurnTojQuery("#TTtraWindow").css("top");if(mobileHeader.length==0){TurnTojQuery("#TTtraWindow").css("top","0");mobileCont.prepend(TurnToHTML.mobileHeader({}));mobileHeader=mobileCont.find("#TTmobileHeader");mobileHeader.find(".TTleftHeader a").bind("click",function(e){e.preventDefault();var anchor=mobileHeader.find(".TTleftHeader a");if(anchor.data("currDiv")){TurnToTrack.trackScreenExited(anchor.data("currDiv"),"premature")}if(!fromEmail){closeMobileOverlay()}else{if(catItem.itemUrl){window.location=catItem.itemUrl}else{window.location=TurnTo.matchData.site.lpUrl}}});mobileHeader.find(".TTrightHeader a").bind("click",function(e){e.preventDefault();TurnTojQuery("#TTtraWindow").css("top",originalTop);myQA(true)})}else{TurnTojQuery(".TTrightHeader",mobileHeader).hide()}}function compareInts(a,b){if(a==b){return 0}else{if(a>b){return 1}else{return -1}}}function mergeSort(array,comparatorFn){if(array.length<2){return array}var middle=Math.ceil(array.length/2);return merge(mergeSort(array.slice(0,middle),comparatorFn),mergeSort(array.slice(middle),comparatorFn),comparatorFn)}function merge(left,right,comparatorFn){var result=new Array();while((left.length>0)&&(right.length>0)){if(comparatorFn(left[0],right[0])<=0){result.push(left.shift())}else{result.push(right.shift())}}while(left.length>0){result.push(left.shift())}while(right.length>0){result.push(right.shift())}return result}function ilv(type,qaid,upVote,elem){var ttObject=TurnTojQuery(this);if(!setCheckDoubleClick(ttObject)){return}var jqElem=traJqC(elem);var doubleVote=false;var increase=true;if(jqElem.hasClass("TT3tmbOn")){jqElem.removeClass("TT3tmbOn");increase=false}else{if(type==0||type==2){jqElem.addClass("TT3tmbOn");var otherLnk=TurnTojQuery("#TT3v"+(upVote?"Down":"Up")+"Lnk"+(type==0?"q":(type==1?"a":"r"))+qaid,jqElem.parent());if(type!=2){otherLnk=otherLnk.parent()}if(otherLnk.hasClass("TT3tmbOn")){doubleVote=true;otherLnk.removeClass("TT3tmbOn")}}else{var sumbittedIds={};jqElem.parents(".TT3questWrp").find(".TT3tmbOn").each(function(){var votedElem=traJqC(this);var id=votedElem.removeClass("TT3tmbOn").attr("id").substr(10);if(!sumbittedIds[id]){sumbittedIds[id]=true;xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/voteOnItem"),postData:toJson({type:1,qaid:id,upVote:true,doubleVote:false,increase:false}),contentType:"text/text",load:function(data,ioArgs){setCheckDoubleClick(ttObject,true);votedElem.next().html(data.upVotes-data.downVotes)},error:function(data,ioArgs){setCheckDoubleClick(ttObject,true);displayGenericErrorMessageInSubWindow()}})}});jqElem.addClass("TT3tmbOn")}}xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/voteOnItem"),postData:toJson({type:type,qaid:qaid,upVote:upVote,doubleVote:doubleVote,increase:increase}),contentType:"text/text",load:function(data,ioArgs){setCheckDoubleClick(ttObject,true);if(type==0){jqElem.parent().find(".TT3vcntUp").html(" ("+data.upVotes+")");jqElem.parents(".TT3questWrp").attr("upvotes",data.upVotes).attr("downvotes",data.downVotes)}else{if(type==1){jqElem.parent().find(".TT3vcntUp").html(data.upVotes-data.downVotes)}else{var parent=jqElem.parent();parent.find(".TT3vcntUp").html(data.upVotes);parent.find(".TT3vcntDown").html(data.downVotes);jqElem.parents(".TTreview").attr("upvotes",data.upVotes).attr("downvotes",data.downVotes)}}},error:function(data,ioArgs){setCheckDoubleClick(ttObject,true);displayGenericErrorMessageInSubWindow()}})}function ila(qid,elem){var cont=traJqC(elem).parents(".TT3questWrp");var isAnsBlockOpen=cont.find("#TT2answerBtns-"+qid).is(":visible");if(isAnsBlockOpen){inputLoseFocus(cont.find("#TT2inlineAnswer-"+qid)[0],hideInlineAnswerInput)}else{cont.find("#TT2inlineAnswer-"+qid).focus()}}function ilf(aid,elem){var rLink=traJqC(elem);var rText=traJqC('<span style="font-weight:bold">'+msg("tra.qa.answer.linkLine.inappropriateThanks")+"</span>");xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/flagAnswer"),postData:toJson({id:aid}),contentType:"text/text",load:function(data,ioArgs){rLink.replaceWith(rText)},error:function(data,ioArgs){elem.show();displayGenericErrorMessageInSubWindow()}})}function ilt(aid,elem){if(TurnTo.matchData.site.enableThankingUsers===true){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/thankAnswerer"),postData:toJson({aid:aid}),contentType:"text/text",load:function(data,ioArgs){traJqC(elem).replaceWith(msg("tra.qa.answer.linkLine.thanked"))},error:function(data,ioArgs){traJq("#error").html(data.error)}})}}function ils(qid,elem){TurnTojQuery("#TTSubWindowClose")[0].onclick=(function(e){toggleSubWindow("none");if(!S.inWidget&&!S.inProfile){toggleMainWindow("block")}})}function ilr(qid,aid,rid,elem,cb,rcnt){var hasReplies=(rcnt===undefined)?false:(rcnt>0);var rLink=traJqC(elem);var rLinkO=rLink.clone();var rText=traJqC("<span>"+rLink.html()+"</span>");if(S.registration&&!S.registration.synced&&!getCookie(NOSYNC_COOKIE_NAME)){syncPartnerAndTTuserState(function(statusObj){ilr(qid,aid,rid,elem);S.registration.synced=false});return}rLink.replaceWith(rText);xhr("GET",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/getTraInitData"),load:function(data,ioArgs){setUserState(data,ioArgs);var idPostfix=qid+(aid?"-"+aid:"")+(rid?"-"+rid:"");var cont=rid?TurnTojQuery(rText.parents(".TT3rplyCntr")[0]).parent():rText.parents(".TT3IAContainer");if(cont.length==0){cont=rText.parents(".TT4bestAnswerBlock");if(cont.length==0){cont=rText.parents(".TT4shownAnswerBlock")}}cont.show();var replyBlock=TurnTojQuery("#TT3IRContainer-"+idPostfix,cont);var replyName=replyBlock.parent().find(".TT3askedBy a").first().text().trim();replyBlock.prepend(TurnToHTML.inlineAnswerInputBox({defaultText:msg("tra.qa.reply.instruction.enterReply",[replyName]),qid:qid,aid:aid,rid:rid,show:true,replyInput:true,related:false,replyToUid:null,smallInputBox:hasReplies})).show();TurnTojQuery("#TT2inlineAnswer-"+idPostfix,cont).keyup(function(){var qaid=this.id.substring(this.id.indexOf("-"));var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){TurnTojQuery("#TT2anwerCharCount-"+idPostfix,cont)[0].style.color="black";TurnTojQuery("#TT2answerBtn-"+idPostfix,cont).show()}else{TurnTojQuery("#TT2anwerCharCount-"+idPostfix,cont)[0].style.color="red";TurnTojQuery("#TT2answerBtn-"+idPostfix,cont).hide()}TurnTojQuery("#TT2anwerCharCount-"+idPostfix,cont).html(msg("tra.qa.reply.charactersLeft",[charLeft]))}else{TurnTojQuery("#TT2anwerCharCount-"+idPostfix,cont).html("");TurnTojQuery("#TT3answerBtn-"+idPostfix,cont).show()}});if(!hasReplies){TurnTojQuery("#TT2inlineAnswer-"+idPostfix,cont).focus()}var canceler=function(){var answerBlock=TurnTojQuery("#TT2answersBlock-"+idPostfix,cont.parents(".TT3questWrp"));answerBlock.parent().hide();answerBlock.remove();rText.replaceWith(rLinkO)};TurnTojQuery("#TT2cancelBtn-"+idPostfix,cont).click(canceler);TurnTojQuery("#TT3loLink",cont).click(function(){logOut(true);if(S.registration&&S.registration.localLogoutFunction){S.registration.localLogoutFunction(function(statusObj){})}else{if(S.registration&&S.registration.useBackplane){Backplane.resetCookieChannel()}}TurnTojQuery(".TT2cancelBtn",cont).click()});TurnTojQuery("#TT2answerBtn-"+idPostfix,cont).click(function(){if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitAnswerReplyEnsurePartnerReg(qid,aid,rid,null,cont)}else{submitAnswerReply(qid,aid,rid,null,cont)}rText.replaceWith(rLinkO)});addTextToButtons();if(cb){cb()}},error:function(data,ioArgs){rText.replaceWith(rLinkO);displayGenericErrorMessageInSubWindow()}})}function showProfile(uid,fromMobile){getTraInitData(function(data,ioargs){setUserState(data,ioargs);if(TurnTo.matchData.user){if(!onMobile){change2LiTitleBarFromLo()}displayProfile(uid?uid:TurnTo.matchData.user.id,TurnTo.params.fromChatter,fromMobile)}else{showGenericRegFlow({header:msg("tra.reg.header.findProfile"),regSource:10,showCancel:true,showNickname:false,fromProfile:true,instructionalText:msg("tra.reg.instruction.lookupProfileConnectOrProvide"),fromMobile:fromMobile},function(data,ioargs){displayProfile(uid?uid:TurnTo.matchData.user.id,TurnTo.params.fromChatter,fromMobile)})}})}function displayReviewerProfile(reviewId){displayProfile(null,false,false,reviewId)}var offset=0;function displayProfile(uid,fromChatter,fromMobile,reviewId){if(onMobile&&!fromMobile){fromChatter=typeof fromChatter=="undefined"||fromChatter==null?false:fromChatter;uid=typeof uid=="undefined"||uid==null?"":uid;reviewId=typeof reviewId=="undefined"||reviewId==null?"":reviewId;window.open(TurnTo.matchData.site.mobileTraPageUrl+(TurnTo.matchData.site.mobileTraPageUrl.indexOf("?")>-1?"&":"?")+"turntosku="+TurnToItemSku+"&ttmlp=true&TurnToMobileFlow=mobileProfile&uid="+uid+"&fromChatter="+fromChatter+"&rid="+reviewId+"&curl="+encodeURIComponent(document.URL),"_blank")}else{traJq("#TT4writeReview").remove();var elId="TTtraLayout";var widgetAlreadyOpen=isWidgetOpen();if(!widgetAlreadyOpen){S.fromEmbed=true}if(widgetAlreadyOpen&&!S.inProfile&&!fromChatter&&!onMobile){elId="TT3profile";if(!S.inProfile){offset=traJq("#TTmainContent")[0].scrollTop;traJq("#TTtraLayout").hide().after('<div id="TT3profile"></div>')}traJq("#TTmoreFeedback").hide();toggleSubWindow("none")}else{if(traJq("#TT3profile").length!=0){elId="TT3profile"}}if(onMobile){elId="TurnToMobileContent"}else{traJq("#TTmainContent").css({height:"auto"});traJq("div#TT4unconfQA").hide()}S.inProfile=true;insertScreen("#"+elId,'<div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div>').show();toggleMainWindow("none");var limit=20;var url;if(uid){url=xhrUri("/traServer4/getProfileData")+"&uid="+uid+"&offset=0&limit="+limit}else{if(reviewId){url=xhrUri("/traServer4/getReviewUserProfileData")+"&rid="+reviewId}}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:url,load:function(data,ioArgs){var isOtherUser=!TurnTo.matchData.user||TurnTo.matchData.user.id!=uid;insertScreen("#"+elId,TurnToHTML.userProfile,{qCnt:data.qCnt,qCntGood:data.qCntGood,aCnt:data.aCnt,aCntGood:data.aCntGood,cCnt:data.cCnt,rCnt:data.rCnt,rCntGood:data.rCntGood,hasPhoto:data.user.hasPhoto,uid:data.user.id,uImgSrc:TurnTo.getUserPhoto(data.user.id,data.user.pid),user:data.user,isOtherUser:isOtherUser,onMobile:onMobile});if(!onMobile){scrollDivTop("TTmainContent")}insertScreenHeader();toggleTopLinks(false,true,isOtherUser);if(TurnTo.matchData.user&&TurnTo.matchData.user.isPreUser&&TurnTo.matchData.user.id==uid){var divMsg='<div id="TT4unconfQA" class="TT4SysMsgBody" style="margin-top:2px;"><a id="TT4unconfQAClose" class="TT3tabClose" title="'+msg("tra.systemMessage.link.dismiss")+'" href="javascript:void(0)" rel="nofollow"></a>'+getUnconfirmedMsg(TurnTo.matchData.user);TurnTojQuery("#TT3overlayHeader").append(divMsg);TurnTojQuery("#TT4unconfQA").show();TurnTojQuery("#TT4unconfQAClose").click(function(){TurnTojQuery("#TT4unconfQA").remove()});setupResendConfirm()}insertQuestions4Profile(data,uid,0,limit,false);insertAnswers4Profile(data,uid,0,limit,false);insertComments4Profile(data,uid,0,limit);if(data.reviews){insertReviews4Profile(data,uid,0,limit,false)}if(traJq("#TT3profile").is(":visible")&&!fromChatter){TurnTojQuery("#TTtraWindowClose")[0].onclick=function(){traJq("#TT3profile").remove();if(S.setupType!="overlay"&&!onMobile){toggleTopLinks(false,false)}else{TurnTojQuery("#TT3overlayHeader").hide()}traJq("#TTtraLayout").show();traJq("#TTmainContent")[0].scrollTop=offset;S.inProfile=false;change2LiTitleBarFromLo();traJq("#TTtraWindowClose")[0].onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;if(ugcFeedSku){window.TurnToItemSku=ugcFeedSku;ugcFeedSku=null}}}}TurnTojQuery(".TT3askedBy","#"+elId).find("a").each(function(){var el=traJq(this);if(el.attr("tt3-uid")==uid&&(!TurnTo.matchData.user||uid!=TurnTo.matchData.user.id)){el.addClass("TT4profileHighlight")}});var profileTabs=traJq("#TTprofileTabs");if(onMobile&&screen.width<480&&data.reviews){profileTabs.find("#TTchatterTab").text(msg("tra.profile.tab.comments.mobile"))}var tabSelectedFunction=function(){var jThis=traJq(this);profileTabs.find(".TTtab").removeClass("TTactiveTab");traJq(".TTtabContent").hide();jThis.addClass("TTactiveTab");var tabContent=traJq("#"+jThis.attr("id")+"Content").show();setupMultiItemScroll(tabContent)};profileTabs.find(".TTtab").click(tabSelectedFunction).keydown(function(e){if(isEnterKey(e)){tabSelectedFunction.call(this)}})},error:function(data,ioArgs){toggleMainWindow();displayGenericErrorMessageInSubWindow()}})}}function insertScreenHeader(){var overlayHeader=traJq("#TT3overlayHeader").html("");if(overlayHeader.length==0||onMobile){if(onMobile){traJq("#TurnToMobileContent").prepend('<div id="TT3overlayHeader"></div>')}else{traJq("#TTmainContent").prepend('<div id="TT3overlayHeader"></div>')}overlayHeader=traJq("#TT3overlayHeader").html("")}if(onMobile&&TurnTo.params.turntoflow!="review"){overlayHeader.append('<div id="TTrespHeader"><div class="TT3removeAttachedItem" id="TTmobileRespHeaderClose" style="float:left"></div><div style="float:left; margin-left: 10px" onclick="window.close();">'+msg("tra.common.header.link.returnToProduct")+'</div><div class="TT2clearBoth"></div></div>');overlayHeader.append('<div class="TT2clearBoth"></div>');var closFn=getMobileLandingPageTTflowCloser();traJq("#TTmobileRespHeaderClose").click(closFn?closFn:closeMobileOverlay)}overlayHeader.append('<span id="TT4poweredByTT">'+msg("tra.common.header.poweredBy")+'</span><div id="TT3toplinks" style="float:right"></div><div class="TT2clearBoth"></div>');overlayHeader.css("height","").show();var topLinks=traJq("#TT3toplinks");if(TurnTo.matchData.user){topLinks.append(TurnToHTML.hiHeaderMsg({displayName:formatName(TurnTo.matchData.user,false,"nickFirst")})+"&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;");updateLogoutLinks(logOut)}topLinks.append('<a id="TT3myProfileLink" href="javascript:void(0)" rel="nofollow">'+msg("tra.common.header.link.myPosts")+"</a>");topLinks.append('&nbsp;&nbsp;&nbsp;<span>|</span>&nbsp;&nbsp;&nbsp;<a id="TT3settingsLink" href="javascript:void(0)" rel="nofollow">'+msg("tra.common.header.link.mySettings")+"</a>")}function expandProfile(uid,count,type,showMore,offsetField){var limit=20;var offset=parseInt(offsetField.val());var onlyFlag;if(type=="q"){onlyFlag="questionsOnly=true"}else{if(type=="a"){onlyFlag="answersOnly=true"}else{if(type=="r"){onlyFlag="reviewsOnly=true"}else{onlyFlag="commentsOnly=true"}}}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getProfileData")+"&uid="+uid+"&"+onlyFlag+"&offset="+offset+"&limit="+limit,load:function(data,ioArgs){if(data.questions){insertQuestions4Profile(data,uid,offset,limit,true)}else{if(data.answeredQuestions){insertAnswers4Profile(data,uid,offset,limit,true)}else{if(data.comments){insertComments4Profile(data,uid,offset,limit)}else{if(data.reviews){insertReviews4Profile(data,uid,offset,limit,false)}}}}if(count>(offset+limit)){offsetField.val(offset+limit)}else{showMore.hide();showMore.find("a").unbind("click."+offsetField.attr("id"))}},error:function(data,ioArgs){displayGenericErrorMessageInSubWindow()}})}function insertReviews4Profile(data,uid,offset,limit,prepend){var revSec=TurnTojQuery("#TTUPReviewSec");for(var i=0;i<data.reviews.length;i++){insertProfileReview(revSec,data.reviews[i],prepend)}var showMore=TurnTojQuery("#TT3UPrShowMore");if(data.rCnt>offset+limit){var offsetField=showMore.next("#TT3UPrOffset");offsetField.val(offset+limit);showMore.show();showMore.find("a").bind("click."+offsetField.attr("id"),function(){expandProfile(uid,data.rCnt,"r",showMore,offsetField)})}else{if(typeof data.rCnt!="undefined"){showMore.hide()}}disableVotingForReviewOwner(revSec)}function insertProfileReview(container,review,prepend){var html=TurnToHTML.profileReviewBlock({id:review.id,siteName:review.siteName,title:review.title,text:review.text,dateCreated:review.dateCreated,dateCreatedInMillis:review.dateCreatedInMillis,upVotes:review.upVotes,downVotes:review.downVotes,rating:review.rating,user:review.user,catItem:review.catItem,customDimensionValues:review.customDimensionValues});if(prepend){container.prepend(html)}else{container.append(html)}}function insertQuestions4Profile(data,uid,offset,limit,append){var questSec=TurnTojQuery("#TT3UPquestSec");var questWrp=questSec.find(".TT3questWrp");questWrp.last().addClass("TT3questBorder");insertQAR({cont:questSec,questions:data.questions,showAbout:true,showImg:true,append:append});questWrp.last().removeClass("TT3questBorder");var showMore=TurnTojQuery("#TT3UPqShowMore");if(data.qCnt>offset+limit){var offsetField=showMore.next("#TT3UPqOffset");offsetField.val(offset+limit);showMore.show();showMore.find("a").bind("click."+offsetField.attr("id"),function(){expandProfile(uid,data.qCnt,"q",showMore,offsetField)})}else{if(typeof data.qCnt!="undefined"){showMore.hide()}}insertYouBadge(questSec);insertModerateLink(questSec,"answer");disableVotingForOwner(questSec,null,true);setupInitialAnswersState(questSec,true,false)}function insertAnswers4Profile(data,uid,offset,limit,append){var ansSec=TurnTojQuery("#TT3UPAnsSec");var questWrp=ansSec.find(".TT3questWrp");questWrp.last().addClass("TT3questBorder");insertQAR({cont:ansSec,questions:data.answeredQuestions,showAbout:true,showImg:true,append:append});questWrp.last().removeClass("TT3questBorder");var showMore=TurnTojQuery("#TT3UPaShowMore");if(data.aqCnt>offset+limit){var offsetField=showMore.next("#TT3UPaOffset");offsetField.val(offset+limit);showMore.show();showMore.find("a").bind("click."+offsetField.attr("id"),function(){expandProfile(uid,data.aqCnt,"a",showMore,offsetField)})}else{if(typeof data.aqCnt!="undefined"){showMore.hide()}}insertYouBadge(ansSec);insertModerateLink(ansSec,"answer");disableVotingForOwner(ansSec,null,true);setupInitialAnswersState(ansSec,true,false);ansSec.find('[id*="TT3IRContainer"]').hide()}function insertComments4Profile(data,uid,offset,limit){var commentSec=TurnTojQuery("#TT3UPCommentSec");for(var i=0;i<data.comments.length;i++){var comment=data.comments[i];var catId=comment.catItem.id;commentSec.append(TurnToHTML.profileCommentBlock({commentText:comment.text,siteName:comment.siteName,user:{fName:comment.fName,lName:comment.lName,nName:comment.nName,uid:uid},catItem:comment.catItem,dateCreated:comment.dateCreated,syndicationSource:comment.syndicationSource}))}var showMore=TurnTojQuery("#TT3UPcShowMore");if(data.cCnt>offset+limit){var offsetField=showMore.next("#TT3UPcOffset");offsetField.val(offset+limit);showMore.show();showMore.find("a").bind("click."+offsetField.attr("id"),function(){expandProfile(uid,data.cCnt,"c",showMore,offsetField)})}else{if(typeof data.cCnt!="undefined"){showMore.hide()}}insertYouBadge(commentSec);insertModerateLink(commentSec,"answer");disableVotingForOwner(commentSec,null,true)}TurnTo.displayDoMoreCheckSSO=function(){if(!onMobile&&S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){syncPartnerAndTTuserState(TurnTo.displayDoMore)}else{TurnTo.displayDoMore()}};function displayDoMore(cmdObj,fromMobile){if(onMobile&&!fromMobile){window.open(TurnTo.matchData.site.mobileTraPageUrl+(TurnTo.matchData.site.mobileTraPageUrl.indexOf("?")>-1?"&":"?")+"turntosku="+TurnToItemSku+"&TurnToMobileFlow=doMore&ttmlp=true&curl="+encodeURIComponent(document.URL),"_blank")}else{cmdObj=cmdObj||{};var wasWidgetOpen=isWidgetOpen();if(!wasWidgetOpen){S.fromEmbed=true}if(!onMobile){traJq("#TTshareMediaScreen").remove()}var getDoMoreDataCallback=function(data){var list=data.purchases.concat(data.questions);var el=null;traJq("#TTmoreFeedback").remove();if(onMobile){var mobileCont=traJq("#TurnToMobileContent");var mobileHeader=TurnTojQuery("#TTmobileHeader",mobileCont);TurnTojQuery(".TTrightHeader",mobileHeader).show();mobileCont.append(TurnToHTML.moreFeedback({list:list,afterSubmission:cmdObj.afterSubmission}));toggleMainWindow("none");el=mobileCont.find("#TTmoreFeedback");TurnToTrack.addCloseLinkMetrics(mobileHeader,"TTmoreFeedback")}else{var traLayout=TurnTojQuery("#TTtraLayout");if(!isWidgetOpen()){toggleMainWindow("none")}el=traLayout.next("#TTmoreFeedback");var doMoreHtml=TurnToHTML.moreFeedback({list:list,afterSubmission:cmdObj.afterSubmission});if(el.length>0){el=el.replace(doMoreHtml)}else{el=TurnTojQuery(doMoreHtml).insertAfter(traLayout)}traLayout.hide();if(wasWidgetOpen&&!S.fromEmbed){TurnTojQuery("#TTtraWindowClose")[0].onclick=function(){el.remove();TurnTojQuery("#TT3overlayHeader").hide();traLayout.show();change2LiTitleBarFromLo()}}else{TurnTojQuery("#TTtraWindowClose")[0].onclick=function(){toggleMainWindow();traLayout.show();el.hide();S.inProfile=false;relatedQsAdded=false}}}var settingsPostsHeader=traJq("#TT3overlayHeader");if(settingsPostsHeader.is(":visible")){settingsPostsHeader.hide()}var qText=TurnTojQuery(".TTqText",el);qText.each(function(){truncateText(TurnTojQuery(this))});qText.bind("click",function(){var block=TurnTojQuery(this).closest(".TTfeedbackBlock");el.hide();showSoloQuestionViewWidget({qid:block.data("qid")},"domore");TurnToTrack.trackScreenExited("TTmoreFeedback","answerQuestionClick");TurnTojQuery("#TTtraWindowClose").unbind("click.reviewMetrics")});TurnTojQuery(".TTfeedbackBlock .TTrateItStars",el).bind("click",function(){var block=TurnTojQuery(this).closest(".TTfeedbackBlock");var cmdObj={sku:block.attr("data-sku"),fromDoMore:true};var siteKeyForItem=TurnTojQuery(this).data("site-key");if(siteKeyForItem&&siteKeyForItem!=S.siteKey){cmdObj.siblingSiteKey=siteKeyForItem}writeReview(cmdObj,onMobile);el.hide();TurnToTrack.trackScreenExited("TTmoreFeedback","writeNewReviewClick");TurnTojQuery("#TTtraWindowClose").unbind("click.reviewMetrics")});traJq("#TTtraWindowClose").bind("click.reviewMetrics",function(){TurnToTrack.trackScreenExited("TTmoreFeedback","premature");traJq("#TTtraWindowClose").unbind("click.reviewMetrics")})};if(onMobile&&S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){syncPartnerAndTTuserState(function(){getDoMoreData(TurnToItemSku,0,10,getDoMoreDataCallback,function(){displayGenericErrorMessageInSubWindow()})})}else{getDoMoreData(TurnToItemSku,0,10,getDoMoreDataCallback,function(){displayGenericErrorMessageInSubWindow()})}}}function getDoMoreData(sku,offset,limit,cb,errorFunc){var encodedSku=encodeURIComponent(sku);xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getDoMoreData")+"&sku="+encodedSku+"&offset="+offset+"&limit="+limit+"&lang="+S.locale,load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.loggedIn=true}if(cb){cb(data)}},error:function(data,ioArgs){errorFunc()}})}function truncateText(jEl){var heightDiff=jEl[0].scrollHeight-jEl.innerHeight();if(heightDiff>1){var txt=jEl.text();for(var i=txt.split(" ").length;i>=0;i--){txt=txt.substring(0,txt.lastIndexOf(" "));jEl.text(txt);if(jEl[0].scrollHeight<=jEl.innerHeight()){break}}txt=txt.substring(0,txt.lastIndexOf(" "))+"...";jEl.text(txt)}}function skipQ(qid){var removeQuestion=function(){var amqSec=traJq("#TT3AmqQuestSec");var len=amqSec.find(".TT3questWrp").length;if(len==1){traJq("#TT3AmqHeader").html("");amqSec.html(TurnToHTML.amqNoMoreQs);return}var quest=amqSec.find("#TT3quest-"+qid);quest.css("visibility","hidden");quest.height(quest.height());quest.html("");slideUp(quest);if(len==2){traJq("#TT3AmqShowMore a").click()}};if(TurnTo.matchData.user){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/skipQ")+"&uid="+TurnTo.matchData.user.id+"&qid="+qid,load:function(data,ioArgs){removeQuestion()},error:function(data,ioArgs){}})}else{removeQuestion()}}function slideUp(obj,onStepCb,onCompleteCb){if(obj.height()>0){obj.height(Math.max(0,obj.height()-5));if(onStepCb){onStepCb()}setTimeout(function(){slideUp(obj,onStepCb,onCompleteCb)},10)}else{obj.remove();if(onStepCb){onStepCb()}if(onCompleteCb){onCompleteCb()}}}TurnTo.scrollDivDown=function(divId,innerId){TurnTojQuery("#"+divId)[0].scrollTop=TurnTojQuery("#"+innerId)[0].offsetTop};TurnTo.scrollDivTop=scrollDivTop=function(divId){TurnTojQuery("#"+divId)[0].scrollTop=0};function insertQAR(obj){var cont=obj.cont,questions=obj.questions,replace=obj.replace,showAbout=obj.showAbout,showImg=obj.showImg,showSkip=obj.showSkip,append=obj.append,insertInputBox=obj.insertInputBox,showReplyLink=obj.showReplyLink,hideDefaultImg=obj.hideDefaultImg,smallInputBox=obj.smallInputBox,hide=obj.hide||false;var view=viewForQAR(cont);for(var i=questions.length-1;i>=0;i--){var quest=questions[i];var htmlContent;var props={asker:{fName:quest.fName,uid:quest.uid,pid:quest.pid,lName:quest.lName,nName:quest.nName,isStaff:quest.isStaff,expertLabel:quest.expertLabel},questionText:replaceTrimLineBreaks(quest.text),rawQuestionText:quest.rawText,qid:quest.id,upVotes:quest.upVotes,downVotes:quest.downVotes,dateCreated:quest.dateCreated,showImg:showImg?(showImg&&quest.miqCatItems&&quest.miqCatItems.length==0):false,catItem:quest.catItem,showSkip:showSkip?showSkip:false,showAbout:showAbout&&quest.miqCatItems&&quest.miqCatItems.length==0,siteId:quest.siteId,siteName:quest.siteName,siteKey:quest.siteKey,syndicationSource:quest.syndicationSource,aCnt:quest.aCnt,dateInMs:quest.dateInMs,qNickName:quest.nickName,shopperName:quest.shopperName,insertInputBox:insertInputBox,miqCatItems:quest.miqCatItems,isNew:false,hideDefaultImg:hideDefaultImg,smallInputBox:smallInputBox,answerVoteHelpText:S.answerVoteHelpText,hide:hide};if(view=="SQVQ"){htmlContent=TurnToHTML.questionAnswerBlockSQV(props)}else{htmlContent=TurnToHTML.questionAnswerBlock(props)}if(replace){var contId=cont.attr("id");var isHidden=!cont.is(":visible");cont.replaceWith(htmlContent);cont=traJqC("#"+contId);if(isHidden&&TurnTojQuery("#TurnToContent").is(":visible")){cont.hide()}}else{if(append){cont.append(htmlContent)}else{cont.prepend(htmlContent)}}var qcntr=TurnTojQuery("#TT3quest-"+quest.id,cont);setupProfileLinks(replace?cont:qcntr);setupInlineAnswer(replace?cont:qcntr,quest.id);if(!(view=="SQVQ")){setupQuestionText(replace?cont:qcntr)}setupMultiItemScroll(replace?cont:qcntr);var hideReply=typeof showReplyLink!="undefined"&&!showReplyLink;for(var j=quest.answers.length-1;j>=0;j--){var ans=quest.answers[j];ans.aid=ans.id;var answerBlock=insertAnswer(quest.id,ans,false,cont,hideReply,(quest.miqCatItems&&quest.miqCatItems.length>0),j==0,(view=="SQVQ"||view=="SQVE"));insertReplies(cont,ans,quest,answerBlock,hideReply);if(j==0&&view=="BROWSE"){answerBlock=insertAnswer(quest.id,ans,false,cont,hideReply,(quest.miqCatItems&&quest.miqCatItems.length>0),false,(view=="SQVQ"||view=="SQVE"));insertReplies(cont,ans,quest,answerBlock,hideReply)}}}addTextToButtons()}function insertReplies(cont,ans,quest,answerBlock,hideReply){var replysCnt=ans.replys.length;var replys=ans.replys.reverse();while(replys.length>0){var reply=replys.pop();insertReply(quest.id,ans.id,reply.parentReplyId,reply,false,cont,hideReply);var childReplies=reply.replys;if(childReplies){for(var k=childReplies.length-1;k>=0;k--){replys.push(childReplies[k])}}}if(replysCnt>0){TurnTojQuery("#TT3IRContainer-"+quest.id+"-"+ans.id+" .TT3rplyCntr",answerBlock).last().removeClass("TT3replyBorder")}}function viewForQAR(cont){var id=cont.attr("id");if(id=="TT3soloQuestion"){return"SQVE"}else{if(id=="TT3UPquestSec"||id=="TT3UPAnsSec"){return"PROFILE"}else{if(id=="TT3soloQuestionQ"||cont.parents("#TT3soloQuestionQ").length>0){return"SQVQ"}else{if(cont.parents("#TTbrowseQAWrapper").length>0){return"BROWSE"}}}}return""}function setupShownAnswer(questionId,answerId){var answerBlock=TurnTojQuery("#TT3soloQuestion #TT3answer-"+answerId);answerBlock.attr("shownanswer","true");var text=answerBlock.find(".TT3aText");var answerLabel='<span class="TTshownAnswer">'+msg("tra.soloQ.answer")+"</span>&nbsp;";if(text.prev().hasClass("TTbestAnswer")){text.prev().replaceWith(answerLabel)}else{text.before(answerLabel)}hideAnswers(answerBlock,questionId)}function setupMultiItemScroll(container,isForSearch,hasTwoRows){var setupScrollFn=function(miqaContainer){var itemContainer1;var itemContainer2;if(isForSearch){itemContainer1=miqaContainer.find(".TT3miqaRsltsRow1");if(hasTwoRows){itemContainer2=miqaContainer.find(".TT3miqaRsltsRow2")}}else{itemContainer1=miqaContainer.find(".TT3miqaSection")}var numOfClicks=0;var items=itemContainer1.children();var numItems=items.length;if(numItems>1){var itemHolderWidth=itemContainer1.width();var secondChild=items.eq(1);var itemWidth=secondChild.outerWidth(true);var numItemsShown=Math.floor(itemHolderWidth/itemWidth);numOfClicks=numItems-numItemsShown}if(numOfClicks>0){var numClicksRight=0;var leftScrollContainer=miqaContainer.find(".TT4miqaScrollLContainer");var rightScrollContainer=miqaContainer.find(".TT4miqaScrollRContainer");var rightScrollBtn=rightScrollContainer.find(".TT4miqaScrollR");var leftScrollBtn=leftScrollContainer.find(".TT4miqaScrollL");rightScrollContainer.css("visibility","visible");var rightClickHandler=function(){var topChild=itemContainer1.children().not(".TThiddenLeft").first();numClicksRight++;topChild.addClass("TThiddenLeft").hide();if(hasTwoRows){var bottomChild=itemContainer2.children().not(".TThiddenLeft").first();bottomChild.addClass("TThiddenLeft").hide()}if(numClicksRight==numOfClicks){rightScrollContainer.css("visibility","hidden")}leftScrollContainer.css("visibility","visible")};rightScrollBtn.unbind("click.ttScroll").bind("click.ttScroll",rightClickHandler);var leftClickHandler=function(){numClicksRight--;var children1=itemContainer1.children(".TThiddenLeft");children1.last().show().removeClass("TThiddenLeft");if(hasTwoRows){var children2=itemContainer2.children(".TThiddenLeft");children2.last().show().removeClass("TThiddenLeft")}if(numClicksRight==0){leftScrollContainer.css("visibility","hidden")}rightScrollContainer.css("visibility","visible")};leftScrollBtn.unbind("click.ttScroll").bind("click.ttScroll",leftClickHandler);if(isForSearch){var clearSearchButton=container.find(".TT3clearSearchMiqa");clearSearchButton.click(function(){rightScrollBtn.unbind("click.ttScroll",rightClickHandler);leftScrollBtn.unbind("click.ttScroll",leftClickHandler)})}miqaContainer.attr("scrollsetup","true")}};if(isForSearch&&container&&container.is(":visible")){setupScrollFn(container)}else{var containers=container?container.find(".TT4miqaContainer"):TurnTojQuery(".TT4miqaContainer");containers.each(function(){var miqaContainer=TurnTojQuery(this);if(miqaContainer.attr("scrollsetup")!="true"&&miqaContainer.is(":visible")){setupScrollFn(miqaContainer)}})}}function setupQuestionText(q){var questions;if(q){questions=q.find(".TT3qText")}else{questions=traJqC(".TT3qText")}if(questions.length>0){questions[0].onclick=function(){var questWrp=TurnTojQuery(this).parents(".TT3questWrp");if(questWrp.attr("id").indexOf("SYSGEN")>-1){if(parseInt(questWrp.attr("answers"))>4){showOrHideComments(questWrp)}}else{showOrHideAnswers(questWrp)}}}}function showOrHideAnswers(qElem){var id=qElem.attr("id");id=id.substring(id.indexOf("-")+1);if(qElem.find(".TT3showText").is(":visible")){showAllAnswers(qElem.find(".TT4expand"),id)}else{hideAnswers(qElem.find(".TT4collapse"),id)}}function showOrHideComments(qElem){var comments=qElem.find("#TT4commentsExpanded");var hide=comments.children().length>0;if(hide){hideAnswers(TurnTojQuery("#TTallCommentsHide"),"SYSGEN")}else{showAllAnswers(TurnTojQuery("#TTallCommentsShow"),"SYSGEN")}}function setupInlineAnswer(cont,qid){updateCommonInstructionInvalidTextIfCustomization(TurnTojQuery(".TT4answerInstructions",cont));TurnTojQuery("#TT2inlineAnswer-"+qid,cont).keyup(function(){var qaid=this.id.substring(this.id.indexOf("-"));var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){TurnTojQuery("#TT2anwerCharCount-"+qid,cont)[0].style.color="black";TurnTojQuery("#TT2answerBtn-"+qid,cont).show()}else{TurnTojQuery("#TT2anwerCharCount-"+qid,cont)[0].style.color="red";TurnTojQuery("#TT2answerBtn-"+qid,cont).hide()}TurnTojQuery("#TT2anwerCharCount-"+qid,cont).html(msg("tra.qa.answer.charactersLeft",[charLeft]))}else{TurnTojQuery("#TT2anwerCharCount-"+qid,cont).html("");TurnTojQuery("#TT3answerBtn-"+qid,cont).show()}});TurnTojQuery("#TT2cancelBtn-"+qid,cont).click(function(){showInputBox(cont.find(".TT4addAnswer"),qid)});TurnTojQuery("#TT3loLink",cont).click(function(){logOut(true);TurnTojQuery(".TT2cancelBtn",cont).click()});var submitAnswer=function(){if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitInlineAnswerEnsurePartnerReg(qid,cont)}else{submitInlineAnswer(qid,cont)}};TurnTojQuery(".TT3answerBtn",cont).click(function(){submitAnswer()});TurnTojQuery(".TT3answerBtn").keydown(function(e){if(isEnterKey(e)){submitAnswer()}});var showPickerFn=function(){if(!miqaCatItems4Ans[qid]){miqaCatItems4Ans[qid]=[]}var parent=TurnTojQuery(this).parents(".TT4ansMiqaAnsBtns");var isOpen=parent.find(".TTmiqaBubble").is(":visible");if(isOpen){parent.find(".TTmiqaBubble").remove()}else{showMultiItemPicker({resultsDiv:cont.find("#TT3miqaAnswer-"+qid),list:miqaCatItems4Ans[qid],mode:"a",id:qid})}};TurnTojQuery(".TT3answerMiqa",cont).unbind().click(showPickerFn).keypress(showPickerFn,checkEnterKeyHandleCallback)}function updateCommonInstructionInvalidTextIfCustomization(instrCont){if(S.commonInstructionInvalidText&&instrCont&&instrCont.length>0){instrCont.text(S.commonInstructionInvalidText)}}function truncate(inputText,maxChars,suffix){if(inputText.length<=maxChars){return inputText}return inputText.substring(0,maxChars-suffix.length)+suffix}function setupDisplayItemsLayoutNav(itemsEle,numOfPages){var nextLink=traJq("#TT2nextLink");nextLink.click(function(){changeDisplayItemsLayoutPage(itemsEle,TurnTo.layoutPage+1,numOfPages)});changeDisplayItemsLayoutPage(itemsEle,0,numOfPages)}function changeDisplayItemsLayoutPage(itemsEle,page,numOfPages){if(page>numOfPages-1||page<0){return}itemsEle[page].style.display="block";if(page!=0){var scrollDown=parseFloat(TurnTojQuery("#TTmainContent")[0].style.maxHeight)-50;traJq("#TTmainContent")[0].scrollTop=traJq("#TTmainContent")[0].scrollTop+scrollDown}TurnTo.layoutPage=page;if(page==numOfPages-1){traJq("#TT2nextLink").hide()}else{traJq("#TT2nextLink").show()}}function getProductImage(imgId,size,siblingSiteKey){var siteKey=siblingSiteKey?siblingSiteKey:S.siteKey;return TurnTo.partnerProtocol+"//"+S.imageStoreBase+"/item/"+siteKey+"/"+imgId+size+".png"}function getUserPhoto(uid,pid){return TurnTo.partnerProtocol+"//"+S.imageStoreBase+"/user/"+(uid==null?0:pid)+".png"}function getFacebookUserPhoto(){if(TurnTo.matchData&&TurnTo.matchData.user&&TurnTo.matchData.user.isFbConnected){return getUrl("/traServer4/fbUserPhoto?uid="+TurnTo.matchData.user.id)}else{if(TurnTo.matchData&&TurnTo.matchData.siteUser&&TurnTo.matchData.siteUser.fbMatched){return getUrl("/traServer4/fbUserPhoto?suid="+TurnTo.matchData.siteUser.id+"&siteKey="+S.siteKey)}else{if(TurnTo.answerData&&TurnTo.answerData.answerer&&TurnTo.answerData.answerer.fbMatched){return getUrl("/traServer4/fbUserPhoto?suid="+TurnTo.answerData.answerer.suid+"&siteKey="+S.siteKey)}}}return getUserPhoto()}function storeSiteUserFbPhoto(suid,callback){var p={};p.suid=suid;xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/storeSiteUserFbPhoto")+"&cid="+cid,content:p,load:function(data,ioArgs){if(data.pid&&data.pid!="0"){TurnTo.matchData.user.pid=data.pid;TurnTo.matchData.user.hasPhoto=true}if(callback){callback()}}})}function iehacks(){if(TurnTojQuery.browser.msie){if(IEversion==7){traJq(".TurnToRolloLoAskButton1").css({margin:"65px 0 0 0",height:"81px"});traJq(".TurnTorolloverDetail").css({left:"207px"})}}}function clearFbConnectPicture(){var ttfbpicdiv=TurnTojQuery("#TTfbPic");if(ttfbpicdiv){ttfbpicdiv.empty()}window.TTfbPicFrame=null}function registerFbConnectUser(cmd){var cmdStr=decodeURIComponent(cmd);var rsltObj=eval("("+cmdStr+")");if(!rsltObj.connectResult){return}rsltObj.service="facebook";xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/createUser"),postData:toJson(rsltObj),contentType:"text/text",load:createUserLoaded})}function enableLogin(flag){var func=flag?doLogin:null;TurnTo.loginSubmit.onclick=func;TurnTo.loginSubmit.disabled=!flag}function doLogin(e){traJq("#TTloginSubmit").hide();traJq("#TTloginSpinner").show();enableLogin(false);var auth={};auth.username=traJq("#TTloginUsername")[0].value;auth.password=traJq("#TTloginPassword")[0].value;if(traJq("#TTloginRememberMe").length>0&&traJq("#TTloginRememberMe")[0].checked){auth._spring_security_remember_me="true"}xhr("POST",{ssl:true,url:xhrUri("/secure/traServer4/doLogin"),content:auth,load:loginGetMatchesLoaded,error:function(data,ioArgs){if(data.status==1){TurnTo.loginMessage.innerHTML='<span class="TTred">'+data.error+"</span>"}else{TurnTo.loginMessage.innerHTML="Timeout - please try again"}enableLogin(true);traJq("#TTloginSubmit").show();traJq("#TTloginSpinner").hide()}});stopDefault(e);return false}function createUserLoaded(data,ioargs){if(data.error){TurnTojQuery("#TTcheckFmMessage")[0].innerHTML=data.error;TurnTojQuery(".TTerrorLoginLink").each(function(i){this.href="javascript:void(0)";this.onclick=showRealLogin})}else{loginGetMatchesLoaded(data,ioargs)}}function loginGetMatchesLoaded(data,ioargs){if(data.status==0){setLocalLoginCookie(data);setModeratorCookie(data);setActivityCookie(TurnToItemSku);insertYouBadge(TurnTo.jQcontext2);insertModerateLink(TurnTo.jQcontext2,"answer");disableVotingForOwner(TurnTo.jQcontext2)}else{TurnTo.loginMessage.innerHTML="Email and Password did not match";enableLogin(true)}}function setLocalCookies(token,validitySeconds,sessionId){if(token){setCookie(S.authCookieName,token,validitySeconds)}setCookie(S.sessionCookieName,sessionId)}function setModeratorCookie(data){var isMod;var uId;if(data){if(data.user){uId=data.user.id;isMod=TurnTojQuery.inArray(TurnTo.siteModerator,data.user.userSiteRoles)>=0}}else{if(TurnTo.matchData&&TurnTo.matchData.user){uId=TurnTo.matchData.user.id;isMod=TurnTojQuery.inArray(TurnTo.siteModerator,TurnTo.matchData.user.userSiteRoles)>=0}}if(isMod){setCookie(MODERATOR_COOKIE_NAME,uId,604800)}else{dropModeratorCookie()}}function dropModeratorCookie(){var c=getCookie(MODERATOR_COOKIE_NAME);if(c){setCookie(MODERATOR_COOKIE_NAME)}}function setLocalLoginCookie(data){var uId;if(data){if(data.user){uId=data.user.id}}else{if(TurnTo.matchData&&TurnTo.matchData.user){uId=TurnTo.matchData.user.id}}if(uId){setCookie(LOGGED_IN_COOKIE_NAME,uId,604800)}else{dropLocalLoginCookie()}}function dropLocalLoginCookie(){var c=getCookie(LOGGED_IN_COOKIE_NAME);if(c){setCookie(LOGGED_IN_COOKIE_NAME)}}function dropLocalNosyncCookie(){var c=getCookie(NOSYNC_COOKIE_NAME);if(c){setCookie(NOSYNC_COOKIE_NAME)}}function dropLocalCookies(){var cn=S.authCookieName;var c=getCookie(cn);if(c){setCookie(cn)}cn=S.sessionCookieName;c=getCookie(cn);if(c){setCookie(cn)}cn=ACTIVITY_COOKIE_NAME;c=getCookie(cn);if(c){setCookie(cn)}dropLocalLoginCookie();dropModeratorCookie();dropLocalNosyncCookie()}function logOut(doXhr,dontShowLogin){fbLogout();localLogout();if(onMobile&&TurnTo.params.turntoflow=="review"){insertUI(true)}insertUiParts(onMobile&&TurnTo.params.turntoflow=="review"?true:false);S.inProfile=false;var loadFn;if(whichWidget=="ask"){loadFn=function(){showQuestionWidget({iteaserClick:true,sku:TurnToItemSku});if(TurnTo.doReviews){insertEmbedReviews()}TurnTo.traDataLoaded=false}}else{loadFn=function(){if(traJq("#TTtraUserStateMain").is(":visible")){TurnTojQuery("#TTtraWindowClose").click()}insertEmbedTra();if(TurnTo.doReviews||(onMobile&&TurnTo.params.turntoflow=="review")){insertEmbedReviews()}}}if(typeof doXhr=="undefined"){doXhr=true}if(doXhr){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/logout"),handleAs:"json",ssl:true,load:loadFn,error:function(data,ioArgs){}})}if(!onMobile){resize()}return false}function fbLogout(){if(TurnTo.matchData&&TurnTo.matchData.user&&TurnTo.matchData.user.isFbConnected){window.open(getUrl("/traServer4/logoutFromFacebook"),"fbLogout","scrollbars=no,menubar=no,height=500,width=740,resizable=no,toolbar=no,status=no,location=no").focus()}}function localLogout(){var s=TurnTo.matchData.site;TurnTo.matchData={};TurnTo.matchData.site=s;TurnTo.loggedIn=false;TurnTo.traDataLoaded=true;var c2=getCookie(LOGGED_IN_TOKEN_COOKIE_NAME);if(c2){setCookie(LOGGED_IN_TOKEN_COOKIE_NAME)}dropLocalCookies()}function makeSendConfirmFunc(){return function(e){xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/sendconfirm"),contentType:"text/text",load:function(response,ioArgs){setCookie(S.updateCookieName,new Date().getTime());if(response.message=="success"){var tmpEmail=TurnTo.matchData.user.firstName;var mess="Your confirmation e-mail has been resent to "+tmpEmail+'. Please check your email to complete your registration.<div align="center" style="padding-top:20px;"><a id="TTLoginDialogClose" rel="nofollow">Click here to close this window</a></div>';TurnTojQuery("#TTcheckFormDiv")[0].style.display="none";var elem=TurnTojQuery("#TTgenMessageScreen")[0];elem.style.display="block";elem.innerHTML=mess;var cl=TurnTojQuery("#TTLoginDialogClose")[0];cl.href="javascript:void(0)";cl.onclick=function(){stopDefault(e);return false};logOut(true,true);stopDefault(e)}},error:function(data,ioArgs){var message="postalcode XHR - Status: "+data.status+" Error: "+data.error;if(data.status==401){logOut(false)}else{}}});stopDefault(e);return false}}function truncateName(name){var len=18;if(name.length>len){var trunc=name.substring(0,len);trunc+="...";return trunc}return name}function setCookie(cName,value,age){var dc=cName+"=";if(typeof value!="undefined"){dc+=value+"; path=/";if(typeof age!="undefined"){if(age!=-1){var d=new Date();d.setTime(d.getTime()+age*1000);dc+="; Expires="+d.toUTCString()}}}else{dc+="; path=/; Expires="+new Date(0).toUTCString()}document.cookie=dc}function getCookie(cName){var c=null;var ac=document.cookie;var start=ac.indexOf(cName+"=");if(start>=0){start+=cName.length+1;var end=ac.indexOf(";",start);if(end==-1){end=ac.length}c=ac.substring(start,end)}return c}function stopDefault(e){if(e){e.preventDefault()}else{if(window.event){window.event.returnValue=false}}}function setActivityCookie(sku){if(!sku){return}var acVal=getCookie(ACTIVITY_COOKIE_NAME);var skus=acVal?acVal.split(","):new Array();for(var i=0;i<skus.length;i++){if(skus[0]==sku){return}}if(skus.length>10){skus.reverse().pop();skus.reverse()}skus.push(sku);setCookie(ACTIVITY_COOKIE_NAME,skus.join(","),172800)}function hasActivity4Sku(sku){if(!sku){return false}var acVal=getCookie(ACTIVITY_COOKIE_NAME);if(!acVal){return false}var skus=acVal.split(",");for(var i=0;i<skus.length;i++){if(skus[i]==sku){return true}}return false}function getDateString(d){var day=d.getDate();var m=d.getMonth()+1;var mS=["January","February","March","April","May","June","July","August","September","October","November","December"][d.getMonth()];var y=d.getFullYear();return mS+" "+day}function checkUnloadReg(){if(!S.showExitPopup){return}if(!S.exitPopupFrequency){S.exitPopupFrequency=100}var freqRes=(Math.floor(Math.random()*100)<S.exitPopupFrequency);var blackout=false;if(S.exitPopupBlackout){var ttCookie=getCookie(S.regPopupCookieName);if(ttCookie){var cookieVal=parseInt(ttCookie);var blackoutSetting=S.exitPopupBlackout*3600000;var now=(new Date()).getTime();blackout=(cookieVal+blackoutSetting)>now}}if(freqRes&&!blackout){TurnTojQuery(window).unload(showRegPopup);setCookie(S.regPopupCookieName,(new Date()).getTime(),31536000)}}function showRegPopup(){if(TurnTo.matchData&&TurnTo.matchData.user){return}var feedString=(TurnTo.turnToFeed&&TurnTo.turnToFeed.orderId)?"&orderId="+TurnTo.turnToFeed.orderId+"&sig="+TurnTo.turnToFeed.sig:"";feedString="layout=embed&siteKey="+S.siteKey+feedString;var uri="http://"+S.host+"/trackin/ordrconfpgpop?siteKey="+S.siteKey+"&qs="+encodeURIComponent(feedString);var wndw=window.open(uri,"regwin","scrollbars=yes,menubar=no,height=500,width=740,resizable=yes,toolbar=no,status=no,location=no")}function randomString(){var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var string_length=10;var randomstring="";for(var i=0;i<string_length;i++){var rnum=Math.floor(Math.random()*chars.length);randomstring+=chars.substring(rnum,rnum+1)}return randomstring}TurnTo.getSecureIframeProxyUrl=getSecureIframeProxyUrl;function getSecureIframeProxyUrl(){}TurnTo.xhr=xhr;function xhr(method,options){var extraQs=options.urlQueryString?"&"+options.urlQueryString:"";var xxxhr=options.ssl==false?ttXhr:ttSecureXhr;xxxhr.request({url:options.url+"&curl="+encodeURIComponent(document.URL)+extraQs,method:method,headers:{"x-auth-token":getCookie(LOGGED_IN_TOKEN_COOKIE_NAME),"Content-Type":options.contentType?options.contentType:"application/json"},data:options.postData,timeout:(options.timeout?options.timeout:120000)},function(rpcdata){var data={status:0,error:""};if(options.handleAs&&options.handleAs=="text"){data.text=rpcdata.data}else{try{data=ttXDM.easyXDM.getJSONObject().parse(rpcdata.data)}catch(ex){console.debug("JSON eval exception: "+ex);data={status:1,error:ex}}}if(data.status!=0&&!data.status){data={status:500,error:"status field not returned in JSON"}}if(data.status==0){var userToken=rpcdata.headers["x-auth-token"];if(userToken){setCookie(LOGGED_IN_TOKEN_COOKIE_NAME,userToken,31536000)}options.load(data,{options:options,xhr:rpcdata})}else{options.error(data,{options:options,xhr:rpcdata})}},(typeof options.error=="function")?options.error:function(){})}function staticXhr(method,options){var extraQs=options.urlQueryString?"&"+options.urlQueryString:"";ttStaticXhr.request({url:getStaticUrl(options.url),method:method,headers:{"Content-Type":options.contentType?options.contentType:"application/json"},timeout:120000},function(rpcdata){var data={status:0,error:""};if(options.handleAs&&options.handleAs=="text"){data.text=rpcdata.data}else{try{data=ttXDM.easyXDM.getJSONObject().parse(rpcdata.data)}catch(ex){console.debug("JSON eval exception: "+ex);data={status:1,error:ex}}}if(data.status!=0&&!data.status){data={status:500,error:"status field not returned in JSON"}}if(data.status==0){options.load(data,{options:options,xhr:rpcdata})}else{options.error(data,{options:options,xhr:rpcdata})}},(typeof options.error=="function")?options.error:function(){})}function createIframe(fname,onloadstr,uri){if(window[fname]){return window[fname]}if(window.frames[fname]){return window.frames[fname]}var cframe=null;var turi=uri;if(!turi){return null}var ieLess9=TurnTojQuery.browser.msie&&TurnTojQuery.browser.version<9;var ifrstr=ieLess9?'<iframe name="'+fname+'" src="'+turi+'" onload="'+onloadstr+'">':"iframe";cframe=document.createElement(ifrstr);with(cframe){name=fname;setAttribute("name",fname);id=fname}var c;if(S.useSetup){TurnTojQuery("#TurnToSetup").append(cframe)}else{c=document.body.appendChild(cframe)}window[fname]=cframe;with(cframe.style){if(TurnTojQuery.browser.safari&&TurnTojQuery.browser.version<419.3){position="absolute"}left=top="1px";height=width="1px";visibility="hidden";position="absolute"}if(!ieLess9){setIframeSrc(cframe,turi,true);cframe.onload=new Function(onloadstr)}return cframe}function setIframeSrc(iframe,src,replace){try{if(!replace){if(TurnTojQuery.browser.safari){iframe.location=src}else{frames[iframe.name].location=src}}else{var idoc;if(TurnTojQuery.browser.msie){idoc=iframe.contentWindow.document}else{if(TurnTojQuery.browser.safari){var vs=TurnTojQuery.browser.version.split(".");var safariVersion=vs[0]+"."+((vs[1])?vs[1]:0);if(parseInt(safariVersion)>=419.3){idoc=iframe.contentWindow.document}else{idoc=iframe.document}}else{idoc=iframe.contentWindow}}if(!idoc){iframe.location=src;return}else{idoc.location.replace(src)}}}catch(e){}}function escapeJsonString(str){return('"'+str.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")}var toJsonIndentStr="\t";TurnTo.toJson=toJson;function toJson(it,prettyPrint,_indentStr){if(it===undefined){return"undefined"}var objtype=typeof it;if(objtype=="number"||objtype=="boolean"){return it+""}if(it===null){return"null"}if(isString(it)){return escapeJsonString(it)}if(it.nodeType&&it.cloneNode){return""}var recurse=arguments.callee;var newObj;_indentStr=_indentStr||"";var nextIndent=prettyPrint?_indentStr+toJsonIndentStr:"";if(typeof it.__json__=="function"){newObj=it.__json__();if(it!==newObj){return recurse(newObj,prettyPrint,nextIndent)}}if(typeof it.json=="function"){newObj=it.json();if(it!==newObj){return recurse(newObj,prettyPrint,nextIndent)}}var sep=prettyPrint?" ":"";var newLine=prettyPrint?"\n":"";if(isArray(it)){var res=TurnTojQuery.map(it,function(obj){var val=recurse(obj,prettyPrint,nextIndent);if(typeof val!="string"){val="undefined"}return newLine+nextIndent+val});return"["+res.join(","+sep)+newLine+_indentStr+"]"}if(objtype=="function"){return null}var output=[];for(var key in it){var keyStr;if(typeof key=="number"){keyStr='"'+key+'"'}else{if(typeof key=="string"){keyStr=escapeJsonString(key)}else{continue}}val=recurse(it[key],prettyPrint,nextIndent);if(typeof val!="string"){continue}output.push(newLine+nextIndent+keyStr+":"+sep+val)}return"{"+output.join(","+sep)+newLine+_indentStr+"}"}function isString(it){return typeof it=="string"||it instanceof String}function isArray(it){return it&&it instanceof Array||typeof it=="array"}function dojo_extend(constructor,props){for(var i=1,l=arguments.length;i<l;i++){dojo_mixin(constructor.prototype,arguments[i])}return constructor}function dojo_mixin(obj,props){var tobj={};for(var x in props){if(tobj[x]===undefined||tobj[x]!=props[x]){obj[x]=props[x]}}if(TurnTojQuery.browser.msie&&props){var p=props.toString;if(typeof p=="function"&&p!=obj.toString&&p!=tobj.toString&&p!="\nfunction toString() {\n    [native code]\n}\n"){obj.toString=props.toString}}return obj}function delAuthImport(domain,regSource){var uri;var name;if(domain=="hotmail.com"||domain=="msn.com"){uri="/liveServicesAuth?consumer="+domain.substring(0,domain.indexOf(".com"));name="LiveServices"}else{if(domain=="gmail.com"){uri="/oauthDataAuth?consumer=google";name="GoogleData"}else{if(domain=="yahoo.com"||domain=="ymail.com"||domain=="rocketmail.com"){uri="/oauthDataAuth?consumer="+domain.substring(0,domain.indexOf(".com"));name="YahooData"}}}if(uri){if(!regSource){regSource=TurnTo.regSourceTra}return window.open(getUrl("/traServer4"+uri+"&siteKey="+S.siteKey+(regSource?"&regSource="+regSource:"")),name,"menubar=no,width=850,height=550,toolbar=no,location=no,scrollbars=yes,resizable=yes")}return null}function getTraInitDataAuthImport(callback,useCallbackInError){xhr("GET",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/getTraInitDataAuthImport"),load:function(data,ioargs){if(callback){callback(data,ioargs)}if(data.user){setLocalLoginCookie(data);setModeratorCookie(data)}},error:function(data,ioargs){if(useCallbackInError){callback(data,ioargs)}else{if(data.errors){displayErrorsInSubscreen(data.errors)}}}})}function addEmailAddresses(p,callbackF){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/addEmailAddresses"),postData:toJson(p),contentType:"text/text",load:function(data,ioargs){if(data.errors){displayErrorsInSubscreen(data.errors)}else{if(callbackF){callbackF(data)}}},error:function(data,ioargs){if(data.errors){displayErrorsInSubscreen(data.errors)}}})}function displayConfirmationScreen(options){if(onMobile){insertScreen("#TurnToMobileSubWindow",TurnToHTML.mobileConfirmationMessageScreen,options)}else{insertScreen("#TTSubScreen",TurnToHTML.confirmationMessageScreen,options)}traJq("#confirmationMessageScreenBtn")[0].onclick=function(){if(onMobile){TurnTojQuery("#TurnToMobileSubWindow").empty()}else{toggleSubWindow("none")}};if(!onMobile){toggleSubWindow("block")}}function stripString(s){var cs=s.replace(/<\/?[^>]+>/gi,"");cs=cs.replace(/<svg\/?[^>]+/gi,"");cs=TurnTojQuery.trim(cs);return cs}function doSubmitRegForm2(e,callbackF,cmdObj){var p={};if(traJq("#TTregFirstName").length>0){if(traJq("#TTregFirstName").hasClass("TTdefaultInput")){p.TTfirstName=traJq("#TTregFirstName")[0].ttInputClicked?traJq("#TTregFirstName")[0].value:""}else{p.TTfirstName=traJq("#TTregFirstName")[0].value}}if(traJq("#TTregLastName").length>0){if(traJq("#TTregLastName").hasClass("TTdefaultInput")){p.TTlastName=traJq("#TTregLastName")[0].ttInputClicked?traJq("#TTregLastName")[0].value:""}else{p.TTlastName=traJq("#TTregLastName")[0].value}}p.TTnickName="";if(traJq("#TTregNickname").length>0&&traJq("#TTregNickname").val()!=traJq("#TTregNickname").attr("ttInputLabelText")){p.TTnickName=traJq("#TTregNickname").val()}if(traJq("#TTregSource").length>0){p.regSource=traJq("#TTregSource")[0].value}if(!p.regSource){p.regSource=TurnTo.regSourceTra}if(traJq("#TTregEmail").length>0){p.TTemail=traJq("#TTregEmail")[0].ttInputClicked?traJq("#TTregEmail")[0].value:""}if(TurnTo.lastUploadedImageId){p.uploadId=TurnTo.lastUploadedImageId}if(traJq("#TT2regCatItmId").length>0){p.regCatItmId=traJq("#TT2regCatItmId").val()}if(window.TurnToItemSku){p.regCatItmSku=TurnToItemSku}if(traJq("#TT2regIid").length>0){p.regIid=traJq("#TT2regIid").val()}if(cmdObj.qid){p.qid=cmdObj.qid}if(cmdObj.sqid){p.sqid=cmdObj.sqid}if(cmdObj.fromProfile){p.fromProfile=true}if(cmdObj.fromReviews){p.fromReviews=true}if(cmdObj.useToken){p.useToken=true}traJq("#TTregSubmit").hide();traJq("#TTregSubmitLoading").show();xhr("POST",{ssl:true,url:xhrUri("/secure/traServer4/registerFullUser"),postData:toJson(p),contentType:"text/text",load:function(data,ioArgs){if(data.errors&&data.errors.length>0){traJq("#TTregSubmitLoading").hide();traJq("#TTregSubmit").show();displayErrorsInSubscreen(data.errors)}else{if(data.existingLoUserEmail){TurnTo.matchData.existingLoUserEmail=data.existingLoUserEmail;TurnTo.matchData.existingLoUserId=data.existingLoUserId}if(data.correlationId){TurnTo.correlationId=data.correlationId}if(callbackF){callbackF(data,ioArgs)}}}});stopDefault(e)}function resendEmailConfirmation(emailAddr,callbackF){xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/sendconfirm"),contentType:"text/text",load:function(response,ioArgs){if(callbackF){callbackF()}else{if(response.message){displayConfirmationScreen({message:response.message})}}},error:function(data,ioArgs){},postData:toJson({email:emailAddr})})}var TRA_ERROR_MESSAGES=new Array();TRA_ERROR_MESSAGES[3]=msg("tra.reg.error.emailInUse");TRA_ERROR_MESSAGES[5]=msg("tra.reg.error.importFail");TRA_ERROR_MESSAGES[6]=msg("tra.reg.error.firstName.blank");TRA_ERROR_MESSAGES[7]=msg("tra.reg.error.lastName.blank");TRA_ERROR_MESSAGES[8]=msg("tra.reg.error.email.invalid");TRA_ERROR_MESSAGES[9]=msg("tra.reg.error.password.blank");TRA_ERROR_MESSAGES[10]=msg("tra.reg.error.passwordsDontMatch");TRA_ERROR_MESSAGES[11]=msg("tra.reg.error.securityCodeDoesntMatch");TRA_ERROR_MESSAGES[12]=msg("tra.reg.error.displayName.invalid");function displayErrorsInSubscreen(errors){var ssQ=traJq("#TTSubDialogErrors").empty();ssQ.addClass("TT4accessFocus");for(var e=0;e<errors.length;e++){var errR=errors[e];if(!errR.message&&!errR.ecode){ssQ.append(errR+"<br>")}else{ssQ.append((errR.message?errR.message:TRA_ERROR_MESSAGES[errR.ecode])+"<br>")}}if(errors){ssQ.show()}}function clearErrorFromField(elId){traJq("#"+elId).removeClass("TTinputBoxError")}function resize(){var topOffset=S.traTopOffset;if(TurnTojQuery.support.boxModel){TurnTojQuery("#TTtraWindow").css({left:((TurnTojQuery(window).width()/2)-350)+"px"})}else{TurnTojQuery("#TTtraWindow").css({top:TurnTojQuery(document).scrollTop()+20+"px",left:((TurnTojQuery(window).width()/2)-350)+"px"})}var mHei=(TurnTojQuery(window).height()-(TurnTo.loggedIn?145:115));if(mHei<0){mHei=0}if(TurnTojQuery("#TTmainContent").length>0){TurnTojQuery("#TTmainContent")[0].style.maxHeight=mHei+"px"}if(TurnTojQuery("#TTscrollArea").length>0){TurnTojQuery("#TTscrollArea")[0].style.maxHeight=mHei+"px"}var d=document.documentElement;var elem=d.offsetHeight?d:document.body;TurnTojQuery("#TTtraBackOverlay")[0].style.height=Math.max(elem.scrollHeight,elem.offsetHeight)+"px";if(TurnTo.quirksMode&&TurnTojQuery.browser.msie){TurnTojQuery("#TTmainContent")[0].style.height=mHei+"px"}}function resizeSubWindow(id){var currentSubWindowHeight=traJq("#"+id).height();var traHeight=TurnTojQuery("#TTmainContent").height();if(currentSubWindowHeight>traHeight-70){traJq("#"+id).css({height:(traHeight-70)+"px"})}else{traJq("#"+id).css({height:"auto"})}}function toggleMainWindow(dis){var t=(dis)?dis:TurnTojQuery(traWindow).css("display");if(t=="none"){if(!onMobile){resize()}traJq("#TTtraUserStateMain").show()}else{if(document.all&&document.createAttribute&&document.compatMode!="BackCompat"){document.getElementsByTagName("html")[0].style.overflow=""}else{document.body.style.overflow=""}}if(t=="none"){traWindow.style.display="block";traJq("#TTtraWindowClose").focus()}else{traWindow.style.display="none"}if(S.setupType=="mobileTT"){traWindow.overlay.display="none"}else{traWindow.overlay.display=(t=="none")?"block":"none"}}function toggleSubWindow(pos,hideBorder){var mainWindowVisible=traJq("#TTtraUserStateMain").is(":visible");if(pos=="none"){if(!mainWindowVisible){toggleMainWindow("block")}}var current=traSubWindow.style.display;if(pos=="none"||(current=="block"&&pos!="block")){if(TurnTo.postPurchaseFlowStarted||TurnTo.pteFlowStarted||TurnTo.noSharingPrefExitFlow){closeOrderConfPurchases();return}}if(hideBorder){TurnTojQuery(traSubWindow).addClass("TTnoBorder")}else{TurnTojQuery(traSubWindow).removeClass("TTnoBorder")}traSubWindow.overlay.display="none";if(pos=="block"||pos=="none"){if(pos==current){return}else{if(mainWindowVisible){traSubWindow.overlay.display=pos}traSubWindow.style.display=pos}}else{if(mainWindowVisible){traSubWindow.style.display=(current=="none")?"block":"none"}traSubWindow.overlay.display=(traSubWindow.overlay.display=="none")?"block":"none"}if(traSubWindow.style.display=="block"){TurnTojQuery("#TTSubWindowClose").focus()}}function closeMobileOverlay(){var params=getParameters();if(TurnToMods.mods.browserUtil.isGSA&&window.history.length>0&&params.ttmlp=="true"){window.history.back()}else{if(window.opener){window.close()}}}function replaceTrimLineBreaks(str){return str.replace(/\n{2,}/g,"<br/><br/>").replace(/\n/g,"<br/>")}TurnTo.showSubWin=showSubWin;function showSubWin(hideBorder){var jTraWindow=TurnTojQuery(traWindow);if(jTraWindow.css("display")=="none"){jTraWindow.css({height:TurnTojQuery(window).height()+"px"});toggleMainWindow();traJq("#TTtraUserStateMain").hide()}TurnTojQuery("#TTtraInsideOverlay").height(jTraWindow.height());toggleSubWindow("block",hideBorder)}TurnTo.hideSubWin=hideSubWin;function hideSubWin(){toggleSubWindow("none")}function display(elem,show,empty){if(empty){traJq(elem)[0].innerHTML=""}if(show){traJq(elem)[0].style.display="block"}else{traJq(elem)[0].style.display="none"}}function makeToolTip(el){var tipTarget=traJq(el);if(tipTarget.length==0){return}tipTarget[0].onmouseover=function(event){toolTipQ[0].innerHTML=traJq("#"+this.id+"-tip")[0].innerHTML;var h=toolTipQ.height();var ol=5;var ot=22;var main=(traJq(this).closest("#TTmainContent")[0])?true:false;if(!main){ot=0}if(toolTipQ[0].style.display!="block"){toolTipQ[0].style.display="block";var left=this.parentNode.offsetLeft+ol;var top=this.parentNode.offsetTop+2;var right="auto";toolTipQ.css({left:left,right:right,top:top,width:"300px"})}}}function connectWithFacebook(e,options){if(typeof options=="undefined"||!options){options={}}var linkParam=options.link?"&link=true":"";var photoParam=options.photo?"&photo=true":"";var postParam=options.post?"&post=true":"";var regSource="&regSource="+(options.regSource?options.regSource:TurnTo.regSourceTra);var svisitParams=TurnToTrack.makeVisitorPartsQS(TurnToTrack.getVisitorParts());var ttFbUrl=getUrl("/traServer4/connectWithFacebook?siteKey="+S.siteKey+linkParam+svisitParams+photoParam+postParam+regSource);if(TurnTo.fbConnectPopupInterval){clearInterval(TurnTo.fbConnectPopupInterval)}if(TurnTo.fbwin!=null&&!TurnTo.fbwin.closed){TurnTo.fbwin.location.href=ttFbUrl}else{TurnTo.fbwin=openConnectWindow(ttFbUrl)}TurnTo.fbConnectPopupInterval=setInterval(function(){fbConnectPopupIntervalFn(options)},500);stopDefault(e)}function openConnectWindow(ttFbUrl){return window.open(ttFbUrl,"ConnectWithFacebook","height=550,width=650,status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1")}function fbConnectPopupIntervalFn(options){if(TurnTo.fbwin.closed){if(options.showSubSpinner){insertScreen("#TTSubScreen",TurnToHTML.subSpinScreen,{description:options.subSpinnerDes})}clearInterval(TurnTo.fbConnectPopupInterval);if(!options.keepSubwindow){toggleSubWindow("none")}getTraInitData(function(data,ioargs){if(!options.noMatchesShow){getMatchesLoaded(data,ioargs)}else{TurnTo.traDataLoaded=false;if(!setUserState(data,ioargs)){return}else{insertYouBadge(TurnTo.jQcontext2);insertModerateLink(TurnTo.jQcontext2,"answer");disableVotingForOwner(TurnTo.jQcontext2)}}if(options.onConnectClose){options.onConnectClose()}else{if(TurnTo.matchData.newfbuser){TurnTo.newfbuserExitFlow=true}}},options)}}function getFbPostToWallGranted(callback){xhr("GET",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/getFbPostToWallGranted"),contentType:"text/text",load:function(data,ioargs){if(data.errors){}else{TurnTo.matchData.user.fbPostToWallGranted=data.fbPostToWallGranted}if(callback){callback()}},error:function(data,ioargs){var message="getFbPostToWallGranted XHR - Status: "+data.status+" Error: "+data.error}})}function getImportHistory(callback){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/getImportHistory"),contentType:"text/text",load:function(data,ioargs){if(data.errors){}else{if(data.importHistory){TurnTo.matchData.importHistory=data.importHistory;TurnTo.matchData.totalFriends=data.totalFriends}}if(callback){callback()}}})}function userHasEmail(){if(!TurnTo.matchData||!TurnTo.matchData.user){return false}for(var pi=0;pi<TurnTo.matchData.user.uIdents.length;pi++){if(TurnTo.matchData.user.uIdents[pi].type==1){return true}}return false}function inputFocus(inputEl,callback){if(inputEl.ttInputClicked){return}var inputElJQ=TurnTojQuery(inputEl);var isPassword=inputElJQ.attr("type")=="password";var passwordPair=inputElJQ.attr("ttPasswordPair");if(!isPassword&&passwordPair){var pf=TurnTojQuery("#"+passwordPair);inputElJQ.hide();pf.show();pf.focus();if(callback){callback(inputElJQ)}return}inputElJQ.removeClass("TTdefaultInput");inputEl.value="";inputEl.ttInputClicked=true;if(callback){callback(inputElJQ)}}function inputLoseFocus(inputEl,callback){inputEl.value=TurnTojQuery.trim(inputEl.value);if(inputEl.value!=""){return}var inputElJQ=TurnTojQuery(inputEl);var isPassword=inputElJQ.attr("type")=="password";var passwordPair=inputElJQ.attr("ttPasswordPair");if(isPassword){var textPairEl=TurnTojQuery("#"+passwordPair);inputElJQ.hide();textPairEl.show();if(callback){callback(inputElJQ)}return}inputEl.value=inputElJQ.attr("ttInputLabelText");inputElJQ.addClass("TTdefaultInput");inputEl.ttInputClicked=false;if(callback){callback(inputElJQ)}}function startPostPurchaseFlow(turnToFeed){if(onMobile&&!S.embedCommentCapture){return}TurnTo.postPurchaseFlowStarted=true;TurnTo.turnToFeed=turnToFeed;if(!TurnTo.params.turntoflow){TurnTo.params.turntoflow="orderconf"}getItems4Conf(turnToFeed,function(){displayManagePastPurchases()})}function displayManagePastPurchases(){if(TurnTo.matchData.items4Conf&&TurnTo.matchData.items4Conf.length>0){setupCommentCapture()}}function getItems4Conf(turnToFeed,callbackF){TurnTo.error=null;var identString="";if(turnToFeed.email){identString+="&email="+encodeURIComponent(turnToFeed.email)}if(turnToFeed.userId){identString+="&externalUserId="+encodeURIComponent(turnToFeed.userId)}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getItems4Conf")+"&cid="+cid+"&sig="+turnToFeed.sig+"&orderId="+turnToFeed.orderId+identString,load:function(data,ioArgs){TurnTo.matchData.items4Conf=data.items;TurnTo.matchData.allTargets=data.allTargets;TurnTo.matchData.siteUser=data.siteUser;if(turnToFeed.serviceForJsFeedDetailsByApi&&TurnTo.matchData.siteUser){turnToFeed.email=TurnTo.matchData.siteUser.email}if(data.user||TurnTo.matchData.user){if(data.user){TurnTo.matchData.user=data.user;showHiInHeader()}TurnTo.matchData.user.items=data.items;TurnTo.matchData.user.raveTargets=data.raveTargets;TurnTo.matchData.user.siteSharing=data.siteSharing}if(data.logoutUser){TurnTo.matchData.user=null}if(callbackF){callbackF()}},error:function(data,ioArgs){var message="getItems4Conf XHR - Status: "+data.status+" Error: "+data.error}})}function getItems4Pte(eml,tri,iuid,callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/getItems4Pte")+"&cid="+cid+"&eml="+eml+(tri?"&tri="+tri:"")+(iuid?"&iuid="+iuid:""),load:function(data,ioArgs){TurnTo.matchData.items4Conf=data.items;TurnTo.matchData.siteUser=data.siteUser;TurnTo.matchData.invitor=data.invitor;if(data.user||TurnTo.matchData.user){if(data.user){TurnTo.matchData.user=data.user;showHiInHeader()}TurnTo.matchData.user.items=data.items;TurnTo.matchData.user.raveTargets=data.raveTargets;TurnTo.matchData.user.siteSharing=data.siteSharing}if(data.logoutUser){TurnTo.matchData.user=null}if(callbackF){callbackF()}},error:function(data,ioArgs){var message="getItems4Pte XHR - Status: "+data.status+" Error: "+data.error}})}TurnTo.registerAndLogin=registerAndLogin;function registerAndLogin(callbackF){TurnTo.error=null;var p={};if(TurnTo.turnToFeed){if(TurnTo.turnToFeed.email){p.email=TurnTo.turnToFeed.email}if(TurnTo.turnToFeed.userId){p.externalUserId=TurnTo.turnToFeed.userId}p.orderId=TurnTo.turnToFeed.orderId;p.sig=TurnTo.turnToFeed.sig}else{if(TurnTo.answerData){p.email=TurnTo.answerData.answerer.email;if(TurnTo.answerData.answerer.passwd){p.passwd=TurnTo.answerData.answerer.passwd}if(TurnTo.answerData.answerer.externalUserId){p.externalUserId=TurnTo.answerData.answerer.externalUserId}}else{if(turntoflowIsReviewOrRebelmail()&&TurnTo.writeReviewInitData){p.eml=TurnTo.writeReviewInitData.reviewer.eml;if(TurnTo.writeReviewInitData.cosId){p.cosId=TurnTo.writeReviewInitData.cosId}}else{if(turntoflowIsReviewOrRebelmail()&&TurnTo.params.reviewStartAction=="shareAPhoto"){p.eml=TurnTo.initShareMedia.eml;if(TurnTo.initShareMedia.cosId){p.cosId=TurnTo.initShareMedia.cosId}}}}}if(TurnTo.params.turntoflow){p.flow=TurnTo.params.turntoflow}xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer4/registerAndLogin"),postData:toJson(p),contentType:"text/text",load:function(data,ioargs){TurnTo.matchData.newUser=data.newUser;TurnTo.matchData.user=data.user;showHiInHeader();if(data.newUser){TurnToTrack.newUserRegistration(TurnTo.matchData.user.id)}TurnTo.matchData.user.items=TurnTo.matchData.items4Conf;TurnTo.matchData.counts={userItems:999};setLocalLoginCookie(data);setModeratorCookie(data);callbackF.call()},error:function(data,ioargs){var message="registerAndLogin XHR - Status: "+data.status+" Error: "+data.error}})}function closeOrderConfPurchases(){TurnTo.exitWidgetStarted=true;TurnTo.postPurchaseFlowStarted=false;TurnTo.pteFlowStarted=false;TurnTo.noSharingPrefExitFlow=false;toggleMainWindow("block");toggleSubWindow("none");TurnTojQuery("#TTtraWindow").css("height","auto");traJq("#TTtraUserStateMain").show();traJq("#TTtraSubWindow").css({top:75+"px"})}function getIdentIndexInUser(ident){if(TurnTo.matchData.user&&TurnTo.matchData.user.uIdents){for(var i=0;i<TurnTo.matchData.user.uIdents.length;i++){if(TurnTo.matchData.user.uIdents[i].ident==ident){return i}}}return -1}function getParameters(){var vars=[],name,value;if(window.location.href.indexOf("?")>0){var hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var i=0;i<hashes.length;i++){name=hashes[i].substring(0,hashes[i].indexOf("="));value=hashes[i].substring(hashes[i].indexOf("=")+1);vars.push(name);vars[name]=value}}return vars}function containsQuestionMark(content){return content.search(/[?]/im)!=-1}function is_child_of(parent,child){if(child!=null){while(child.parentNode){if((child=child.parentNode)==parent){return true}}}return false}function fixOnMouseOut(element,boxElement,event){if(!event){event=window.event}var current_mouse_target=null;if(event.toElement){current_mouse_target=event.toElement}else{if(event.relatedTarget){current_mouse_target=event.relatedTarget}}if(!is_child_of(element,current_mouse_target)&&element!=current_mouse_target){boxElement.style.display="none"}}function getText(u,F,E){TurnTo.error=null;staticXhr("GET",{handleAs:"text",iframeProxyUrl:TurnTo.iframeProxyUrl,url:u,load:function(data,ioArgs){F(data,ioArgs)},error:function(data,ioArgs){if(E){E(data,ioArgs)}}})}var instAnsSearchRunning=false;var instAnsSearchAgain=false;var instantAnswerCount=0;var instAnsTimer;function instantanswers(inputElem,params){if(inputElem.attr("nosearch")){return}var term=inputElem.val();TurnTojQuery("#TT4inlineSqv"+(params.fromQA?"Q":"R")).hide();if(params.fromQA){traJqC(".TTsqvBorder").hide()}else{traJqR(".TTsqvBorder").hide()}var delay=((term.length%5)==0)?1:500;clearTimeout(instAnsTimer);if(params.fromReviews){insertReviewSearchLoading(params)}else{insertSearchLoading(params)}instAnsTimer=setTimeout(function(){instantAnswerSearch(inputElem,params)},delay)}function instAnsView(id,ugcType,params,cb){params.logClick=true;if(ugcType=="q"){params.qid=id;showInlineSoloQuestionViewWidget(params,cb)}else{if(ugcType=="k"){params.said=id;showInlineSoloArticleViewWidget(params,cb)}else{if(ugcType=="ir"){params.irid=id;showInlineSoloReviewViewWidget(params,cb)}}}questionAskedOrInstantResultClick()}function insertInstantAnswers(rslt,params){var elId=params.fromQA?"TurnToContent":"TurnToReviewsContent";var container=TurnTojQuery("#"+elId);var postfix=params.fromQA?"Q":"R";var iaDiv=container.find("#TT4instantAnswers"+postfix);var wasHidden=!iaDiv.is(":visible");container.find("#TTsuggestedQs").hide();container.find("#TTreviewsWrapper").hide();var itemCnt=rslt.items.length;if(params.fromQA){var qSection=container.find("#TT2questionSection");var askMsg=qSection.find(".TT4askQ");var html='<div class="TT4askQ">';container.find("#TTaskArea .TT4startTyping").hide();container.find("#TT4questionTextHelpCnt").hide();var reviseText=msg("tra.instantAnsResults.reviseSearch")+" ";var resultCountText="";if(itemCnt>0){resultCountText=msg("tra.instantAnsResults.resultsCount."+getPlural(itemCnt),[itemCnt]);reviseText=msg("tra.instantAnsResults.notWhatLookingFor")+" "}else{resultCountText=S.instantAnswerNoResultsMsg}html+='<div id="TT4askQResultsLine" class="TT-ui-helper-clearfix">';html+='<span class="TTinstAnsresultCountText">'+resultCountText+"</span>";html+='<input id="TT4instAnswNext" class="TT4instAnswNext TTrespDesktopDisp" style="float:right" type="button" value="">';html+='<span class="TTinstAnsReviseText TTrespDesktopDisp">'+reviseText+"</span>";html+='<input id="TT4instAnswNext" class="TT4instAnswNext TTrespMobileDisp" style="float:right;" type="button" value="">';html+="</div>";html+='<div class="TT4iaSection"></div></div>';askMsg.length==0?qSection.append(html):askMsg.replaceWith(html);addTextToButtons();iaDiv=container.find("#TT2questionSection .TT4askQ .TT4iaSection");TurnTojQuery("#TT2questionSection .TT4askQ .TT4iaSection").append(TurnToHTML.instantAnswersResults({rs:rslt,iaRsltCount:itemCnt,truncateFn:truncate,fromQA:params.fromQA,fromReviews:params.fromReviews,postfix:postfix}))}else{insertScreen(iaDiv,TurnToHTML.instantAnswersResults,{rs:rslt,iaRsltCount:itemCnt,truncateFn:truncate,fromQA:params.fromQA,fromReviews:params.fromReviews,postfix:postfix,noResultText:S.instantAnswerNoResultsMsg})}var showMoreDiv=container.find("#TT3iaShowMore"+postfix);if(itemCnt>S.iaExpandCnt){var numToShow=itemCnt-S.iaExpandCnt;showMoreDiv.show().find("span").html(msg("tra.instantAnsResults.showMore."+getPlural(numToShow),[numToShow]));showMoreDiv.children("a").click(function(){iaDiv.find(".TT3questBorder").show();showMoreDiv.hide()})}else{showMoreDiv.hide()}container.find("#TT4instAnswNext").click(function(){iaDiv.empty().hide();container.find("#TT2questionSection .TT4askQ").hide();traJq(this).parent().hide();container.find("#TT2questionText").attr("nosearch",true);expandAndFadeIn(container.find("#TTaskExpand"));container.find("#TT2questionText").focus();container.find(".TT4QhintCenter").html(S.submitQuestionReviewMsg)});if(wasHidden){expandAndFadeIn(iaDiv)}iaDiv.find(".TT3itemBox").each(function(i){this.onclick=function(){var jThis=traJqC(this);var oldFunc=this.onclick;this.onclick=null;instAnsView(jThis.attr("id"),jThis.attr("ugctype"),params,function(){jThis[0].onclick=oldFunc;runClientCallbackFunc("instantClick")})}})}function expandAndFadeIn(jqElmnt){jqElmnt.css({opacity:"0"}).slideDown({duration:400,complete:function(){jqElmnt.animate({opacity:"1"},500)}})}function showByExpanding(jqElmnt,cb){jqElmnt.slideDown({duration:400,complete:function(){if(cb){cb()}}})}function hideBySlidingUp(jqElmnt,cb){jqElmnt.slideUp({duration:400,complete:function(){if(cb){cb()}}})}function fadeToWhite(el,b,i){if(b>=0){bl=b;if(bl>255){bl=255;b=-(i+1)}el.css("background-color","rgb(255, 255, "+(bl)+")");setTimeout(function(){fadeToWhite(el,b+=i,i)},100)}}function isMobileDevice(){if(S.forceMobile){return true}var uAgent=navigator.userAgent;if(uAgent&&uAgent.match(/iPad/i)!=null){return false}if(screen.width<=736){return true}else{if(screen.width<=1280&&Math.abs(window.orientation)==90){return true}else{if(screen.width==1080&&screen.height==1920&&window.orientation==0){return true}else{if(screen.width==1920&&screen.height==1080&&Math.abs(window.orientation)==90){return true}}}}return false}var qaSessionId=null;function instantAnswerSearch(inputElem,params){if(inputElem.attr("nosearch")){return}var postfix=params.fromQA?"Q":"R";var searchTerm=inputElem.val();if(searchTerm==="/diag"){TurnTo.diagnostics.showDevDiag()}if(TurnTojQuery.trim(searchTerm).length==0||inputElem.hasClass("TTdefaultInput")){TurnTojQuery("#TTaskArea .TT4startTyping").show();traJqC("#TT4instantAnswers"+postfix).hide();var container=TurnTojQuery("#TT2questionSection");container.find(".TT4askQ").hide();return}if(instAnsSearchRunning){instAnsSearchAgain=true;return}instAnsSearchRunning=true;insertSearchLoading(params);xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer4/instantAnswersSearch")+(qaSessionId?"&qaSessionId="+qaSessionId:""),postData:toJson({searchTerm:searchTerm,sku:TurnToItemSku,categoryIds:typeof TurnToItemGroupIds!="undefined"?TurnToItemGroupIds:[],brand:typeof TurnToCatItemBrand!="undefined"?TurnToCatItemBrand:"",isCategory:TurnToCatItemType==2}),contentType:"text/text",timeout:5000,load:function(data,ioArgs){if(data.qaSessionId){qaSessionId=data.qaSessionId;TurnToTrack.visitSearchRun()}instAnsSearchRunning=false;if(inputElem.attr("nosearch")){instAnsSearchAgain=false;return}if(instAnsSearchAgain){instAnsSearchAgain=false;instantAnswerSearch(inputElem,params)}else{if(!TurnTojQuery("#TT4inlineSqv"+postfix).is(":visible")){insertInstantAnswers(data,params)}}},error:function(data,ioArgs){insertInstantAnswers({items:[]},params);instAnsSearchRunning=false;instAnsSearchAgain=false}})}var SEARCH_LOADING_HTML='<div class="TT4askQ"><img class="TT4searchLoading" src="'+TurnTo.getStaticUrl("/images/spinner.gif")+'" alt="'+msg("tra.commom.alt.loading")+'"/></div>';function insertSearchLoading(params){if(!params.fromQA){return}var container=TurnTojQuery("#TurnToContent");if(container.find("#TT2questionSection .TT4askQ .TT4searchLoading").length>0){return}var qCnt=container.find("#TT2questionSection");var askMsg=qCnt.find(".TT4askQ");askMsg.length==0?qCnt.append(SEARCH_LOADING_HTML):askMsg.replaceWith(SEARCH_LOADING_HTML)}function insertReviewSearchLoading(params){if(!params.fromReviews){return}var container=TurnTojQuery("#TurnToReviewsContent");var qCnt=container.find("#TT4instantAnswersR");if(qCnt.find(".TT4searchLoading").length>0){return}qCnt.show();qCnt.find("#TT4iaResultsR").empty().hide();var askMsg=qCnt.find(".TT4instAnsUL");askMsg.length==0?qCnt.append(SEARCH_LOADING_HTML):askMsg.replaceWith(SEARCH_LOADING_HTML)}function insertJsonLDMetadata(){if(!TurnTo.matchData.site.jsonLdMetadata||!TurnToItemSku){return}TurnTojQuery.ajax({url:getStaticUrl("/sitedata/"+S.siteKey+"/v4_3/"+TurnToItemSku+"/d/jsonld"),dataType:"script",cache:true})}function doNothing(){}function isWidgetOpen(){return TurnTojQuery("#TTtraWindow").is(":visible")}var forceCustomSerializer=S.useCustomSerializerForIE&&typeof TurnToSerializer!="undefined";function isIE(){var userAgent=navigator.userAgent;if(!userAgent){return false}return userAgent.indexOf("MSIE ")>-1||userAgent.indexOf("Trident/")>-1}var ELEMS_TO_MESSAGE={".TT4instAnswNext":"tra.qa.button.submitNewQuestion",".TTsqvForward":"tra.qa.button.forward",".TTsqvBack":"tra.qa.button.back",".TT3answerBtn":"tra.qa.answer.button.submit",".TT3searchBtn":"tra.qa.button.search",".TTdoneBtn":"tra.qa.button.done",".TTbigSubmitBtn":"tra.qa.button.submit","#TT3questCancelBtn":"tra.qa.button.cancelSubmitQuestion","#TT2askOwnersBtn":"tra.qa.button.submit","#TT3updateButton":"tra.settings.button.update","#closePhotoButton":"tra.settings.changePhoto.button.cancel","#savePhotoButton":"tra.settings.changePhoto.button.save","#TT2acceptDup":"tra.qa.button.submitDuplicate.accept","#TT2cancelDup":"tra.qa.button.submitDuplicate.cancel","#TT2ppCloseBtn":"tra.qa.sqv.button.close","#TT2answerBtn":"tra.qa.button.answer.submit","#TTregSubmit":"tra.reg.button.submit"};function addTextToButtons(){if(S.useTextForButtons){for(prop in ELEMS_TO_MESSAGE){var elem=TurnTojQuery(prop);if(elem.is("input")){elem.val(msg(ELEMS_TO_MESSAGE[prop]))}else{elem.html(msg(ELEMS_TO_MESSAGE[prop]))}}}}var REMOTE=getUrl("");ttXhr=new ttXDM.easyXDM.Rpc({local:S.localProxyUrl||"/turnto/turntoproxy.html",swf:REMOTE+"/tra4_3/xdm.swf",remote:REMOTE+"/tra4_3/cors/",remoteHelper:REMOTE+"/tra4_3/turntoproxy.html",lazy:true,hash:true},{remote:{request:{}},serializer:(forceCustomSerializer?TurnToSerializer:null)});var SREMOTE="https://"+S.host;ttSecureXhr=new ttXDM.easyXDM.Rpc({local:S.localProxyUrl||"/turnto/turntoproxy.html",swf:SREMOTE+"/tra4_3/xdm.swf",remote:SREMOTE+"/tra4_3/cors/",remoteHelper:SREMOTE+"/tra4_3/turntoproxy.html",lazy:true,hash:true},{remote:{request:{}},serializer:(forceCustomSerializer?TurnToSerializer:null)});var STATICREMOTE=getStaticUrl("");ttStaticXhr=new ttXDM.easyXDM.Rpc({local:S.localProxyUrl||"/turnto/turntoproxy.html",swf:STATICREMOTE+"/tra4_3/xdm.swf",remote:STATICREMOTE+"/tra4_3/cors/",remoteHelper:STATICREMOTE+"/tra4_3/turntoproxy.html",lazy:true,hash:true},{remote:{request:{}},serializer:(forceCustomSerializer?TurnToSerializer:null)})};TurnTo.init();TurnToMods.define("rateIt",["util"],function(E){var U=TurnTo.S;var R=TurnTo.msg;var P=TurnTojQuery;var I="#TTrateItScreen";var Z;var B;var K=0;var Q=null;var ab={};var O={};var aa=150;var F=1000;function M(c){B=c;K=0;Q=null;ab={};O={};var a=TurnTo.matchData.site.acceptedReviewsType==WRITE_REV_ONLY_PURCHASERS?U.visualContentRateItPromptForRatingWhenPurchaseRequired:U.visualContentRateItPromptForRatingWhenPurchaseNotRequired;var d=P("#TurnToMobileContent");d.find(I).remove();d.append(TurnToHTML.rateIt({initData:B,catItem:B.catalogItem,ratingPrompt:a}));Z=P(I);S();if(B.preSelectedRating>0){var b=P("#TToverallRatingStars.TTrateItStars li",Z);b.each(function(f,e){if(P(this).data("rating")==B.preSelectedRating){P(this).trigger("click")}})}W();J();X();if(B.rebelmailFormFields){G(B.rebelmailFormFields);N()}else{T("enabled",N)}if(B.showGuidelines){P("#TTwriteRevGuideLn",Z).click()}TurnToTrack.addCloseLinkMetrics(d,"TTrateIt")}function S(){P(".TTrateItStars li",Z).unbind("click.ttStar").bind("click.ttStar",function(){var c=P(this).closest(".TTformGroup").data("dim-id");var a=P(this).data("rating");if(c){var e=B.dimensionDefinitions.filter(function(f){return f.id==c})[0];var d=e.itemReviewDimensionValueDefinitions;var b=d.filter(function(f){return f.value==a})[0];ab[c]=b.id}else{K=a}P.each(P(this).parent().children(),function(){if(P(this).data("rating")<=a){P(this).removeClass("TTvc-star-lg-empty").addClass("TTvc-star-lg-filled")}else{P(this).removeClass("TTvc-star-lg-filled").addClass("TTvc-star-lg-empty")}});if(!c&&P.trim(P("textarea[name=title]",Z).val()).length>0){T("enabled",N)}})}function J(){P("#TTwriteRevGuideLn",Z).click(function(){var a=TurnTojQuery("#TTmobileWriteRevGuideLines");if(U.reviewGuidelines){a.html(U.reviewGuidelines)}else{TurnTo.insertScreen(a,TurnToHTML.reviewGuidelines,{})}a.slideDown(function(){TurnTojQuery("html,body").animate({scrollTop:a.offset().top})})})}function X(){var a=P(".TTformGroup[data-dim-id]",Z);P("label.TTradio",a).unbind("click").bind("click",function(){V(this,true)});P("label.TTmdCheckbox",a).unbind("click").bind("click",function(){V(this,true)});P("select",a).unbind("change").bind("change",function(){V(this)});P.each(P(".TTsliderCont",a),function(b,c){C(P(c))})}function C(e){if(!e.is(":visible")){setTimeout(function(){C(e)},F);return}var c=P(".TTsliderBar",e);var k=P(".TTsliderDot",e);var d=e.parent().data("dim-id");var h=B.dimensionDefinitions.filter(function(o){return o.id==d})[0];var i=h.itemReviewDimensionValueDefinitions;var g=k.outerWidth();var m=c.offset().left-(g/2);var a=c.width();var j=m+a;var b=a/(i.length-1);var n=[];for(var l=0;l<i.length;l++){var f=null;if(l==0){f=m}else{if(l==(i.length-1)){f=j}else{f=m+(a/(i.length-1)*l)}}n.push({id:i[l].id,x:f})}O[d]=n;k.bind("touchstart",function(o){var u=P(this).addClass("TTdraggable").removeClass("TTempty");var q=u.css("z-index"),p=u.outerHeight(),r=u.outerWidth(),t=u.offset().top+p-o.originalEvent.touches[0].pageY,s=u.offset().left+r-o.originalEvent.touches[0].pageX;u.css("z-index",1000).parents().bind("touchmove",function(w){var v=w.originalEvent.touches[0].pageX+s-r;v=v<m?m:v;v=v>j?j:v;P(".TTdraggable",e).offset({left:v})}).bind("touchcancel touchend",function(w){P(this).unbind("touchcancel touchend");u.css("z-index",q);var v=L(u.offset().left,n);P(".TTdraggable",e).offset({left:v.x});P(".TTdraggable",e).removeClass("TTdraggable");ab[d]=v.id});o.preventDefault()})}function L(f,d){var c=10000;var b=null;for(var e=0;e<d.length;e++){var a=Math.abs(f-d[e].x);if(a<c){b=d[e];c=a}}return b}function V(b,d){var a=P(b).closest(".TTformGroup");var c=a.data("dim-id");if(!d){ab[c]=P("input, select",a).val()}else{ab[c]=[];P.each(P("[name=TTcustDim-"+c+"]:checked",a),function(e,f){ab[c].push(P(f).val())})}}function G(a){P.each(a,function(e,c){if(e=="title"){P("textarea[name=title]").val(c)}else{if(e=="text"){P("textarea[name=text]").val(c)}else{if(e=="rating"){P("#TToverallRatingStars li:nth-child("+c+")").click()}else{if(e.indexOf("TTcustDim-")>-1){var d=P("#"+e);var b=d.data("dim-type");var f=d.find(".TTradio").length>0;if(b==1){d.find("li:nth-child("+c+")").click()}else{if(b==2&&!f){setTimeout(function(){var m=O[d.data("dim-id")];if(!m){return}var i=m.filter(function(n){return n.id==c});if(i.length==0){return}i=i[0];var h=d.find(".TTsliderDot");var j=h.offset().left+5;var l=h.offset().top+5;var k={touches:[{pageX:j,pageY:l}]};h.trigger(P.Event("touchstart",{originalEvent:k}));k.touches[0].pageX=i.x;h.trigger(P.Event("touchmove",{originalEvent:k}));h.trigger(P.Event("touchend"))},F+200)}else{if(b==3&&!f){d.find("select").val(c).change()}else{if(f||b==4){if(!P.isArray(c)){c=[c]}for(var g=0;g<c.length;g++){d.find("input[value="+c[g]+"]").click()}}}}}}}}}})}function D(m,k,f){m.profileDims=[];for(var l=0;l<B.profileAttrs.length;l++){var g=B.profileAttrs[l];if(g.collectDuringContentSubmit){var i=P("#TTprofileDim-"+g.id,Z);var e=P.trim(i.val());if(g.required&&e==""){var n="tra.rateIt.profileDim"+(g.type==0?"SelectErr":"FreeFormErr")+".blank";var d="profileDim"+g.id;k[d]=i;f.push({code:n,field:d});TurnToTrack.addErrorMetric("TTrateIt","profileDimOptError")}else{if(e!=""&&e!=i.attr("data-oldvalue")&&g.type==0){m.profileDims.push({dimDefId:g.id,dimValueId:e})}else{if(e!=""&&g.type==1){m.profileDims.push({dimDefId:g.id,dimValueId:g.values[0].id,dimFreeformText:e})}}}}}if(!B.shopperProfile.shopperCityStateHidden&&B.shopperProfile.cityStateCollectDuringContentSubmit){var o=P("#TTcity",Z).val();var a=P("#TTreviewCountry",Z).val();var j="#TTstate";if(a==="US"||a==="CA"){j=j+a}var c=P(j,Z).val();if(B.shopperProfile.cityStateRequired){if(o==""){f.push({code:"tra.wrev.error.city.blank",field:"city"});k.city=P("#TTcity",Z);TurnToTrack.addErrorMetric("TTrateIt","cityBlankError")}if(c==""){if(a=="US"){f.push({code:"tra.wrev.error.state.blank",field:"state"})}else{if(a=="CA"){f.push({code:"tra.wrev.error.province.blank",field:"state"})}else{f.push({code:"tra.wrev.error.stateother.blank",field:"state"})}}k.state=P(j,Z);TurnToTrack.addErrorMetric("TTrateIt","stateBlankError")}if(a==""){f.push({code:"tra.wrev.error.country.blank",field:"country"});k.country=P("#TTreviewCountry",Z);TurnToTrack.addErrorMetric("TTrateIt","countryBlankError")}}m.city=o;m.state=c;m.country=a}var b=B.shopperProfile;if(!b.shopperAgeRangeHidden&&b.ageRangeCollectDuringContentSubmit){var h=P("#TTreviewAge",Z).val();m.ageRange=h;if(b.ageRangeRequired&&h==""){f.push({code:"tra.wrev.error.age.blank",field:"age"});k.age=P("#TTreviewAge",Z);TurnToTrack.addErrorMetric("TTrateIt","ageBlankErrors")}}}function N(){Y("on");var g=[];var m={catItemId:B.catalogItem.id};var j={};m.rating=K;if(K==0){j.rating=P("#TToverallRatingStars");g.push({code:"tra.wrev.error.rating.blank",field:"rating"});TurnToTrack.addErrorMetric("TTrateIt","ratingBlankErrors")}var k=P("textarea[name=title]",Z);var h=P.trim(k.val());m.title=h;j.title=k;if(B.reviewTitleMandatory&&h.length==0){g.push({code:"tra.rateIt.titleErr.blank",field:"title"});TurnToTrack.addErrorMetric("TTrateIt","titleBlankErrors")}else{if(h.length>aa){g.push({code:"tra.rateIt.titleErr.max",field:"title"});TurnToTrack.addErrorMetric("TTrateIt","titleTooLongErrors")}}if(E.containsEmail(h)){g.push({code:"tra.common.textErr.emailNotAllowed",field:"title"});TurnToTrack.addErrorMetric("TTrateIt","titleEmailErrors")}if(E.containsPhoneNumber(h)){g.push({code:"tra.common.textErr.phoneNotAllowed",field:"title"});TurnToTrack.addErrorMetric("TTrateIt","titlePhoneErrors")}var o=P("textarea[name=text]",Z);var e=o.val();m.text=e;j.text=o;if(!e||e.length<TurnTo.matchData.site.reviewsMinLength){g.push({code:"tra.wrev.error.reviewBody.minLength",args:[TurnTo.matchData.site.reviewsMinLength],field:"text"});TurnToTrack.addErrorMetric("TTrateIt","reviewsMinLengthErrors")}if(e&&e.length>TurnTo.matchData.site.reviewsMaxLength){g.push({code:"tra.wrev.error.reviewBody.maxLength",field:"text"});TurnToTrack.addErrorMetric("TTrateIt","reviewsMaxLengthErrors")}if(E.containsEmail(e)){g.push({code:"tra.common.textErr.emailNotAllowed",field:"text"});TurnToTrack.addErrorMetric("TTrateIt","emailNotAllowedErrors")}if(E.containsPhoneNumber(e)){g.push({code:"tra.common.textErr.phoneNotAllowed",field:"text"});TurnToTrack.addErrorMetric("TTrateIt","phoneNotAllowedErrors")}m.customDimensionValues=ab;for(var l=0;l<B.dimensionDefinitions.length;l++){var n=B.dimensionDefinitions[l];if(n.required&&!ab[n.id]){var i=P(".TTformGroup[data-dim-id="+n.id+"]",Z);var f="dim"+n.id;j[f]=i;var b=n.type==1?"tra.rateIt.dimRatingErr.blank":"tra.rateIt.dimOptionErr.blank";g.push({code:b,field:f,append:true});TurnToTrack.addErrorMetric("TTrateIt","customDimRequiredErrors")}}D(m,j,g);if(B.showSweepstakesOptIn){var d=P("[name=TTsweepstakesOptIn]");if(d!=null&&d.length>0){m.sweepstakesOptIn=d[0].checked}}var c=function(q){if(q){H(q,j)}else{H([{code:"tra.common.error.unexpected"}],{})}Y("off",N)};if(g.length>0){c(g);return}var a=B.media;if(a){m.mediaIds=[];for(var l=0;l<a.length;l++){m.mediaIds.push(a[l].id)}}if(B.fromRse){m.fromRse=true}else{if(B.fromInline){m.fromInline=true}}if(B.transId){m.transId=B.transId}if(B.cosId&&B.cosTransId){m.cosId=B.cosId;m.cosTransId=B.cosTransId}m.rateIt=true;m.mobile=U.setupType=="mobileTT";if(TurnTo.deviceFingerprint){m.deviceFingerprint=TurnTo.deviceFingerprint}var p=function(){Y("on");TurnTo.xhr("POST",{iframeProxyUrl:TurnTo.getSecureIframeProxyUrl(),url:TurnTo.xhrUri("/traServer4/createReview",B.siblingSiteKey),postData:TurnTo.toJson(m),load:function(q,r){Q=q.id;var s={reviewId:Q,vcAttached:(m.mediaIds?m.mediaIds.length>0:false)};s.alreadyReviewed=q.alreadyReviewed==true?true:false;Z.trigger("ttRateIt.complete",[Q,s.alreadyReviewed]);TurnToTrack.trackScreenExited("TTrateIt","submit",s);TurnTo.runClientCallbackFunc("reviewSubmit")},error:function(q,r){c(q.errors);TurnToTrack.addErrorMetric("TTrateIt","submitErrors")}})};setTimeout(function(){Y("off",N)},2000);TurnTo.checkReviewAuthAndSubmit(p)}function H(a,g){for(var e=0;e<a.length;e++){var f=a[e].args?a[e].args:[];var c=a[e].code?R(a[e].code,f):a[e];var d='<div class="TTfieldErr">'+c+"</div>";if(a[e].field){var b=g[a[e].field];a[e].append?b.append(d):b.after(d)}else{P(".TTdivider",Z).after(d)}}P("html, body").animate({scrollTop:P("#TTrateIt .TTfieldErr").eq(0).closest(".TTformGroup").offset().top})}function Y(c,b){var d=P("textarea",Z);var a=P(".TTrateItSubmitBtns .TTimgLoading",Z);if(c=="on"){P(".TTfieldErr",Z).remove();T("disabled");a.show();d.attr("disabled","disabled");P(".TTrateItStars li",Z).unbind("click.ttStar")}else{T("enabled",b);a.hide();d.removeAttr("disabled");S()}}function T(a,b){var c=P("#TTrateItSubmitBtn",Z);if(a=="hidden"){c.hide()}else{c.show()}if(b&&a=="enabled"){c.addClass("TTvc-submit").removeClass("TTvc-submit-disabled").unbind("click").bind("click",b)}else{c.addClass("TTvc-submit-disabled").removeClass("TTvc-submit").unbind("click")}}function W(){var a=P(".TTskipLink",Z);if(B.startAction=="shareAPhoto"){a.show()}a.bind("click",function(){Z.trigger("ttRateIt.cancelled");TurnToTrack.trackScreenExited("TTrateIt","skipped/no thanks")})}return{display:M}});

/* TurnTo tra.v4.3.10845 /trunk.rev.10845 Mon Mar 14 08:19:56 PDT 2016 (c) 2015, TurnTo Networks, Inc. http://www.turnto.com/tra4/licenses.html */TurnToMods.define("fileUpload",[],function(){var l;var p;var c=(10*1024*1024);var i;var e;var k;var n;var g;var a;var j=TurnTojQuery;function o(q){n=q.uploadForm;l=q.acceptedMimeTypes;if(l){p=j.map(l,function(r){return r.substring(r.indexOf("/")+1)})}c=q.maxFileSize?q.maxFileSize:c;i=parseInt(c/(1024*1024));g=j("input[name=TTimgFile]",n);k=q.dropArea;e=q.bindingElem?q.bindingElem:document;if(!q.onMobile){}h();f()}function f(){if(a){return}var q=TurnTo.getUrl("");a=new TurnTo.ttXDM.easyXDM.Rpc({swf:q+"/tra4_3/xdm.swf",remote:q+"/tra4_3/cors/upload.html",},{local:{returnUploadResponse:function(r){if(r&&r.uploaded){e.trigger("ttFileUpload.complete",[r.uploaded])}if(r&&r.errors&&r.errors.length>0){e.trigger("ttFileUpload.fail",[r.errors])}g.val("");g.show();j("input[name=uploadData]",n).val("")}}})}function m(){return window.File&&window.FileList&&window.FileReader}function h(){g.unbind("change").bind("change",function(q){g.hide();b()})}function b(){var x=(new Date()).getTime();var s=[];var y=[];var w=[];var u=g.get(0);if(u.files&&u.files.length>1){for(var v=0;v<u.files.length;++v){var t=u.files.item(v);var r=x+"-"+v;if(!d(t)){w.push({errorCode:"invalidFileType"});break}else{if(t.size>c){w.push({errorCode:"maxFileSize",args:[i]})}else{s.push({uploadId:r,file:t,name:t.name});y.push({uploadId:r,name:t.name,size:t.size})}}}}else{var q=g.val();if(q==""){return}q=q.substring(q.lastIndexOf("\\")+1);var t=u.files?u.files.item(v):null;if(!d(t,q)){w.push({errorCode:"invalidFileType"})}else{if(t&&t.size>c){w.push({errorCode:"maxFileSize",args:[i]})}else{s.push({uploadId:x,file:t,name:q});y.push({uploadId:x})}}}if(w.length>0){e.trigger("ttFileUpload.fail",[w]);g.show();return}j("input[name=uploadData]",n).val(JSON.stringify(y));n.attr("action",TurnTo.getUrl("/traServer4/uploadTmpImages"));e.trigger("ttFileUpload.start",[s]);n.submit()}function d(q,s){if(!l){return true}if(q){return j.inArray(q.type,l)>-1}else{if(s&&s.indexOf(".")>-1){var r=s.toLowerCase().substring(s.lastIndexOf(".")+1);return j.inArray(r,p)>-1}}return false}return{init:o}});
/*
checksum:
cb8b926c3f11a70da4ddef70d93bdb99
*/

/* TurnTo tra.v4.3.10650 /trunk.rev.10650 Wed Feb 10 10:01:38 PST 2016 (c) 2015, TurnTo Networks, Inc. http://www.turnto.com/tra4/licenses.html */TurnToMods.define("imageUtil",["browserUtil"],function(f){var e=TurnTo.S,g=TurnTojQuery,a=console&&e.devMode;function l(z,u,r,y){var t=z/u;var A=r/y;var q=r;var x=y;if(z<=r&&u<=y){q=z;x=u}else{if(t<A){q=Math.floor(y*t)}else{x=Math.floor(r/t)}}var v=x>y?-Math.floor((x-y)/2):Math.floor((y-x)/2);var s=q>r?-Math.floor((q-r)/2):Math.floor((r-q)/2);return{width:q,height:x,top:v,left:s}}function o(q,t,x,r){var y=x;var s=r;if(q>t&&t>=r){y=Math.floor((q/t)*x)}else{if(t>q&&q>x){s=Math.floor((t/q)*r)}else{if(q<x||t<r){y=q;s=t}}}var v=s>r?-Math.floor((s-r)/2):Math.floor((r-s)/2);var u=y>x?-Math.floor((y-x)/2):Math.floor((x-y)/2);return{width:y,height:s,top:v,left:u}}function k(q,t,s){var u=null;if(s.format=="PZ"){u=o(q,t,s.size,s.size)}else{if(s.format=="L"){u=l(q,t,s.size,s.size)}else{if(s.format=="LH"){u=l(q,t,s.maxW,s.h)}}}var r="";g.each(u,function(x,w){if(u.hasOwnProperty(x)){r+=x+":"+w+"px;"}});return r}TurnTo.getMediaImg=d;function d(s,E,F,D){D=D||"";var z=i(E);var A=s.width;var v=s.height;var q="";if(s.type=="photo"){q=TurnTo.partnerProtocol+"//"+e.imageStoreBase;var t="/"+s.imageId;if(s.imageProcessed==1){q+="/media/"+e.siteKey;if(z.format=="PZ"||z.format=="L"){var u=z.size*2;if(s.width>=u&&s.height>=u){if(z.format=="PZ"&&u<=320){t+="_PZ320";A=320;v=320}else{var y=1000;if(u<=560){y=560}t+="_L"+y;var C=s.width/s.height;A=s.width>s.height?Math.floor(y/2*C):y/2;v=s.height>s.width?Math.floor(y/2/C):y/2}}}else{if(z.format=="LH"){if(z.h<=360){t+="_LH720";if(s.height>360){v=360;var x=360/s.height;A=Math.floor(s.width*x)}else{if(s.width>640){A=640;var x=640/s.width;v=Math.floor(s.height*x)}}}}}}else{q+="/media/temp";if(s.orientation&&s.orientation!=1){if(!f.isIOS){var r="TTorientation-"+s.orientation;F=F?F+" "+r:r}else{if(h(s.orientation)){A=s.height;v=s.width}}}}q+=(t+"."+s.imageType)}else{q=s.thumbnailUrl}D+=k(A,v,z);var B='<img src="'+q+'"';B+=s.caption?' alt="'+s.caption+'"':"";B+=F?' class="'+F+'"':"";B+=D?' style="'+D+'"':"";B+=">";return B}function i(q){var s=(q?q:"PZ-64").split("-");var r={format:s[0]};if(r.format=="PZ"||r.format=="L"){r.size=parseInt(s[1])}else{if(r.format=="LH"){r.maxW=parseInt(s[1]);r.h=parseInt(s[2])}}return r}TurnTo.adjustVideoSize=p;function p(u,t,r,A,x){var v=TurnTojQuery(u);var s=v.attr("width");var y=v.attr("height");if(!t){var w=r/y;t=Math.round(w*s)}else{if(!r){var w=t/s;r=Math.round(w*y)}}if(A){var q=A-t;if(q>0){v.css("margin-left",Math.floor(q/2)+"px")}}if(x){var q=x-r;if(q>0){v.css("margin-top",Math.floor(q/2)+"px")}}v.attr({width:t,height:r});var z=TurnTojQuery("<div></div>");z.append(v);return z.html()}function h(q){return g.inArray(q,[5,6,7,8])!==-1}function c(u){var A=new DataView(u);if(a){console.log("Got file of length "+u.byteLength)}var r=m(A,u.byteLength);if(r==false||r==-1){return false}if(b(A,r,4)!="Exif"){if(a){console.log("Not valid EXIF data! "+b(A,r,4))}return false}var x,C,D,t,s,z=r+6;if(A.getUint16(z)==18761){x=false}else{if(A.getUint16(z)==19789){x=true}else{if(a){console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)")}return false}}if(A.getUint16(z+2,!x)!=42){if(a){console.log("Not valid TIFF data! (no 0x002A)")}return false}var q=A.getUint32(z+4,!x);if(q<8){if(a){console.log("Not valid TIFF data! (First offset less than 8)",A.getUint32(z+4,!x))}return false}var B=z+q;var w=A.getUint16(B,!x),y,v;for(v=0;v<w;v++){y=B+v*12+2;if(A.getUint16(y,!x)==274){return j(A,y,z,B,x)}}return -1}function m(t,r){if((t.getUint8(0)!=255)||(t.getUint8(1)!=216)){if(a){console.log("Not a valid JPEG")}return false}var s=2,q;while(s<r){if(t.getUint8(s)!=255){if(a){console.log("Not a valid marker at offset "+s+", found: "+t.getUint8(s))}return false}q=t.getUint8(s+1);if(q==225){if(a){console.log("Found 0xFFE1 marker")}return(s+4)}else{s+=2+t.getUint16(s+2)}}return -1}function j(t,w,z,A,v){var y=t.getUint32(w+4,!v),q=t.getUint32(w+8,!v)+z,u,x,s,r;if(y==1){return t.getUint16(w+8,!v)}else{u=y>2?q:(w+8);x=[];for(r=0;r<y;r++){x[r]=t.getUint16(u+2*r,!v)}return x}}function b(r,t,s){var q="";for(n=t;n<t+s;n++){q+=String.fromCharCode(r.getUint8(n))}return q}return{getMediaImg:d,getPanZoomCss:o,getLetterboxCss:l,getOrientation:c,isRotated:h,adjustVideoSize:p}});
/*
checksum:
d337dd690155ba3a3083c633af14e4b2
*/

/* TurnTo tra.v4.3.34aa0b28f6c497255f16ff7c8eeb7ca425379485 master.34aa0b28f6c497255f16ff7c8eeb7ca425379485 Mon Sep 18 10:59:47 PDT 2017 (c) 2017, TurnTo Networks, Inc. http://www.turnto.com/tra4/licenses.html */TurnToMods.define("jsonp",[],function(){var a=TurnToBoot.getTurnToConfig();var c;if(typeof TurnToPinboard!=="undefined"){c=TurnToPinboard.$}else{if(typeof TurnToGallery!=="undefined"){c=TurnToGallery.$}else{if(typeof TurnToPinboardTeaser!=="undefined"){c=TurnToPinboardTeaser.$}else{c=TurnTojQuery}}}function d(g,f,h){if(f==null){f={}}f.jsonpCallback=h;f.crossDomain=true;f.dataType="jsonp";var e="//"+a.staticHost+g;if(e.indexOf("?")==-1){e+="?"}else{e+="&"}e+="callback=?";return c.ajax(e,f)}function b(g,f,h){if(f==null){f={}}f.jsonpCallback=h;f.crossDomain=true;f.dataType="jsonp";var e="//"+a.host+g;if(e.indexOf("?")==-1){e+="?"}else{e+="&"}e+="callback=?";return c.ajax(e,f)}return{staticAjax:d,ajax:b}});
/*
checksum:
d87b25e54f15f3cc24e611acd6fb03e7
*/

/* TurnTo tra.v4.3.34aa0b28f6c497255f16ff7c8eeb7ca425379485 master.34aa0b28f6c497255f16ff7c8eeb7ca425379485 Mon Sep 18 10:59:47 PDT 2017 (c) 2017, TurnTo Networks, Inc. http://www.turnto.com/tra4/licenses.html */TurnToMods.define("mediaModal",["browserUtil","jsonp","msg"],function(W,q,V){var D="TT-vc-modal-overlay",am="#"+D,ah,K="TT-vc-modal",ai,Z="TT-vc-modal-container",al="#"+Z,N,U={},E=[],g,h=0,af,Q=false,P=false,L=false,aj=1600,aa=1000,r=0.9,ak=0.9,d=0.96,v=480,R,T=150,j=TurnToBoot.getTurnToConfig(),J;j.imageStoreBase=j.imageStoreBase||"wac.edgecastcdn.net/001A39/prod";var c="//"+j.imageStoreBase+"/item/"+j.siteKey+"/";var p=j.host||"www.turnto.com";if(typeof TurnToPinboard!=="undefined"){J=TurnToPinboard.$}else{if(typeof TurnToGallery!=="undefined"){J=TurnToGallery.$}else{if(typeof TurnToPinboardTeaser!=="undefined"){J=TurnToPinboardTeaser.$}else{J=TurnTojQuery}}}function C(an){U=an;h=an.mediaIndex||an.mediaIndex===0?an.mediaIndex:null;P=false;preloadCheck=false;E=[];R=null;g=W.isMobileDevice();var S=J("body");S.find(am).remove();S.find(al).remove();S.append('<div id="'+D+'"></div>');S.append('<div id="'+Z+'"></div>');ah=J(am);N=J(al);i();N.html(TTMediaModalHTML.spinner({staticHost:j.staticHost,msgMod:V}));N.find(".TT-spinner").css({position:"absolute",top:(N.height()/2)-16,left:(N.width()/2)-16}).show();N.append('<div id="'+K+'" data-index=""></div>');ai=J("#"+K);J(am).bind("click",X);N.show();ag().then(function(ao,ar){if(!h&&h!==0){h=w(U.mediaId)}ai.html(TTMediaModalHTML.mediaModal({msgMod:V,staticHost:j.staticHost}));var ap=0,aq=J("#TT-vc-modal",N);cssLoadedCheckInterval=setInterval(function(){if(ap>=30){clearInterval(cssLoadedCheckInterval);typeof console!==undefined?console.error("CSS for modal not loadeded"):"";X();return}ap++;if(aq.height()>0){clearInterval(cssLoadedCheckInterval);A(aq)}},250);Y();ae()},function(){}).then(function(){if(Q&&h+3>=af){ag()}})}function A(){N.find(".TT-spinner").remove();if(B()<v){var S=ai.find(".TT-vc-carousel__media-block");S.height(S.width())}if(B()>=v){J(".TT-vc-modal__info").height(N.height())}f(h);e();z();y();G();l();if(U.isModerator){O()}J(".TT-vc-modal__close",ai).bind("click",X).bind("keydown",function(an){if(H(an)){X.call(this,an)}});J(".TT-close-icon",ai).focus()}function i(){var an,ap,ao,ar=document.documentElement.clientWidth,S=document.documentElement.clientHeight;if(ar<v){an=Math.floor(ar*d);ap="auto";ao=J(window).scrollTop()+20}else{an=Math.min(aj,Math.floor(ar*r));ap=Math.min(aa,Math.floor(S*ak));ao=Math.floor((S-ap)/2)+J(window).scrollTop()}var aq=Math.floor((ar-an)/2)+J(window).scrollLeft();N.css({position:"absolute",width:an,height:ap,top:ao,left:aq})}function Y(){J(window).bind("resize",function(S){clearTimeout(R);R=setTimeout(F,T)})}function F(){i();var ao=E[h];var ap=J(".TT-vc-carousel__media-block",ai);if(g){if(B()<s()){ap.height(ap.width())}else{ap.css({height:"100%"})}}var S=ap.width();var an=ap.height();if(ao.type=="photo"){J(".TT-vc-carousel__media-block img",ai).css(o(ao,S,an))}else{M(J(".TT-vc-carousel__media-block iframe",ai),S,an)}}function f(S){var ap=E[S];ai.data("index",S);var ar=J(".TT-vc-carousel__media-block",ai);var an=ar.width();var ao=ar.height();ap.isLoaded=true;if(ap.type=="photo"){J(".TT-vc-carousel__media-block",ai).html(b(ap));J(".TT-vc-carousel__media-block img",ai).css(o(ap,an,ao))}else{J(".TT-vc-carousel__media-block",ai).html(a(ap,an,ao))}J(".TT-vc-caption__text",ai).html(ap.caption);if(ap.user){J(".TT-vc-caption__author",ai).html(k(ap.user)+",")}J(".TT-vc-caption__timestamp",ai).html(ap.dateCreated);var aq={baseImgUrl:c,catItems:ap.catItems?ap.catItems:[]};J(".TT-products-list",ai).html(TTMediaModalHTML.associatedProductsList(aq));n(ap);I(ap)}function k(S){var an=S.nName?S.nName:S.fName;if(!S.nName&&an&&S.lName){an+=" "+S.lName[0]+"."}return an}function ag(){if(P){return}P=true;return U.getMediaPromise().then(function(S,an){E.push.apply(E,S);af=E.length;Q=an;P=false},function(){P=false})}function ae(){E[h].isLoaded=true;var S=setInterval(function(){if(!L){if(!Q){clearInterval(S)}L=true;m(h,"next")}},3000)}function m(aq,ap){var S=ap=="next"?aq+1:aq-1;if(S>=E.length){m(h,"prev")}else{if(S>=0){var ao=E[S];if(ao.isLoaded){m(S,ap)}else{ao.isLoaded=true;if(ao.type=="photo"){var an=new Image();an.onload=function(){m(S,ap)};an.src=ac(ao)}else{m(S,ap)}}}else{L=false}}}function ac(S){var an="//"+j.imageStoreBase,ao="/"+S.imageId;if(S.imageProcessed==1){an+="/media/"+j.siteKey;ao+=g?"_L1000":"_L1800"}else{an+="/media/temp"}an+=(ao+"."+S.imageType);return an}function b(an){var S="";if(an.imageProcessed!=1&&an.orientation&&an.orientation!=1&&!W.isIOS){S="TTorientation-"+an.orientation}return'<img src="'+ac(an)+'" class="'+S+'" alt="'+(an.caption?an.caption:V.msg("tra.mediaModal.userSubmittedPhoto"))+'">'}function o(an,ap,S){var ar={},at=an.width,aq=an.height,au=at/aq;var av=g?500:900;if(an.imageProcessed==1){if(at>=aq&&at>av){at=av;aq=Math.floor(av/au)}else{if(aq>at&&aq>av){aq=av;at=Math.floor(av*au)}}}else{if(an.orientation&&an.orientation!=1&&W.isIOS&&ad(an.orientation)){at=an.height;aq=an.width}}var ao=(ap/at)<(S/aq);if((ao&&at<ap)||(!ao&&aq<S)){ar.width=at;ar.height=aq;ar.top=Math.floor((S-aq)/2);ar.left=Math.floor((ap-at)/2)}else{if(ao&&at>=ap){ar.width=ap;ar.height=Math.floor(aq*ap/at);ar.left=0;ar.top=Math.floor((S-ar.height)/2)}else{if(!ao&&aq>=S){ar.height=S;ar.width=Math.floor(at*S/aq);ar.left=Math.floor((ap-ar.width)/2);ar.top=0}}}return ar}function a(an,ap,S){var ao=J(an.html);M(ao,ap,S);return J("<div></div>").append(ao).html()}function M(at,aw,au){var av=at.attr("width")/at.attr("height"),aq=aw/au,ao=av>=aq,ap=aw,S=au,ar=0,an=0;if(ao){S=Math.floor(ap/av);ar=Math.floor((au-S)/2)}else{ap=Math.floor(S*av);an=Math.floor((aw-ap)/2)}at.attr({width:ap,height:S});at.css({top:ar,left:an})}function ad(S){return J.inArray(S,[5,6,7,8])!==-1}function e(){if(af==1&&!Q){return}var ap=J(".TT-vc-carousel__back",ai);var an=J(".TT-vc-carousel__next",ai);if((h+1)<af||Q){an.show()}if(h>0){ap.show()}var ao=function(aq){if(h>0){h--;f(h)}if(h==0){ap.hide()}an.show()};ap.unbind("click").bind("click",ao).unbind("keydown").bind("keydown",function(aq){if(H(aq)){ao.call(aq)}});var S=function(at){if((h+1)<af||Q){if(h+1>=af){an.hide();var av=J(".TT-vc-carousel .TT-spinner",ai).show();var ar=h+1;var au=function(){an.show();av.hide();if(ar==h+1){h++;f(h)}};if(P){var aq=setInterval(function(){if(!P){clearInterval(aq);au()}},500)}else{ag().then(au)}}else{h++;f(h)}}if((h+1)>=af){an.hide()}ap.show();if(Q&&!P&&h+3>=af){ag()}};an.unbind("click").bind("click",S).unbind("keydown").bind("keydown",function(aq){if(H(aq)){S.call(aq)}})}function n(S){ab(".TT-icon-thumbs-up",S.votedOn)}function I(S){ab(".TT-icon-flag",S.flagged)}function ab(an,aq){var S=J(an,ai),ao=aq?"TT-is-on":"TT-is-off",ap=aq?"TT-is-off":"TT-is-on";S.addClass(ao).removeClass(ap);aq?S.parent().addClass("TT-disabled"):S.parent().removeClass("TT-disabled")}function z(){var an=J(".TT-icon-thumbs-up",ai).parent();var S=function(){var ao=E[h];if(ao.votedOn){return}q.ajax("/traServer4/"+j.siteKey+"/v4_3/gallery/vote/"+ao.id+"?curl="+encodeURIComponent(document.URL),{},"TurnToMods.mods.mediaModal.handleVote")};an.unbind("click").bind("click",S).unbind("keydown").bind("keydown",function(ao){if(H(ao)){S.call(this,ao)}})}function x(an){var S=w(an.id);E[S].votedOn=true;if(S==h){n(E[S])}}function y(){var av=[{value:"spam",name:V.msg("tra.flagMedia.type.spam")},{value:"offensive",name:V.msg("tra.flagMedia.type.offensive")},{value:"ipViolation",name:V.msg("tra.flagMedia.type.ipViolation")},{value:"offTopic",name:V.msg("tra.flagMedia.type.offTopic")}];ai.append(TTMediaModalHTML.flagMedia({flagOptions:av,msgMod:V,staticHost:j.staticHost}));var S=J(".TT-icon-flag",ai),au=J(".TT-flag-vc-modal",ai),az=S.offset().top-ai.offset().top-ai.scrollTop(),at=S.offset().left-ai.offset().left-ai.scrollLeft(),ap=J(".TT-submit-btn",au),ay=J(".TT-modal-overlay",ai),aq=200,ax=260;if(B()<v){var ao=Math.floor(ai.width()/2)-(ax/2);au.css({top:az-aq,left:ao})}else{if(ai.height()-az<aq+10){var aw=Math.floor((ai.height()-aq)/2);au.css({top:aw,left:at-ax})}else{au.css({top:az+10,left:at-(ax/2)})}}J(".TT-link--upper",au).bind("click",function(aA){aA.preventDefault();ay.hide();au.hide()});ay.bind("click",function(){ay.hide();au.hide()});var an=function(){if(ap.hasClass("TT-disabled")){return}ap.addClass("TT-disabled").removeClass("TT-active");J(".TT-spinner",au).show();var aA=E[h];var aB=J("input[name=ttMediaFlagType]:checked",au).val();q.ajax("/traServer4/"+j.siteKey+"/v4_3/gallery/flag/"+aA.id+"/"+aB+"?curl="+encodeURIComponent(document.URL),{},"TurnToMods.mods.mediaModal.handleFlag")};ap.bind("click",an).bind("keydown",function(aA){if(H(aA)){an.call(this)}});J("input[name=ttMediaFlagType]",au).bind("click",function(){if(J("input[name=ttMediaFlagType]:checked",au).length>0){ap.addClass("TT-active").removeClass("TT-disabled")}});var ar=function(){if(E[h].flagged){return}J(".TT-modal-overlay",ai).show();J(".TT-spinner",au).hide();J(".TT-submit-btn",au).addClass("TT-disabled").removeClass("TT-active");J("input[name=ttMediaFlagType]:checked",au).attr("checked",false);au.show()};S.parent().bind("click",ar).bind("keydown",function(aA){if(H(aA)){ar.call(this);ap.addClass("TT-active").removeClass("TT-disabled");J(".TT-radio__input",au).first().click().focus()}})}function u(an){var S=w(an.id);E[S].flagged=true;if(S==h){I(E[S])}J(".TT-flag-vc-modal",ai).hide();J(".TT-modal-overlay",ai).hide()}function l(){var an=function(){var ao=J(this).closest("li");if(typeof TurnToCatItemId!="undefined"&&ao.data("cat-item-id")==TurnToCatItemId){X();window.scrollTo(0,0)}else{window.open(ao.data("cat-item-url"),"_self")}};var S=".TT-shop-now-button,.TT-products-list__title,.TT-products-list__image";J(".TT-products-list",ai).delegate(S,"click",an).delegate(S,"keydown",function(ao){if(H(ao)){an.call(this)}})}function G(){var an=function(aq){aq.preventDefault();var ap=E[h],ao=J(this).find("i");if(ao.hasClass("TT-icon-pinterest")){t(ap,16)}else{if(ao.hasClass("TT-icon-facebook")){t(ap,9)}else{if(ao.hasClass("TT-icon-twitter")){t(ap,10)}}}return false};var S=".TT-vc-modal-actions__group--share .TT-vc-modal-actions__icon";ai.delegate(S,"click",an);ai.delegate(S,"keydown",function(ao){if(H(ao)){an.call(this,ao)}})}function t(an,av){var au="https://"+j.host+"/transLink/"+av+"/vc/"+an.id+"/"+j.locale+"?sid="+U.siteId+"&vcId="+an.id;var ay=encodeURIComponent(an.caption),ar,ao,aw,S=600,ax=400,aq=(B()/2)-(S),at=(s()/2)-(ax);if(an.type=="photo"){ar=encodeURIComponent("https:"+ac(an))}else{ar=encodeURIComponent(an.thumbnailUrl)}if(av==16){ao="https://www.pinterest.com/pin/create/button/?media="+ar+"&description="+ay;aw="url"}else{if(av==9){var az=encodeURIComponent(an.caption+" | "+k(an.user)+" | "+U.siteName);ao="https://www.facebook.com/dialog/feed?app_id="+U.appId+"&caption="+ay+"&description="+az+"&picture="+ar;aw="link"}else{if(av==10){if(an.type=="video"){ay+=" "+an.providedLink}ao="https://twitter.com/intent/tweet/?text="+ay;aw="url"}}}var ap="https://"+p+"/traServer4/socialRedirect?ttUrl="+encodeURIComponent(au)+"&socialUrl="+encodeURIComponent(ao)+"&urlParamName="+aw;window.open(ap,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width="+S+",height="+ax+",top="+at+",left="+aq);return false}function O(){var S="//"+j.host+"/visualContents/vcsolo?siteId="+U.siteId+"&id=";J(".TT-moderate-link",ai).bind("click",function(an){an.preventDefault();window.open(S+E[h].id,"_blank")}).show()}function X(S){if(S){S.preventDefault()}if(N!==undefined){N.remove()}if(ah!==undefined){ah.remove()}}function w(ao){var S=null;for(var an=0;an<E.length;an++){if(E[an].id==ao){S=an;break}}return S}function B(){if(g){return document.documentElement.clientWidth}else{return screen.width}}function s(){if(g){return document.documentElement.clientHeight}else{return screen.height}}function H(an){var S=(an.keyCode?an.keyCode:an.which);return S=="13"}return{display:C,handleVote:x,handleFlag:u,close:X}});
/*
checksum:
6eb8ffd4aeb0c508238af4baf046ecb2
*/
TTMediaModalHTML={spinner:new Function("obj","var p=[];with(obj){p.push('<img class=\"TT-spinner\" src=\"//',staticHost,'/images/tra/trans_spinner.gif\" alt=\"',msgMod.msg('tra.commom.alt.loading'),'\" style=\"display:none;\">');}return p.join('');"),associatedProductsList:new Function("obj","var p=[];with(obj){p.push('');for(var i = 0; i < catItems.length; i++) { var catItem = catItems[i];p.push('    <li data-cat-item-url=\"',catItem.url,'\" data-cat-item-id=\"',catItem.id,'\">     <img class=\"TT-products-list__image\" src=\"',baseImgUrl,'',catItem.imageId,'L.png\" tabindex=\"0\" alt=\"',catItem.title,'\">     <div class=\"TT-products-list__info\">        <div class=\"TT-products-list__title\">',catItem.title,'</div>        <div class=\"TT-shop-now-button\" tabindex=\"0\"></div>       </div>    </li>');}p.push('<!-- -->            ');}return p.join('');"),flagMedia:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT-flag-vc-modal\" style=\"display:none\">  <div class=\"TT-flag-vc-modal__prompt\">',msgMod.msg('tra.flagMedia.prompt'),'</div>  <ul class=\"TT-flag-vc-options\">    ');for(var i = 0; i < flagOptions.length; i++) {        var option = flagOptions[i];    p.push('      <li class=\"TT-flag-vc-options__item\">        <label class=\"TT-radio\">          <input class=\"TT-radio__input\" type=\"radio\" name=\"ttMediaFlagType\" value=\"',option.value,'\">          <span class=\"TT-radio__outer\"><span class=\"TT-radio__inner\"></span></span>',option.name,'        </label>      </li>    ');}p.push('  </ul>  <div class=\"TT-flag-vc-btns\">    <div class=\"TT-submit-btn TT-disabled\" tabindex=\"0\">      ',TTMediaModalHTML.spinner({staticHost: staticHost, msgMod: msgMod}),'    </div>    <a class=\"TT-link--upper\" href=\"#\">',msgMod.msg('tra.common.button.cancel'),'</a>  </div></div>');}return p.join('');"),mediaModal:new Function("obj","var p=[];with(obj){p.push(' <div class=\"TT-vc-modal__close\"><div class=\"TT-close-icon\" aria-label=\"',msgMod.msg('tra.common.label.close'),'\" title=\"',msgMod.msg('tra.common.label.close'),'\" tabindex=\"0\"></div></div> <div class=\"TT-vc-carousel\">  <div class=\"TT-vc-carousel__back\" style=\"display:none;\" aria-label=\"',msgMod.msg('tra.mediaModal.button.previous'),'\" tabindex=\"0\" role=\"button\"></div>  <div class=\"TT-vc-carousel__media-block\"></div>  <div class=\"TT-vc-carousel__next\" style=\"display:none;\" aria-label=\"',msgMod.msg('tra.mediaModal.button.next'),'\" tabindex=\"0\" role=\"button\"></div>    ',TTMediaModalHTML.spinner({staticHost: staticHost, msgMod: msgMod}),' </div> <div class=\"TT-vc-modal__info\">    <div class=\"TT-vc-caption\">      <span class=\"TT-vc-caption__text\"></span>      <span class=\"TT-vc-caption__author\"></span>      <span class=\"TT-vc-caption__timestamp\"></span>  </div>  <div class=\"TT-vc-modal-actions\">     <div class=\"TT-vc-modal-actions__group\">        <div class=\"TT-vc-modal-actions__icon\" tabindex=\"0\"><i class=\"TT-icon-thumbs-up TT-is-off\" aria-label=\"',msgMod.msg('tra.mediaModal.upvote'),'\"></i></div>     </div>        <div class=\"TT-vc-modal-actions__group TT-vc-modal-actions__group--share\">         <div class=\"TT-vc-modal-actions__icon\" tabindex=\"0\"><i class=\"TT-icon-pinterest\" aria-label=\"',msgMod.msg('tra.mediaModal.pinterest'),'\"></i></div>         <div class=\"TT-vc-modal-actions__icon\" tabindex=\"0\"><i class=\"TT-icon-facebook\" aria-label=\"',msgMod.msg('tra.mediaModal.facebook'),'\"></i></div>         <div class=\"TT-vc-modal-actions__icon\" tabindex=\"0\"><i class=\"TT-icon-twitter\" aria-label=\"',msgMod.msg('tra.mediaModal.twitter'),'\"></i></div>      </div>        <div class=\"TT-vc-modal-actions__group\">         <div class=\"TT-vc-modal-actions__icon\" tabindex=\"0\"><i class=\"TT-icon-flag TT-is-off\"aria-label=\"',msgMod.msg('tra.mediaModal.flagInappropriate'),'\"></i></div>      </div>        <a class=\"TT-moderate-link TT-link--upper\" style=\"display:none;\" href=\"#\">',msgMod.msg('tra.common.linkLine.moderate'),'</a>  </div>  <section class=\"TT-products-info\">         <ul class=\"TT-products-list\"></ul>     </section> </div>  <div class=\"TT-modal-overlay\" style=\"display:none\"></div>');}return p.join('');")};

/* TurnTo tra.v4.3.a92cf67721462375211b33669658983f095038e0 master.a92cf67721462375211b33669658983f095038e0 Mon Aug 06 09:31:05 PDT 2018 (c) 2017, TurnTo Networks, Inc. http://www.turnto.com/tra4/licenses.html */TurnToMods.define("shareMedia",["fileUpload","imageUtil","browserUtil","util"],function(J,g,v,Q){var j=TurnTo.S;var R=TurnTo.msg;var i=TurnTo.matchData.site.vcSettings;var h="#TTshareMediaScreen";var ab;var e;var X;var E=TurnTojQuery;var ad=100;var b=5;var H=90;var d=90;function L(ah){e=ah;e.startAction=e.startAction||"rateIt";if(e.startAction==="shareAPhoto"){e.shareMediaPromptText=j.visualContentSharePrompt}else{if(e.startAction==="rateIt"&&e.onMobile===true){e.shareMediaPromptText=j.visualContentSharePromptForReviewAfterRateItOnMobile}else{e.shareMediaPromptText=j.visualContentSharePromptForReview}}if(!e.onMobile&&e.startAction!="shareAPhoto"){e.imagesWillBeAddedMsg=TurnTo.msg("tra.shareMedia.message.imagesWillBeAddedToGallery")}else{e.imagesWillBeAddedMsg=null}e.allMediaMap={photo:[],video:[],audio:[]};e.mediaSelCntMap={photo:0,video:0,audio:0};X=false;ab=E(h);ab.empty();TurnTo.insertScreen(TurnTojQuery(h),TurnToHTML.shareMediaScreen,e);ab=E(h);ab.data("catItemId",e.catItem.id);ab.show();M(e.mediaType);W();ag(w);a();n();var S=ab.siblings("#TTmobileHeader");TurnToTrack.track("TTshareMediaScreen Displayed",e);TurnToTrack.addCloseLinkMetrics(S,"TTshareMediaScreen")}function q(){var S=E("#TTmediaListCont-photo",ab);J.init({acceptedMimeTypes:i.acceptedImageMimeTypes,maxFileSize:i.maxImageSize,uploadForm:E("#TTuploadForm",S),dropArea:null,bindingElem:S,onMobile:e.onMobile});S.bind("ttFileUpload.start",r);S.bind("ttFileUpload.complete",U);S.bind("ttFileUpload.fail",o)}function r(ak,S){E(".TTvc-add-new-photo").css("opacity",0.2);var al=E("#TTmediaListCont-photo",ab);var aj=[];for(var ai=0;ai<S.length;ai++){var ah={id:null,tmpId:S[ai].uploadId,type:"photo",caption:"",provider:"",selected:false,imageId:null,imageType:null,uploadFileName:S[ai].name,file:S[ai].file?S[ai].file:null};aj.push(Z(al,ah))}E.when.apply(E,aj).then(function(){f(al)})}function Z(ak,ai){var aj=E.Deferred();var ah=ai.file;if(ah&&ah.type.indexOf("jpeg")!==-1){var S=new FileReader();S.onload=function(al){var am=g.getOrientation(S.result);ai.orientation=am&&am!==-1?am:1;F(ak,ai);aj.resolve()};S.readAsArrayBuffer(ah)}else{F(ak,ai);aj.resolve()}return aj}function F(aj,S){var ai=E(".TTmediaBlock",aj).eq(0);e.allMediaMap.photo.unshift(S);var ah=E(TurnToHTML.mediaBlockPhoto({photo:S,addDataAttrs:true,isIOS:v.isIOS}));ai.after(ah);if(S.file){x(S,ah)}P(ah,"photo",aj)}function U(al,ak){E(".TTvc-add-new-photo").css("opacity",1);for(var ai=0;ai<ak.length;ai++){var am=ak[ai].uploadId;var S=af(null,am,"photo");var aj=e.allMediaMap.photo[S];if(S>-1){aj.imgLoaded=true;aj.imageId=ak[ai].imageId;aj.imageType=ak[ai].imageType;aj.width=ak[ai].width;aj.height=ak[ai].height;aj.orientation=ak[ai].orientation}var ah=E("#TTmediaListCont-photo .TTmediaBlock[data-tmp-id="+am+"], .TTcaptionBlock[data-tmp-id="+am+"]",ab);E.each(ah,function(ap,ao){var an=E(ao);if(E("img",an).length==0){an.append(TurnTo.getMediaImg(aj,"PZ-88"))}E(".TTtransSpinner",an).hide()})}}function o(aj,an){E(".TTvc-add-new-photo").css("opacity",1);var am=[];var ai=E("#TTcaptionAddCont",ab).is(":visible");for(var ah=0;ah<an.length;ah++){var ak="tra.shareMedia.uploadErr."+an[ah].errorCode;var S=an[ah].args;var al=an[ah].uploadId;if(al){D(al,"photo");if(ai){am.push({code:ak,tmpId:al,args:S});K(E(".TTcaptionBlock[data-tmp-id="+al+"]",ab),3000);E("#TTmediaListCont-photo .TTmediaBlock[data-tmp-id="+al+"]",ab).remove()}else{u(ak,S);y(E("#TTmediaListCont-photo .TTmediaBlock[data-tmp-id="+al+"]",ab))}}else{if(ai){am.push({code:ak,args:S})}else{u(ak,S)}}}if(ai){B(am,true)}}function u(ai,S){var ah=E('<div class="TTfieldErr">'+R(ai,S)+"</div>");E("#TTselectedMediaInfo",ab).prepend(ah);y(ah)}function x(ai,S){var ah=new FileReader;var aj=E("img",S);ah.onload=function(){var ak=new Image();ak.src=ah.result;ak.onload=function(){if(v.isIOS&&g.isRotated(ai.orientation)){ai.width=ak.height;ai.height=ak.width}else{ai.width=ak.width;ai.height=ak.height}var al=g.getPanZoomCss(ai.width,ai.height,H,d);aj.css(al);ai.imgStyles=aj.attr("style")}};ah.readAsDataURL(ai.file)}function y(S,ah){if(!ah&&ah!==0){ah=3000}setTimeout(function(){E(S).slideUp("slow",function(){E(this).remove()})},ah)}function M(ah){var S=this;E(".TTmediaBtn",ab).bind("click keydown",function(ao){if(ao.type=="keydown"&&!G(ao)){return}ao.preventDefault();var aj=TurnTojQuery(this);var al=aj.data("type");e.mediaType=al;var an=aj.parent().find('[class*="-on"]');if(an.length>0){var ai=an.data("type");var am="TTvc-bar-media-lg-"+ai;an.removeClass(am+"-on");an.addClass(am)}ae(al);var ak="TTvc-bar-media-lg-"+al;aj.removeClass(ak);aj.addClass(ak+"-on");E("[class*=TTnew]",ab).hide();E(".TTnew"+Q.capitalize(al),ab).show();if(al==="video"){E(".TTnewVideo .TTlinkedContent",ab).hide()}f(E("#TTmediaListCont-"+al,ab))});if(ah==="video"){E(".TTmediaBtn[data-type=video]",ab).click()}}function W(){var S=E(".TTnewVideo .TTlinkedContent",ab);E("input#providedLink",S).bind("change keyup input",function(ai){var aj=E(this).val();E("hr",S).removeClass("TTmediaLinkError");E(".TTmediaLinkInputError",S).hide();E(".TTmediaLinkInputInst",S).show();var ah=E(".TTsubmitLinkedContentBtn",S);if(E.trim(aj).length<1){ah.removeClass("TTvc-add-video").addClass("TTvc-add-video-disabled").attr("tabindex",-1)}else{ah.removeClass("TTvc-add-video-disabled").addClass("TTvc-add-video").attr("tabindex",0)}});S.delegate(".TTsubmitLinkedContentBtn.TTvc-add-video","click keydown",function(ah){if(ah.type=="keydown"&&!G(ah)){return}m(S)});E(".TTaddLinkedContentCtrls .TTcancelLink",S).bind("click keydown",function(ai){if(ai.type=="keydown"&&!G(ai)){return}ai.preventDefault();E("input#providedLink",S).val("");E(".TTsubmitLinkedContentBtn",S).removeClass("TTvc-add-video").addClass("TTvc-add-video-disabled");S.hide();var ah=E("#TTmediaListCont",ab);ah.show();E("#TTmediaListCont-video",ah).show()})}function z(ai,ah){var S=E("#TTmediaSubmitBtn",ab);if(ai=="hidden"){S.hide()}else{S.show()}if(ah&&ai=="enabled"){S.addClass("TTvc-submit").removeClass("TTvc-submit-disabled").unbind("click keydown").bind("click keydown",function(aj){if(aj.type=="keydown"&&!G(aj)){return}ah.call(this)}).attr("tabindex",0)}else{S.addClass("TTvc-submit-disabled").removeClass("TTvc-submit").unbind("click keydown").attr("tabindex",-1)}}function ag(S){var ah="&catItemId="+e.catItem.id;if(e.mediaIdsToPreselect&&e.mediaIdsToPreselect.length>0){ah+="&preSelectedIds="+e.mediaIdsToPreselect.join(",")}TurnTo.xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:TurnTo.xhrUri("/traServer4/getMediaContent4User",e.siblingSiteKey)+ah,load:function(aj,ai){e.allMediaMap=aj.mc;TurnTo.insertScreen(E("#TTmediaListCont-photo"),TurnToHTML.mediaLists,{model:e,type:"photo",isIOS:v.isIOS});TurnTo.insertScreen(E("#TTmediaListCont-video"),TurnToHTML.mediaLists,{model:e,type:"video"});S()},error:function(aj,ai){}})}function s(ai){var S=E("#TTmediaListCont",ab);var ak=E("#TTmediaListCont-"+ai,S);var aj=ak.find(".TTmediaList");var ah=aj.find(".TTmediaBlock");if(S.is(":visible")&&ak.is(":visible")){f(ak)}ah.eq(0).bind("click keydown",function(am){if(am.type=="keydown"&&!G(am)){return}if(ai==="video"){var al=E(".TTnewVideo .TTlinkedContent",ab);E("input#providedLink",al).val("");E(".TTsubmitLinkedContentBtn",al).removeClass("TTvc-add-video").addClass("TTvc-add-video-disabled");E(".TTmediaLinkInputError",al).text("").hide();E("hr",al).removeClass("TTmediaLinkError");al.show();S.hide()}else{if(ai==="photo"){}}});if(ai=="photo"&&!X){X=true;q()}ak.delegate(".TTmediaBlock","click",function(){P(this,ai,ak)});T()}function P(ai,ah,S){if(ai===E(".TTmediaBlock:first",S)[0]){return}var aj=E(ai,S);aj.toggleClass("TTselected");I(aj.data("id"),aj.data("tmp-id"),ah,aj.hasClass("TTselected"));T()}function f(S){var ah=E(".TTmediaBlock",S);ah.removeClass("TThidden");var aj=ah.length-1;var an=E(".TTmediaList",S).width();var al=E(".TTmediaBlock:first",S).outerWidth(true);var am=Math.floor(an/al)-1;var ak=E('div[class^="TTvc-next"]',S);var ai=E('div[class^="TTvc-back"]',S);if(aj>am){ak.removeClass("TTvc-next-disabled").addClass("TTvc-next")}ak.unbind("click").bind("click",function(){if(!ak.hasClass("TTvc-next-disabled")){var aq=E(".TTmediaBlock",S);var ap=aq.filter(".TThidden");var ao=aq.slice(ap.length+1);var ar=0;E.each(ao,function(){if(ar<am){E(this).addClass("TThidden");ar++}});if(ao.length-ar-am<=0){ak.removeClass("TTvc-next").addClass("TTvc-next-disabled")}ai.removeClass("TTvc-back-disabled").addClass("TTvc-back")}});ai.unbind("click").bind("click",function(){if(!ai.hasClass("TTvc-back-disabled")){var aq=E(".TTmediaBlock",S);var ap=aq.filter(".TThidden");var ao=ap.slice(ap.length-am);ao.removeClass("TThidden");if(ap.length-am<=0){ai.removeClass("TTvc-back").addClass("TTvc-back-disabled")}ak.removeClass("TTvc-next-disabled").addClass("TTvc-next")}})}function T(){var S=p();if(S>0&&S<=b){z("enabled",V)}else{z("disabled")}}function p(){return e.mediaSelCntMap.photo+e.mediaSelCntMap.video+e.mediaSelCntMap.audio}function w(){s("photo");s("video");if(e.mediaIdsToPreselect&&e.mediaIdsToPreselect.length>0){var al=E("#TTmediaListCont-photo",ab);var ah=E("#TTmediaListCont-video",ab);var aj=E(".TTmediaBlock",al);var ai=E(".TTmediaBlock",ah);for(var ak=0,S=aj.length;ak<S;ak++){if(E.inArray(aj.eq(ak).data("id"),e.mediaIdsToPreselect)>-1){P(aj.eq(ak),"photo",al)}}for(var ak=0,S=ai.length;ak<S;ak++){if(E.inArray(ai.eq(ak).data("id"),e.mediaIdsToPreselect)>-1){P(ai.eq(ak),"video",ah)}}}}function I(al,ak,ah,ai){var S=af(al,ak,ah);if(S>-1){var aj=e.allMediaMap[ah][S].selected;e.allMediaMap[ah][S].selected=ai;if(aj!==ai){e.mediaSelCntMap[ah]=ai?e.mediaSelCntMap[ah]+1:e.mediaSelCntMap[ah]-1}t()}}function D(ai,ah){var S=af(null,ai,ah);if(S>-1){e.allMediaMap[ah].splice(S,1);e.mediaSelCntMap[ah]--;t()}}function t(){var al=E("#TTselectedMediaCnts",ab);var ao=e.mediaSelCntMap.photo;var am=e.mediaSelCntMap.video;var ai=ao+am;var an="tra.shareMedia.photosSelected.counts."+TurnTo.getPlural(ao);var ah="tra.shareMedia.videosSelected.counts."+TurnTo.getPlural(am);al.html(R(an,[ao])+R(ah,[am]));var ak=E("#TTtooManyMediaSelected");if(ai>b){var S=ai-b;var aj="tra.shareMedia.tooManyMediaSelected.error."+TurnTo.getPlural(S);ak.text(R(aj,[b,S]));ak.show();TurnToTrack.addErrorMetric("TTshareMediaScreen","tooManyMediaSelected")}else{ak.text("");ak.hide()}}function A(ak,aj,ai,ah){var S=af(ak,aj,ai);if(S>-1){e.allMediaMap[ai][S].caption=ah}}function af(al,ak,aj){var ah=e.allMediaMap[aj];if(ah&&ah.length>0){if(!ak||ak===""){for(var ai=0,S=ah.length;ai<S;ai++){if(ah[ai].id==al){return ai}}}else{for(var ai=0,S=ah.length;ai<S;ai++){if(ah[ai].tmpId==ak){return ai}}}return -1}}function a(){var S=E("#TTcaptionAddCont",ab);S.delegate(".TTmediaRemove","click",function(){K(E(this).parent(),0)})}function K(S,ai){var ah=S.closest("#TTcaptionAddCont");var am=S.data("id");var al=S.data("tmp-id");var aj=S.data("type");I(am,al,aj,false);E("#TTmediaListCont-"+aj+" .TTselected[data-id="+am+"][data-tmp-id="+al+"]",ab).removeClass("TTselected");var ak=ah.find(".TTcaptionBlock").length-1;if(ak==0){z("disabled")}else{z("enabled",k)}E(".TTaddFilesPrompt",ab).toggle(ak<b);if(ak<b){E("#TTmediaBtnsCont",ab).show()}else{E("#TTmediaBtnsCont",ab).hide()}y(S,ai)}function V(){E("#TTselectedMediaInfo",ab).hide();E("#TTmediaAddCont",ab).hide();var ak=E("#TTmediaListCont",ab);ak.hide();var an=E('.TTmediaBtn[class*="-on"]',ab);var ah="TTvc-bar-media-lg-"+an.data("type");an.removeClass(ah+"-on").addClass(ah);var al=E("#TTcaptionAddCont",ab);al.empty();var am=c("photo");if(am.length>0){al.append(TurnToHTML.shareMediaCaptions({media:am,type:"photo",isIOS:v.isIOS}));l(am,al)}var aj=c("video");if(aj.length>0){al.append(TurnToHTML.shareMediaCaptions({media:aj,type:"video"}));l(aj,al)}al.show();E(".TTmediaRow .TTmediaSubmitBtns").addClass("TTonAddCaptions");var ai=al.find(".TTcaptionBlock");var ao=E.grep(ai,function(ap){var aq=E(ap);return aq.data("tmp-id")&&E.trim(aq.find("textarea").val())==""});if(e.startAction==="shareAPhoto"){E("#TTcaptionOtherNote",ab).show()}var S=ao.length===0?j.visualContentCaptionsPromptWhenNoneEditable:j.visualContentCaptionsPrompt;E(".TTmediaPrompt p:first",ab).html(S);E(".TTaddFilesPrompt",ab).html(R("tra.shareMedia.prompt.addMoreFiles")).removeClass("TTrespMobileDisp").toggle(ai.length<b);ai.length<b?E("#TTmediaBtnsCont").show():E("#TTmediaBtnsCont").hide();z("enabled",k);if(e.onMobile){E(".TTmediaSubmitBtns .TTcancelLink, .TTskipLink",ab).hide()}E(".TTmediaBtn",ab).unbind("click.ttBack keydown.ttBack").bind("click.ttBack keydown.ttBack",function(ap){if(ap.type=="keydown"&&!G(ap)){return}E(".TTmediaBtn",ab).unbind("click.ttBack");O()})}function l(S,ah){E.each(S,function(aj,ai){if(ai.tmpId){var ak=ah.find(".TTcaptionBlock[data-tmp-id="+ai.tmpId+"]");ak.find("textarea").bind("keyup change input",function(){var am=E.trim(E(this).val());A("",ai.tmpId,ai.type,am);var al=am.length;if(al>ad&&ak.find(".TTfieldErr").length==0){B([{code:"tra.shareMedia.captionErr.max",args:[ad],tmpId:ai.tmpId}],false)}else{if(al<=ad){ak.find(".TTfieldErr").remove()}}})}})}function c(aj){var ah=e.allMediaMap[aj];var ak=[];for(var ai=0,S=ah.length;ai<S;ai++){if(ah[ai].selected===true){ak.push(E.extend(true,{},ah[ai]))}}ak.sort(N);return ak}function N(ah,S){if(ah.tmpId&&S.tmpId){if(ah.caption===""&&S.caption===""){return 0}else{if(ah.caption===""&&S.caption!==""){return -1}else{if(S.caption===""&&ah.caption!==""){return 1}}}}else{if(ah.tmpId&&!S.tmpId){return -1}else{if(!ah.tmpId&&S.tmpId){return 1}else{return 0}}}}function k(){z("disabled");E(".TTmediaSubmitBtns .TTimgLoading",ab).show();var S={media:[],assoc:[]};var ai=[];var aj=[];E.each(E("#TTcaptionAddCont .TTcaptionBlock",ab),function(al,ak){var ao=E(ak);var aq=ao.data("tmp-id");var am=ao.data("type");var ap=ao.data("id");var an=e.allMediaMap[am][af(ap,aq,am)];if(aq){if(an.caption.length>ad){aj.push({code:"tra.shareMedia.captionErr.max",args:[ad],tmpId:aq});TurnToTrack.addErrorMetric("TTshareMediaScreen","captionTooLongError")}if(Q.containsEmail(an.caption)){aj.push({code:"tra.common.textErr.emailNotAllowed",tmpId:aq});TurnToTrack.addErrorMetric("TTshareMediaScreen","emailNotAllowedError")}if(Q.containsPhoneNumber(an.caption)){aj.push({code:"tra.common.textErr.phoneNotAllowed",tmpId:aq});TurnToTrack.addErrorMetric("TTshareMediaScreen","phoneNotAllowedError")}if(am=="photo"&&!an.imgLoaded){aj.push({code:"tra.shareMedia.uploadErr.photoNotYetUploaded",tmpId:aq});TurnToTrack.addErrorMetric("TTshareMediaScreen","photoNotYetUploadedError")}S.media.push(an)}else{S.assoc.push(an.id);ai.push(an)}});if(aj.length>0){B(aj,true);return}var ah=function(){S.catItemId=ab.data("catItemId");if(e.transId){S.transId=e.transId}if(e.cosId&&e.cosTransId){S.cosId=e.cosId;S.cosTransId=e.cosTransId}TurnTo.xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:TurnTo.xhrUri("/traServer4/saveMedia",e.siblingSiteKey),postData:TurnTo.toJson(S),load:function(al,ak){if(al.errors&&al.errors.length>0){B(al.errors,true);return}if(al.media){Array.prototype.push.apply(ai,al.media)}Y(ai);TurnToTrack.trackScreenExited("TTshareMediaScreen","submit")},error:function(al,ak){if(!al.errors||al.errors.length==0){al.errors=[{code:3}]}B(al.errors,true);return}})};if(!TurnTo.matchData.user&&TurnTo.params.turntoflow=="review"&&e.startAction=="shareAPhoto"&&TurnTo.initShareMedia.eml){TurnTo.registerAndLogin(ah)}else{ah()}}function B(ah,S){if(S){E("#TTcaptionAddCont .TTfieldErr",ab).remove()}E.each(ah,function(){var ai='<div class="TTfieldErr">'+R(this.code,this.args)+"</div>";if(this.tmpId){var aj=E("#TTcaptionAddCont .TTcaptionBlock[data-tmp-id="+this.tmpId+"]",ab);aj.append(ai)}else{var aj=E("#TTcaptionAddCont .TTcaptionBlock",ab).eq(0);aj.before(ai)}});z("enabled",k);E(".TTmediaSubmitBtns .TTimgLoading",ab).hide()}function Y(S){ab.trigger("ttMediaSelected."+e.shareFor,[S])}function n(){var S=E(".TTmediaSubmitBtns .TTcancelLink",ab);var ah=E(".TTskipLink",ab);if(e.startAction=="shareAPhoto"){S.bind("click",function(ai){ai.preventDefault();if(e.onMobile){var aj=e.catItem.itemUrl?e.catItem.itemUrl:TurnTo.matchData.site.lpUrl;window.location=aj}else{ab.trigger("ttMediaSelectionCancelled."+e.shareFor)}});S.show();ah.hide()}else{ah.bind("click",function(ai){ai.preventDefault();ab.trigger("ttMediaSelectionCancelled."+e.shareFor);TurnToTrack.trackScreenExited("TTshareMediaScreen","skipped/no thanks")});S.hide();ah.show()}}function O(){E("#TTcaptionAddCont",ab).hide();E("#TTcaptionOtherNote",ab).hide();T();E(".TTmediaPrompt p:first",ab).html(e.shareMediaPromptText);E(".TTaddFilesPrompt",ab).html(R("tra.shareMedia.prompt.addFiles")).addClass("TTrespMobileDisp").show();E("#TTmediaAddCont",ab).show();E("#TTmediaListCont",ab).show();E("#TTselectedMediaInfo",ab).show();E(".TTmediaRow .TTmediaSubmitBtns").removeClass("TTonAddCaptions");var ah=E(".TTmediaSubmitBtns .TTcancelLink",ab);var S=E(".TTskipLink",ab);if(e.startAction=="shareAPhoto"){ah.show();S.hide()}else{ah.hide();S.show()}}function C(ai,S){var ah="TTvc-"+(ai.is('[class*="back"]')?"back":"next");if(S=="on"){ai.removeClass(ah+"-disabled");ai.addClass(ah)}else{ai.removeClass(ah);ai.addClass(ah+"-disabled")}}function ae(S){var ah=E("#TTmediaListCont",ab);E("#TTmediaListCont-photo",ah).hide();E("#TTmediaListCont-video",ah).hide();ah.show();E("#TTmediaListCont-"+S,ah).show()}function ac(ak,aj,ah,ai,S){E(".TTmediaCount",ab).html(R("tra.shareMedia.photosOutOf",[ak,aj,ah]));E(".TTPagingNums",ab).html(R("tra.shareMedia.paging",[ai,S]))}function aa(S){var ai=ab.find(".TTmediaList");if(ai.is(":visible")){S();return}var ah=setInterval(function(){if(ai.is(":visible")){clearInterval(ah);S()}},100);setTimeout(function(){clearInterval(ah)},10000)}function m(ah){var S=E("input#providedLink",ah).val();TurnTo.xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:TurnTo.xhrUri("/sitedata/"+j.siteKey+"/v4_3/linkedvideoinfo")+"&providedLink="+encodeURIComponent(S),load:function(am,aj){e.allMediaMap.video.unshift(am.mc);E(".TTnewVideo .TTlinkedContent",ab).hide();var al=E("#TTmediaListCont",ab);var ak=E("#TTmediaListCont-video",al);var ai=E(".TTmediaBlock",ak).eq(0);var an=E(TurnToHTML.mediaBlockVideo({video:am.mc}));ai.after(an);P(an,"video",ak);E("input#providedLink",ah).val("");al.show();ak.show();f(ak)},error:function(aj,ai){E(".TTmediaLinkInputError",ah).text(aj.error).show();E(".TTmediaLinkInputInst",ah).hide();E(".TTmediaLinkInputSep",ah).addClass("TTmediaLinkError");E(".TTsubmitLinkedContentBtn",ah).removeClass("TTvc-add-video").addClass("TTvc-add-video-disabled")}})}function G(ah){var S=(ah.keyCode?ah.keyCode:ah.which);return S=="13"}return{display:L}});
/*
checksum:
c8d52c11ca6d7c797281b7a50d878b91
*/
if(TurnTo.unsupport()){for(prop in TurnTo){if(typeof TurnTo[prop]=="function"){TurnTo[prop]=function(){}}}}else{if(!TurnTo.S.useSetup){if(!TurnTo.S.skipOnload){TurnTojQuery(document).ready(TurnTo.onload)}}};}
/*
checksum:
e9a07dcb3835d439a5a071f35f82b94e
c1ae57b0133b3114310cca9a9caebbb9
867cd6241c303e948a96b64a56a7ed0f
d79de461a3a65e2633ffff73541c9966
5e0f96011d46d9421befe9404be056c2
848b62146966b4212cdea2a1eabafd31
fad58c0e6e585ed34ac740ea15dcf60c
20b5ba40da1d721c692780082fa61cd6
478e1c6b6f184f6a12081ceb96c5a5df
f3721f0461facd702354be3bafe50925
5ecc400dbac619155364272833f1c8fd
b93801473cc4d4e0f96db1c137cb2d24
dcfdf367d1c18005b6b7da2aa88c466a
825d1254b5505d65140b6fff877feddc
ac8eaa0a5b2868ec79173d64282f24eb
cf539a78b99d6c65b626286712af8db6
cbb184dd8e05c9709e5dcaedaa0495cf
*/
